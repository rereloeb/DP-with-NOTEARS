samples  5000  graph  13 26 ER mlp  minibatch size  175  noise  0.5  minibatches per NN training  20 adaclip_and_quantile
cuda
cuda
iteration 1 in inner loop,alpha 0.0 rho 1.0 h 1.3261408551088962
iteration 1 in outer loop, alpha = 1.3261408551088962, rho = 1.0, h = 1.3261408551088962
cuda
iteration 1 in inner loop,alpha 1.3261408551088962 rho 1.0 h 0.8833022561168153
iteration 2 in inner loop,alpha 1.3261408551088962 rho 10.0 h 0.3976662043074768
iteration 3 in inner loop,alpha 1.3261408551088962 rho 100.0 h 0.14473978390051023
iteration 2 in outer loop, alpha = 15.80011924515992, rho = 100.0, h = 0.14473978390051023
cuda
iteration 1 in inner loop,alpha 15.80011924515992 rho 100.0 h 0.09206134723974557
iteration 2 in inner loop,alpha 15.80011924515992 rho 1000.0 h 0.03605103482185257
iteration 3 in outer loop, alpha = 51.85115406701249, rho = 1000.0, h = 0.03605103482185257
cuda
iteration 1 in inner loop,alpha 51.85115406701249 rho 1000.0 h 0.022520091840645406
iteration 2 in inner loop,alpha 51.85115406701249 rho 10000.0 h 0.007430765387507421
iteration 4 in outer loop, alpha = 126.1588079420867, rho = 10000.0, h = 0.007430765387507421
cuda
iteration 1 in inner loop,alpha 126.1588079420867 rho 10000.0 h 0.003776628811836602
iteration 2 in inner loop,alpha 126.1588079420867 rho 100000.0 h 0.0013610307532996302
iteration 5 in outer loop, alpha = 262.2618832720497, rho = 100000.0, h = 0.0013610307532996302
cuda
iteration 1 in inner loop,alpha 262.2618832720497 rho 100000.0 h 0.0007716999804809888
iteration 6 in outer loop, alpha = 1033.9618637530384, rho = 1000000.0, h = 0.0007716999804809888
Threshold 0.3
[[0.001 0.    0.182 2.569 0.635 0.    0.017 0.    0.    0.437 0.    1.888
  0.   ]
 [0.631 0.001 0.321 0.04  0.172 0.002 0.04  0.    0.    2.061 0.001 0.198
  0.   ]
 [0.    0.    0.002 0.    0.    0.    0.001 0.    0.    0.    0.    0.
  0.   ]
 [0.    0.    2.687 0.001 0.109 0.001 0.089 0.    0.    1.627 0.    0.283
  0.   ]
 [0.    0.    0.255 0.    0.001 0.    0.002 0.    0.    0.    0.    0.
  0.   ]
 [0.077 0.029 0.336 0.065 0.609 0.001 0.013 0.    0.114 2.26  0.033 0.126
  0.012]
 [0.009 0.012 1.092 0.025 0.088 0.043 0.027 0.001 0.002 0.973 0.001 0.299
  0.003]
 [0.009 0.007 0.009 0.01  1.505 3.724 0.081 0.001 0.648 0.449 0.002 0.053
  0.   ]
 [0.021 1.541 2.239 0.017 0.092 0.004 0.359 0.    0.    1.386 0.002 0.194
  0.022]
 [0.    0.    1.123 0.    0.242 0.    0.001 0.    0.    0.004 0.    2.362
  0.   ]
 [1.749 0.008 2.559 0.069 0.554 0.    0.012 0.001 0.003 0.986 0.    0.091
  0.001]
 [0.    0.    0.95  0.    0.976 0.    0.001 0.    0.    0.    0.    0.001
  0.   ]
 [0.007 1.023 2.329 0.018 0.272 0.003 0.091 0.    0.006 2.319 0.    0.415
  0.   ]]
[[0.    0.    0.    2.569 0.635 0.    0.    0.    0.    0.437 0.    1.888
  0.   ]
 [0.631 0.    0.321 0.    0.    0.    0.    0.    0.    2.061 0.    0.
  0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.   ]
 [0.    0.    2.687 0.    0.    0.    0.    0.    0.    1.627 0.    0.
  0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.   ]
 [0.    0.    0.336 0.    0.609 0.    0.    0.    0.    2.26  0.    0.
  0.   ]
 [0.    0.    1.092 0.    0.    0.    0.    0.    0.    0.973 0.    0.
  0.   ]
 [0.    0.    0.    0.    1.505 3.724 0.    0.    0.648 0.449 0.    0.
  0.   ]
 [0.    1.541 2.239 0.    0.    0.    0.359 0.    0.    1.386 0.    0.
  0.   ]
 [0.    0.    1.123 0.    0.    0.    0.    0.    0.    0.    0.    2.362
  0.   ]
 [1.749 0.    2.559 0.    0.554 0.    0.    0.    0.    0.986 0.    0.
  0.   ]
 [0.    0.    0.95  0.    0.976 0.    0.    0.    0.    0.    0.    0.
  0.   ]
 [0.    1.023 2.329 0.    0.    0.    0.    0.    0.    2.319 0.    0.415
  0.   ]]
{'fdr': 0.4117647058823529, 'tpr': 0.7692307692307693, 'fpr': 0.2692307692307692, 'f1': 0.6666666666666667, 'shd': 16, 'npred': 34, 'ntrue': 26}
[2.709e-04 1.824e-01 2.569e+00 6.347e-01 4.409e-04 1.688e-02 1.418e-04
 1.314e-04 4.370e-01 2.441e-05 1.888e+00 8.225e-05 6.311e-01 3.206e-01
 3.991e-02 1.718e-01 1.888e-03 4.013e-02 3.257e-04 1.429e-04 2.061e+00
 1.297e-03 1.978e-01 1.038e-04 3.463e-05 1.430e-05 1.019e-04 1.623e-04
 1.429e-05 9.834e-04 5.300e-06 2.169e-05 1.810e-04 1.877e-06 1.476e-05
 1.439e-05 1.233e-04 6.370e-05 2.687e+00 1.093e-01 5.654e-04 8.929e-02
 1.822e-04 4.822e-05 1.627e+00 8.417e-06 2.825e-01 5.350e-05 3.871e-05
 3.550e-05 2.549e-01 1.370e-04 9.870e-06 1.644e-03 7.721e-06 1.615e-05
 1.463e-04 4.828e-06 2.880e-04 1.052e-05 7.735e-02 2.929e-02 3.360e-01
 6.516e-02 6.090e-01 1.331e-02 1.129e-04 1.145e-01 2.260e+00 3.342e-02
 1.261e-01 1.247e-02 9.295e-03 1.173e-02 1.092e+00 2.524e-02 8.756e-02
 4.262e-02 9.732e-04 2.381e-03 9.727e-01 1.082e-03 2.986e-01 2.923e-03
 8.812e-03 6.955e-03 9.492e-03 1.023e-02 1.505e+00 3.724e+00 8.077e-02
 6.482e-01 4.494e-01 1.951e-03 5.338e-02 2.108e-04 2.096e-02 1.541e+00
 2.239e+00 1.656e-02 9.200e-02 4.081e-03 3.586e-01 3.273e-04 1.386e+00
 1.763e-03 1.943e-01 2.219e-02 4.106e-05 8.852e-05 1.123e+00 1.152e-04
 2.416e-01 2.212e-04 1.069e-03 4.351e-05 1.334e-05 6.935e-06 2.362e+00
 3.005e-05 1.749e+00 7.818e-03 2.559e+00 6.923e-02 5.540e-01 3.162e-04
 1.167e-02 8.957e-04 2.919e-03 9.857e-01 9.067e-02 8.555e-04 2.191e-06
 6.270e-06 9.500e-01 2.399e-05 9.764e-01 7.224e-06 1.035e-03 1.079e-06
 2.817e-06 4.822e-05 8.203e-07 9.864e-07 7.113e-03 1.023e+00 2.329e+00
 1.810e-02 2.718e-01 2.717e-03 9.136e-02 2.993e-05 5.610e-03 2.319e+00
 3.833e-04 4.147e-01]
[[0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 1. 0. 0. 0.]
 [0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0. 0. 0.]
 [0. 1. 1. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 1. 0.]
 [1. 0. 1. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 0. 0.]
 [0. 1. 1. 0. 0. 0. 1. 0. 0. 1. 0. 0. 0.]]
[0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0.
 0. 0. 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0. 0.
 0. 1. 1. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 1. 0.
 1. 0. 1. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 0.
 0. 1. 1. 0. 0. 0. 1. 0. 0. 1. 0. 0.]
aucroc, aucpr (0.8715976331360946, 0.7667248028902397)
cuda
1963
cuda
Objective function 480.43 = squared loss an data 285.64 + 0.5*rho*h**2 194.315677 + alpha*h 0.000000 + L2reg 0.24 + L1reg 0.24 ; SHD = 91 ; DAG False
||w||^2 1766731.2055121183
exp ma of ||w||^2 10991364733.8748
||w|| 1329.1844136582847
exp ma of ||w|| 15057.99730115575
||w||^2 2509751.2640182427
exp ma of ||w||^2 10452806571.29938
||w|| 1584.2194494508149
exp ma of ||w|| 14399.052438462115
cuda
Objective function 207.59 = squared loss an data 206.52 + 0.5*rho*h**2 0.866703 + alpha*h 0.000000 + L2reg 0.09 + L1reg 0.11 ; SHD = 37 ; DAG False
Proportion of microbatches that were clipped  0.7194202898550724
iteration 1 in inner loop, alpha 0.0 rho 1.0 h 1.3165887914307852
iteration 1 in outer loop, alpha = 1.3165887914307852, rho = 1.0, h = 1.3165887914307852
cuda
1963
cuda
Objective function 209.32 = squared loss an data 206.52 + 0.5*rho*h**2 0.866703 + alpha*h 1.733406 + L2reg 0.09 + L1reg 0.11 ; SHD = 37 ; DAG False
v before min max tensor([[-3.283e-11, -2.290e-11,  1.163e-10,  ..., -3.260e-11, -2.136e-11,
         -3.337e-11],
        [-3.022e-11, -3.325e-11, -1.161e-11,  ...,  1.361e-11, -3.316e-11,
          2.967e-11],
        [-1.780e-11,  8.552e-12,  1.984e-11,  ...,  1.530e-11, -3.227e-11,
         -2.384e-11],
        ...,
        [ 1.622e-11,  4.398e-11, -3.009e-11,  ..., -2.640e-11, -2.353e-11,
         -1.788e-11],
        [-2.161e-11, -2.320e-11, -2.158e-11,  ...,  2.939e-11, -3.146e-11,
          1.166e-10],
        [-1.528e-11,  1.074e-10, -5.916e-12,  ..., -2.876e-11,  4.514e-11,
          2.828e-11]], device='cuda:0')
v tensor([[1.000e-12, 1.000e-12, 1.163e-10,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.361e-11, 1.000e-12,
         2.967e-11],
        [1.000e-12, 8.552e-12, 1.984e-11,  ..., 1.530e-11, 1.000e-12,
         1.000e-12],
        ...,
        [1.622e-11, 4.398e-11, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 2.939e-11, 1.000e-12,
         1.166e-10],
        [1.000e-12, 1.074e-10, 1.000e-12,  ..., 1.000e-12, 4.514e-11,
         2.828e-11]], device='cuda:0')
v before min max tensor([-2.314e-11, -3.004e-11, -2.660e-12, -1.689e-11, -2.676e-11, -3.711e-12,
        -2.620e-11, -3.385e-11, -3.230e-11, -3.028e-11, -3.852e-12, -1.764e-11,
         5.153e-11,  5.304e-11, -3.051e-11, -2.418e-11,  6.565e-11, -3.389e-11,
         1.178e-10, -1.511e-11,  2.250e-11, -3.026e-11,  3.773e-11, -2.036e-11,
        -2.251e-11, -3.380e-11,  1.872e-11, -3.308e-11, -3.380e-11, -2.293e-11,
        -7.993e-12, -2.495e-11, -8.234e-12, -2.914e-11, -2.102e-11, -1.964e-11,
        -2.886e-11, -2.040e-11, -2.715e-11, -3.375e-11, -2.060e-11, -2.492e-11,
        -2.944e-11, -2.965e-11, -3.243e-11, -2.405e-11, -2.222e-11, -2.839e-11,
         9.627e-11, -1.093e-11,  2.570e-11, -1.484e-11, -1.303e-11,  3.954e-11,
        -3.291e-11, -4.887e-12, -1.154e-11, -8.731e-12,  6.327e-11, -2.647e-11,
        -1.964e-11, -2.401e-11, -2.695e-11,  2.588e-11,  7.160e-12, -2.896e-11,
         7.476e-12,  2.774e-11, -1.257e-11, -2.590e-11, -2.881e-11, -3.356e-11,
         5.049e-11, -3.189e-11, -1.362e-11, -1.917e-11, -3.389e-11, -3.074e-11,
        -1.252e-11, -3.366e-11, -2.367e-11, -3.378e-11,  3.755e-11, -3.332e-11,
        -3.299e-11, -2.157e-11, -1.463e-11,  6.685e-11, -3.318e-11,  1.097e-10,
        -3.169e-11, -3.072e-11, -3.253e-11,  5.957e-12, -1.118e-11,  5.103e-11,
        -3.037e-11, -3.169e-11, -2.386e-11,  5.727e-11, -2.885e-11, -1.543e-11,
        -1.450e-11, -2.210e-11, -3.182e-11,  1.388e-11, -1.848e-11,  4.109e-12,
         7.571e-12, -2.279e-11, -1.810e-11, -2.596e-11,  1.382e-11, -1.626e-11,
         7.860e-11,  3.551e-11, -2.528e-11,  6.276e-11, -4.801e-13, -3.014e-11,
        -1.434e-12, -3.390e-11, -3.048e-11, -2.087e-12, -1.678e-11, -3.372e-11,
        -3.306e-11, -2.068e-11, -3.222e-11, -3.368e-11], device='cuda:0')
v tensor([1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        5.153e-11, 5.304e-11, 1.000e-12, 1.000e-12, 6.565e-11, 1.000e-12,
        1.178e-10, 1.000e-12, 2.250e-11, 1.000e-12, 3.773e-11, 1.000e-12,
        1.000e-12, 1.000e-12, 1.872e-11, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        9.627e-11, 1.000e-12, 2.570e-11, 1.000e-12, 1.000e-12, 3.954e-11,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 6.327e-11, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 2.588e-11, 7.160e-12, 1.000e-12,
        7.476e-12, 2.774e-11, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        5.049e-11, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 3.755e-11, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 6.685e-11, 1.000e-12, 1.097e-10,
        1.000e-12, 1.000e-12, 1.000e-12, 5.957e-12, 1.000e-12, 5.103e-11,
        1.000e-12, 1.000e-12, 1.000e-12, 5.727e-11, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.388e-11, 1.000e-12, 4.109e-12,
        7.571e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.382e-11, 1.000e-12,
        7.860e-11, 3.551e-11, 1.000e-12, 6.276e-11, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12], device='cuda:0')
v before min max tensor([[[ 4.181e-11],
         [ 5.468e-10],
         [-3.354e-11],
         [ 2.773e-10],
         [ 2.800e-10],
         [ 8.969e-10],
         [ 5.060e-10],
         [ 2.849e-10],
         [ 6.426e-10],
         [ 4.183e-10]],

        [[ 3.656e-10],
         [ 9.697e-10],
         [-1.988e-13],
         [ 2.037e-10],
         [ 1.140e-11],
         [ 4.010e-10],
         [-1.476e-11],
         [ 1.790e-10],
         [ 8.049e-10],
         [ 4.578e-11]],

        [[ 4.935e-11],
         [-2.979e-11],
         [ 2.703e-11],
         [-1.282e-11],
         [-1.990e-11],
         [ 2.404e-10],
         [ 8.482e-11],
         [-2.948e-12],
         [ 1.425e-10],
         [ 1.021e-10]],

        [[-3.390e-11],
         [-8.920e-12],
         [-3.288e-11],
         [ 2.624e-11],
         [ 7.697e-11],
         [ 3.182e-11],
         [-2.473e-11],
         [-3.374e-11],
         [ 2.469e-11],
         [-3.388e-11]],

        [[ 2.231e-07],
         [ 6.398e-09],
         [ 2.220e-07],
         [ 4.044e-11],
         [-2.838e-11],
         [ 2.223e-07],
         [ 2.297e-07],
         [ 2.190e-07],
         [ 2.109e-07],
         [ 2.303e-07]],

        [[-3.286e-11],
         [ 7.869e-09],
         [-2.898e-11],
         [ 1.702e-10],
         [ 1.074e-08],
         [ 6.828e-09],
         [-3.336e-11],
         [-3.152e-11],
         [-2.196e-11],
         [ 7.362e-09]],

        [[ 3.563e-12],
         [ 5.967e-11],
         [-3.256e-12],
         [ 2.826e-12],
         [ 3.407e-11],
         [-3.320e-11],
         [ 2.586e-11],
         [ 8.524e-11],
         [-1.845e-11],
         [ 4.327e-11]],

        [[-2.042e-11],
         [-3.234e-11],
         [-2.191e-11],
         [-3.184e-11],
         [-3.361e-11],
         [-1.824e-12],
         [-2.938e-11],
         [-1.347e-11],
         [-4.124e-12],
         [ 7.431e-12]],

        [[-3.369e-11],
         [-1.327e-11],
         [-1.369e-11],
         [-3.040e-11],
         [-2.895e-11],
         [-3.144e-11],
         [ 1.131e-11],
         [-2.392e-11],
         [-2.976e-11],
         [ 2.008e-11]],

        [[ 4.669e-08],
         [ 4.335e-08],
         [ 5.233e-08],
         [ 4.156e-08],
         [-7.853e-12],
         [ 2.897e-10],
         [ 4.999e-08],
         [ 5.289e-08],
         [ 1.955e-09],
         [ 4.643e-08]],

        [[ 2.723e-11],
         [ 1.583e-10],
         [ 1.605e-11],
         [-2.321e-11],
         [-2.786e-11],
         [-8.142e-12],
         [-1.107e-11],
         [ 5.500e-11],
         [ 4.255e-11],
         [-3.338e-11]],

        [[ 6.615e-08],
         [-3.112e-11],
         [-3.083e-11],
         [ 6.328e-08],
         [ 6.974e-08],
         [ 1.886e-11],
         [ 6.617e-08],
         [ 8.462e-12],
         [-7.454e-12],
         [ 6.887e-08]],

        [[-2.775e-11],
         [ 1.383e-11],
         [-3.189e-11],
         [ 1.183e-11],
         [-3.220e-11],
         [-3.390e-11],
         [-1.322e-11],
         [ 1.342e-11],
         [ 5.343e-11],
         [ 7.228e-12]]], device='cuda:0')
v tensor([[[4.181e-11],
         [5.468e-10],
         [1.000e-12],
         [2.773e-10],
         [2.800e-10],
         [8.969e-10],
         [5.060e-10],
         [2.849e-10],
         [6.426e-10],
         [4.183e-10]],

        [[3.656e-10],
         [9.697e-10],
         [1.000e-12],
         [2.037e-10],
         [1.140e-11],
         [4.010e-10],
         [1.000e-12],
         [1.790e-10],
         [8.049e-10],
         [4.578e-11]],

        [[4.935e-11],
         [1.000e-12],
         [2.703e-11],
         [1.000e-12],
         [1.000e-12],
         [2.404e-10],
         [8.482e-11],
         [1.000e-12],
         [1.425e-10],
         [1.021e-10]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.624e-11],
         [7.697e-11],
         [3.182e-11],
         [1.000e-12],
         [1.000e-12],
         [2.469e-11],
         [1.000e-12]],

        [[2.231e-07],
         [6.398e-09],
         [2.220e-07],
         [4.044e-11],
         [1.000e-12],
         [2.223e-07],
         [2.297e-07],
         [2.190e-07],
         [2.109e-07],
         [2.303e-07]],

        [[1.000e-12],
         [7.869e-09],
         [1.000e-12],
         [1.702e-10],
         [1.074e-08],
         [6.828e-09],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [7.362e-09]],

        [[3.563e-12],
         [5.967e-11],
         [1.000e-12],
         [2.826e-12],
         [3.407e-11],
         [1.000e-12],
         [2.586e-11],
         [8.524e-11],
         [1.000e-12],
         [4.327e-11]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [7.431e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.131e-11],
         [1.000e-12],
         [1.000e-12],
         [2.008e-11]],

        [[4.669e-08],
         [4.335e-08],
         [5.233e-08],
         [4.156e-08],
         [1.000e-12],
         [2.897e-10],
         [4.999e-08],
         [5.289e-08],
         [1.955e-09],
         [4.643e-08]],

        [[2.723e-11],
         [1.583e-10],
         [1.605e-11],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [5.500e-11],
         [4.255e-11],
         [1.000e-12]],

        [[6.615e-08],
         [1.000e-12],
         [1.000e-12],
         [6.328e-08],
         [6.974e-08],
         [1.886e-11],
         [6.617e-08],
         [8.462e-12],
         [1.000e-12],
         [6.887e-08]],

        [[1.000e-12],
         [1.383e-11],
         [1.000e-12],
         [1.183e-11],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.342e-11],
         [5.343e-11],
         [7.228e-12]]], device='cuda:0')
v before min max tensor([[ 8.113e-10],
        [ 3.188e-10],
        [-1.221e-11],
        [-3.378e-11],
        [ 2.277e-07],
        [ 8.488e-09],
        [ 2.254e-11],
        [ 9.080e-11],
        [-2.545e-11],
        [ 5.336e-08],
        [-2.430e-11],
        [ 6.824e-08],
        [-3.337e-11]], device='cuda:0')
v tensor([[8.113e-10],
        [3.188e-10],
        [1.000e-12],
        [1.000e-12],
        [2.277e-07],
        [8.488e-09],
        [2.254e-11],
        [9.080e-11],
        [1.000e-12],
        [5.336e-08],
        [1.000e-12],
        [6.824e-08],
        [1.000e-12]], device='cuda:0')
a after update for 1 param tensor([[ 7.907e-10, -2.533e-09, -9.359e-09,  ...,  8.693e-10,  2.703e-09,
         -5.545e-10],
        [ 1.464e-09, -6.177e-10, -3.605e-09,  ..., -5.263e-09,  6.580e-10,
          6.088e-09],
        [ 3.064e-09,  4.975e-09, -5.597e-09,  ...,  5.356e-09,  9.750e-10,
          2.422e-09],
        ...,
        [-5.406e-09, -6.739e-09, -1.491e-09,  ..., -2.091e-09,  2.459e-09,
         -3.057e-09],
        [ 2.677e-09, -2.498e-09,  2.680e-09,  ...,  6.074e-09,  1.193e-09,
         -9.369e-09],
        [ 3.295e-09,  9.077e-09,  4.039e-09,  ...,  1.731e-09,  6.788e-09,
          6.021e-09]], device='cuda:0')
s after update for 1 param tensor([[3.017e-06, 3.017e-06, 4.542e-06,  ..., 3.017e-06, 3.017e-06,
         3.017e-06],
        [3.017e-06, 3.017e-06, 3.017e-06,  ..., 3.219e-06, 3.017e-06,
         3.459e-06],
        [3.017e-06, 3.139e-06, 3.314e-06,  ..., 3.245e-06, 3.017e-06,
         3.017e-06],
        ...,
        [3.259e-06, 3.660e-06, 3.017e-06,  ..., 3.017e-06, 3.017e-06,
         3.017e-06],
        [3.017e-06, 3.017e-06, 3.017e-06,  ..., 3.455e-06, 3.017e-06,
         4.546e-06],
        [3.017e-06, 4.443e-06, 3.017e-06,  ..., 3.017e-06, 3.676e-06,
         3.439e-06]], device='cuda:0')
b after update for 1 param tensor([[0.000, 0.000, 0.000,  ..., 0.000, 0.000, 0.000],
        [0.000, 0.000, 0.000,  ..., 0.000, 0.000, 0.000],
        [0.000, 0.000, 0.000,  ..., 0.000, 0.000, 0.000],
        ...,
        [0.000, 0.000, 0.000,  ..., 0.000, 0.000, 0.000],
        [0.000, 0.000, 0.000,  ..., 0.000, 0.000, 0.000],
        [0.000, 0.000, 0.000,  ..., 0.000, 0.000, 0.000]], device='cuda:0')
clipping threshold 1.0990416364710647
a after update for 1 param tensor([-2.504e-09,  1.500e-09, -4.268e-09,  3.149e-09, -2.040e-09,  4.195e-09,
        -2.119e-09, -1.751e-10,  9.668e-10,  1.453e-09,  4.186e-09,  3.079e-09,
        -7.058e-09, -7.120e-09,  1.406e-09, -2.380e-09, -7.618e-09, -7.535e-11,
         9.403e-09, -3.310e-09,  5.734e-09, -1.457e-09, -6.463e-09, -2.810e-09,
        -2.577e-09, -2.434e-10,  5.539e-09, -6.917e-10,  2.423e-10,  2.529e-09,
         3.886e-09,  2.285e-09,  3.868e-09,  1.666e-09,  2.740e-09,  2.884e-09,
        -1.714e-09,  2.806e-09, -1.984e-09, -2.981e-10,  2.784e-09, -2.288e-09,
        -1.612e-09,  1.575e-09,  9.262e-10, -2.397e-09, -2.610e-09, -1.792e-09,
        -8.712e-09, -3.660e-09, -5.895e-09,  3.334e-09,  3.488e-09,  6.544e-09,
        -7.605e-10, -4.113e-09, -3.611e-09,  3.831e-09,  7.527e-09,  2.081e-09,
         2.884e-09,  2.401e-09,  2.013e-09, -5.904e-09, -4.893e-09,  1.696e-09,
         4.912e-09,  5.995e-09, -3.527e-09,  2.160e-09, -1.723e-09,  4.468e-10,
        -7.015e-09,  1.082e-09, -3.439e-09, -2.930e-09, -6.821e-11, -1.358e-09,
         3.530e-09,  3.743e-10, -2.442e-09, -2.695e-10, -6.454e-09, -5.811e-10,
        -7.271e-10,  2.681e-09,  3.352e-09, -7.664e-09,  6.467e-10, -9.151e-09,
        -1.136e-09,  1.362e-09, -8.952e-10,  4.821e-09,  3.639e-09,  7.037e-09,
        -1.434e-09,  1.136e-09, -2.419e-09, -7.291e-09, -1.716e-09,  3.281e-09,
        -3.363e-09,  2.623e-09,  1.101e-09,  5.278e-09,  2.998e-09,  4.708e-09,
         4.917e-09, -2.545e-09,  3.035e-09,  2.152e-09, -5.274e-09, -3.207e-09,
         8.099e-09, -6.361e-09,  2.241e-09,  7.507e-09, -4.414e-09, -1.480e-09,
        -4.351e-09,  1.786e-11,  1.413e-09,  4.307e-09, -3.160e-09,  3.238e-10,
        -6.994e-10, -2.776e-09, -9.890e-10, -3.585e-10], device='cuda:0')
s after update for 1 param tensor([3.017e-06, 3.017e-06, 3.017e-06, 3.017e-06, 3.017e-06, 3.017e-06,
        3.017e-06, 3.017e-06, 3.017e-06, 3.017e-06, 3.017e-06, 3.017e-06,
        3.762e-06, 3.782e-06, 3.017e-06, 3.017e-06, 3.945e-06, 3.017e-06,
        4.558e-06, 3.017e-06, 3.354e-06, 3.017e-06, 3.574e-06, 3.017e-06,
        3.017e-06, 3.017e-06, 3.297e-06, 3.017e-06, 3.017e-06, 3.017e-06,
        3.017e-06, 3.017e-06, 3.017e-06, 3.017e-06, 3.017e-06, 3.017e-06,
        3.017e-06, 3.017e-06, 3.017e-06, 3.017e-06, 3.017e-06, 3.017e-06,
        3.017e-06, 3.017e-06, 3.017e-06, 3.017e-06, 3.017e-06, 3.017e-06,
        4.316e-06, 3.017e-06, 3.401e-06, 3.017e-06, 3.017e-06, 3.599e-06,
        3.017e-06, 3.017e-06, 3.017e-06, 3.017e-06, 3.915e-06, 3.017e-06,
        3.017e-06, 3.017e-06, 3.017e-06, 3.404e-06, 3.117e-06, 3.017e-06,
        3.122e-06, 3.431e-06, 3.017e-06, 3.017e-06, 3.017e-06, 3.017e-06,
        3.748e-06, 3.017e-06, 3.017e-06, 3.017e-06, 3.017e-06, 3.017e-06,
        3.017e-06, 3.017e-06, 3.017e-06, 3.017e-06, 3.571e-06, 3.017e-06,
        3.017e-06, 3.017e-06, 3.017e-06, 3.960e-06, 3.017e-06, 4.469e-06,
        3.017e-06, 3.017e-06, 3.017e-06, 3.098e-06, 3.017e-06, 3.755e-06,
        3.017e-06, 3.017e-06, 3.017e-06, 3.838e-06, 3.017e-06, 3.017e-06,
        3.017e-06, 3.017e-06, 3.017e-06, 3.223e-06, 3.017e-06, 3.068e-06,
        3.124e-06, 3.017e-06, 3.017e-06, 3.017e-06, 3.222e-06, 3.017e-06,
        4.106e-06, 3.543e-06, 3.017e-06, 3.908e-06, 3.017e-06, 3.017e-06,
        3.017e-06, 3.017e-06, 3.017e-06, 3.017e-06, 3.017e-06, 3.017e-06,
        3.017e-06, 3.017e-06, 3.017e-06, 3.017e-06], device='cuda:0')
b after update for 1 param tensor([0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
        0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
        0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
        0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
        0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
        0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
        0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
        0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
        0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
        0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
        0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
        0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
        0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000],
       device='cuda:0')
clipping threshold 1.0990416364710647
a after update for 1 param tensor([[[ 6.644e-09],
         [ 1.840e-08],
         [ 4.573e-10],
         [ 1.347e-08],
         [ 1.353e-08],
         [ 2.330e-08],
         [ 1.774e-08],
         [ 1.363e-08],
         [ 1.986e-08],
         [ 1.624e-08]],

        [[-1.526e-08],
         [-2.419e-08],
         [-4.433e-09],
         [-1.177e-08],
         [ 5.139e-09],
         [-1.592e-08],
         [-3.341e-09],
         [-1.114e-08],
         [-2.211e-08],
         [-6.816e-09]],

        [[-6.967e-09],
         [ 1.548e-09],
         [-5.960e-09],
         [-3.505e-09],
         [-2.857e-09],
         [-1.265e-08],
         [-8.320e-09],
         [-4.248e-09],
         [-1.014e-08],
         [-8.906e-09]],

        [[-3.120e-11],
         [ 3.816e-09],
         [ 7.722e-10],
         [ 5.921e-09],
         [-8.040e-09],
         [ 6.190e-09],
         [-2.312e-09],
         [ 3.043e-10],
         [ 5.845e-09],
         [ 1.061e-10]],

        [[-3.607e-07],
         [-6.124e-08],
         [-3.598e-07],
         [-6.583e-09],
         [ 1.795e-09],
         [-3.600e-07],
         [-3.660e-07],
         [-3.574e-07],
         [-3.507e-07],
         [-3.665e-07]],

        [[-7.800e-10],
         [ 6.788e-08],
         [ 1.694e-09],
         [ 1.091e-08],
         [ 7.924e-08],
         [ 6.325e-08],
         [ 5.635e-10],
         [-1.177e-09],
         [-2.639e-09],
         [ 6.567e-08]],

        [[ 4.674e-09],
         [ 7.386e-09],
         [-4.227e-09],
         [ 4.627e-09],
         [-6.295e-09],
         [-6.400e-10],
         [ 5.903e-09],
         [ 8.335e-09],
         [-3.001e-09],
         [ 6.708e-09]],

        [[-2.804e-09],
         [ 9.552e-10],
         [-2.644e-09],
         [-1.096e-09],
         [-4.122e-10],
         [-4.325e-09],
         [ 1.624e-09],
         [-3.451e-09],
         [-4.167e-09],
         [-4.909e-09]],

        [[-3.502e-10],
         [ 3.468e-09],
         [-3.433e-09],
         [ 1.430e-09],
         [ 1.699e-09],
         [-1.198e-09],
         [ 5.134e-09],
         [-2.413e-09],
         [-1.553e-09],
         [ 5.610e-09]],

        [[-1.650e-07],
         [-1.590e-07],
         [-1.747e-07],
         [-1.557e-07],
         [-3.897e-09],
         [-1.374e-08],
         [-1.708e-07],
         [-1.757e-07],
         [-3.406e-08],
         [-1.646e-07]],

        [[ 5.970e-09],
         [ 1.059e-08],
         [ 5.397e-09],
         [ 2.496e-09],
         [ 1.876e-09],
         [-3.875e-09],
         [-3.648e-09],
         [ 7.199e-09],
         [ 6.676e-09],
         [ 5.492e-10]],

        [[ 1.964e-07],
         [-1.273e-09],
         [ 1.338e-09],
         [ 1.921e-07],
         [ 2.017e-07],
         [ 5.546e-09],
         [ 1.965e-07],
         [ 4.970e-09],
         [ 3.927e-09],
         [ 2.004e-07]],

        [[-1.893e-09],
         [ 5.275e-09],
         [ 1.082e-09],
         [-5.163e-09],
         [ 9.957e-10],
         [ 5.632e-12],
         [ 3.472e-09],
         [ 5.252e-09],
         [-7.136e-09],
         [ 4.897e-09]]], device='cuda:0')
s after update for 1 param tensor([[[3.631e-06],
         [7.980e-06],
         [3.017e-06],
         [6.061e-06],
         [6.083e-06],
         [9.934e-06],
         [7.720e-06],
         [6.123e-06],
         [8.559e-06],
         [7.130e-06]],

        [[6.750e-06],
         [1.029e-05],
         [3.017e-06],
         [5.419e-06],
         [3.184e-06],
         [7.007e-06],
         [3.017e-06],
         [5.186e-06],
         [9.460e-06],
         [3.685e-06]],

        [[3.733e-06],
         [3.017e-06],
         [3.421e-06],
         [3.017e-06],
         [3.017e-06],
         [5.748e-06],
         [4.181e-06],
         [3.017e-06],
         [4.822e-06],
         [4.383e-06]],

        [[3.017e-06],
         [3.017e-06],
         [3.017e-06],
         [3.409e-06],
         [4.086e-06],
         [3.490e-06],
         [3.017e-06],
         [3.017e-06],
         [3.387e-06],
         [3.017e-06]],

        [[1.494e-04],
         [2.547e-05],
         [1.490e-04],
         [3.612e-06],
         [3.017e-06],
         [1.491e-04],
         [1.516e-04],
         [1.480e-04],
         [1.453e-04],
         [1.518e-04]],

        [[3.017e-06],
         [2.821e-05],
         [3.017e-06],
         [5.101e-06],
         [3.290e-05],
         [2.630e-05],
         [3.017e-06],
         [3.017e-06],
         [3.017e-06],
         [2.730e-05]],

        [[3.059e-06],
         [3.869e-06],
         [3.017e-06],
         [3.047e-06],
         [3.522e-06],
         [3.017e-06],
         [3.404e-06],
         [4.186e-06],
         [3.017e-06],
         [3.651e-06]],

        [[3.017e-06],
         [3.017e-06],
         [3.017e-06],
         [3.017e-06],
         [3.017e-06],
         [3.017e-06],
         [3.017e-06],
         [3.017e-06],
         [3.017e-06],
         [3.121e-06]],

        [[3.017e-06],
         [3.017e-06],
         [3.017e-06],
         [3.017e-06],
         [3.017e-06],
         [3.017e-06],
         [3.183e-06],
         [3.017e-06],
         [3.017e-06],
         [3.318e-06]],

        [[6.839e-05],
         [6.591e-05],
         [7.240e-05],
         [6.454e-05],
         [3.017e-06],
         [6.162e-06],
         [7.076e-05],
         [7.278e-05],
         [1.430e-05],
         [6.821e-05]],

        [[3.424e-06],
         [4.983e-06],
         [3.257e-06],
         [3.017e-06],
         [3.017e-06],
         [3.017e-06],
         [3.017e-06],
         [3.808e-06],
         [3.641e-06],
         [3.017e-06]],

        [[8.139e-05],
         [3.017e-06],
         [3.017e-06],
         [7.960e-05],
         [8.357e-05],
         [3.299e-06],
         [8.140e-05],
         [3.138e-06],
         [3.017e-06],
         [8.304e-05]],

        [[3.017e-06],
         [3.222e-06],
         [3.017e-06],
         [3.191e-06],
         [3.017e-06],
         [3.017e-06],
         [3.017e-06],
         [3.216e-06],
         [3.787e-06],
         [3.118e-06]]], device='cuda:0')
b after update for 1 param tensor([[[0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000]],

        [[0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000]],

        [[0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000]],

        [[0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000]],

        [[0.001],
         [0.000],
         [0.001],
         [0.000],
         [0.000],
         [0.001],
         [0.001],
         [0.001],
         [0.001],
         [0.001]],

        [[0.000],
         [0.001],
         [0.000],
         [0.000],
         [0.001],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.001]],

        [[0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000]],

        [[0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000]],

        [[0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000]],

        [[0.001],
         [0.001],
         [0.001],
         [0.001],
         [0.000],
         [0.000],
         [0.001],
         [0.001],
         [0.000],
         [0.001]],

        [[0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000]],

        [[0.001],
         [0.000],
         [0.000],
         [0.001],
         [0.001],
         [0.000],
         [0.001],
         [0.000],
         [0.000],
         [0.001]],

        [[0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000],
         [0.000]]], device='cuda:0')
clipping threshold 1.0990416364710647
a after update for 1 param tensor([[ 2.220e-08],
        [-1.434e-08],
        [ 3.556e-09],
        [-2.655e-10],
        [-3.644e-07],
        [ 7.049e-08],
        [-5.736e-09],
        [-8.527e-09],
        [-2.219e-09],
        [-1.764e-07],
        [-2.365e-09],
        [ 1.995e-07],
        [-5.539e-10]], device='cuda:0')
s after update for 1 param tensor([[9.494e-06],
        [6.394e-06],
        [3.017e-06],
        [3.017e-06],
        [1.509e-04],
        [2.929e-05],
        [3.355e-06],
        [4.252e-06],
        [3.017e-06],
        [7.311e-05],
        [3.017e-06],
        [8.266e-05],
        [3.017e-06]], device='cuda:0')
b after update for 1 param tensor([[0.000],
        [0.000],
        [0.000],
        [0.000],
        [0.001],
        [0.001],
        [0.000],
        [0.000],
        [0.000],
        [0.001],
        [0.000],
        [0.001],
        [0.000]], device='cuda:0')
clipping threshold 1.0990416364710647
||w||^2 1593.1457830762083
exp ma of ||w||^2 23585.435324542243
||w|| 39.9142303330054
exp ma of ||w|| 108.98163890369028
||w||^2 102.51224309123613
exp ma of ||w||^2 210.82512382909613
||w|| 10.124832990782423
exp ma of ||w|| 10.79693540971521
cuda
Objective function 158.36 = squared loss an data 157.12 + 0.5*rho*h**2 0.205315 + alpha*h 0.843677 + L2reg 0.11 + L1reg 0.08 ; SHD = 29 ; DAG False
Proportion of microbatches that were clipped  0.8675346730823663
iteration 1 in inner loop, alpha 1.3165887914307852 rho 1.0 h 0.6408048671664979
1963
cuda
Objective function 160.21 = squared loss an data 157.12 + 0.5*rho*h**2 2.053154 + alpha*h 0.843677 + L2reg 0.11 + L1reg 0.08 ; SHD = 29 ; DAG False
v before min max tensor([[ 3.551e-09, -1.835e-10,  6.405e-10,  ...,  3.037e-12,  6.829e-10,
          6.509e-10],
        [-8.525e-10, -3.644e-10, -1.230e-09,  ..., -4.705e-10, -3.341e-10,
         -5.300e-10],
        [-1.434e-09,  9.653e-11,  2.826e-10,  ..., -4.773e-10, -5.664e-10,
          1.982e-09],
        ...,
        [-1.818e-10, -2.073e-10, -7.314e-10,  ..., -2.705e-10,  1.635e-10,
         -4.461e-10],
        [ 6.446e-11,  5.762e-10, -2.487e-10,  ..., -2.691e-10, -1.623e-11,
         -5.099e-10],
        [ 1.388e-10,  1.959e-09, -4.709e-10,  ..., -1.363e-10,  8.142e-11,
         -2.469e-10]], device='cuda:0')
v tensor([[3.551e-09, 1.000e-12, 6.405e-10,  ..., 3.037e-12, 6.829e-10,
         6.509e-10],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [1.000e-12, 9.653e-11, 2.826e-10,  ..., 1.000e-12, 1.000e-12,
         1.982e-09],
        ...,
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.635e-10,
         1.000e-12],
        [6.446e-11, 5.762e-10, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [1.388e-10, 1.959e-09, 1.000e-12,  ..., 1.000e-12, 8.142e-11,
         1.000e-12]], device='cuda:0')
v before min max tensor([ 1.354e-11,  7.926e-10, -2.785e-10, -1.572e-10, -2.197e-10, -2.709e-10,
        -5.646e-10, -3.075e-10,  3.071e-10, -2.778e-10, -1.349e-10, -1.837e-10,
         9.240e-11, -7.853e-10, -2.402e-10, -3.218e-10, -2.387e-10, -3.498e-10,
        -1.881e-10, -2.044e-10,  1.455e-12,  1.377e-09,  4.259e-10,  2.124e-10,
        -1.441e-10, -2.178e-10,  2.941e-10, -5.875e-11, -7.009e-10, -2.273e-10,
        -2.161e-10, -3.291e-10, -6.446e-10, -5.254e-10, -4.732e-10, -1.113e-10,
         3.139e-10, -2.608e-10, -2.790e-10, -2.973e-10,  2.822e-10, -1.081e-09,
        -2.823e-10,  4.736e-11,  1.597e-09, -1.884e-10,  2.551e-10,  5.043e-10,
         1.729e-09, -2.318e-10, -2.701e-10, -1.793e-10, -2.099e-10, -6.099e-10,
        -1.115e-10, -3.310e-10, -2.473e-10, -7.488e-12, -1.227e-10,  1.465e-10,
        -2.378e-10, -1.630e-10, -2.768e-10,  2.893e-10, -7.029e-10,  8.705e-11,
         1.351e-09,  2.839e-10,  2.786e-10, -2.133e-10,  1.745e-11,  2.657e-10,
        -4.408e-10,  1.885e-10,  2.239e-10, -3.202e-10, -3.729e-11, -1.529e-10,
        -3.210e-10, -2.752e-10, -2.256e-10, -8.408e-10, -4.642e-10, -1.445e-10,
        -5.301e-10, -2.833e-10,  2.936e-09,  4.097e-10, -2.219e-10, -2.414e-10,
        -3.520e-10,  8.155e-11,  1.163e-10, -2.364e-10, -2.515e-10,  3.588e-11,
        -2.157e-10, -1.335e-10, -3.321e-10, -3.400e-10, -6.226e-10,  2.120e-10,
         7.089e-11, -2.819e-10, -4.007e-10, -1.998e-10, -2.373e-10,  3.327e-10,
        -4.194e-11,  5.082e-10,  7.963e-11, -2.367e-10, -2.722e-10,  1.062e-10,
         2.297e-10,  1.879e-09, -5.761e-10,  6.258e-10, -3.664e-10, -2.212e-10,
        -3.259e-10, -2.888e-10, -5.907e-10, -1.577e-10, -7.289e-11, -2.847e-10,
         2.413e-10,  7.868e-11,  4.391e-10, -2.989e-10], device='cuda:0')
v tensor([1.354e-11, 7.926e-10, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 3.071e-10, 1.000e-12, 1.000e-12, 1.000e-12,
        9.240e-11, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.455e-12, 1.377e-09, 4.259e-10, 2.124e-10,
        1.000e-12, 1.000e-12, 2.941e-10, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        3.139e-10, 1.000e-12, 1.000e-12, 1.000e-12, 2.822e-10, 1.000e-12,
        1.000e-12, 4.736e-11, 1.597e-09, 1.000e-12, 2.551e-10, 5.043e-10,
        1.729e-09, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.465e-10,
        1.000e-12, 1.000e-12, 1.000e-12, 2.893e-10, 1.000e-12, 8.705e-11,
        1.351e-09, 2.839e-10, 2.786e-10, 1.000e-12, 1.745e-11, 2.657e-10,
        1.000e-12, 1.885e-10, 2.239e-10, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 2.936e-09, 4.097e-10, 1.000e-12, 1.000e-12,
        1.000e-12, 8.155e-11, 1.163e-10, 1.000e-12, 1.000e-12, 3.588e-11,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 2.120e-10,
        7.089e-11, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 3.327e-10,
        1.000e-12, 5.082e-10, 7.963e-11, 1.000e-12, 1.000e-12, 1.062e-10,
        2.297e-10, 1.879e-09, 1.000e-12, 6.258e-10, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        2.413e-10, 7.868e-11, 4.391e-10, 1.000e-12], device='cuda:0')
v before min max tensor([[[ 7.012e-10],
         [ 1.568e-09],
         [ 7.027e-11],
         [ 2.836e-10],
         [ 1.049e-09],
         [-1.269e-10],
         [ 1.050e-08],
         [ 2.951e-10],
         [ 2.622e-09],
         [ 3.761e-09]],

        [[ 5.067e-10],
         [ 2.223e-09],
         [ 1.559e-09],
         [-3.714e-10],
         [-2.202e-10],
         [ 2.566e-09],
         [-6.361e-10],
         [ 2.289e-10],
         [ 4.012e-09],
         [-4.743e-10]],

        [[-1.267e-09],
         [ 1.136e-09],
         [-2.565e-09],
         [ 9.524e-10],
         [-9.742e-10],
         [ 9.130e-09],
         [ 4.261e-09],
         [-2.674e-09],
         [-2.386e-09],
         [-2.116e-09]],

        [[ 1.458e-08],
         [ 1.050e-09],
         [ 1.791e-08],
         [-2.972e-10],
         [ 3.066e-09],
         [ 8.462e-09],
         [-1.517e-09],
         [-1.269e-09],
         [-5.097e-10],
         [ 1.311e-09]],

        [[ 3.168e-05],
         [ 3.259e-05],
         [ 3.097e-05],
         [ 1.394e-06],
         [ 8.114e-08],
         [ 2.955e-05],
         [ 3.063e-05],
         [ 2.823e-05],
         [ 2.691e-05],
         [ 2.825e-05]],

        [[ 3.652e-07],
         [ 5.746e-07],
         [-4.083e-10],
         [ 4.276e-07],
         [ 4.274e-07],
         [ 6.242e-07],
         [ 3.243e-07],
         [-1.718e-10],
         [ 6.800e-08],
         [ 5.115e-07]],

        [[-1.080e-09],
         [-1.885e-09],
         [ 1.991e-08],
         [-1.175e-09],
         [ 6.804e-09],
         [-2.057e-09],
         [-3.605e-11],
         [-1.067e-09],
         [ 2.030e-08],
         [-1.428e-09]],

        [[ 2.544e-10],
         [ 2.491e-12],
         [ 1.159e-09],
         [-8.591e-10],
         [ 7.529e-10],
         [ 3.447e-11],
         [ 3.065e-10],
         [-1.866e-10],
         [ 7.963e-10],
         [ 3.941e-10]],

        [[ 1.043e-09],
         [ 3.567e-09],
         [ 1.435e-09],
         [ 1.586e-09],
         [-3.212e-10],
         [-1.301e-10],
         [-1.201e-12],
         [ 1.978e-10],
         [-4.038e-10],
         [ 1.156e-10]],

        [[ 7.787e-06],
         [ 5.943e-06],
         [ 5.458e-06],
         [ 5.992e-06],
         [ 7.582e-08],
         [ 5.099e-06],
         [ 5.288e-06],
         [ 5.487e-06],
         [ 5.930e-06],
         [ 6.862e-06]],

        [[ 1.987e-09],
         [-2.276e-10],
         [-1.051e-09],
         [ 9.023e-10],
         [-1.493e-10],
         [ 5.116e-10],
         [-4.240e-11],
         [ 4.265e-09],
         [-4.475e-10],
         [ 4.351e-11]],

        [[ 6.687e-06],
         [ 5.488e-06],
         [ 8.170e-06],
         [ 6.526e-06],
         [ 9.223e-06],
         [ 5.621e-06],
         [ 6.964e-06],
         [ 5.818e-06],
         [ 3.842e-06],
         [ 7.858e-06]],

        [[-2.315e-10],
         [ 3.408e-10],
         [-3.705e-10],
         [-2.420e-10],
         [ 2.712e-10],
         [-2.595e-10],
         [-3.137e-10],
         [ 8.480e-11],
         [ 7.247e-11],
         [ 1.068e-09]]], device='cuda:0')
v tensor([[[7.012e-10],
         [1.568e-09],
         [7.027e-11],
         [2.836e-10],
         [1.049e-09],
         [1.000e-12],
         [1.050e-08],
         [2.951e-10],
         [2.622e-09],
         [3.761e-09]],

        [[5.067e-10],
         [2.223e-09],
         [1.559e-09],
         [1.000e-12],
         [1.000e-12],
         [2.566e-09],
         [1.000e-12],
         [2.289e-10],
         [4.012e-09],
         [1.000e-12]],

        [[1.000e-12],
         [1.136e-09],
         [1.000e-12],
         [9.524e-10],
         [1.000e-12],
         [9.130e-09],
         [4.261e-09],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.458e-08],
         [1.050e-09],
         [1.791e-08],
         [1.000e-12],
         [3.066e-09],
         [8.462e-09],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.311e-09]],

        [[3.168e-05],
         [3.259e-05],
         [3.097e-05],
         [1.394e-06],
         [8.114e-08],
         [2.955e-05],
         [3.063e-05],
         [2.823e-05],
         [2.691e-05],
         [2.825e-05]],

        [[3.652e-07],
         [5.746e-07],
         [1.000e-12],
         [4.276e-07],
         [4.274e-07],
         [6.242e-07],
         [3.243e-07],
         [1.000e-12],
         [6.800e-08],
         [5.115e-07]],

        [[1.000e-12],
         [1.000e-12],
         [1.991e-08],
         [1.000e-12],
         [6.804e-09],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.030e-08],
         [1.000e-12]],

        [[2.544e-10],
         [2.491e-12],
         [1.159e-09],
         [1.000e-12],
         [7.529e-10],
         [3.447e-11],
         [3.065e-10],
         [1.000e-12],
         [7.963e-10],
         [3.941e-10]],

        [[1.043e-09],
         [3.567e-09],
         [1.435e-09],
         [1.586e-09],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.978e-10],
         [1.000e-12],
         [1.156e-10]],

        [[7.787e-06],
         [5.943e-06],
         [5.458e-06],
         [5.992e-06],
         [7.582e-08],
         [5.099e-06],
         [5.288e-06],
         [5.487e-06],
         [5.930e-06],
         [6.862e-06]],

        [[1.987e-09],
         [1.000e-12],
         [1.000e-12],
         [9.023e-10],
         [1.000e-12],
         [5.116e-10],
         [1.000e-12],
         [4.265e-09],
         [1.000e-12],
         [4.351e-11]],

        [[6.687e-06],
         [5.488e-06],
         [8.170e-06],
         [6.526e-06],
         [9.223e-06],
         [5.621e-06],
         [6.964e-06],
         [5.818e-06],
         [3.842e-06],
         [7.858e-06]],

        [[1.000e-12],
         [3.408e-10],
         [1.000e-12],
         [1.000e-12],
         [2.712e-10],
         [1.000e-12],
         [1.000e-12],
         [8.480e-11],
         [7.247e-11],
         [1.068e-09]]], device='cuda:0')
v before min max tensor([[-1.404e-09],
        [ 9.961e-11],
        [ 2.153e-09],
        [ 7.649e-09],
        [ 3.551e-05],
        [ 3.676e-07],
        [ 1.341e-08],
        [-4.237e-10],
        [ 1.910e-09],
        [ 6.521e-06],
        [ 6.661e-10],
        [ 7.779e-06],
        [ 4.165e-09]], device='cuda:0')
v tensor([[1.000e-12],
        [9.961e-11],
        [2.153e-09],
        [7.649e-09],
        [3.551e-05],
        [3.676e-07],
        [1.341e-08],
        [1.000e-12],
        [1.910e-09],
        [6.521e-06],
        [6.661e-10],
        [7.779e-06],
        [4.165e-09]], device='cuda:0')
a after update for 1 param tensor([[-5.021e-08,  6.200e-09,  2.672e-08,  ..., -2.243e-08, -4.608e-08,
          2.182e-08],
        [-4.471e-08,  9.483e-09,  3.912e-08,  ..., -9.274e-09,  1.363e-08,
         -1.989e-08],
        [-3.314e-08, -3.238e-08,  1.085e-08,  ...,  1.998e-08, -1.287e-08,
         -2.599e-08],
        ...,
        [-7.034e-09, -2.164e-09,  1.539e-08,  ...,  3.908e-10, -6.282e-09,
          8.224e-09],
        [-1.790e-08,  1.740e-08, -2.736e-10,  ..., -5.988e-09,  1.677e-08,
         -2.561e-08],
        [-2.410e-08, -1.911e-08,  1.492e-08,  ...,  1.765e-08, -2.750e-08,
          1.636e-08]], device='cuda:0')
s after update for 1 param tensor([[1.918e-05, 4.187e-06, 8.418e-06,  ..., 2.666e-06, 9.576e-06,
         8.479e-06],
        [8.838e-06, 3.374e-06, 1.126e-05,  ..., 4.802e-06, 3.855e-06,
         6.252e-06],
        [1.589e-05, 4.498e-06, 5.921e-06,  ..., 4.406e-06, 5.339e-06,
         1.476e-05],
        ...,
        [2.628e-06, 2.628e-06, 7.404e-06,  ..., 2.704e-06, 9.023e-06,
         4.091e-06],
        [3.640e-06, 9.844e-06, 2.628e-06,  ..., 2.628e-06, 3.735e-06,
         9.360e-06],
        [5.593e-06, 1.495e-05, 4.333e-06,  ..., 2.628e-06, 3.866e-06,
         3.466e-06]], device='cuda:0')
b after update for 1 param tensor([[0.001, 0.000, 0.001,  ..., 0.000, 0.001, 0.001],
        [0.001, 0.000, 0.001,  ..., 0.001, 0.000, 0.001],
        [0.001, 0.001, 0.001,  ..., 0.001, 0.001, 0.001],
        ...,
        [0.000, 0.000, 0.001,  ..., 0.000, 0.001, 0.000],
        [0.000, 0.001, 0.000,  ..., 0.000, 0.000, 0.001],
        [0.001, 0.001, 0.001,  ..., 0.000, 0.000, 0.000]], device='cuda:0')
clipping threshold 1.4661999361058542
a after update for 1 param tensor([ 1.381e-08, -3.255e-08, -2.058e-09, -1.772e-08, -9.390e-09, -1.347e-08,
        -2.129e-08, -1.679e-08, -1.536e-08, -1.124e-08,  4.856e-09,  1.916e-09,
         1.884e-08, -6.374e-10, -5.895e-09,  3.824e-09,  1.422e-08, -2.005e-08,
         1.171e-08,  1.704e-08,  2.367e-09,  4.581e-08,  1.644e-08, -1.609e-08,
         4.829e-09, -3.667e-09, -9.662e-09,  2.060e-09, -3.446e-09, -4.241e-09,
         1.042e-08, -1.430e-08, -4.248e-08,  3.341e-09, -1.621e-08,  9.338e-09,
         3.669e-08, -1.344e-08,  1.386e-08,  8.192e-09, -2.628e-08, -6.362e-08,
        -2.138e-09, -5.545e-08, -2.388e-08, -2.035e-08, -8.196e-09, -4.921e-08,
        -4.955e-08, -5.333e-08,  5.807e-10, -5.597e-09,  2.248e-08, -9.928e-09,
         2.676e-08, -7.592e-09,  3.690e-09, -1.693e-08, -1.838e-08, -1.087e-08,
        -7.082e-09,  9.716e-09, -4.933e-09,  2.190e-08, -2.606e-08,  1.144e-08,
         2.821e-08,  2.638e-08, -1.704e-08, -3.366e-09,  2.053e-08,  1.126e-08,
        -1.889e-08, -2.088e-08, -1.503e-08,  7.223e-10,  1.082e-08,  5.821e-09,
        -8.591e-09, -1.228e-09, -3.129e-09,  1.035e-08,  1.284e-08, -1.622e-08,
        -2.927e-09, -7.779e-09, -4.908e-08, -3.883e-09,  1.488e-08,  2.188e-09,
        -1.987e-08, -3.124e-08, -2.438e-09, -2.936e-09, -1.310e-08, -6.482e-09,
        -1.300e-08, -1.404e-09,  1.180e-08, -9.680e-09, -2.207e-08,  7.599e-09,
         2.702e-08,  9.369e-09,  4.928e-09,  1.884e-08,  1.216e-08, -2.921e-08,
         2.197e-08,  3.475e-08, -1.870e-08, -4.766e-09, -9.833e-09, -2.368e-08,
        -1.867e-08, -6.465e-08, -2.003e-08, -4.173e-08, -4.808e-08, -5.390e-09,
        -1.861e-10, -1.868e-09, -2.179e-08,  5.839e-09, -1.275e-08, -6.229e-09,
        -2.778e-08,  1.881e-08, -2.824e-08,  2.528e-09], device='cuda:0')
s after update for 1 param tensor([2.856e-06, 9.277e-06, 2.628e-06, 3.295e-06, 2.628e-06, 2.628e-06,
        5.274e-06, 2.938e-06, 6.125e-06, 2.628e-06, 3.344e-06, 2.800e-06,
        4.006e-06, 7.703e-06, 2.628e-06, 3.149e-06, 3.577e-06, 3.753e-06,
        2.628e-06, 3.605e-06, 6.011e-06, 1.202e-05, 7.249e-06, 5.618e-06,
        2.628e-06, 2.628e-06, 6.018e-06, 2.628e-06, 7.218e-06, 2.628e-06,
        3.780e-06, 3.518e-06, 8.996e-06, 4.830e-06, 6.058e-06, 2.899e-06,
        7.312e-06, 3.174e-06, 2.817e-06, 2.749e-06, 5.918e-06, 1.268e-05,
        2.628e-06, 7.501e-06, 1.290e-05, 4.949e-06, 5.804e-06, 9.380e-06,
        1.380e-05, 8.642e-06, 3.060e-06, 2.628e-06, 2.864e-06, 5.579e-06,
        3.952e-06, 3.086e-06, 2.628e-06, 2.628e-06, 2.628e-06, 4.632e-06,
        3.680e-06, 2.628e-06, 2.685e-06, 5.978e-06, 6.430e-06, 3.954e-06,
        1.238e-05, 6.086e-06, 7.228e-06, 4.141e-06, 2.924e-06, 6.452e-06,
        4.324e-06, 5.280e-06, 5.403e-06, 3.043e-06, 2.749e-06, 2.628e-06,
        3.012e-06, 2.628e-06, 2.628e-06, 7.954e-06, 4.263e-06, 2.949e-06,
        4.893e-06, 2.628e-06, 1.736e-05, 7.299e-06, 2.945e-06, 3.253e-06,
        3.545e-06, 4.471e-06, 6.251e-06, 2.947e-06, 2.628e-06, 3.224e-06,
        2.628e-06, 2.884e-06, 3.198e-06, 3.725e-06, 6.189e-06, 5.349e-06,
        4.206e-06, 2.628e-06, 4.013e-06, 2.628e-06, 4.267e-06, 7.179e-06,
        2.628e-06, 7.627e-06, 3.843e-06, 3.898e-06, 3.644e-06, 4.174e-06,
        5.457e-06, 1.479e-05, 5.461e-06, 8.631e-06, 8.760e-06, 2.628e-06,
        3.106e-06, 2.671e-06, 5.438e-06, 2.628e-06, 2.628e-06, 2.628e-06,
        5.851e-06, 6.394e-06, 7.121e-06, 5.518e-06], device='cuda:0')
b after update for 1 param tensor([0.000, 0.001, 0.000, 0.000, 0.000, 0.000, 0.001, 0.000, 0.001, 0.000,
        0.000, 0.000, 0.000, 0.001, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
        0.001, 0.001, 0.001, 0.001, 0.000, 0.000, 0.001, 0.000, 0.001, 0.000,
        0.000, 0.000, 0.001, 0.001, 0.001, 0.000, 0.001, 0.000, 0.000, 0.000,
        0.001, 0.001, 0.000, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001,
        0.000, 0.000, 0.000, 0.001, 0.000, 0.000, 0.000, 0.000, 0.000, 0.001,
        0.000, 0.000, 0.000, 0.001, 0.001, 0.000, 0.001, 0.001, 0.001, 0.000,
        0.000, 0.001, 0.001, 0.001, 0.001, 0.000, 0.000, 0.000, 0.000, 0.000,
        0.000, 0.001, 0.001, 0.000, 0.001, 0.000, 0.001, 0.001, 0.000, 0.000,
        0.000, 0.001, 0.001, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
        0.001, 0.001, 0.001, 0.000, 0.000, 0.000, 0.001, 0.001, 0.000, 0.001,
        0.000, 0.000, 0.000, 0.000, 0.001, 0.001, 0.001, 0.001, 0.001, 0.000,
        0.000, 0.000, 0.001, 0.000, 0.000, 0.000, 0.001, 0.001, 0.001, 0.001],
       device='cuda:0')
clipping threshold 1.4661999361058542
a after update for 1 param tensor([[[ 7.071e-08],
         [ 8.330e-08],
         [ 1.292e-08],
         [ 6.189e-08],
         [ 8.237e-08],
         [ 5.737e-08],
         [ 1.066e-07],
         [ 3.342e-08],
         [ 6.613e-08],
         [ 7.584e-08]],

        [[ 1.874e-08],
         [ 4.401e-08],
         [ 4.772e-08],
         [ 7.591e-09],
         [ 1.548e-09],
         [ 1.125e-08],
         [-2.272e-08],
         [ 1.464e-08],
         [ 2.886e-08],
         [-9.357e-09]],

        [[-8.085e-08],
         [ 3.372e-08],
         [-1.329e-07],
         [-9.657e-08],
         [-2.886e-08],
         [-1.855e-07],
         [-1.112e-07],
         [-9.305e-08],
         [-6.793e-08],
         [-8.210e-08]],

        [[-1.524e-07],
         [-1.032e-07],
         [-1.881e-07],
         [ 6.102e-09],
         [-1.408e-07],
         [-1.261e-07],
         [-4.542e-08],
         [-1.038e-07],
         [ 8.438e-09],
         [-3.340e-08]],

        [[-8.015e-06],
         [-7.923e-06],
         [-8.049e-06],
         [-1.344e-06],
         [-3.668e-07],
         [-7.921e-06],
         [-7.864e-06],
         [-7.726e-06],
         [-7.450e-06],
         [-7.558e-06]],

        [[ 1.004e-06],
         [ 1.077e-06],
         [-4.118e-09],
         [ 9.684e-07],
         [ 1.000e-06],
         [ 1.112e-06],
         [ 9.480e-07],
         [ 1.445e-08],
         [ 3.112e-07],
         [ 1.033e-06]],

        [[ 1.036e-07],
         [ 9.560e-08],
         [-8.423e-08],
         [ 6.429e-08],
         [-1.007e-07],
         [ 7.775e-08],
         [-4.820e-09],
         [ 8.810e-08],
         [-1.564e-07],
         [ 3.867e-08]],

        [[ 3.884e-08],
         [ 3.636e-08],
         [-3.642e-08],
         [-2.602e-08],
         [ 3.456e-08],
         [-1.531e-08],
         [ 3.374e-08],
         [-3.381e-08],
         [ 2.504e-08],
         [ 2.246e-08]],

        [[ 2.209e-08],
         [ 6.485e-08],
         [ 2.749e-08],
         [ 4.787e-08],
         [-1.226e-08],
         [ 1.033e-08],
         [-1.588e-08],
         [ 3.919e-08],
         [ 3.981e-08],
         [ 3.733e-08]],

        [[-3.599e-06],
         [-3.429e-06],
         [-3.270e-06],
         [-3.417e-06],
         [-3.058e-07],
         [-3.179e-06],
         [-3.290e-06],
         [-3.345e-06],
         [-3.362e-06],
         [-3.588e-06]],

        [[-3.801e-08],
         [-1.437e-09],
         [-2.238e-08],
         [-3.410e-08],
         [ 4.098e-09],
         [-2.425e-08],
         [-1.847e-08],
         [-4.064e-08],
         [-1.258e-09],
         [-3.365e-08]],

        [[ 3.748e-06],
         [ 3.568e-06],
         [ 3.997e-06],
         [ 3.773e-06],
         [ 4.170e-06],
         [ 3.555e-06],
         [ 3.977e-06],
         [ 3.375e-06],
         [ 2.855e-06],
         [ 3.938e-06]],

        [[ 1.592e-08],
         [ 3.033e-08],
         [ 1.121e-08],
         [ 1.268e-08],
         [-7.698e-09],
         [ 3.669e-10],
         [ 3.559e-09],
         [ 6.408e-08],
         [-2.037e-08],
         [ 5.637e-08]]], device='cuda:0')
s after update for 1 param tensor([[[1.161e-05],
         [1.730e-05],
         [3.719e-06],
         [1.151e-05],
         [1.665e-05],
         [9.173e-06],
         [3.346e-05],
         [6.696e-06],
         [1.715e-05],
         [2.062e-05]],

        [[1.031e-05],
         [1.545e-05],
         [1.564e-05],
         [3.486e-06],
         [2.628e-06],
         [1.830e-05],
         [7.037e-06],
         [5.597e-06],
         [2.078e-05],
         [4.409e-06]],

        [[1.606e-05],
         [1.103e-05],
         [3.155e-05],
         [1.897e-05],
         [9.899e-06],
         [4.131e-05],
         [2.607e-05],
         [2.442e-05],
         [2.190e-05],
         [1.939e-05]],

        [[4.248e-05],
         [2.081e-05],
         [4.777e-05],
         [3.519e-06],
         [3.185e-05],
         [3.436e-05],
         [1.573e-05],
         [1.913e-05],
         [5.590e-06],
         [1.311e-05]],

        [[2.057e-03],
         [2.055e-03],
         [2.057e-03],
         [3.967e-04],
         [9.903e-05],
         [2.007e-03],
         [2.016e-03],
         [1.957e-03],
         [1.894e-03],
         [1.930e-03]],

        [[2.376e-04],
         [2.701e-04],
         [3.742e-06],
         [2.379e-04],
         [2.431e-04],
         [2.810e-04],
         [2.253e-04],
         [2.628e-06],
         [8.620e-05],
         [2.582e-04]],

        [[1.982e-05],
         [2.404e-05],
         [4.556e-05],
         [2.374e-05],
         [2.881e-05],
         [2.245e-05],
         [4.562e-06],
         [1.593e-05],
         [4.677e-05],
         [1.437e-05]],

        [[6.413e-06],
         [4.254e-06],
         [1.113e-05],
         [8.003e-06],
         [1.035e-05],
         [3.202e-06],
         [6.629e-06],
         [5.333e-06],
         [9.297e-06],
         [7.271e-06]],

        [[1.132e-05],
         [2.126e-05],
         [1.226e-05],
         [1.357e-05],
         [4.256e-06],
         [2.628e-06],
         [4.585e-06],
         [9.616e-06],
         [8.748e-06],
         [5.932e-06]],

        [[9.647e-04],
         [8.801e-04],
         [8.372e-04],
         [8.844e-04],
         [9.097e-05],
         [8.165e-04],
         [8.388e-04],
         [8.500e-04],
         [8.734e-04],
         [9.340e-04]],

        [[1.471e-05],
         [5.311e-06],
         [9.670e-06],
         [9.851e-06],
         [2.628e-06],
         [7.675e-06],
         [3.837e-06],
         [2.117e-05],
         [4.175e-06],
         [5.856e-06]],

        [[9.459e-04],
         [8.930e-04],
         [1.027e-03],
         [9.422e-04],
         [1.091e-03],
         [8.922e-04],
         [9.965e-04],
         [8.724e-04],
         [7.275e-04],
         [1.007e-03]],

        [[2.869e-06],
         [7.355e-06],
         [3.518e-06],
         [2.628e-06],
         [5.866e-06],
         [2.628e-06],
         [3.263e-06],
         [1.351e-05],
         [4.071e-06],
         [1.465e-05]]], device='cuda:0')
b after update for 1 param tensor([[[0.001],
         [0.001],
         [0.000],
         [0.001],
         [0.001],
         [0.001],
         [0.001],
         [0.001],
         [0.001],
         [0.001]],

        [[0.001],
         [0.001],
         [0.001],
         [0.000],
         [0.000],
         [0.001],
         [0.001],
         [0.001],
         [0.001],
         [0.001]],

        [[0.001],
         [0.001],
         [0.001],
         [0.001],
         [0.001],
         [0.002],
         [0.001],
         [0.001],
         [0.001],
         [0.001]],

        [[0.002],
         [0.001],
         [0.002],
         [0.000],
         [0.001],
         [0.001],
         [0.001],
         [0.001],
         [0.001],
         [0.001]],

        [[0.011],
         [0.011],
         [0.011],
         [0.005],
         [0.002],
         [0.011],
         [0.011],
         [0.011],
         [0.011],
         [0.011]],

        [[0.004],
         [0.004],
         [0.000],
         [0.004],
         [0.004],
         [0.004],
         [0.004],
         [0.000],
         [0.002],
         [0.004]],

        [[0.001],
         [0.001],
         [0.002],
         [0.001],
         [0.001],
         [0.001],
         [0.001],
         [0.001],
         [0.002],
         [0.001]],

        [[0.001],
         [0.001],
         [0.001],
         [0.001],
         [0.001],
         [0.000],
         [0.001],
         [0.001],
         [0.001],
         [0.001]],

        [[0.001],
         [0.001],
         [0.001],
         [0.001],
         [0.001],
         [0.000],
         [0.001],
         [0.001],
         [0.001],
         [0.001]],

        [[0.008],
         [0.007],
         [0.007],
         [0.007],
         [0.002],
         [0.007],
         [0.007],
         [0.007],
         [0.007],
         [0.007]],

        [[0.001],
         [0.001],
         [0.001],
         [0.001],
         [0.000],
         [0.001],
         [0.000],
         [0.001],
         [0.000],
         [0.001]],

        [[0.008],
         [0.007],
         [0.008],
         [0.007],
         [0.008],
         [0.007],
         [0.008],
         [0.007],
         [0.007],
         [0.008]],

        [[0.000],
         [0.001],
         [0.000],
         [0.000],
         [0.001],
         [0.000],
         [0.000],
         [0.001],
         [0.000],
         [0.001]]], device='cuda:0')
clipping threshold 1.4661999361058542
a after update for 1 param tensor([[ 4.523e-08],
        [ 2.239e-08],
        [ 1.067e-08],
        [-1.416e-07],
        [-8.189e-06],
        [ 9.460e-07],
        [-7.010e-08],
        [-6.360e-08],
        [ 4.405e-08],
        [-3.407e-06],
        [-2.816e-08],
        [ 3.958e-06],
        [ 6.636e-08]], device='cuda:0')
s after update for 1 param tensor([[1.323e-05],
        [4.560e-06],
        [1.950e-05],
        [3.630e-05],
        [2.132e-03],
        [2.286e-04],
        [3.799e-05],
        [1.355e-05],
        [1.610e-05],
        [8.977e-04],
        [9.212e-06],
        [1.014e-03],
        [2.214e-05]], device='cuda:0')
b after update for 1 param tensor([[0.001],
        [0.001],
        [0.001],
        [0.001],
        [0.011],
        [0.004],
        [0.002],
        [0.001],
        [0.001],
        [0.007],
        [0.001],
        [0.008],
        [0.001]], device='cuda:0')
clipping threshold 1.4661999361058542
||w||^2 9257468.746767158
exp ma of ||w||^2 9736948.495435836
||w|| 3042.6088718018223
exp ma of ||w|| 2708.7770593921873
cuda
Objective function 114.39 = squared loss an data 113.27 + 0.5*rho*h**2 0.485022 + alpha*h 0.410058 + L2reg 0.15 + L1reg 0.08 ; SHD = 29 ; DAG False
Proportion of microbatches that were clipped  0.9441900400686892
iteration 2 in inner loop, alpha 1.3165887914307852 rho 10.0 h 0.311455222964069
iteration 2 in outer loop, alpha = 4.4311410210714754, rho = 10.0, h = 0.311455222964069
cuda
1963
cuda
Objective function 115.36 = squared loss an data 113.27 + 0.5*rho*h**2 0.485022 + alpha*h 1.380102 + L2reg 0.15 + L1reg 0.08 ; SHD = 29 ; DAG False
||w||^2 11429338468.99517
exp ma of ||w||^2 29584964728.655914
||w|| 106908.08420786134
exp ma of ||w|| 153374.18760114364
cuda
Objective function 80.30 = squared loss an data 78.91 + 0.5*rho*h**2 0.199966 + alpha*h 0.886153 + L2reg 0.22 + L1reg 0.08 ; SHD = 28 ; DAG False
Proportion of microbatches that were clipped  0.9994279176201373
iteration 1 in inner loop, alpha 4.4311410210714754 rho 10.0 h 0.19998291634773224
1963
cuda
Objective function 82.10 = squared loss an data 78.91 + 0.5*rho*h**2 1.999658 + alpha*h 0.886153 + L2reg 0.22 + L1reg 0.08 ; SHD = 28 ; DAG False
||w||^2 33498771857.810226
exp ma of ||w||^2 45788718940.87156
||w|| 183026.6971176889
exp ma of ||w|| 199050.67097868776
||w||^2 19106944.463627048
exp ma of ||w||^2 81704676.21680097
||w|| 4371.149101051925
exp ma of ||w|| 7755.73915780084
||w||^2 3149581.5708666025
exp ma of ||w||^2 21818230.439769916
||w|| 1774.706051960888
exp ma of ||w|| 4057.1867465594373
||w||^2 13139.764707175647
exp ma of ||w||^2 325177.20773600694
||w|| 114.62881272688664
exp ma of ||w|| 450.7956111771233
||w||^2 5186.280743176649
exp ma of ||w||^2 38452.37560749812
||w|| 72.01583675259664
exp ma of ||w|| 144.70338382094312
cuda
Objective function 56.12 = squared loss an data 55.09 + 0.5*rho*h**2 0.300094 + alpha*h 0.343288 + L2reg 0.31 + L1reg 0.08 ; SHD = 25 ; DAG True
Proportion of microbatches that were clipped  1.0
iteration 2 in inner loop, alpha 4.4311410210714754 rho 100.0 h 0.07747175064734435
iteration 3 in outer loop, alpha = 12.17831608580591, rho = 100.0, h = 0.07747175064734435
cuda
1963
cuda
Objective function 56.72 = squared loss an data 55.09 + 0.5*rho*h**2 0.300094 + alpha*h 0.943475 + L2reg 0.31 + L1reg 0.08 ; SHD = 25 ; DAG True
||w||^2 6750450.1868213
exp ma of ||w||^2 17982440.196360663
||w|| 2598.162848402944
exp ma of ||w|| 3803.469064128999
||w||^2 2942864.1922353464
exp ma of ||w||^2 2581000.84327364
||w|| 1715.477832044281
exp ma of ||w|| 1349.8025421131965
||w||^2 2623727.355639264
exp ma of ||w||^2 2356558.9711847515
||w|| 1619.7923804115342
exp ma of ||w|| 1284.278996378286
cuda
Objective function 40.17 = squared loss an data 38.87 + 0.5*rho*h**2 0.152747 + alpha*h 0.673114 + L2reg 0.38 + L1reg 0.09 ; SHD = 24 ; DAG True
Proportion of microbatches that were clipped  1.0
iteration 1 in inner loop, alpha 12.17831608580591 rho 100.0 h 0.05527151347539139
1963
cuda
Objective function 41.54 = squared loss an data 38.87 + 0.5*rho*h**2 1.527470 + alpha*h 0.673114 + L2reg 0.38 + L1reg 0.09 ; SHD = 24 ; DAG True
||w||^2 18319467790.155617
exp ma of ||w||^2 31545217540.463432
||w|| 135349.42848108232
exp ma of ||w|| 165508.86189236995
||w||^2 1128537534.2081409
exp ma of ||w||^2 2420528503.635834
||w|| 33593.71271842606
exp ma of ||w|| 46261.223447247416
||w||^2 212356974.00347438
exp ma of ||w||^2 789534810.5087312
||w|| 14572.473160156253
exp ma of ||w|| 25919.1884540064
||w||^2 434208.79515836545
exp ma of ||w||^2 3317512.957370541
||w|| 658.9452140795663
exp ma of ||w|| 1505.1331739227344
||w||^2 45618.99190453907
exp ma of ||w||^2 110481.60601562214
||w|| 213.58602928220532
exp ma of ||w|| 267.41084397692396
cuda
Objective function 29.92 = squared loss an data 28.94 + 0.5*rho*h**2 0.206278 + alpha*h 0.247360 + L2reg 0.44 + L1reg 0.09 ; SHD = 23 ; DAG True
Proportion of microbatches that were clipped  1.0
iteration 2 in inner loop, alpha 12.17831608580591 rho 1000.0 h 0.020311476893622782
1963
cuda
Objective function 31.77 = squared loss an data 28.94 + 0.5*rho*h**2 2.062780 + alpha*h 0.247360 + L2reg 0.44 + L1reg 0.09 ; SHD = 23 ; DAG True
||w||^2 117359029190.2917
exp ma of ||w||^2 251865061772.21954
||w|| 342577.0412480844
exp ma of ||w|| 458080.4022052171
cuda
Objective function 24.36 = squared loss an data 23.45 + 0.5*rho*h**2 0.250118 + alpha*h 0.086134 + L2reg 0.49 + L1reg 0.09 ; SHD = 25 ; DAG True
Proportion of microbatches that were clipped  1.0
iteration 3 in inner loop, alpha 12.17831608580591 rho 10000.0 h 0.0070727386888105315
iteration 4 in outer loop, alpha = 82.90570297391122, rho = 10000.0, h = 0.0070727386888105315
cuda
1963
cuda
Objective function 24.86 = squared loss an data 23.45 + 0.5*rho*h**2 0.250118 + alpha*h 0.586370 + L2reg 0.49 + L1reg 0.09 ; SHD = 25 ; DAG True
||w||^2 512729736269.3927
exp ma of ||w||^2 275105883567.64166
||w|| 716051.4899568276
exp ma of ||w|| 465730.8717010288
||w||^2 51239433.98724473
exp ma of ||w||^2 431937824.1529637
||w|| 7158.172531257173
exp ma of ||w|| 18356.829408150115
cuda
Objective function 22.36 = squared loss an data 20.93 + 0.5*rho*h**2 0.242575 + alpha*h 0.577460 + L2reg 0.53 + L1reg 0.09 ; SHD = 24 ; DAG True
Proportion of microbatches that were clipped  1.0
iteration 1 in inner loop, alpha 82.90570297391122 rho 10000.0 h 0.006965266658578884
1963
cuda
Objective function 24.54 = squared loss an data 20.93 + 0.5*rho*h**2 2.425747 + alpha*h 0.577460 + L2reg 0.53 + L1reg 0.09 ; SHD = 24 ; DAG True
||w||^2 929262584.9129667
exp ma of ||w||^2 20618432019.48974
||w|| 30483.808569681165
exp ma of ||w|| 60365.94730882596
||w||^2 1598799462.5925741
exp ma of ||w||^2 13637054620.52439
||w|| 39984.99046633091
exp ma of ||w|| 50074.91563780455
||w||^2 3947756.3575993176
exp ma of ||w||^2 18007151.191300258
||w|| 1986.8961617556458
exp ma of ||w|| 3539.184636534221
||w||^2 4078.963938977512
exp ma of ||w||^2 18046.28991168537
||w|| 63.866767093516735
exp ma of ||w|| 102.33470848480573
cuda
Objective function 22.12 = squared loss an data 20.65 + 0.5*rho*h**2 0.572110 + alpha*h 0.280440 + L2reg 0.54 + L1reg 0.08 ; SHD = 26 ; DAG True
Proportion of microbatches that were clipped  0.9611428571428572
iteration 2 in inner loop, alpha 82.90570297391122 rho 100000.0 h 0.0033826332539348414
iteration 5 in outer loop, alpha = 3465.5389569087524, rho = 1000000.0, h = 0.0033826332539348414
Threshold 0.3
[[0.007 0.021 0.504 1.561 1.137 0.326 0.223 0.171 0.147 0.409 0.013 1.189
  0.069]
 [0.09  0.006 0.328 0.164 0.876 0.159 0.275 0.191 0.711 0.371 0.015 0.634
  0.488]
 [0.009 0.011 0.011 0.007 0.014 0.048 0.219 0.057 0.009 0.069 0.007 0.016
  0.009]
 [0.006 0.014 1.342 0.01  0.02  0.2   0.302 0.091 0.04  0.131 0.012 0.017
  0.031]
 [0.009 0.01  0.316 0.148 0.009 0.319 0.1   0.131 0.035 0.009 0.011 0.01
  0.017]
 [0.01  0.015 0.075 0.02  0.014 0.008 0.164 0.558 0.01  0.01  0.017 0.013
  0.007]
 [0.011 0.014 0.013 0.019 0.014 0.024 0.011 0.044 0.007 0.022 0.016 0.017
  0.015]
 [0.017 0.012 0.037 0.021 0.024 0.01  0.043 0.006 0.013 0.023 0.015 0.013
  0.015]
 [0.022 0.006 0.865 0.036 0.038 0.694 0.985 0.137 0.008 0.475 0.014 0.087
  0.109]
 [0.01  0.009 0.097 0.029 0.25  0.901 0.22  0.104 0.013 0.016 0.021 0.417
  0.006]
 [0.433 0.088 0.76  0.202 0.228 0.115 0.292 0.189 0.085 0.227 0.009 0.175
  0.046]
 [0.008 0.007 0.114 0.094 0.802 0.209 0.209 0.082 0.024 0.015 0.01  0.009
  0.018]
 [0.017 0.008 0.982 0.057 0.098 0.547 0.3   0.076 0.023 0.757 0.032 0.054
  0.007]]
[[0.    0.    0.504 1.561 1.137 0.326 0.    0.    0.    0.409 0.    1.189
  0.   ]
 [0.    0.    0.328 0.    0.876 0.    0.    0.    0.711 0.371 0.    0.634
  0.488]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.   ]
 [0.    0.    1.342 0.    0.    0.    0.302 0.    0.    0.    0.    0.
  0.   ]
 [0.    0.    0.316 0.    0.    0.319 0.    0.    0.    0.    0.    0.
  0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.558 0.    0.    0.    0.
  0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.   ]
 [0.    0.    0.865 0.    0.    0.694 0.985 0.    0.    0.475 0.    0.
  0.   ]
 [0.    0.    0.    0.    0.    0.901 0.    0.    0.    0.    0.    0.417
  0.   ]
 [0.433 0.    0.76  0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.   ]
 [0.    0.    0.    0.    0.802 0.    0.    0.    0.    0.    0.    0.
  0.   ]
 [0.    0.    0.982 0.    0.    0.547 0.3   0.    0.    0.757 0.    0.
  0.   ]]
{'fdr': 0.5666666666666667, 'tpr': 0.5, 'fpr': 0.3269230769230769, 'f1': 0.4642857142857143, 'shd': 26, 'npred': 30, 'ntrue': 26}
[0.021 0.504 1.561 1.137 0.326 0.223 0.171 0.147 0.409 0.013 1.189 0.069
 0.09  0.328 0.164 0.876 0.159 0.275 0.191 0.711 0.371 0.015 0.634 0.488
 0.009 0.011 0.007 0.014 0.048 0.219 0.057 0.009 0.069 0.007 0.016 0.009
 0.006 0.014 1.342 0.02  0.2   0.302 0.091 0.04  0.131 0.012 0.017 0.031
 0.009 0.01  0.316 0.148 0.319 0.1   0.131 0.035 0.009 0.011 0.01  0.017
 0.01  0.015 0.075 0.02  0.014 0.164 0.558 0.01  0.01  0.017 0.013 0.007
 0.011 0.014 0.013 0.019 0.014 0.024 0.044 0.007 0.022 0.016 0.017 0.015
 0.017 0.012 0.037 0.021 0.024 0.01  0.043 0.013 0.023 0.015 0.013 0.015
 0.022 0.006 0.865 0.036 0.038 0.694 0.985 0.137 0.475 0.014 0.087 0.109
 0.01  0.009 0.097 0.029 0.25  0.901 0.22  0.104 0.013 0.021 0.417 0.006
 0.433 0.088 0.76  0.202 0.228 0.115 0.292 0.189 0.085 0.227 0.175 0.046
 0.008 0.007 0.114 0.094 0.802 0.209 0.209 0.082 0.024 0.015 0.01  0.018
 0.017 0.008 0.982 0.057 0.098 0.547 0.3   0.076 0.023 0.757 0.032 0.054]
[[0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 1. 0. 0. 0.]
 [0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0. 0. 0.]
 [0. 1. 1. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 1. 0.]
 [1. 0. 1. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 0. 0.]
 [0. 1. 1. 0. 0. 0. 1. 0. 0. 1. 0. 0. 0.]]
[0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0.
 0. 0. 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0. 0.
 0. 1. 1. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 1. 0.
 1. 0. 1. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 0.
 0. 1. 1. 0. 0. 0. 1. 0. 0. 1. 0. 0.]
aucroc, aucpr (0.7529585798816568, 0.5179415946955797)
Iterations 200
Achieves (22.758190739507555, 1e-05)-DP
