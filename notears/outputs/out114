samples  5000  graph  10 30 ER mlp  minibatch size  100  noise  0.8  minibatches per NN training  63 quantile adaptive clipping
cuda
cuda
iteration 1 in inner loop,alpha 0.0 rho 1.0 h 1.1229782946562032
iteration 1 in outer loop, alpha = 1.1229782946562032, rho = 1.0, h = 1.1229782946562032
cuda
iteration 1 in inner loop,alpha 1.1229782946562032 rho 1.0 h 0.7586153562268656
iteration 2 in inner loop,alpha 1.1229782946562032 rho 10.0 h 0.35052850700977345
iteration 3 in inner loop,alpha 1.1229782946562032 rho 100.0 h 0.11468940960946838
iteration 2 in outer loop, alpha = 12.591919255603042, rho = 100.0, h = 0.11468940960946838
cuda
iteration 1 in inner loop,alpha 12.591919255603042 rho 100.0 h 0.05177271318199317
iteration 2 in inner loop,alpha 12.591919255603042 rho 1000.0 h 0.015651355822457802
iteration 3 in outer loop, alpha = 28.243275078060844, rho = 1000.0, h = 0.015651355822457802
cuda
iteration 1 in inner loop,alpha 28.243275078060844 rho 1000.0 h 0.0076855114245848455
iteration 2 in inner loop,alpha 28.243275078060844 rho 10000.0 h 0.0014915828817034793
iteration 4 in outer loop, alpha = 43.15910389509564, rho = 10000.0, h = 0.0014915828817034793
cuda
iteration 1 in inner loop,alpha 43.15910389509564 rho 10000.0 h 0.0007429807041994252
iteration 2 in inner loop,alpha 43.15910389509564 rho 100000.0 h 0.0002891063685233064
iteration 5 in outer loop, alpha = 72.06974074742628, rho = 100000.0, h = 0.0002891063685233064
cuda
iteration 1 in inner loop,alpha 72.06974074742628 rho 100000.0 h 0.00017923228974936478
iteration 6 in outer loop, alpha = 251.30203049679108, rho = 1000000.0, h = 0.00017923228974936478
Threshold 0.3
[[0.004 0.    0.375 0.    1.151 0.    1.81  0.    0.001 0.006]
 [2.238 0.002 1.51  0.    0.873 0.002 0.112 0.102 0.002 2.622]
 [0.003 0.    0.007 0.    2.013 0.    1.925 0.    0.001 0.   ]
 [1.277 0.414 1.493 0.    0.836 0.429 1.187 0.252 2.727 2.817]
 [0.    0.    0.    0.    0.004 0.    0.    0.    0.    0.   ]
 [0.182 0.001 0.192 0.    0.252 0.001 0.317 0.005 0.006 2.979]
 [0.    0.    0.001 0.    1.628 0.    0.004 0.    0.    0.   ]
 [1.803 0.006 1.373 0.    1.751 0.103 0.274 0.002 0.001 0.098]
 [2.33  0.05  2.344 0.    0.942 0.076 0.592 0.223 0.004 0.323]
 [0.177 0.    2.484 0.    1.744 0.    2.59  0.003 0.004 0.006]]
[[0.    0.    0.375 0.    1.151 0.    1.81  0.    0.    0.   ]
 [2.238 0.    1.51  0.    0.873 0.    0.    0.    0.    2.622]
 [0.    0.    0.    0.    2.013 0.    1.925 0.    0.    0.   ]
 [1.277 0.414 1.493 0.    0.836 0.429 1.187 0.    2.727 2.817]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.317 0.    0.    2.979]
 [0.    0.    0.    0.    1.628 0.    0.    0.    0.    0.   ]
 [1.803 0.    1.373 0.    1.751 0.    0.    0.    0.    0.   ]
 [2.33  0.    2.344 0.    0.942 0.    0.592 0.    0.    0.323]
 [0.    0.    2.484 0.    1.744 0.    2.59  0.    0.    0.   ]]
{'fdr': 0.12903225806451613, 'tpr': 0.9, 'fpr': 0.26666666666666666, 'f1': 0.8852459016393444, 'shd': 7, 'npred': 31, 'ntrue': 30}
[1.711e-04 3.748e-01 3.700e-05 1.151e+00 1.428e-04 1.810e+00 3.375e-04
 6.544e-04 6.155e-03 2.238e+00 1.510e+00 2.197e-04 8.729e-01 2.166e-03
 1.120e-01 1.016e-01 2.148e-03 2.622e+00 2.777e-03 4.733e-05 5.290e-06
 2.013e+00 1.718e-05 1.925e+00 3.450e-04 9.293e-04 3.424e-04 1.277e+00
 4.136e-01 1.493e+00 8.364e-01 4.289e-01 1.187e+00 2.521e-01 2.727e+00
 2.817e+00 1.031e-04 5.159e-06 1.565e-04 6.005e-06 6.467e-06 4.281e-04
 6.477e-05 7.295e-05 1.786e-05 1.822e-01 1.158e-03 1.915e-01 2.300e-04
 2.522e-01 3.169e-01 5.073e-03 5.512e-03 2.979e+00 1.947e-04 3.789e-05
 6.277e-04 9.142e-06 1.628e+00 2.855e-05 3.123e-05 1.601e-05 3.414e-04
 1.803e+00 5.688e-03 1.373e+00 2.606e-04 1.751e+00 1.033e-01 2.739e-01
 5.383e-04 9.756e-02 2.330e+00 5.015e-02 2.344e+00 1.064e-04 9.416e-01
 7.641e-02 5.921e-01 2.232e-01 3.225e-01 1.773e-01 2.227e-04 2.484e+00
 1.256e-04 1.744e+00 1.761e-04 2.590e+00 2.575e-03 3.510e-03]
[[0. 0. 0. 0. 1. 0. 1. 0. 0. 0.]
 [1. 0. 1. 0. 1. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 1. 0. 1. 0. 0. 0.]
 [1. 1. 1. 0. 1. 1. 1. 1. 1. 1.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [1. 1. 1. 0. 1. 1. 0. 0. 0. 0.]
 [1. 0. 1. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 1. 0. 1. 0. 0. 0.]]
[0. 0. 0. 1. 0. 1. 0. 0. 0. 1. 1. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 1. 0. 1.
 0. 0. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0. 1. 1. 1. 0. 1. 1. 0. 0. 0.
 1. 0. 1. 0. 1. 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 1. 0. 0.]
aucroc, aucpr (0.9805555555555556, 0.9709317334018953)
cuda
noise_multiplier  0.8  noise_multiplier_b  5.0  noise_multiplier_delta  0.802572353905128
cuda
Objective function 461.65 = squared loss an data 284.59 + 0.5*rho*h**2 176.710652 + alpha*h 0.000000 + L2reg 0.19 + L1reg 0.16 ; SHD = 55 ; DAG False
total norm for a microbatch 63.168367010151826 clip 9.383352533628253
total norm for a microbatch 28.455819400228712 clip 26.641406122532022
total norm for a microbatch 31.92880102081526 clip 25.624566362385497
cuda
Objective function 45.75 = squared loss an data 44.80 + 0.5*rho*h**2 0.606981 + alpha*h 0.000000 + L2reg 0.26 + L1reg 0.08 ; SHD = 38 ; DAG False
Proportion of microbatches that were clipped  0.9014778325123153
iteration 1 in inner loop, alpha 0.0 rho 1.0 h 1.10179931383826
iteration 1 in outer loop, alpha = 1.10179931383826, rho = 1.0, h = 1.10179931383826
cuda
noise_multiplier  0.8  noise_multiplier_b  5.0  noise_multiplier_delta  0.802572353905128
cuda
Objective function 46.97 = squared loss an data 44.80 + 0.5*rho*h**2 0.606981 + alpha*h 1.213962 + L2reg 0.26 + L1reg 0.08 ; SHD = 38 ; DAG False
total norm for a microbatch 35.34783088562865 clip 11.073018889325377
total norm for a microbatch 57.07939314760599 clip 17.134664115709796
total norm for a microbatch 32.10718520369438 clip 30.76752217635451
total norm for a microbatch 29.786471730731012 clip 32.542742693788874
total norm for a microbatch 31.91196924862833 clip 32.542742693788874
cuda
Objective function 13.67 = squared loss an data 11.63 + 0.5*rho*h**2 0.436052 + alpha*h 1.028931 + L2reg 0.49 + L1reg 0.07 ; SHD = 31 ; DAG False
Proportion of microbatches that were clipped  0.9131139568811801
iteration 1 in inner loop, alpha 1.10179931383826 rho 1.0 h 0.9338646058097702
noise_multiplier  0.8  noise_multiplier_b  5.0  noise_multiplier_delta  0.802572353905128
cuda
Objective function 17.59 = squared loss an data 11.63 + 0.5*rho*h**2 4.360516 + alpha*h 1.028931 + L2reg 0.49 + L1reg 0.07 ; SHD = 31 ; DAG False
total norm for a microbatch 72.30742009168783 clip 2.5540993192966748
total norm for a microbatch 67.72264438881007 clip 3.2992799286752
total norm for a microbatch 69.78800872413717 clip 8.718251174484738
total norm for a microbatch 45.39026941759825 clip 16.11613543770107
total norm for a microbatch 78.01899705179596 clip 40.700517772816696
total norm for a microbatch 85.16605752645286 clip 44.96643444767999
total norm for a microbatch 57.76565521870394 clip 47.164196972455606
total norm for a microbatch 42.80172638434595 clip 46.69275266671817
total norm for a microbatch 28.419608265898468 clip 46.2864711385754
total norm for a microbatch 76.05501534587363 clip 44.989105365804775
cuda
Objective function 11.18 = squared loss an data 9.09 + 0.5*rho*h**2 0.929137 + alpha*h 0.474960 + L2reg 0.62 + L1reg 0.06 ; SHD = 27 ; DAG False
Proportion of microbatches that were clipped  0.9273760656772971
iteration 2 in inner loop, alpha 1.10179931383826 rho 10.0 h 0.43107699907805674
noise_multiplier  0.8  noise_multiplier_b  5.0  noise_multiplier_delta  0.802572353905128
cuda
Objective function 19.54 = squared loss an data 9.09 + 0.5*rho*h**2 9.291369 + alpha*h 0.474960 + L2reg 0.62 + L1reg 0.06 ; SHD = 27 ; DAG False
total norm for a microbatch 56.216067237834835 clip 1.420592037411281
total norm for a microbatch 69.20375249809962 clip 2.4308121983620232
total norm for a microbatch 45.237759333970864 clip 4.906045091146857
total norm for a microbatch 91.13425412821267 clip 15.747777780695808
total norm for a microbatch 126.70152165253735 clip 54.25930601060439
total norm for a microbatch 87.07782456753259 clip 61.0097357318358
total norm for a microbatch 115.59734242760274 clip 60.348272215672
cuda
Objective function 12.61 = squared loss an data 10.62 + 0.5*rho*h**2 1.070719 + alpha*h 0.161233 + L2reg 0.70 + L1reg 0.06 ; SHD = 25 ; DAG False
Proportion of microbatches that were clipped  0.9405909797822706
iteration 3 in inner loop, alpha 1.10179931383826 rho 100.0 h 0.14633649680531136
iteration 2 in outer loop, alpha = 15.735448994369396, rho = 100.0, h = 0.14633649680531136
cuda
noise_multiplier  0.8  noise_multiplier_b  5.0  noise_multiplier_delta  0.802572353905128
cuda
Objective function 14.75 = squared loss an data 10.62 + 0.5*rho*h**2 1.070719 + alpha*h 2.302670 + L2reg 0.70 + L1reg 0.06 ; SHD = 25 ; DAG False
total norm for a microbatch 122.40036141471467 clip 1.9264795716616325
total norm for a microbatch 49.77531287834252 clip 2.533516530780312
total norm for a microbatch 45.29484057293237 clip 2.533516530780312
total norm for a microbatch 81.3166158885574 clip 3.312223029831494
total norm for a microbatch 137.18110490562378 clip 16.73940535584572
total norm for a microbatch 64.66599157491665 clip 31.435624201426844
total norm for a microbatch 117.69853758418802 clip 61.53321168604108
cuda
Objective function 13.37 = squared loss an data 10.53 + 0.5*rho*h**2 0.472163 + alpha*h 1.529115 + L2reg 0.78 + L1reg 0.06 ; SHD = 22 ; DAG True
Proportion of microbatches that were clipped  0.9378052751546727
iteration 1 in inner loop, alpha 15.735448994369396 rho 100.0 h 0.09717642417466621
noise_multiplier  0.8  noise_multiplier_b  5.0  noise_multiplier_delta  0.802572353905128
cuda
Objective function 17.62 = squared loss an data 10.53 + 0.5*rho*h**2 4.721629 + alpha*h 1.529115 + L2reg 0.78 + L1reg 0.06 ; SHD = 22 ; DAG True
total norm for a microbatch 122.46501824526835 clip 1.5682079317343711
total norm for a microbatch 112.88025786401619 clip 5.229961667599415
total norm for a microbatch 90.08461819234897 clip 7.520064715582756
total norm for a microbatch 105.2912848587893 clip 69.76482353275826
cuda
Objective function 13.27 = squared loss an data 11.36 + 0.5*rho*h**2 0.530637 + alpha*h 0.512617 + L2reg 0.81 + L1reg 0.05 ; SHD = 20 ; DAG True
Proportion of microbatches that were clipped  0.9406887755102041
iteration 2 in inner loop, alpha 15.735448994369396 rho 1000.0 h 0.03257720053871793
iteration 3 in outer loop, alpha = 48.312649533087324, rho = 1000.0, h = 0.03257720053871793
cuda
noise_multiplier  0.8  noise_multiplier_b  5.0  noise_multiplier_delta  0.802572353905128
cuda
Objective function 14.33 = squared loss an data 11.36 + 0.5*rho*h**2 0.530637 + alpha*h 1.573891 + L2reg 0.81 + L1reg 0.05 ; SHD = 20 ; DAG True
total norm for a microbatch 85.41695504319715 clip 1.7519340349905836
total norm for a microbatch 71.73091742707368 clip 2.310318181147265
total norm for a microbatch 56.5507667151934 clip 21.391801115573813
total norm for a microbatch 76.79674359563967 clip 25.362301914474667
total norm for a microbatch 78.14235174592267 clip 65.71212694789581
cuda
Objective function 13.44 = squared loss an data 11.01 + 0.5*rho*h**2 0.316696 + alpha*h 1.215898 + L2reg 0.84 + L1reg 0.06 ; SHD = 16 ; DAG True
Proportion of microbatches that were clipped  0.9418886198547215
iteration 1 in inner loop, alpha 48.312649533087324 rho 1000.0 h 0.025167287228462953
noise_multiplier  0.8  noise_multiplier_b  5.0  noise_multiplier_delta  0.802572353905128
cuda
Objective function 16.29 = squared loss an data 11.01 + 0.5*rho*h**2 3.166962 + alpha*h 1.215898 + L2reg 0.84 + L1reg 0.06 ; SHD = 16 ; DAG True
total norm for a microbatch 166.85939380145015 clip 1.0866776598045196
total norm for a microbatch 141.9596901835239 clip 3.2404830344505133
total norm for a microbatch 81.01916887707465 clip 3.893353301069285
total norm for a microbatch 51.09196072382268 clip 4.630010404307833
total norm for a microbatch 166.7198043847789 clip 5.510329600428125
total norm for a microbatch 59.92741492599302 clip 6.019363839100308
total norm for a microbatch 56.944085263768855 clip 34.366636721571794
total norm for a microbatch 76.25428882171613 clip 61.549500052886515
total norm for a microbatch 69.48130135620124 clip 68.36287622738287
cuda
Objective function 13.10 = squared loss an data 11.18 + 0.5*rho*h**2 0.500393 + alpha*h 0.483316 + L2reg 0.88 + L1reg 0.06 ; SHD = 15 ; DAG True
Proportion of microbatches that were clipped  0.9433662106267897
iteration 2 in inner loop, alpha 48.312649533087324 rho 10000.0 h 0.010003928603506296
noise_multiplier  0.8  noise_multiplier_b  5.0  noise_multiplier_delta  0.802572353905128
cuda
Objective function 17.60 = squared loss an data 11.18 + 0.5*rho*h**2 5.003929 + alpha*h 0.483316 + L2reg 0.88 + L1reg 0.06 ; SHD = 15 ; DAG True
total norm for a microbatch 105.9219824509437 clip 3.8382812381314024
total norm for a microbatch 80.85525207513389 clip 3.8382812381314024
total norm for a microbatch 129.6843392158504 clip 7.789021024552614
total norm for a microbatch 137.94752843273807 clip 10.1290110212004
total norm for a microbatch 61.19365135567668 clip 63.67908434775571
total norm for a microbatch 71.08864685374286 clip 77.2312662781132
total norm for a microbatch 65.39978021270406 clip 81.4760049595631
cuda
Objective function 13.31 = squared loss an data 11.17 + 0.5*rho*h**2 0.952955 + alpha*h 0.210917 + L2reg 0.92 + L1reg 0.06 ; SHD = 16 ; DAG True
Proportion of microbatches that were clipped  0.9502115196876016
iteration 3 in inner loop, alpha 48.312649533087324 rho 100000.0 h 0.004365673294280725
iteration 4 in outer loop, alpha = 484.87997896115985, rho = 100000.0, h = 0.004365673294280725
cuda
noise_multiplier  0.8  noise_multiplier_b  5.0  noise_multiplier_delta  0.802572353905128
cuda
Objective function 15.22 = squared loss an data 11.17 + 0.5*rho*h**2 0.952955 + alpha*h 2.116828 + L2reg 0.92 + L1reg 0.06 ; SHD = 16 ; DAG True
total norm for a microbatch 258.5743575023812 clip 1.4239194868742164
total norm for a microbatch 156.41048529423833 clip 4.528193354502542
total norm for a microbatch 102.53588381103829 clip 35.084625889437476
cuda
Objective function 13.50 = squared loss an data 11.01 + 0.5*rho*h**2 0.293056 + alpha*h 1.173882 + L2reg 0.96 + L1reg 0.06 ; SHD = 17 ; DAG True
Proportion of microbatches that were clipped  0.951274242667094
iteration 1 in inner loop, alpha 484.87997896115985 rho 100000.0 h 0.0024209737789888663
iteration 5 in outer loop, alpha = 2905.853757950026, rho = 1000000.0, h = 0.0024209737789888663
Threshold 0.3
[[0.01  0.011 0.045 0.003 0.061 0.018 0.026 0.006 0.005 0.014]
 [0.594 0.006 0.467 0.038 0.613 0.034 0.445 0.309 0.275 0.809]
 [0.17  0.01  0.007 0.005 0.325 0.014 0.293 0.029 0.009 0.016]
 [0.717 0.174 0.828 0.005 0.653 0.278 0.706 0.55  1.869 1.103]
 [0.14  0.007 0.012 0.004 0.007 0.013 0.008 0.029 0.01  0.007]
 [0.393 0.159 0.445 0.028 0.331 0.004 0.463 0.306 0.112 1.023]
 [0.307 0.012 0.027 0.006 0.652 0.017 0.006 0.028 0.013 0.016]
 [0.865 0.028 0.28  0.007 0.221 0.013 0.251 0.005 0.108 0.058]
 [1.272 0.013 0.914 0.004 0.827 0.048 0.45  0.074 0.004 0.733]
 [0.371 0.012 0.411 0.004 0.716 0.006 0.605 0.12  0.009 0.007]]
[[0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.594 0.    0.467 0.    0.613 0.    0.445 0.309 0.    0.809]
 [0.    0.    0.    0.    0.325 0.    0.    0.    0.    0.   ]
 [0.717 0.    0.828 0.    0.653 0.    0.706 0.55  1.869 1.103]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.393 0.    0.445 0.    0.331 0.    0.463 0.306 0.    1.023]
 [0.307 0.    0.    0.    0.652 0.    0.    0.    0.    0.   ]
 [0.865 0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [1.272 0.    0.914 0.    0.827 0.    0.45  0.    0.    0.733]
 [0.371 0.    0.411 0.    0.716 0.    0.605 0.    0.    0.   ]]
{'fdr': 0.34375, 'tpr': 0.7, 'fpr': 0.7333333333333333, 'f1': 0.6774193548387096, 'shd': 17, 'npred': 32, 'ntrue': 30}
[0.011 0.045 0.003 0.061 0.018 0.026 0.006 0.005 0.014 0.594 0.467 0.038
 0.613 0.034 0.445 0.309 0.275 0.809 0.17  0.01  0.005 0.325 0.014 0.293
 0.029 0.009 0.016 0.717 0.174 0.828 0.653 0.278 0.706 0.55  1.869 1.103
 0.14  0.007 0.012 0.004 0.013 0.008 0.029 0.01  0.007 0.393 0.159 0.445
 0.028 0.331 0.463 0.306 0.112 1.023 0.307 0.012 0.027 0.006 0.652 0.017
 0.028 0.013 0.016 0.865 0.028 0.28  0.007 0.221 0.013 0.251 0.108 0.058
 1.272 0.013 0.914 0.004 0.827 0.048 0.45  0.074 0.733 0.371 0.012 0.411
 0.004 0.716 0.006 0.605 0.12  0.009]
[[0. 0. 0. 0. 1. 0. 1. 0. 0. 0.]
 [1. 0. 1. 0. 1. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 1. 0. 1. 0. 0. 0.]
 [1. 1. 1. 0. 1. 1. 1. 1. 1. 1.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [1. 1. 1. 0. 1. 1. 0. 0. 0. 0.]
 [1. 0. 1. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 1. 0. 1. 0. 0. 0.]]
[0. 0. 0. 1. 0. 1. 0. 0. 0. 1. 1. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 1. 0. 1.
 0. 0. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0. 1. 1. 1. 0. 1. 1. 0. 0. 0.
 1. 0. 1. 0. 1. 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 1. 0. 0.]
aucroc, aucpr (0.89, 0.8406215499535277)
Iterations 630
Achieves (6.682218196030888, 1e-05)-DP
