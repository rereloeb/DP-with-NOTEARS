samples  5000  graph  10 30 ER mlp  minibatch size  100  noise  0.6  minibatches per NN training  63 quantile adaptive clipping
cuda
cuda
iteration 1 in inner loop,alpha 0.0 rho 1.0 h 1.1229782946562032
iteration 1 in outer loop, alpha = 1.1229782946562032, rho = 1.0, h = 1.1229782946562032
cuda
iteration 1 in inner loop,alpha 1.1229782946562032 rho 1.0 h 0.7591342657638389
iteration 2 in inner loop,alpha 1.1229782946562032 rho 10.0 h 0.34960077202379125
iteration 3 in inner loop,alpha 1.1229782946562032 rho 100.0 h 0.11451259254910795
iteration 2 in outer loop, alpha = 12.574237549566998, rho = 100.0, h = 0.11451259254910795
cuda
iteration 1 in inner loop,alpha 12.574237549566998 rho 100.0 h 0.052227753583817815
iteration 2 in inner loop,alpha 12.574237549566998 rho 1000.0 h 0.015653784002786608
iteration 3 in outer loop, alpha = 28.228021552353606, rho = 1000.0, h = 0.015653784002786608
cuda
iteration 1 in inner loop,alpha 28.228021552353606 rho 1000.0 h 0.007176494129216948
iteration 2 in inner loop,alpha 28.228021552353606 rho 10000.0 h 0.0013097947489359996
iteration 4 in outer loop, alpha = 41.325969041713606, rho = 10000.0, h = 0.0013097947489359996
cuda
iteration 1 in inner loop,alpha 41.325969041713606 rho 10000.0 h 0.0006765536514627968
iteration 2 in inner loop,alpha 41.325969041713606 rho 100000.0 h 0.0002906323986398007
iteration 5 in outer loop, alpha = 70.38920890569368, rho = 100000.0, h = 0.0002906323986398007
cuda
iteration 1 in inner loop,alpha 70.38920890569368 rho 100000.0 h 0.00018095840590603984
iteration 6 in outer loop, alpha = 251.34761481173354, rho = 1000000.0, h = 0.00018095840590603984
Threshold 0.3
[[0.004 0.    0.425 0.    1.147 0.    1.855 0.    0.001 0.005]
 [2.246 0.001 2.081 0.    0.872 0.002 0.066 0.098 0.003 2.494]
 [0.002 0.    0.007 0.    2.019 0.    2.039 0.    0.001 0.   ]
 [1.275 0.422 1.4   0.    0.837 0.439 1.173 0.254 2.724 2.83 ]
 [0.    0.    0.    0.    0.004 0.    0.    0.    0.    0.   ]
 [0.173 0.013 0.262 0.    0.253 0.001 0.306 0.006 0.004 2.859]
 [0.    0.    0.001 0.    1.629 0.    0.004 0.    0.    0.   ]
 [1.81  0.005 1.535 0.    1.735 0.096 0.363 0.002 0.    0.109]
 [2.332 0.05  2.288 0.    1.001 0.079 0.626 0.238 0.004 0.282]
 [0.172 0.    2.711 0.    1.74  0.    2.623 0.003 0.004 0.006]]
[[0.    0.    0.425 0.    1.147 0.    1.855 0.    0.    0.   ]
 [2.246 0.    2.081 0.    0.872 0.    0.    0.    0.    2.494]
 [0.    0.    0.    0.    2.019 0.    2.039 0.    0.    0.   ]
 [1.275 0.422 1.4   0.    0.837 0.439 1.173 0.    2.724 2.83 ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.306 0.    0.    2.859]
 [0.    0.    0.    0.    1.629 0.    0.    0.    0.    0.   ]
 [1.81  0.    1.535 0.    1.735 0.    0.363 0.    0.    0.   ]
 [2.332 0.    2.288 0.    1.001 0.    0.626 0.    0.    0.   ]
 [0.    0.    2.711 0.    1.74  0.    2.623 0.    0.    0.   ]]
{'fdr': 0.12903225806451613, 'tpr': 0.9, 'fpr': 0.26666666666666666, 'f1': 0.8852459016393444, 'shd': 7, 'npred': 31, 'ntrue': 30}
[1.531e-04 4.251e-01 2.830e-05 1.147e+00 2.597e-04 1.855e+00 3.968e-04
 6.710e-04 4.824e-03 2.246e+00 2.081e+00 1.448e-04 8.722e-01 1.997e-03
 6.571e-02 9.756e-02 3.145e-03 2.494e+00 1.926e-03 3.927e-05 3.746e-06
 2.019e+00 1.600e-05 2.039e+00 2.560e-04 9.805e-04 2.824e-04 1.275e+00
 4.218e-01 1.400e+00 8.366e-01 4.393e-01 1.173e+00 2.536e-01 2.724e+00
 2.830e+00 9.187e-05 4.415e-06 1.442e-04 7.754e-06 3.546e-06 4.221e-04
 3.186e-05 7.201e-05 1.868e-05 1.731e-01 1.331e-02 2.618e-01 1.968e-04
 2.532e-01 3.060e-01 5.534e-03 4.174e-03 2.859e+00 2.016e-04 3.263e-05
 5.380e-04 6.496e-06 1.629e+00 2.667e-05 9.205e-05 2.239e-05 2.841e-04
 1.810e+00 5.487e-03 1.535e+00 1.796e-04 1.735e+00 9.566e-02 3.628e-01
 3.013e-04 1.090e-01 2.332e+00 5.027e-02 2.288e+00 4.976e-05 1.001e+00
 7.914e-02 6.257e-01 2.383e-01 2.821e-01 1.719e-01 2.483e-04 2.711e+00
 7.055e-05 1.740e+00 2.131e-04 2.623e+00 3.125e-03 4.286e-03]
[[0. 0. 0. 0. 1. 0. 1. 0. 0. 0.]
 [1. 0. 1. 0. 1. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 1. 0. 1. 0. 0. 0.]
 [1. 1. 1. 0. 1. 1. 1. 1. 1. 1.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [1. 1. 1. 0. 1. 1. 0. 0. 0. 0.]
 [1. 0. 1. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 1. 0. 1. 0. 0. 0.]]
[0. 0. 0. 1. 0. 1. 0. 0. 0. 1. 1. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 1. 0. 1.
 0. 0. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0. 1. 1. 1. 0. 1. 1. 0. 0. 0.
 1. 0. 1. 0. 1. 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 1. 0. 0.]
aucroc, aucpr (0.9788888888888889, 0.9687713934332481)
cuda
noise_multiplier  0.6  noise_multiplier_b  5.0  noise_multiplier_delta  0.6010829247756457
cuda
Objective function 461.65 = squared loss an data 284.59 + 0.5*rho*h**2 176.710652 + alpha*h 0.000000 + L2reg 0.19 + L1reg 0.16 ; SHD = 55 ; DAG False
total norm for a microbatch 63.29744897783968 clip 9.383352533628253
total norm for a microbatch 28.192958959538103 clip 26.641406122532022
total norm for a microbatch 31.818490885809897 clip 25.93391352958019
cuda
Objective function 44.06 = squared loss an data 43.17 + 0.5*rho*h**2 0.552915 + alpha*h 0.000000 + L2reg 0.26 + L1reg 0.08 ; SHD = 38 ; DAG False
Proportion of microbatches that were clipped  0.9014778325123153
iteration 1 in inner loop, alpha 0.0 rho 1.0 h 1.0515848580982095
iteration 1 in outer loop, alpha = 1.0515848580982095, rho = 1.0, h = 1.0515848580982095
cuda
noise_multiplier  0.6  noise_multiplier_b  5.0  noise_multiplier_delta  0.6010829247756457
cuda
Objective function 45.17 = squared loss an data 43.17 + 0.5*rho*h**2 0.552915 + alpha*h 1.105831 + L2reg 0.26 + L1reg 0.08 ; SHD = 38 ; DAG False
total norm for a microbatch 34.433153891793474 clip 11.073018889325377
total norm for a microbatch 59.25897225284971 clip 17.203340032438224
total norm for a microbatch 31.21923784075803 clip 31.768005241949474
total norm for a microbatch 32.67271435951554 clip 33.600951501977256
total norm for a microbatch 38.7930186252173 clip 33.600951501977256
cuda
Objective function 12.67 = squared loss an data 10.74 + 0.5*rho*h**2 0.401748 + alpha*h 0.942619 + L2reg 0.51 + L1reg 0.07 ; SHD = 30 ; DAG False
Proportion of microbatches that were clipped  0.914572864321608
iteration 1 in inner loop, alpha 1.0515848580982095 rho 1.0 h 0.896379110605551
noise_multiplier  0.6  noise_multiplier_b  5.0  noise_multiplier_delta  0.6010829247756457
cuda
Objective function 16.28 = squared loss an data 10.74 + 0.5*rho*h**2 4.017478 + alpha*h 0.942619 + L2reg 0.51 + L1reg 0.07 ; SHD = 30 ; DAG False
total norm for a microbatch 78.38752664671735 clip 2.5540993192966748
total norm for a microbatch 67.26358900943242 clip 3.2992799286752
total norm for a microbatch 60.203771308539814 clip 8.718251174484738
total norm for a microbatch 51.770556413188785 clip 16.11613543770107
total norm for a microbatch 86.8386952949218 clip 40.86364588262348
total norm for a microbatch 87.41737777216905 clip 46.24328712981299
total norm for a microbatch 55.019390406089165 clip 48.309830309972426
total norm for a microbatch 49.28527891085393 clip 47.445845385224246
total norm for a microbatch 32.55136256968819 clip 47.22151988068436
total norm for a microbatch 81.84122912132318 clip 45.897945580798925
cuda
Objective function 10.61 = squared loss an data 8.63 + 0.5*rho*h**2 0.832820 + alpha*h 0.429176 + L2reg 0.65 + L1reg 0.06 ; SHD = 28 ; DAG False
Proportion of microbatches that were clipped  0.9276918219134828
iteration 2 in inner loop, alpha 1.0515848580982095 rho 10.0 h 0.4081226463997041
noise_multiplier  0.6  noise_multiplier_b  5.0  noise_multiplier_delta  0.6010829247756457
cuda
Objective function 18.10 = squared loss an data 8.63 + 0.5*rho*h**2 8.328205 + alpha*h 0.429176 + L2reg 0.65 + L1reg 0.06 ; SHD = 28 ; DAG False
total norm for a microbatch 53.738043380142194 clip 1.420592037411281
total norm for a microbatch 70.14096987502298 clip 2.4308121983620232
total norm for a microbatch 44.29686594466636 clip 4.906045091146857
total norm for a microbatch 86.44560523381443 clip 15.747777780695808
total norm for a microbatch 142.80598410532255 clip 54.259306010604384
total norm for a microbatch 86.4541324077298 clip 60.76618421667401
total norm for a microbatch 108.84248071874238 clip 60.1073612699153
cuda
Objective function 11.72 = squared loss an data 9.85 + 0.5*rho*h**2 0.939034 + alpha*h 0.144112 + L2reg 0.74 + L1reg 0.06 ; SHD = 23 ; DAG False
Proportion of microbatches that were clipped  0.9413685847589425
iteration 3 in inner loop, alpha 1.0515848580982095 rho 100.0 h 0.13704263820451246
iteration 2 in outer loop, alpha = 14.755848678549455, rho = 100.0, h = 0.13704263820451246
cuda
noise_multiplier  0.6  noise_multiplier_b  5.0  noise_multiplier_delta  0.6010829247756457
cuda
Objective function 13.60 = squared loss an data 9.85 + 0.5*rho*h**2 0.939034 + alpha*h 2.022180 + L2reg 0.74 + L1reg 0.06 ; SHD = 23 ; DAG False
total norm for a microbatch 106.85966082757241 clip 1.9264795716616325
total norm for a microbatch 67.53009031464045 clip 2.533516530780312
total norm for a microbatch 52.443207477545144 clip 2.533516530780312
total norm for a microbatch 68.71624516014363 clip 3.312223029831494
total norm for a microbatch 140.41348888355273 clip 16.73940535584572
total norm for a microbatch 64.85750997568199 clip 31.435624201426844
total norm for a microbatch 130.5328914098796 clip 61.5332116860411
cuda
Objective function 12.58 = squared loss an data 9.99 + 0.5*rho*h**2 0.394299 + alpha*h 1.310364 + L2reg 0.82 + L1reg 0.06 ; SHD = 20 ; DAG True
Proportion of microbatches that were clipped  0.9387821556496255
iteration 1 in inner loop, alpha 14.755848678549455 rho 100.0 h 0.08880302563939324
noise_multiplier  0.6  noise_multiplier_b  5.0  noise_multiplier_delta  0.6010829247756457
cuda
Objective function 16.13 = squared loss an data 9.99 + 0.5*rho*h**2 3.942989 + alpha*h 1.310364 + L2reg 0.82 + L1reg 0.06 ; SHD = 20 ; DAG True
total norm for a microbatch 131.0266028848031 clip 1.5682079317343711
total norm for a microbatch 116.58112659724168 clip 5.229961667599415
total norm for a microbatch 104.52888018518816 clip 7.520064715582756
total norm for a microbatch 107.57781093433617 clip 70.89003842392981
cuda
Objective function 12.24 = squared loss an data 10.48 + 0.5*rho*h**2 0.410641 + alpha*h 0.422873 + L2reg 0.87 + L1reg 0.06 ; SHD = 18 ; DAG True
Proportion of microbatches that were clipped  0.9408482142857143
iteration 2 in inner loop, alpha 14.755848678549455 rho 1000.0 h 0.028658007994165402
iteration 3 in outer loop, alpha = 43.41385667271486, rho = 1000.0, h = 0.028658007994165402
cuda
noise_multiplier  0.6  noise_multiplier_b  5.0  noise_multiplier_delta  0.6010829247756457
cuda
Objective function 13.06 = squared loss an data 10.48 + 0.5*rho*h**2 0.410641 + alpha*h 1.244155 + L2reg 0.87 + L1reg 0.06 ; SHD = 18 ; DAG True
total norm for a microbatch 82.27876006301496 clip 1.7519340349905836
total norm for a microbatch 68.34157742091067 clip 2.310318181147265
total norm for a microbatch 53.68310487674784 clip 21.391801115573813
total norm for a microbatch 79.68309370577775 clip 25.362301914474667
total norm for a microbatch 76.04597076746057 clip 66.23993237020899
cuda
Objective function 12.47 = squared loss an data 10.42 + 0.5*rho*h**2 0.207728 + alpha*h 0.884892 + L2reg 0.89 + L1reg 0.07 ; SHD = 15 ; DAG True
Proportion of microbatches that were clipped  0.941727199354318
iteration 1 in inner loop, alpha 43.41385667271486 rho 1000.0 h 0.02038271474594211
noise_multiplier  0.6  noise_multiplier_b  5.0  noise_multiplier_delta  0.6010829247756457
cuda
Objective function 14.34 = squared loss an data 10.42 + 0.5*rho*h**2 2.077275 + alpha*h 0.884892 + L2reg 0.89 + L1reg 0.07 ; SHD = 15 ; DAG True
total norm for a microbatch 200.48399975651327 clip 1.0866776598045196
total norm for a microbatch 146.69718295914726 clip 3.2404830344505133
total norm for a microbatch 78.51278835769442 clip 3.893353301069285
total norm for a microbatch 61.50243030457214 clip 4.630010404307833
total norm for a microbatch 176.95076869395422 clip 5.510329600428125
total norm for a microbatch 66.16995574244424 clip 6.019363839100308
total norm for a microbatch 69.0072935863523 clip 34.366636721571794
total norm for a microbatch 77.79955593628522 clip 61.05906839472878
total norm for a microbatch 73.40416373191269 clip 67.0092005815146
cuda
Objective function 12.48 = squared loss an data 10.74 + 0.5*rho*h**2 0.366055 + alpha*h 0.371464 + L2reg 0.93 + L1reg 0.07 ; SHD = 14 ; DAG True
Proportion of microbatches that were clipped  0.9438434616608335
iteration 2 in inner loop, alpha 43.41385667271486 rho 10000.0 h 0.008556343401838973
noise_multiplier  0.6  noise_multiplier_b  5.0  noise_multiplier_delta  0.6010829247756457
cuda
Objective function 15.78 = squared loss an data 10.74 + 0.5*rho*h**2 3.660551 + alpha*h 0.371464 + L2reg 0.93 + L1reg 0.07 ; SHD = 14 ; DAG True
total norm for a microbatch 104.64811208850949 clip 3.8382812381314024
total norm for a microbatch 91.4675450038552 clip 3.8382812381314024
total norm for a microbatch 133.3455013843558 clip 7.789021024552614
total norm for a microbatch 135.05541035908558 clip 10.1290110212004
total norm for a microbatch 59.94473216610388 clip 64.44783664872914
total norm for a microbatch 72.52115453051594 clip 77.5408100179805
total norm for a microbatch 64.5820575620307 clip 79.22631939611983
cuda
Objective function 12.37 = squared loss an data 10.53 + 0.5*rho*h**2 0.633236 + alpha*h 0.154499 + L2reg 0.98 + L1reg 0.07 ; SHD = 17 ; DAG True
Proportion of microbatches that were clipped  0.9493979824275952
iteration 3 in inner loop, alpha 43.41385667271486 rho 100000.0 h 0.0035587530133120993
iteration 4 in outer loop, alpha = 399.2891580039248, rho = 100000.0, h = 0.0035587530133120993
cuda
noise_multiplier  0.6  noise_multiplier_b  5.0  noise_multiplier_delta  0.6010829247756457
cuda
Objective function 13.63 = squared loss an data 10.53 + 0.5*rho*h**2 0.633236 + alpha*h 1.420971 + L2reg 0.98 + L1reg 0.07 ; SHD = 17 ; DAG True
total norm for a microbatch 391.3818889272969 clip 1.4239194868742164
total norm for a microbatch 139.66376074736144 clip 4.528193354502542
total norm for a microbatch 105.15052090000994 clip 35.084625889437476
cuda
Objective function 12.59 = squared loss an data 10.50 + 0.5*rho*h**2 0.199257 + alpha*h 0.797094 + L2reg 1.02 + L1reg 0.07 ; SHD = 15 ; DAG True
Proportion of microbatches that were clipped  0.9493508575092162
iteration 1 in inner loop, alpha 399.2891580039248 rho 100000.0 h 0.0019962814851304245
iteration 5 in outer loop, alpha = 2395.570643134349, rho = 1000000.0, h = 0.0019962814851304245
Threshold 0.3
[[0.009 0.009 0.021 0.002 0.041 0.01  0.019 0.006 0.004 0.009]
 [0.685 0.005 0.463 0.031 0.577 0.038 0.479 0.306 0.267 0.838]
 [0.204 0.007 0.006 0.004 0.395 0.013 0.34  0.031 0.009 0.017]
 [0.907 0.187 0.902 0.006 0.713 0.43  0.824 0.591 1.969 1.371]
 [0.164 0.007 0.01  0.004 0.004 0.008 0.009 0.026 0.008 0.008]
 [0.436 0.14  0.417 0.013 0.32  0.005 0.598 0.285 0.087 1.01 ]
 [0.441 0.008 0.02  0.005 0.619 0.01  0.007 0.04  0.008 0.014]
 [0.834 0.024 0.242 0.008 0.252 0.015 0.166 0.006 0.106 0.052]
 [1.451 0.012 0.964 0.002 0.85  0.065 0.651 0.072 0.006 0.619]
 [0.463 0.009 0.435 0.003 0.716 0.005 0.686 0.135 0.012 0.007]]
[[0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.685 0.    0.463 0.    0.577 0.    0.479 0.306 0.    0.838]
 [0.    0.    0.    0.    0.395 0.    0.34  0.    0.    0.   ]
 [0.907 0.    0.902 0.    0.713 0.43  0.824 0.591 1.969 1.371]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.436 0.    0.417 0.    0.32  0.    0.598 0.    0.    1.01 ]
 [0.441 0.    0.    0.    0.619 0.    0.    0.    0.    0.   ]
 [0.834 0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [1.451 0.    0.964 0.    0.85  0.    0.651 0.    0.    0.619]
 [0.463 0.    0.435 0.    0.716 0.    0.686 0.    0.    0.   ]]
{'fdr': 0.30303030303030304, 'tpr': 0.7666666666666667, 'fpr': 0.6666666666666666, 'f1': 0.7301587301587302, 'shd': 15, 'npred': 33, 'ntrue': 30}
[8.785e-03 2.084e-02 2.431e-03 4.139e-02 9.567e-03 1.938e-02 5.835e-03
 3.707e-03 8.857e-03 6.855e-01 4.628e-01 3.082e-02 5.774e-01 3.765e-02
 4.793e-01 3.056e-01 2.670e-01 8.380e-01 2.042e-01 7.383e-03 3.908e-03
 3.953e-01 1.317e-02 3.404e-01 3.075e-02 8.899e-03 1.692e-02 9.072e-01
 1.866e-01 9.023e-01 7.126e-01 4.303e-01 8.238e-01 5.914e-01 1.969e+00
 1.371e+00 1.644e-01 7.160e-03 1.027e-02 3.571e-03 8.462e-03 8.971e-03
 2.602e-02 8.256e-03 7.679e-03 4.361e-01 1.400e-01 4.169e-01 1.344e-02
 3.203e-01 5.981e-01 2.855e-01 8.708e-02 1.010e+00 4.406e-01 8.178e-03
 2.029e-02 4.814e-03 6.192e-01 9.592e-03 4.031e-02 8.113e-03 1.354e-02
 8.340e-01 2.445e-02 2.419e-01 7.937e-03 2.515e-01 1.513e-02 1.665e-01
 1.061e-01 5.170e-02 1.451e+00 1.246e-02 9.639e-01 1.924e-03 8.501e-01
 6.516e-02 6.508e-01 7.164e-02 6.189e-01 4.634e-01 8.639e-03 4.353e-01
 2.584e-03 7.156e-01 4.948e-03 6.856e-01 1.352e-01 1.187e-02]
[[0. 0. 0. 0. 1. 0. 1. 0. 0. 0.]
 [1. 0. 1. 0. 1. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 1. 0. 1. 0. 0. 0.]
 [1. 1. 1. 0. 1. 1. 1. 1. 1. 1.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [1. 1. 1. 0. 1. 1. 0. 0. 0. 0.]
 [1. 0. 1. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 1. 0. 1. 0. 0. 0.]]
[0. 0. 0. 1. 0. 1. 0. 0. 0. 1. 1. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 1. 0. 1.
 0. 0. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0. 1. 1. 1. 0. 1. 1. 0. 0. 0.
 1. 0. 1. 0. 1. 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 1. 0. 0.]
aucroc, aucpr (0.8961111111111111, 0.8491705292868661)
Iterations 630
Achieves (14.15454886112812, 1e-05)-DP
