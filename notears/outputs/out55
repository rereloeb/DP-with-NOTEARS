samples  5000  graph  13 26 ER mlp  minibatch size  25  noise  0.5  minibatches per NN training  1000 adaclip_and_quantile
cuda
cuda
iteration 1 in inner loop,alpha 0.0 rho 1.0 h 1.3261408551088962
iteration 1 in outer loop, alpha = 1.3261408551088962, rho = 1.0, h = 1.3261408551088962
cuda
iteration 1 in inner loop,alpha 1.3261408551088962 rho 1.0 h 0.8833022561168153
iteration 2 in inner loop,alpha 1.3261408551088962 rho 10.0 h 0.3976662043074768
iteration 3 in inner loop,alpha 1.3261408551088962 rho 100.0 h 0.14473978390051023
iteration 2 in outer loop, alpha = 15.80011924515992, rho = 100.0, h = 0.14473978390051023
cuda
iteration 1 in inner loop,alpha 15.80011924515992 rho 100.0 h 0.09206134723974557
iteration 2 in inner loop,alpha 15.80011924515992 rho 1000.0 h 0.03605103482185257
iteration 3 in outer loop, alpha = 51.85115406701249, rho = 1000.0, h = 0.03605103482185257
cuda
iteration 1 in inner loop,alpha 51.85115406701249 rho 1000.0 h 0.022520091840645406
iteration 2 in inner loop,alpha 51.85115406701249 rho 10000.0 h 0.007430765387507421
iteration 4 in outer loop, alpha = 126.1588079420867, rho = 10000.0, h = 0.007430765387507421
cuda
iteration 1 in inner loop,alpha 126.1588079420867 rho 10000.0 h 0.003776628811836602
iteration 2 in inner loop,alpha 126.1588079420867 rho 100000.0 h 0.0013610307532996302
iteration 5 in outer loop, alpha = 262.2618832720497, rho = 100000.0, h = 0.0013610307532996302
cuda
iteration 1 in inner loop,alpha 262.2618832720497 rho 100000.0 h 0.0007716999804809888
iteration 6 in outer loop, alpha = 1033.9618637530384, rho = 1000000.0, h = 0.0007716999804809888
Threshold 0.3
[[0.001 0.    0.182 2.569 0.635 0.    0.017 0.    0.    0.437 0.    1.888
  0.   ]
 [0.631 0.001 0.321 0.04  0.172 0.002 0.04  0.    0.    2.061 0.001 0.198
  0.   ]
 [0.    0.    0.002 0.    0.    0.    0.001 0.    0.    0.    0.    0.
  0.   ]
 [0.    0.    2.687 0.001 0.109 0.001 0.089 0.    0.    1.627 0.    0.283
  0.   ]
 [0.    0.    0.255 0.    0.001 0.    0.002 0.    0.    0.    0.    0.
  0.   ]
 [0.077 0.029 0.336 0.065 0.609 0.001 0.013 0.    0.114 2.26  0.033 0.126
  0.012]
 [0.009 0.012 1.092 0.025 0.088 0.043 0.027 0.001 0.002 0.973 0.001 0.299
  0.003]
 [0.009 0.007 0.009 0.01  1.505 3.724 0.081 0.001 0.648 0.449 0.002 0.053
  0.   ]
 [0.021 1.541 2.239 0.017 0.092 0.004 0.359 0.    0.    1.386 0.002 0.194
  0.022]
 [0.    0.    1.123 0.    0.242 0.    0.001 0.    0.    0.004 0.    2.362
  0.   ]
 [1.749 0.008 2.559 0.069 0.554 0.    0.012 0.001 0.003 0.986 0.    0.091
  0.001]
 [0.    0.    0.95  0.    0.976 0.    0.001 0.    0.    0.    0.    0.001
  0.   ]
 [0.007 1.023 2.329 0.018 0.272 0.003 0.091 0.    0.006 2.319 0.    0.415
  0.   ]]
[[0.    0.    0.    2.569 0.635 0.    0.    0.    0.    0.437 0.    1.888
  0.   ]
 [0.631 0.    0.321 0.    0.    0.    0.    0.    0.    2.061 0.    0.
  0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.   ]
 [0.    0.    2.687 0.    0.    0.    0.    0.    0.    1.627 0.    0.
  0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.   ]
 [0.    0.    0.336 0.    0.609 0.    0.    0.    0.    2.26  0.    0.
  0.   ]
 [0.    0.    1.092 0.    0.    0.    0.    0.    0.    0.973 0.    0.
  0.   ]
 [0.    0.    0.    0.    1.505 3.724 0.    0.    0.648 0.449 0.    0.
  0.   ]
 [0.    1.541 2.239 0.    0.    0.    0.359 0.    0.    1.386 0.    0.
  0.   ]
 [0.    0.    1.123 0.    0.    0.    0.    0.    0.    0.    0.    2.362
  0.   ]
 [1.749 0.    2.559 0.    0.554 0.    0.    0.    0.    0.986 0.    0.
  0.   ]
 [0.    0.    0.95  0.    0.976 0.    0.    0.    0.    0.    0.    0.
  0.   ]
 [0.    1.023 2.329 0.    0.    0.    0.    0.    0.    2.319 0.    0.415
  0.   ]]
{'fdr': 0.4117647058823529, 'tpr': 0.7692307692307693, 'fpr': 0.2692307692307692, 'f1': 0.6666666666666667, 'shd': 16, 'npred': 34, 'ntrue': 26}
[2.709e-04 1.824e-01 2.569e+00 6.347e-01 4.409e-04 1.688e-02 1.418e-04
 1.314e-04 4.370e-01 2.441e-05 1.888e+00 8.225e-05 6.311e-01 3.206e-01
 3.991e-02 1.718e-01 1.888e-03 4.013e-02 3.257e-04 1.429e-04 2.061e+00
 1.297e-03 1.978e-01 1.038e-04 3.463e-05 1.430e-05 1.019e-04 1.623e-04
 1.429e-05 9.834e-04 5.300e-06 2.169e-05 1.810e-04 1.877e-06 1.476e-05
 1.439e-05 1.233e-04 6.370e-05 2.687e+00 1.093e-01 5.654e-04 8.929e-02
 1.822e-04 4.822e-05 1.627e+00 8.417e-06 2.825e-01 5.350e-05 3.871e-05
 3.550e-05 2.549e-01 1.370e-04 9.870e-06 1.644e-03 7.721e-06 1.615e-05
 1.463e-04 4.828e-06 2.880e-04 1.052e-05 7.735e-02 2.929e-02 3.360e-01
 6.516e-02 6.090e-01 1.331e-02 1.129e-04 1.145e-01 2.260e+00 3.342e-02
 1.261e-01 1.247e-02 9.295e-03 1.173e-02 1.092e+00 2.524e-02 8.756e-02
 4.262e-02 9.732e-04 2.381e-03 9.727e-01 1.082e-03 2.986e-01 2.923e-03
 8.812e-03 6.955e-03 9.492e-03 1.023e-02 1.505e+00 3.724e+00 8.077e-02
 6.482e-01 4.494e-01 1.951e-03 5.338e-02 2.108e-04 2.096e-02 1.541e+00
 2.239e+00 1.656e-02 9.200e-02 4.081e-03 3.586e-01 3.273e-04 1.386e+00
 1.763e-03 1.943e-01 2.219e-02 4.106e-05 8.852e-05 1.123e+00 1.152e-04
 2.416e-01 2.212e-04 1.069e-03 4.351e-05 1.334e-05 6.935e-06 2.362e+00
 3.005e-05 1.749e+00 7.818e-03 2.559e+00 6.923e-02 5.540e-01 3.162e-04
 1.167e-02 8.957e-04 2.919e-03 9.857e-01 9.067e-02 8.555e-04 2.191e-06
 6.270e-06 9.500e-01 2.399e-05 9.764e-01 7.224e-06 1.035e-03 1.079e-06
 2.817e-06 4.822e-05 8.203e-07 9.864e-07 7.113e-03 1.023e+00 2.329e+00
 1.810e-02 2.718e-01 2.717e-03 9.136e-02 2.993e-05 5.610e-03 2.319e+00
 3.833e-04 4.147e-01]
[[0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 1. 0. 0. 0.]
 [0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0. 0. 0.]
 [0. 1. 1. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 1. 0.]
 [1. 0. 1. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 0. 0.]
 [0. 1. 1. 0. 0. 0. 1. 0. 0. 1. 0. 0. 0.]]
[0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0.
 0. 0. 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0. 0.
 0. 1. 1. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 1. 0.
 1. 0. 1. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 0.
 0. 1. 1. 0. 0. 0. 1. 0. 0. 1. 0. 0.]
aucroc, aucpr (0.8715976331360946, 0.7667248028902397)
cuda
1963
cuda
Objective function 480.43 = squared loss an data 285.64 + 0.5*rho*h**2 194.315677 + alpha*h 0.000000 + L2reg 0.24 + L1reg 0.24 ; SHD = 91 ; DAG False
||w||^2 0.4277900599122136
exp ma of ||w||^2 822.0628113181764
||w|| 0.6540566182772051
exp ma of ||w|| 0.4479851032860404
||w||^2 0.7371565958787768
exp ma of ||w||^2 0.42709994567287046
||w|| 0.8585782409767772
exp ma of ||w|| 0.5161346450020464
||w||^2 0.17828294012890275
exp ma of ||w||^2 0.29123606634481775
||w|| 0.4222356452609168
exp ma of ||w|| 0.5140352124267203
||w||^2 0.36049360494384514
exp ma of ||w||^2 0.3431944794481307
||w|| 0.6004111965510346
exp ma of ||w|| 0.5629907140563092
||w||^2 0.48495775992399426
exp ma of ||w||^2 0.42083315959032797
||w|| 0.6963890865916799
exp ma of ||w|| 0.6115348648592697
||w||^2 0.17407870397000666
exp ma of ||w||^2 0.4059115520749219
||w|| 0.4172274007900328
exp ma of ||w|| 0.6098046056378685
||w||^2 0.2853012228005166
exp ma of ||w||^2 0.4199302851392346
||w|| 0.5341359590970417
exp ma of ||w|| 0.6168295787051069
||w||^2 0.2991556327077431
exp ma of ||w||^2 0.5797647275921805
||w|| 0.5469512160218158
exp ma of ||w|| 0.7252130985696221
||w||^2 0.33004344112945616
exp ma of ||w||^2 0.5602597148032565
||w|| 0.5744940740594773
exp ma of ||w|| 0.7220888814609682
||w||^2 0.812272083639722
exp ma of ||w||^2 0.6051916835973327
||w|| 0.9012613847490205
exp ma of ||w|| 0.7451380237280597
||w||^2 0.8957559399902513
exp ma of ||w||^2 0.6914445434978588
||w|| 0.9464438387935394
exp ma of ||w|| 0.7948360699587026
||w||^2 0.0994909233840143
exp ma of ||w||^2 0.724731201369828
||w|| 0.31542181818005915
exp ma of ||w|| 0.8135492413173421
||w||^2 0.8310204414596396
exp ma of ||w||^2 0.6776795820924294
||w|| 0.9116032258936119
exp ma of ||w|| 0.7905738099376944
||w||^2 0.4581028473868987
exp ma of ||w||^2 0.7598675022364363
||w|| 0.6768329538275295
exp ma of ||w|| 0.8362342964673096
||w||^2 0.2790997167977176
exp ma of ||w||^2 0.7630595169445743
||w|| 0.5282988896427074
exp ma of ||w|| 0.8412422304152876
||w||^2 0.5242116901982771
exp ma of ||w||^2 0.7832445556480927
||w|| 0.724024647507443
exp ma of ||w|| 0.8387048478371566
||w||^2 1.040523881420263
exp ma of ||w||^2 0.7440123053966501
||w|| 1.0200607243788298
exp ma of ||w|| 0.8258634854303358
||w||^2 1.3980696049726091
exp ma of ||w||^2 0.7371298803135637
||w|| 1.1823999344437606
exp ma of ||w|| 0.8307396389409738
||w||^2 0.2373531954535055
exp ma of ||w||^2 0.7727564538419195
||w|| 0.4871890756713511
exp ma of ||w|| 0.8505559691246465
||w||^2 1.302050646617795
exp ma of ||w||^2 0.8287801523668555
||w|| 1.1410743387780635
exp ma of ||w|| 0.8740598611527501
||w||^2 0.5412758391549126
exp ma of ||w||^2 0.7945450432589392
||w|| 0.7357145092730689
exp ma of ||w|| 0.8529910139585397
||w||^2 0.772581030088635
exp ma of ||w||^2 0.886864504312129
||w|| 0.8789658867604789
exp ma of ||w|| 0.904317918607491
||w||^2 0.7093350806001244
exp ma of ||w||^2 0.8310325465460788
||w|| 0.8422203278240941
exp ma of ||w|| 0.8717217510401806
||w||^2 1.702812780046556
exp ma of ||w||^2 0.7838930269244184
||w|| 1.3049186871397604
exp ma of ||w|| 0.8472829227694969
cuda
Objective function 11.50 = squared loss an data 7.88 + 0.5*rho*h**2 2.377528 + alpha*h 0.000000 + L2reg 1.10 + L1reg 0.14 ; SHD = 61 ; DAG False
Proportion of microbatches that were clipped  0.770476499715886
iteration 1 in inner loop, alpha 0.0 rho 1.0 h 2.180608915323271
iteration 1 in outer loop, alpha = 2.180608915323271, rho = 1.0, h = 2.180608915323271
cuda
1963
cuda
Objective function 16.26 = squared loss an data 7.88 + 0.5*rho*h**2 2.377528 + alpha*h 4.755055 + L2reg 1.10 + L1reg 0.14 ; SHD = 61 ; DAG False
||w||^2 69225744435.82991
exp ma of ||w||^2 38100115818.36166
||w|| 263107.8570393327
exp ma of ||w|| 67128.29869649278
||w||^2 123384686.5005713
exp ma of ||w||^2 16587181184.82799
||w|| 11107.86597419015
exp ma of ||w|| 72904.74413243335
||w||^2 0.5136797446851769
exp ma of ||w||^2 6517.393955772735
||w|| 0.7167145489559821
exp ma of ||w|| 1.0272069091284457
||w||^2 1.0804806875681643
exp ma of ||w||^2 55.65029096781938
||w|| 1.0394617297275375
exp ma of ||w|| 1.0327441447156105
v before min max tensor([[-33.188, -23.501, -13.351,  ...,  21.884, -29.565,  55.104],
        [ 20.195, -20.528,  46.399,  ...,  65.348, -28.388, -17.052],
        [ -4.424,  13.442, -23.923,  ..., -15.835, -13.698,  10.541],
        ...,
        [-11.606,  65.137, -19.498,  ..., 179.687,  19.665, 324.280],
        [ -5.702, -15.238, -22.800,  ...,  -9.628, -15.139, -32.442],
        [ -1.025, -15.838, -10.161,  ...,  19.055,  16.904,  15.678]],
       device='cuda:0')
v tensor([[1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e+01, 1.000e-12,
         1.000e+01],
        [1.000e+01, 1.000e-12, 1.000e+01,  ..., 1.000e+01, 1.000e-12,
         1.000e-12],
        [1.000e-12, 1.000e+01, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e+01],
        ...,
        [1.000e-12, 1.000e+01, 1.000e-12,  ..., 1.000e+01, 1.000e+01,
         1.000e+01],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e+01, 1.000e+01,
         1.000e+01]], device='cuda:0')
v before min max tensor([146.536, -23.252, -19.701, -33.978,  72.470, -29.922, -12.722,   2.863,
        -23.823, -25.827,  53.576, 254.228, -30.196,  79.974,  46.228, -16.647,
        105.452, -24.712, -12.279, -28.495, -11.749, -11.583, -18.271, 260.450,
         -3.686,  21.964, -22.503,  90.342,  -9.473,  -3.109,  43.786, -24.341,
        -30.616,  15.835,  64.536,  -7.381,  -6.226, -13.299, -21.109, -14.486,
         -0.770, -32.947, -10.497,  21.722, -23.997, -12.585,  -1.096, -26.269,
          3.242, -21.452, -24.963, -18.057, -16.454,   5.215, -30.874, -26.023,
         15.876,  61.199, -18.611,  60.638,   5.006, -11.515,  -2.190, -26.151,
          5.854, -13.861,   9.632, -20.908,  31.742, -33.851,  -3.183, -13.030,
        -20.892, 168.251,  -3.515,  -7.883, -29.042,   4.247, -21.832, -14.133,
        -27.722,  24.894, -23.408, -21.754, -24.967,  -4.474,  -6.293, 223.454,
        -14.190,  15.710,  91.007,  46.227, -30.337, -28.023,  25.190, -25.190,
        -27.719,  83.404, -21.022, -19.025, -19.124, -28.201,  13.681, -25.099,
         66.207, -20.983,   6.318, -22.576,  59.066,   3.688, -13.074,  65.620,
         21.104,  27.239,   5.472,  20.084, -26.527,  -1.147, -25.476, -27.545,
        -23.294, -17.415,  61.067, 131.734,  19.655, 163.464, -14.236,  23.699,
         -9.564,  61.150], device='cuda:0')
v tensor([1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e-12, 2.863e+00, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e+01,
        1.000e-12, 1.000e+01, 1.000e+01, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01,
        1.000e-12, 1.000e+01, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        3.242e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 5.215e+00,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e+01, 1.000e-12, 1.000e+01,
        5.006e+00, 1.000e-12, 1.000e-12, 1.000e-12, 5.854e+00, 1.000e-12,
        9.632e+00, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 4.247e+00,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e+01,
        1.000e+01, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e+01, 1.000e-12, 6.318e+00, 1.000e-12,
        1.000e+01, 3.688e+00, 1.000e-12, 1.000e+01, 1.000e+01, 1.000e+01,
        5.472e+00, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e+01, 1.000e+01, 1.000e+01,
        1.000e-12, 1.000e+01, 1.000e-12, 1.000e+01], device='cuda:0')
v before min max tensor([[[-2.934e+01],
         [-1.578e+01],
         [-2.326e+01],
         [-1.993e+01],
         [-3.235e+01],
         [-2.268e+01],
         [-2.557e+01],
         [-3.187e+01],
         [-3.416e+01],
         [-2.903e+01]],

        [[-3.009e+01],
         [ 2.573e+01],
         [ 2.955e+00],
         [-3.641e+01],
         [-2.519e+01],
         [-9.612e+00],
         [ 4.313e+01],
         [-1.818e+01],
         [-2.655e+01],
         [-1.382e+01]],

        [[-1.250e+01],
         [-1.946e+01],
         [ 1.380e+01],
         [ 5.019e+01],
         [ 4.020e+01],
         [ 1.104e+02],
         [-1.345e+00],
         [-2.194e+01],
         [ 5.078e+00],
         [ 1.183e+01]],

        [[ 1.612e+01],
         [-7.334e+00],
         [ 1.610e+02],
         [-3.656e+01],
         [-1.622e+01],
         [ 1.069e+02],
         [-5.221e+00],
         [-9.117e-01],
         [-2.325e+01],
         [ 3.400e+01]],

        [[ 1.335e+01],
         [ 2.260e+02],
         [-1.764e+01],
         [-2.584e+01],
         [-2.956e+01],
         [-2.704e+01],
         [-1.681e+01],
         [ 5.888e+00],
         [-3.513e+01],
         [-2.336e+01]],

        [[-2.346e+01],
         [-3.138e+01],
         [-3.185e+00],
         [-1.627e+01],
         [-3.178e+01],
         [ 1.232e-02],
         [-3.391e+01],
         [-1.144e+01],
         [ 9.428e+00],
         [ 9.640e+00]],

        [[ 1.525e+01],
         [-3.355e+01],
         [ 7.530e+01],
         [-8.027e+00],
         [ 1.700e+01],
         [ 3.821e+01],
         [-1.615e+01],
         [ 7.478e+01],
         [-4.416e+00],
         [ 1.121e+02]],

        [[-2.727e+01],
         [ 3.943e+01],
         [-1.795e+01],
         [ 1.191e+02],
         [-2.979e+00],
         [ 5.466e+01],
         [ 2.014e+02],
         [-2.404e+01],
         [-1.480e+01],
         [-6.301e+00]],

        [[ 6.411e+00],
         [-2.947e+01],
         [-1.334e+01],
         [ 5.124e+01],
         [-3.057e+01],
         [ 5.363e+01],
         [-3.792e+00],
         [ 5.326e+01],
         [-1.876e+01],
         [ 9.918e+00]],

        [[-6.270e+00],
         [-4.807e+00],
         [-2.720e+01],
         [-1.186e+01],
         [-1.920e+01],
         [-3.017e+01],
         [-1.243e+01],
         [ 7.731e+01],
         [-3.098e+01],
         [-1.524e+01]],

        [[ 9.291e+00],
         [ 1.322e+01],
         [-1.777e+01],
         [ 3.393e+01],
         [-2.317e+01],
         [-1.405e+01],
         [-1.934e+01],
         [ 2.563e-02],
         [ 7.187e+00],
         [-3.055e+01]],

        [[ 4.597e+00],
         [-1.309e+01],
         [ 9.478e+01],
         [ 2.110e+01],
         [-2.168e+00],
         [-2.194e+01],
         [-1.448e+01],
         [-2.393e+01],
         [-1.422e+01],
         [ 4.601e+01]],

        [[-2.313e+01],
         [-1.815e+01],
         [ 8.902e+01],
         [ 7.887e+01],
         [ 1.977e+01],
         [-1.830e+01],
         [-6.817e+00],
         [ 6.204e+01],
         [ 1.259e+02],
         [-2.862e+01]]], device='cuda:0')
v tensor([[[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e+01],
         [2.955e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [5.078e+00],
         [1.000e+01]],

        [[1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01]],

        [[1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [5.888e+00],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.232e-02],
         [1.000e-12],
         [1.000e-12],
         [9.428e+00],
         [9.640e+00]],

        [[1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01]],

        [[1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[6.411e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [9.918e+00]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12]],

        [[9.291e+00],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.563e-02],
         [7.187e+00],
         [1.000e-12]],

        [[4.597e+00],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12]]], device='cuda:0')
v before min max tensor([[150.170],
        [-15.129],
        [ 13.626],
        [-20.906],
        [-27.183],
        [-35.507],
        [-25.612],
        [-30.369],
        [-16.638],
        [  7.680],
        [-28.711],
        [  1.390],
        [ -7.643]], device='cuda:0')
v tensor([[1.000e+01],
        [1.000e-12],
        [1.000e+01],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [7.680e+00],
        [1.000e-12],
        [1.390e+00],
        [1.000e-12]], device='cuda:0')
a after update for 1 param tensor([[-0.001,  0.027, -0.218,  ..., -0.104,  0.157, -0.032],
        [-0.006, -0.054,  0.065,  ..., -0.017,  0.105, -0.053],
        [ 0.008,  0.129,  0.121,  ...,  0.056,  0.175,  0.091],
        ...,
        [ 0.023,  0.028, -0.113,  ...,  0.005, -0.015, -0.043],
        [-0.037,  0.020,  0.030,  ..., -0.098, -0.004, -0.034],
        [-0.045,  0.064,  0.067,  ..., -0.035, -0.139,  0.001]],
       device='cuda:0')
s after update for 1 param tensor([[2.084, 1.328, 1.985,  ..., 1.746, 1.678, 2.277],
        [1.817, 1.173, 1.504,  ..., 2.140, 1.641, 1.472],
        [1.893, 1.619, 1.351,  ..., 1.365, 0.931, 2.239],
        ...,
        [1.534, 2.227, 1.271,  ..., 1.763, 2.181, 2.094],
        [1.326, 0.861, 1.433,  ..., 1.333, 1.226, 1.969],
        [1.605, 2.199, 1.453,  ..., 1.966, 2.148, 1.983]], device='cuda:0')
b after update for 1 param tensor([[83.316, 66.491, 81.307,  ..., 76.243, 74.742, 87.070],
        [77.791, 62.506, 70.778,  ..., 84.414, 73.920, 70.008],
        [79.388, 73.427, 67.084,  ..., 67.416, 55.688, 86.344],
        ...,
        [71.463, 86.113, 65.053,  ..., 76.618, 85.222, 83.501],
        [66.461, 53.535, 69.084,  ..., 66.638, 63.890, 80.984],
        [73.107, 85.571, 69.554,  ..., 80.916, 84.576, 81.262]],
       device='cuda:0')
clipping threshold 0.7014292018811504
a after update for 1 param tensor([-5.583e-02, -2.770e-02,  3.983e-02, -4.293e-02, -7.206e-03, -6.617e-02,
         7.842e-03,  3.193e-02,  9.909e-02,  9.310e-02, -1.024e-01,  5.716e-02,
         1.048e-01, -3.952e-02,  1.179e-01, -7.603e-03, -8.015e-02,  4.081e-03,
         3.571e-02,  4.227e-02, -1.892e-02,  1.643e-01, -8.021e-02,  1.700e-01,
         6.995e-02,  1.594e-01, -4.098e-02, -3.075e-02,  2.521e-01,  8.083e-02,
        -5.216e-02, -6.485e-02, -1.979e-01, -2.860e-02, -7.310e-02, -1.393e-01,
         1.195e-02, -5.056e-02, -1.481e-01, -1.294e-01, -1.181e-01,  1.287e-01,
        -8.294e-02,  3.378e-02,  1.567e-02, -9.383e-02, -4.352e-02, -3.370e-02,
        -5.546e-02, -1.553e-02,  2.160e-03,  4.868e-02,  9.252e-02, -8.059e-02,
        -3.215e-02,  2.504e-02,  8.229e-02, -2.023e-01,  5.501e-02, -7.883e-02,
         2.278e-02, -4.305e-02, -1.462e-01, -9.465e-02,  1.945e-01, -5.668e-02,
         9.727e-02,  1.201e-01, -1.736e-02, -5.287e-02,  5.841e-02, -1.194e-01,
         2.409e-02, -1.035e-01,  6.842e-02,  5.351e-02, -2.343e-05,  1.302e-01,
        -2.432e-02,  1.467e-01,  4.805e-02, -1.051e-01,  8.214e-02,  7.920e-03,
        -1.585e-01, -5.994e-02, -3.085e-02, -4.243e-02,  5.990e-02,  1.124e-01,
        -7.282e-02,  1.651e-01, -1.685e-01,  6.293e-02, -3.574e-02,  7.640e-02,
        -4.126e-02,  2.641e-02, -4.331e-02, -7.916e-02, -8.220e-02,  1.482e-01,
         1.502e-02, -9.590e-02, -1.986e-01,  1.894e-02,  8.410e-03,  2.535e-02,
        -2.747e-03,  2.196e-01, -2.394e-01,  4.360e-02, -2.309e-01, -8.843e-02,
         8.211e-02, -6.445e-02,  1.553e-01,  1.448e-02,  5.008e-02, -1.212e-01,
         1.011e-01, -7.106e-02,  1.217e-01,  5.119e-02,  1.964e-02,  3.623e-02,
         1.491e-01,  2.630e-02,  5.880e-02,  2.962e-02], device='cuda:0')
s after update for 1 param tensor([1.896, 1.992, 1.359, 2.034, 1.699, 1.826, 1.134, 1.401, 1.601, 1.541,
        2.070, 1.922, 1.715, 1.809, 2.063, 1.547, 1.696, 1.548, 1.377, 1.800,
        1.811, 1.598, 1.428, 1.809, 1.440, 1.645, 1.309, 1.721, 1.636, 0.879,
        1.490, 1.377, 1.731, 1.995, 1.661, 1.599, 1.748, 1.757, 1.362, 1.327,
        1.912, 1.926, 1.492, 2.106, 1.611, 1.649, 1.922, 1.521, 1.705, 2.165,
        1.570, 1.111, 1.394, 1.800, 1.748, 1.473, 1.719, 2.038, 1.065, 1.791,
        1.510, 1.150, 1.132, 1.479, 1.645, 1.084, 1.350, 1.517, 1.965, 2.035,
        1.456, 1.529, 1.381, 1.682, 2.144, 1.148, 1.750, 1.714, 1.779, 1.465,
        1.608, 1.774, 1.425, 1.261, 1.465, 1.469, 1.778, 2.029, 1.659, 2.100,
        1.999, 2.066, 1.833, 1.694, 2.136, 2.007, 1.582, 1.590, 1.383, 1.217,
        1.081, 1.792, 1.517, 1.982, 2.113, 1.284, 1.564, 1.281, 1.602, 1.759,
        1.074, 1.861, 2.028, 1.680, 1.738, 1.753, 1.791, 1.225, 1.678, 1.591,
        1.434, 1.341, 1.470, 1.934, 2.161, 1.779, 1.110, 1.711, 1.851, 1.803],
       device='cuda:0')
b after update for 1 param tensor([79.459, 81.448, 67.274, 82.295, 75.212, 77.971, 61.460, 68.303, 73.029,
        71.643, 83.021, 80.007, 75.578, 77.620, 82.892, 71.786, 75.155, 71.803,
        67.726, 77.422, 77.663, 72.946, 68.970, 77.609, 69.252, 74.005, 66.016,
        75.702, 73.809, 54.095, 70.443, 67.728, 75.921, 81.505, 74.381, 72.962,
        76.306, 76.498, 67.344, 66.475, 79.785, 80.082, 70.494, 83.744, 73.235,
        74.105, 80.009, 71.162, 75.343, 84.915, 72.311, 60.821, 68.140, 77.418,
        76.304, 70.041, 75.652, 82.382, 59.564, 77.226, 70.902, 61.880, 61.392,
        70.183, 74.017, 60.082, 67.058, 71.070, 80.888, 82.317, 69.638, 71.348,
        67.807, 74.849, 84.497, 61.827, 76.345, 75.558, 76.959, 69.842, 73.171,
        76.855, 68.878, 64.800, 69.851, 69.936, 76.946, 82.201, 74.330, 83.620,
        81.589, 82.952, 78.128, 75.116, 84.334, 81.745, 72.576, 72.762, 67.875,
        63.673, 60.003, 77.249, 71.072, 81.248, 83.888, 65.400, 72.175, 65.306,
        73.033, 76.546, 59.796, 78.722, 82.176, 74.794, 76.088, 76.410, 77.226,
        63.880, 74.742, 72.779, 69.093, 66.819, 69.977, 80.252, 84.828, 76.972,
        60.793, 75.493, 78.510, 77.483], device='cuda:0')
clipping threshold 0.7014292018811504
a after update for 1 param tensor([[[-9.375e-02],
         [-2.156e-02],
         [ 2.338e-02],
         [ 7.080e-02],
         [-4.494e-03],
         [-3.637e-02],
         [ 1.513e-03],
         [-5.620e-02],
         [ 1.238e-03],
         [-7.079e-02]],

        [[-9.090e-02],
         [ 6.642e-02],
         [-6.383e-02],
         [-3.175e-02],
         [ 1.131e-01],
         [-1.357e-02],
         [ 2.124e-04],
         [-9.675e-03],
         [ 1.699e-02],
         [-8.974e-02]],

        [[-1.180e-02],
         [-2.258e-03],
         [ 1.643e-01],
         [-2.540e-02],
         [ 1.183e-01],
         [ 9.383e-02],
         [ 8.387e-02],
         [ 3.662e-02],
         [ 6.521e-02],
         [-2.548e-01]],

        [[ 3.271e-02],
         [-1.611e-02],
         [-1.079e-01],
         [ 6.186e-02],
         [-9.435e-02],
         [ 4.986e-02],
         [ 2.131e-02],
         [-8.964e-02],
         [-6.563e-02],
         [-1.605e-02]],

        [[-1.755e-01],
         [ 1.016e-01],
         [-2.324e-01],
         [ 6.966e-02],
         [ 3.024e-02],
         [ 1.002e-01],
         [-1.047e-01],
         [-1.010e-01],
         [-2.555e-01],
         [-1.854e-01]],

        [[ 4.298e-02],
         [ 5.130e-02],
         [-1.130e-01],
         [ 3.923e-03],
         [-8.467e-02],
         [ 1.009e-01],
         [-5.660e-02],
         [ 4.377e-02],
         [-9.326e-02],
         [-3.470e-02]],

        [[-1.561e-01],
         [-8.100e-02],
         [ 4.617e-02],
         [ 6.580e-02],
         [-1.596e-02],
         [ 7.386e-02],
         [ 7.277e-02],
         [ 1.230e-01],
         [ 2.481e-02],
         [-1.219e-01]],

        [[ 5.286e-02],
         [-1.485e-01],
         [ 4.503e-02],
         [-7.073e-03],
         [ 1.026e-01],
         [-1.330e-01],
         [ 1.356e-01],
         [ 1.672e-02],
         [ 2.901e-02],
         [-9.795e-02]],

        [[-4.269e-02],
         [ 7.858e-02],
         [-1.059e-01],
         [ 6.756e-04],
         [ 1.493e-01],
         [ 1.108e-01],
         [ 1.774e-01],
         [ 9.489e-02],
         [ 2.125e-02],
         [ 9.811e-02]],

        [[-2.727e-02],
         [-1.169e-01],
         [-4.877e-02],
         [ 1.267e-01],
         [-8.805e-02],
         [-1.606e-02],
         [ 4.690e-02],
         [ 4.233e-02],
         [-6.954e-02],
         [ 4.311e-02]],

        [[-9.864e-02],
         [-4.207e-02],
         [ 1.577e-01],
         [-9.451e-02],
         [-2.777e-02],
         [ 1.044e-02],
         [ 3.400e-02],
         [ 2.484e-01],
         [ 2.274e-01],
         [ 7.233e-02]],

        [[-2.617e-02],
         [ 4.753e-02],
         [-3.012e-02],
         [-3.616e-02],
         [ 5.971e-02],
         [ 1.874e-02],
         [-2.454e-01],
         [-1.665e-02],
         [-1.328e-01],
         [ 4.669e-02]],

        [[-6.746e-02],
         [-7.263e-03],
         [-3.337e-02],
         [ 3.781e-02],
         [-2.242e-03],
         [-1.492e-01],
         [-9.090e-02],
         [ 6.846e-02],
         [ 5.170e-02],
         [-2.114e-02]]], device='cuda:0')
s after update for 1 param tensor([[[1.661],
         [0.955],
         [1.377],
         [1.157],
         [1.839],
         [1.621],
         [1.621],
         [1.830],
         [1.929],
         [1.666]],

        [[1.699],
         [1.918],
         [1.679],
         [2.071],
         [1.478],
         [0.811],
         [1.666],
         [1.884],
         [1.547],
         [1.541]],

        [[1.604],
         [1.420],
         [1.663],
         [2.038],
         [1.922],
         [1.995],
         [0.915],
         [1.461],
         [1.708],
         [2.160]],

        [[2.039],
         [1.355],
         [1.903],
         [2.116],
         [1.448],
         [1.910],
         [1.465],
         [1.038],
         [1.487],
         [1.871]],

        [[1.779],
         [2.077],
         [1.647],
         [1.558],
         [1.692],
         [1.529],
         [1.038],
         [1.287],
         [2.046],
         [1.796]],

        [[1.332],
         [1.895],
         [1.483],
         [0.920],
         [2.283],
         [1.867],
         [1.948],
         [1.861],
         [2.024],
         [1.725]],

        [[1.815],
         [1.931],
         [2.380],
         [1.682],
         [1.950],
         [1.797],
         [1.388],
         [1.975],
         [1.541],
         [2.199]],

        [[1.962],
         [1.613],
         [1.219],
         [2.151],
         [1.467],
         [2.042],
         [2.050],
         [1.611],
         [1.614],
         [1.809]],

        [[1.462],
         [1.956],
         [1.699],
         [1.967],
         [1.728],
         [1.475],
         [1.678],
         [1.895],
         [1.467],
         [2.120]],

        [[0.869],
         [1.833],
         [2.095],
         [1.569],
         [1.140],
         [1.704],
         [1.734],
         [1.906],
         [2.068],
         [1.379]],

        [[2.021],
         [1.813],
         [1.929],
         [1.785],
         [1.315],
         [1.140],
         [1.307],
         [1.154],
         [1.052],
         [1.970]],

        [[1.607],
         [1.074],
         [1.642],
         [1.612],
         [1.325],
         [1.239],
         [1.670],
         [1.669],
         [1.851],
         [2.187]],

        [[1.307],
         [1.035],
         [1.909],
         [1.482],
         [1.673],
         [1.226],
         [1.057],
         [2.112],
         [1.922],
         [1.622]]], device='cuda:0')
b after update for 1 param tensor([[[74.383],
         [56.394],
         [67.724],
         [62.066],
         [78.255],
         [73.470],
         [73.476],
         [78.061],
         [80.157],
         [74.495]],

        [[75.226],
         [79.925],
         [74.775],
         [83.046],
         [70.161],
         [51.982],
         [74.484],
         [79.214],
         [71.771],
         [71.647]],

        [[73.083],
         [68.757],
         [74.421],
         [82.384],
         [80.003],
         [81.500],
         [55.214],
         [69.763],
         [75.426],
         [84.813]],

        [[82.397],
         [67.169],
         [79.614],
         [83.937],
         [69.453],
         [79.758],
         [69.836],
         [58.792],
         [70.368],
         [78.938]],

        [[76.966],
         [83.158],
         [74.055],
         [72.034],
         [75.055],
         [71.368],
         [58.783],
         [65.460],
         [82.547],
         [77.339]],

        [[66.596],
         [79.448],
         [70.275],
         [55.350],
         [87.190],
         [78.861],
         [80.538],
         [78.719],
         [82.095],
         [75.792]],

        [[77.742],
         [80.197],
         [89.036],
         [74.840],
         [80.578],
         [77.362],
         [67.994],
         [81.104],
         [71.628],
         [85.575]],

        [[80.837],
         [73.297],
         [63.722],
         [84.642],
         [69.902],
         [82.472],
         [82.617],
         [73.252],
         [73.305],
         [77.617]],

        [[69.764],
         [80.714],
         [75.218],
         [80.941],
         [75.867],
         [70.096],
         [74.752],
         [79.436],
         [69.885],
         [84.020]],

        [[53.808],
         [78.127],
         [83.530],
         [72.283],
         [61.621],
         [75.323],
         [75.990],
         [79.662],
         [82.994],
         [67.775]],

        [[82.041],
         [77.703],
         [80.141],
         [77.090],
         [66.165],
         [61.606],
         [65.965],
         [61.987],
         [59.186],
         [81.000]],

        [[73.160],
         [59.812],
         [73.957],
         [73.278],
         [66.436],
         [64.238],
         [74.579],
         [74.561],
         [78.509],
         [85.342]],

        [[65.962],
         [58.701],
         [79.728],
         [70.246],
         [74.640],
         [63.896],
         [59.330],
         [83.868],
         [80.002],
         [73.493]]], device='cuda:0')
clipping threshold 0.7014292018811504
a after update for 1 param tensor([[-0.012],
        [ 0.001],
        [ 0.045],
        [ 0.068],
        [ 0.050],
        [-0.142],
        [-0.006],
        [-0.046],
        [ 0.049],
        [ 0.152],
        [ 0.082],
        [ 0.119],
        [ 0.004]], device='cuda:0')
s after update for 1 param tensor([[2.018],
        [0.932],
        [1.986],
        [1.189],
        [1.768],
        [2.009],
        [1.639],
        [1.724],
        [1.757],
        [2.019],
        [1.621],
        [1.866],
        [1.524]], device='cuda:0')
b after update for 1 param tensor([[81.975],
        [55.717],
        [81.325],
        [62.920],
        [76.727],
        [81.785],
        [73.880],
        [75.764],
        [76.489],
        [81.992],
        [73.481],
        [78.838],
        [71.237]], device='cuda:0')
clipping threshold 0.7014292018811504
||w||^2 0.8473975742581519
exp ma of ||w||^2 1.0656343821792287
||w|| 0.9205420002684027
exp ma of ||w|| 0.9833692312477114
||w||^2 1.526744324100629
exp ma of ||w||^2 0.9874197474428585
||w|| 1.2356149578653655
exp ma of ||w|| 0.9567891372813166
||w||^2 0.29866637088250164
exp ma of ||w||^2 1.0990477392555584
||w|| 0.5465037702363101
exp ma of ||w|| 1.0086288906743843
||w||^2 0.9680705908792048
exp ma of ||w||^2 0.9985614285307499
||w|| 0.9839057835378369
exp ma of ||w|| 0.956344561326797
||w||^2 1.7108118618092099
exp ma of ||w||^2 1.1373983644665322
||w|| 1.3079800693470867
exp ma of ||w|| 1.0329953127257245
||w||^2 0.687413098808142
exp ma of ||w||^2 1.0467429087251228
||w|| 0.8291037925423704
exp ma of ||w|| 0.9878676009186454
||w||^2 0.5147869080425991
exp ma of ||w||^2 1.0670011372569652
||w|| 0.7174865211574355
exp ma of ||w|| 0.9900617391578368
||w||^2 0.4664401654259706
exp ma of ||w||^2 1.0988015445558101
||w|| 0.6829642490101299
exp ma of ||w|| 1.0035051857442079
||w||^2 1.0631444909699006
exp ma of ||w||^2 1.1623982236161834
||w|| 1.0310889830513663
exp ma of ||w|| 1.0249319455935941
||w||^2 0.854621631503951
exp ma of ||w||^2 1.109034082119642
||w|| 0.9244574795543335
exp ma of ||w|| 1.0165306027204368
||w||^2 0.8818381355527213
exp ma of ||w||^2 1.1883320050363595
||w|| 0.9390623704273967
exp ma of ||w|| 1.0419498928759536
||w||^2 0.8197325130993863
exp ma of ||w||^2 1.2842082173556482
||w|| 0.9053908068339254
exp ma of ||w|| 1.0856013644634117
||w||^2 0.6569229944794558
exp ma of ||w||^2 1.1045273685381092
||w|| 0.810507862071341
exp ma of ||w|| 1.0074051614033823
||w||^2 1.059744106192871
exp ma of ||w||^2 1.2028798830251188
||w|| 1.0294387335790658
exp ma of ||w|| 1.0373827775221027
||w||^2 1.0983608509787237
exp ma of ||w||^2 1.1931444548122199
||w|| 1.0480271232075646
exp ma of ||w|| 1.0498236234793623
||w||^2 1.5650508736664388
exp ma of ||w||^2 1.2886770315740268
||w|| 1.2510199333609513
exp ma of ||w|| 1.0923732062259497
||w||^2 1.5704270542468632
exp ma of ||w||^2 1.1016484658641614
||w|| 1.2531668102239475
exp ma of ||w|| 1.0020605592933136
||w||^2 0.5277958505693894
exp ma of ||w||^2 1.1252291645867583
||w|| 0.7264955956985488
exp ma of ||w|| 1.0123084277768872
v before min max tensor([[-35.866, -39.742, -24.087,  ..., -18.916,   1.673, -13.540],
        [ -8.725, 101.453,   1.664,  ...,  -6.983, -25.432, -22.834],
        [  4.125, -33.443,   8.926,  ...,  45.664,  90.737,   6.907],
        ...,
        [ 23.176, -27.041,   0.629,  ...,  -4.558,  89.988,  -3.119],
        [-36.824, 123.538,  -8.603,  ..., -33.103, -31.968,  30.221],
        [-10.110,   2.446,   5.997,  ..., 129.029,  22.494, -17.745]],
       device='cuda:0')
v tensor([[1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.673e+00,
         1.000e-12],
        [1.000e-12, 1.000e+01, 1.664e+00,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [4.125e+00, 1.000e-12, 8.926e+00,  ..., 1.000e+01, 1.000e+01,
         6.907e+00],
        ...,
        [1.000e+01, 1.000e-12, 6.285e-01,  ..., 1.000e-12, 1.000e+01,
         1.000e-12],
        [1.000e-12, 1.000e+01, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e+01],
        [1.000e-12, 2.446e+00, 5.997e+00,  ..., 1.000e+01, 1.000e+01,
         1.000e-12]], device='cuda:0')
v before min max tensor([218.376,  85.135, 117.211, 150.734, -43.961, -17.681, -19.150, -25.460,
        -14.171, -22.548,   1.933, -24.130,  42.966,   4.556, -25.797, -30.182,
         -9.485,  55.657,  -1.283,   3.682, -29.823, -35.449, -31.124,  66.825,
          7.444,   7.307,  21.875, -12.517,  29.344,   3.321, -17.767, -13.006,
        -32.860, 344.548, -21.400, -28.695, 196.614, -21.966, -18.935, -34.128,
         -1.042,  -2.464, -27.044, -18.233, 162.038,  -6.074, -12.235, -22.147,
        -39.617,  65.851, -31.824, 166.801,   3.461, -38.025, -10.282, 113.230,
         -8.651, -27.168,   5.438,  -1.314,  22.996,   2.202,  15.993,   8.189,
        -18.616,  33.252, -25.027, -25.701, -12.202, -10.555,  25.372, -36.434,
        -22.589, -31.953,  17.194,  -7.730, -12.982,   2.019,   4.279,   6.384,
         47.506,  21.704,   2.996, -11.800, 118.271,  84.750, -27.354,  -2.989,
         56.991, -32.686, 122.287, -28.124, -31.902, -17.549, -32.029, -30.415,
        -35.679, -26.369, -17.193, -31.408, -19.111, -37.171, -32.225, -26.785,
          5.576, -31.275, -28.956, -27.789, -34.599, -11.290,  76.256, -37.531,
         18.579, -29.251,  -2.873, -28.686,  76.470,  29.352,  16.514, -37.238,
        -15.998, -44.251, -18.915,  51.535, -35.923, -25.970,  97.483, -28.928,
        -16.860,  13.319], device='cuda:0')
v tensor([1.000e+01, 1.000e+01, 1.000e+01, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.933e+00, 1.000e-12,
        1.000e+01, 4.556e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01,
        1.000e-12, 3.682e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01,
        7.444e+00, 7.307e+00, 1.000e+01, 1.000e-12, 1.000e+01, 3.321e+00,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e+01, 1.000e-12, 1.000e+01, 3.461e+00, 1.000e-12,
        1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 5.438e+00, 1.000e-12,
        1.000e+01, 2.202e+00, 1.000e+01, 8.189e+00, 1.000e-12, 1.000e+01,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 2.019e+00,
        4.279e+00, 6.384e+00, 1.000e+01, 1.000e+01, 2.996e+00, 1.000e-12,
        1.000e+01, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 5.576e+00, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e+01, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e-12, 1.000e+01], device='cuda:0')
v before min max tensor([[[-20.895],
         [ -9.107],
         [-24.407],
         [-10.993],
         [-31.622],
         [ 10.484],
         [ 16.334],
         [ 40.025],
         [-27.674],
         [152.229]],

        [[  5.565],
         [ 72.720],
         [ -6.201],
         [-16.130],
         [ 70.720],
         [-16.898],
         [162.411],
         [  0.833],
         [ 13.030],
         [ 37.896]],

        [[-17.786],
         [ 19.473],
         [  4.218],
         [  9.299],
         [-27.180],
         [ 26.959],
         [-26.554],
         [-42.587],
         [106.861],
         [ 13.021]],

        [[-27.809],
         [-29.249],
         [-27.342],
         [-32.116],
         [  4.849],
         [-23.361],
         [-23.695],
         [-19.167],
         [-19.848],
         [-12.622]],

        [[ 54.919],
         [-14.518],
         [-30.099],
         [-24.744],
         [-17.553],
         [ 95.752],
         [-16.051],
         [ 26.869],
         [-30.677],
         [-36.733]],

        [[ -1.067],
         [ 51.133],
         [ 12.210],
         [-38.118],
         [-30.182],
         [-16.602],
         [251.371],
         [-20.954],
         [-12.228],
         [ 14.470]],

        [[-25.653],
         [ -8.712],
         [ -3.029],
         [-26.714],
         [ 88.001],
         [ 84.398],
         [-29.625],
         [ 11.996],
         [-23.461],
         [-14.749]],

        [[ 41.748],
         [ 39.527],
         [  4.153],
         [ 47.499],
         [-19.848],
         [ -8.233],
         [-37.462],
         [ 34.778],
         [-21.982],
         [-33.405]],

        [[-21.580],
         [ 40.496],
         [ 73.098],
         [ -8.724],
         [ 49.811],
         [ 61.087],
         [  4.233],
         [ 26.893],
         [291.914],
         [ -2.397]],

        [[-30.798],
         [-32.826],
         [ 43.502],
         [  8.989],
         [ -9.283],
         [-27.321],
         [-33.940],
         [ 66.605],
         [ 86.843],
         [ 45.646]],

        [[-13.185],
         [ 25.210],
         [-14.596],
         [-26.437],
         [-39.049],
         [ 63.298],
         [-18.603],
         [168.700],
         [-25.717],
         [-19.943]],

        [[-28.385],
         [-36.091],
         [ 73.592],
         [-35.271],
         [ 11.874],
         [ 46.572],
         [-22.659],
         [ 15.131],
         [-39.558],
         [-12.229]],

        [[-14.902],
         [-36.418],
         [ 34.284],
         [-32.647],
         [-22.798],
         [-29.741],
         [-26.400],
         [192.484],
         [ 22.558],
         [ 45.122]]], device='cuda:0')
v tensor([[[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01]],

        [[5.565e+00],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [8.331e-01],
         [1.000e+01],
         [1.000e+01]],

        [[1.000e-12],
         [1.000e+01],
         [4.218e+00],
         [9.299e+00],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [4.849e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e+01],
         [1.000e+01],
         [4.153e+00],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [4.233e+00],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [8.989e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01]],

        [[1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01]]], device='cuda:0')
v before min max tensor([[-16.144],
        [-38.288],
        [-22.854],
        [-23.334],
        [-24.767],
        [-43.988],
        [-17.840],
        [-26.382],
        [ 11.530],
        [  7.854],
        [ 45.118],
        [-38.674],
        [-25.836]], device='cuda:0')
v tensor([[1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e+01],
        [7.854e+00],
        [1.000e+01],
        [1.000e-12],
        [1.000e-12]], device='cuda:0')
a after update for 1 param tensor([[ 0.022,  0.009,  0.041,  ..., -0.134, -0.033, -0.120],
        [ 0.008,  0.044,  0.050,  ...,  0.042, -0.035,  0.022],
        [-0.007,  0.068, -0.064,  ...,  0.051,  0.022,  0.224],
        ...,
        [-0.092,  0.027,  0.038,  ..., -0.061,  0.086,  0.021],
        [-0.054, -0.015, -0.048,  ...,  0.102, -0.147,  0.055],
        [-0.065,  0.006, -0.090,  ...,  0.012, -0.052, -0.115]],
       device='cuda:0')
s after update for 1 param tensor([[1.699, 1.968, 1.371,  ..., 1.679, 1.605, 1.607],
        [1.470, 1.977, 1.437,  ..., 1.827, 1.380, 1.225],
        [2.052, 1.556, 1.851,  ..., 2.025, 1.677, 1.732],
        ...,
        [2.159, 1.501, 1.695,  ..., 0.513, 1.550, 0.949],
        [1.904, 1.834, 0.928,  ..., 1.755, 1.785, 1.544],
        [1.858, 0.854, 2.037,  ..., 2.013, 1.933, 1.751]], device='cuda:0')
b after update for 1 param tensor([[75.344, 81.085, 67.676,  ..., 74.904, 73.233, 73.278],
        [70.093, 81.273, 69.303,  ..., 78.124, 67.895, 63.977],
        [82.813, 72.110, 78.637,  ..., 82.262, 74.856, 76.084],
        ...,
        [84.939, 70.814, 75.260,  ..., 41.410, 71.960, 56.324],
        [79.762, 78.278, 55.699,  ..., 76.576, 77.236, 71.820],
        [78.799, 53.418, 82.491,  ..., 82.021, 80.374, 76.485]],
       device='cuda:0')
clipping threshold 0.7696365821255405
a after update for 1 param tensor([ 0.012, -0.003, -0.098,  0.010, -0.109,  0.228, -0.074, -0.019, -0.049,
        -0.118,  0.021, -0.076,  0.089,  0.106,  0.266,  0.064,  0.149, -0.079,
        -0.224, -0.049, -0.004,  0.064, -0.034, -0.051,  0.157, -0.020,  0.002,
         0.071,  0.166,  0.040,  0.016, -0.004, -0.114, -0.175, -0.024, -0.045,
         0.055,  0.026, -0.102,  0.077, -0.097,  0.001, -0.035, -0.078,  0.036,
         0.062, -0.060, -0.080,  0.027, -0.155, -0.000, -0.032,  0.067,  0.081,
        -0.261, -0.175, -0.172,  0.111, -0.103,  0.225,  0.083, -0.109, -0.065,
        -0.162, -0.104,  0.049,  0.253,  0.163, -0.097, -0.133, -0.098,  0.042,
         0.113,  0.030,  0.069, -0.039, -0.105,  0.038, -0.155,  0.061, -0.066,
         0.040,  0.090, -0.014,  0.070, -0.120,  0.019, -0.222, -0.202,  0.203,
        -0.042,  0.143,  0.048,  0.013,  0.180, -0.054,  0.189, -0.066, -0.007,
         0.138, -0.225,  0.206, -0.115, -0.017,  0.068, -0.062, -0.041, -0.002,
         0.097,  0.029, -0.033,  0.021,  0.034, -0.060, -0.113, -0.021,  0.038,
         0.232,  0.117,  0.030, -0.061, -0.022,  0.086, -0.171, -0.095,  0.158,
        -0.063,  0.097,  0.251, -0.089], device='cuda:0')
s after update for 1 param tensor([2.076, 2.242, 2.038, 2.216, 2.103, 0.921, 1.350, 1.337, 1.441, 1.505,
        1.930, 1.652, 1.294, 1.849, 1.212, 1.531, 1.799, 2.086, 1.481, 1.363,
        1.876, 1.649, 1.928, 1.884, 2.086, 1.398, 1.748, 1.884, 1.659, 1.482,
        0.995, 0.800, 1.645, 2.102, 1.195, 1.563, 1.772, 1.161, 1.805, 1.766,
        1.412, 1.129, 1.434, 1.829, 1.544, 1.698, 1.551, 1.068, 1.914, 2.222,
        1.849, 1.795, 0.891, 1.933, 1.781, 1.694, 1.167, 1.267, 2.017, 1.418,
        1.403, 1.432, 2.109, 1.882, 1.230, 1.748, 1.621, 2.226, 1.496, 1.533,
        1.464, 1.697, 1.051, 1.493, 2.161, 1.415, 1.670, 1.615, 1.268, 1.248,
        1.973, 2.098, 1.889, 1.417, 1.754, 1.954, 1.867, 1.008, 1.509, 1.683,
        1.925, 1.923, 1.613, 1.408, 1.769, 1.739, 1.687, 1.598, 1.451, 1.552,
        1.915, 1.893, 1.766, 2.307, 2.032, 1.472, 1.403, 1.570, 1.788, 0.642,
        1.777, 1.814, 1.968, 1.372, 1.421, 1.764, 1.715, 2.052, 2.316, 1.737,
        1.846, 2.067, 1.796, 2.183, 1.710, 1.392, 2.026, 1.652, 1.451, 1.837],
       device='cuda:0')
b after update for 1 param tensor([83.277, 86.553, 82.520, 86.044, 83.832, 55.484, 67.158, 66.835, 69.397,
        70.920, 80.308, 74.302, 65.765, 78.609, 63.650, 71.535, 77.523, 83.493,
        70.334, 67.477, 79.163, 74.226, 80.269, 79.352, 83.478, 68.340, 76.434,
        79.335, 74.444, 70.376, 57.662, 51.694, 74.141, 83.814, 63.180, 72.260,
        76.943, 62.294, 77.664, 76.814, 68.689, 61.417, 69.232, 78.175, 71.834,
        75.333, 71.982, 59.739, 79.967, 86.159, 78.611, 77.443, 54.561, 80.366,
        77.152, 75.233, 62.455, 65.053, 82.103, 68.845, 68.471, 69.182, 83.954,
        79.295, 64.112, 76.419, 73.594, 86.238, 70.709, 71.565, 69.941, 75.291,
        59.266, 70.627, 84.973, 68.754, 74.703, 73.451, 65.100, 64.567, 81.187,
        83.729, 79.442, 68.807, 76.557, 80.811, 78.990, 58.033, 71.005, 74.980,
        80.206, 80.164, 73.418, 68.599, 76.892, 76.227, 75.069, 73.074, 69.633,
        72.016, 80.000, 79.535, 76.810, 87.789, 82.392, 70.141, 68.457, 72.431,
        77.292, 46.298, 77.051, 77.861, 81.092, 67.709, 68.910, 76.775, 75.693,
        82.801, 87.978, 76.178, 78.545, 83.108, 77.470, 85.413, 75.590, 68.204,
        82.272, 74.298, 69.622, 78.352], device='cuda:0')
clipping threshold 0.7696365821255405
a after update for 1 param tensor([[[-0.014],
         [-0.236],
         [ 0.132],
         [ 0.050],
         [-0.187],
         [ 0.007],
         [ 0.064],
         [ 0.039],
         [-0.048],
         [-0.067]],

        [[ 0.054],
         [-0.128],
         [ 0.039],
         [-0.076],
         [ 0.050],
         [-0.048],
         [-0.002],
         [ 0.161],
         [-0.001],
         [-0.184]],

        [[ 0.128],
         [ 0.147],
         [-0.037],
         [ 0.158],
         [ 0.159],
         [-0.018],
         [ 0.069],
         [ 0.068],
         [-0.129],
         [ 0.102]],

        [[ 0.057],
         [ 0.110],
         [-0.036],
         [-0.046],
         [ 0.005],
         [-0.150],
         [ 0.124],
         [ 0.028],
         [-0.138],
         [ 0.102]],

        [[ 0.058],
         [ 0.060],
         [-0.018],
         [ 0.037],
         [ 0.060],
         [ 0.056],
         [ 0.026],
         [ 0.001],
         [ 0.009],
         [ 0.022]],

        [[ 0.194],
         [-0.050],
         [ 0.028],
         [-0.036],
         [ 0.061],
         [-0.013],
         [-0.102],
         [-0.110],
         [-0.149],
         [-0.031]],

        [[ 0.112],
         [ 0.105],
         [-0.027],
         [ 0.053],
         [-0.130],
         [ 0.034],
         [-0.034],
         [-0.021],
         [-0.065],
         [ 0.064]],

        [[-0.125],
         [ 0.135],
         [-0.051],
         [ 0.008],
         [ 0.005],
         [ 0.012],
         [-0.015],
         [-0.080],
         [-0.075],
         [-0.029]],

        [[-0.163],
         [ 0.014],
         [ 0.018],
         [ 0.041],
         [ 0.002],
         [ 0.076],
         [ 0.155],
         [ 0.073],
         [-0.066],
         [-0.041]],

        [[-0.097],
         [-0.089],
         [ 0.069],
         [ 0.112],
         [ 0.111],
         [-0.097],
         [-0.052],
         [ 0.022],
         [ 0.041],
         [-0.012]],

        [[ 0.134],
         [-0.029],
         [-0.145],
         [ 0.094],
         [ 0.063],
         [-0.054],
         [-0.009],
         [-0.118],
         [ 0.117],
         [ 0.115]],

        [[ 0.125],
         [ 0.006],
         [ 0.038],
         [ 0.008],
         [ 0.044],
         [-0.083],
         [ 0.023],
         [-0.074],
         [ 0.108],
         [ 0.032]],

        [[ 0.026],
         [-0.025],
         [-0.018],
         [ 0.083],
         [ 0.020],
         [-0.029],
         [ 0.046],
         [-0.090],
         [ 0.059],
         [ 0.050]]], device='cuda:0')
s after update for 1 param tensor([[[1.081],
         [1.586],
         [1.156],
         [1.561],
         [1.688],
         [1.746],
         [1.619],
         [1.650],
         [1.744],
         [1.987]],

        [[1.543],
         [1.716],
         [1.609],
         [1.643],
         [1.726],
         [1.429],
         [1.960],
         [1.631],
         [1.208],
         [1.544]],

        [[0.980],
         [1.760],
         [1.263],
         [1.773],
         [1.891],
         [2.192],
         [1.835],
         [1.985],
         [2.020],
         [1.806]],

        [[1.294],
         [1.385],
         [1.947],
         [1.585],
         [1.353],
         [1.626],
         [1.701],
         [0.891],
         [0.990],
         [1.615]],

        [[1.446],
         [1.525],
         [1.626],
         [1.413],
         [1.900],
         [1.666],
         [1.799],
         [1.648],
         [1.916],
         [1.709]],

        [[1.052],
         [2.147],
         [1.905],
         [1.905],
         [1.479],
         [0.864],
         [2.119],
         [1.219],
         [1.855],
         [1.314]],

        [[1.515],
         [1.182],
         [1.707],
         [1.249],
         [1.812],
         [1.627],
         [1.425],
         [1.935],
         [1.546],
         [0.797]],

        [[1.894],
         [1.675],
         [1.673],
         [1.754],
         [2.048],
         [1.681],
         [2.087],
         [2.062],
         [1.614],
         [1.706]],

        [[1.831],
         [1.705],
         [1.968],
         [1.036],
         [1.307],
         [1.792],
         [1.869],
         [1.634],
         [2.154],
         [1.492]],

        [[1.529],
         [1.703],
         [2.383],
         [2.300],
         [2.058],
         [1.430],
         [1.790],
         [1.868],
         [1.868],
         [2.016]],

        [[1.716],
         [1.841],
         [1.440],
         [1.342],
         [2.059],
         [2.293],
         [0.878],
         [1.882],
         [1.590],
         [2.001]],

        [[1.829],
         [1.801],
         [1.816],
         [1.648],
         [1.931],
         [2.289],
         [1.973],
         [1.705],
         [1.841],
         [1.600]],

        [[1.893],
         [1.704],
         [2.227],
         [1.556],
         [1.199],
         [1.473],
         [1.353],
         [1.887],
         [1.823],
         [2.058]]], device='cuda:0')
b after update for 1 param tensor([[[60.101],
         [72.800],
         [62.139],
         [72.227],
         [75.106],
         [76.389],
         [73.546],
         [74.243],
         [76.335],
         [81.475]],

        [[71.805],
         [75.721],
         [73.318],
         [74.087],
         [75.941],
         [69.103],
         [80.933],
         [73.834],
         [63.528],
         [71.825]],

        [[57.231],
         [76.692],
         [64.972],
         [76.959],
         [79.487],
         [85.583],
         [78.295],
         [81.447],
         [82.160],
         [77.673]],

        [[65.759],
         [68.028],
         [80.652],
         [72.780],
         [67.232],
         [73.707],
         [75.398],
         [54.577],
         [57.529],
         [73.452]],

        [[69.514],
         [71.393],
         [73.706],
         [68.717],
         [79.687],
         [74.605],
         [77.530],
         [74.199],
         [80.007],
         [75.558]],

        [[59.282],
         [84.694],
         [79.784],
         [79.777],
         [70.301],
         [53.718],
         [84.140],
         [63.817],
         [78.729],
         [66.256]],

        [[71.140],
         [62.840],
         [75.521],
         [64.595],
         [77.818],
         [73.722],
         [69.009],
         [80.405],
         [71.881],
         [51.607]],

        [[79.550],
         [74.807],
         [74.767],
         [76.552],
         [82.713],
         [74.956],
         [83.498],
         [83.005],
         [73.444],
         [75.509]],

        [[78.223],
         [75.480],
         [81.099],
         [58.823],
         [66.078],
         [77.390],
         [79.025],
         [73.900],
         [84.830],
         [70.596]],

        [[71.484],
         [75.425],
         [89.240],
         [87.661],
         [82.932],
         [69.121],
         [77.339],
         [78.995],
         [79.010],
         [82.078]],

        [[75.727],
         [78.429],
         [69.364],
         [66.970],
         [82.944],
         [87.533],
         [54.169],
         [79.295],
         [72.879],
         [81.760]],

        [[78.176],
         [77.567],
         [77.892],
         [74.216],
         [80.329],
         [87.458],
         [81.185],
         [75.470],
         [78.441],
         [73.119]],

        [[79.537],
         [75.450],
         [86.257],
         [72.102],
         [63.284],
         [70.161],
         [67.241],
         [79.397],
         [78.057],
         [82.924]]], device='cuda:0')
clipping threshold 0.7696365821255405
a after update for 1 param tensor([[-0.027],
        [-0.050],
        [-0.034],
        [ 0.063],
        [-0.085],
        [ 0.238],
        [ 0.006],
        [ 0.102],
        [ 0.112],
        [ 0.174],
        [-0.068],
        [-0.166],
        [-0.099]], device='cuda:0')
s after update for 1 param tensor([[0.945],
        [1.889],
        [1.064],
        [1.089],
        [1.572],
        [2.054],
        [1.727],
        [1.575],
        [1.928],
        [1.695],
        [1.258],
        [1.932],
        [1.242]], device='cuda:0')
b after update for 1 param tensor([[56.192],
        [79.446],
        [59.632],
        [60.312],
        [72.463],
        [82.848],
        [75.955],
        [72.546],
        [80.254],
        [75.257],
        [64.845],
        [80.340],
        [64.426]], device='cuda:0')
clipping threshold 0.7696365821255405
||w||^2 0.6783135930873675
exp ma of ||w||^2 1.1546647573396904
||w|| 0.82359795597571
exp ma of ||w|| 1.0306985910156055
||w||^2 0.9235772165107577
exp ma of ||w||^2 1.196567265474226
||w|| 0.9610292485199177
exp ma of ||w|| 1.0464000831885898
||w||^2 0.6322787811906757
exp ma of ||w||^2 1.0530169543761612
||w|| 0.7951595947925647
exp ma of ||w|| 0.9838954850902799
cuda
Objective function 13.39 = squared loss an data 7.58 + 0.5*rho*h**2 1.052085 + alpha*h 3.163139 + L2reg 1.45 + L1reg 0.15 ; SHD = 59 ; DAG False
Proportion of microbatches that were clipped  0.7758922184246085
iteration 1 in inner loop, alpha 2.180608915323271 rho 1.0 h 1.4505759206831783
1963
cuda
Objective function 22.86 = squared loss an data 7.58 + 0.5*rho*h**2 10.520853 + alpha*h 3.163139 + L2reg 1.45 + L1reg 0.15 ; SHD = 59 ; DAG False
||w||^2 18902073496.283726
exp ma of ||w||^2 110201511545.16939
||w|| 137484.81187492574
exp ma of ||w|| 253815.13817628307
||w||^2 3.7118574975247016
exp ma of ||w||^2 96036910.52957736
||w|| 1.9266181504192006
exp ma of ||w|| 389.90945266913343
||w||^2 0.7508941681515238
exp ma of ||w||^2 719083.1650768962
||w|| 0.8665414982281713
exp ma of ||w|| 4.250407283583199
||w||^2 1.686758975678687
exp ma of ||w||^2 1.7425729871583273
||w|| 1.298752853963635
exp ma of ||w|| 1.2625813507091224
||w||^2 1.1447140456764837
exp ma of ||w||^2 1.8667829888674174
||w|| 1.0699131019276675
exp ma of ||w|| 1.3135626437697892
||w||^2 2.5308281544078497
exp ma of ||w||^2 1.887190797532927
||w|| 1.5908576788662931
exp ma of ||w|| 1.3223635050935678
||w||^2 2.93225737080999
exp ma of ||w||^2 1.7787624252497396
||w|| 1.7123835349623022
exp ma of ||w|| 1.2759985311080382
||w||^2 1.6648552113765125
exp ma of ||w||^2 1.7776590633476423
||w|| 1.290292684384637
exp ma of ||w|| 1.277361618704164
||w||^2 0.6912022386821467
exp ma of ||w||^2 1.8397031508136636
||w|| 0.8313857339900335
exp ma of ||w|| 1.295074545593796
||w||^2 1.2780418737537624
exp ma of ||w||^2 1.7724893220125781
||w|| 1.1305051409674183
exp ma of ||w|| 1.2763930125503629
||w||^2 0.9469820437636481
exp ma of ||w||^2 1.8253969495820315
||w|| 0.9731300240788218
exp ma of ||w|| 1.2928754567666483
||w||^2 1.1445578517118635
exp ma of ||w||^2 1.9145077985649273
||w|| 1.069840105675546
exp ma of ||w|| 1.322268976452126
||w||^2 0.517232797801953
exp ma of ||w||^2 1.7088279563481688
||w|| 0.7191889861517298
exp ma of ||w|| 1.2434063316797495
||w||^2 1.119506818822283
exp ma of ||w||^2 1.6929330713263349
||w|| 1.0580674925647622
exp ma of ||w|| 1.2321522950344206
||w||^2 1.176145867332692
exp ma of ||w||^2 1.8987425021165547
||w|| 1.084502589822953
exp ma of ||w|| 1.32010902612244
||w||^2 4.654919768817802
exp ma of ||w||^2 1.6615004672619016
||w|| 2.1575263077927467
exp ma of ||w|| 1.237840639288646
||w||^2 1.862084734841135
exp ma of ||w||^2 1.8928138140670885
||w|| 1.3645822565316958
exp ma of ||w|| 1.323181348994596
||w||^2 0.9381476456899057
exp ma of ||w||^2 1.8347406387232257
||w|| 0.9685802216078468
exp ma of ||w|| 1.297060886979582
||w||^2 3.2803825744343293
exp ma of ||w||^2 1.9738905494927856
||w|| 1.8111826452443522
exp ma of ||w|| 1.351537057222463
||w||^2 1.607910532988322
exp ma of ||w||^2 1.735825249667451
||w|| 1.2680341213817246
exp ma of ||w|| 1.2641630392508256
||w||^2 1.5929341553863412
exp ma of ||w||^2 1.697769618317848
||w|| 1.2621149533169873
exp ma of ||w|| 1.2546293271636453
||w||^2 1.863723600449611
exp ma of ||w||^2 1.876383732686671
||w|| 1.3651826253104786
exp ma of ||w|| 1.3153562442500695
||w||^2 2.4231125485137732
exp ma of ||w||^2 1.777135312795388
||w|| 1.5566350081228975
exp ma of ||w|| 1.2819712573676278
||w||^2 3.1606382114438936
exp ma of ||w||^2 1.7108551980343665
||w|| 1.7778183853937088
exp ma of ||w|| 1.2580223162634179
||w||^2 0.424086019306738
exp ma of ||w||^2 1.762036953465232
||w|| 0.6512188720443672
exp ma of ||w|| 1.270675116516337
||w||^2 1.782990667047199
exp ma of ||w||^2 1.8606697079001082
||w|| 1.3352867358912839
exp ma of ||w|| 1.2956106189280971
||w||^2 0.7252767178184499
exp ma of ||w||^2 1.727596861180981
||w|| 0.8516317970921764
exp ma of ||w|| 1.2541650269468336
v before min max tensor([[135.953, 276.127, -10.484,  ..., -61.578, -51.409, -58.787],
        [ -6.512, 206.186, -10.689,  ...,  16.974, -52.822, -56.626],
        [ 42.145,  43.074,   4.148,  ..., -43.222, -56.009, -65.178],
        ...,
        [-40.302, -73.717, 138.254,  ..., -55.775, -82.041, -73.519],
        [-69.683, -33.499, 277.091,  ..., -61.091, -29.779,  55.288],
        [-55.344, -67.781, -40.804,  ..., -51.099, 178.720, 186.789]],
       device='cuda:0')
v tensor([[1.000e+01, 1.000e+01, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [1.000e-12, 1.000e+01, 1.000e-12,  ..., 1.000e+01, 1.000e-12,
         1.000e-12],
        [1.000e+01, 1.000e+01, 4.148e+00,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        ...,
        [1.000e-12, 1.000e-12, 1.000e+01,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [1.000e-12, 1.000e-12, 1.000e+01,  ..., 1.000e-12, 1.000e-12,
         1.000e+01],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e+01,
         1.000e+01]], device='cuda:0')
v before min max tensor([-66.733, -78.654,  60.848, 203.646, -30.585,  31.913, -43.813, 650.219,
         81.650,  34.332, 137.156, -10.970,  22.164, -57.409,  43.402, -23.969,
         60.101, 252.017,  50.533, -65.001,  32.149,  97.683, -25.587,  81.336,
        -35.403, -38.880, -49.304, -67.607,  -1.014,  31.469, -59.312, -54.549,
        -21.350,   5.056, 138.273,  -4.105, -45.314,  -6.392, -17.444,  45.332,
        -64.928, -53.575, 113.945, -41.510, 104.286,  10.698,  -9.518, 514.994,
        -55.085, -58.917, 198.081, -75.605, -55.181,  90.537, -62.313, -75.021,
        -60.385, -38.116,  13.663,   2.454, -72.434, -66.264, -74.141, -59.249,
        -61.034, -71.526, -62.823, -48.424, -25.942, -27.995, -72.570, -52.969,
        -67.877,  36.672, -76.102, -55.883, -21.187, -45.369, -46.116,  34.928,
        -45.483, -14.805,  17.624, 256.955, -67.034,   2.449, -12.174,  30.026,
        -27.068, 160.856, -43.641,  65.154, -76.451, -43.795, -48.299,  19.086,
        -43.304,  11.153, -58.210, -27.094,   5.203, -71.624,  95.621,  30.927,
        168.948,  57.363,  15.525, -29.590, -31.150, -30.980, -34.055, -57.375,
        -31.436,  -7.760, 122.078, 299.043, -55.397,  50.092,  32.817, 113.712,
        455.077, -40.505, -53.084, 123.560, -76.759, -43.882, -17.216, -45.562,
        106.558, -50.463], device='cuda:0')
v tensor([1.000e-12, 1.000e-12, 1.000e+01, 1.000e+01, 1.000e-12, 1.000e+01,
        1.000e-12, 1.000e+01, 1.000e+01, 1.000e+01, 1.000e+01, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e+01, 1.000e+01,
        1.000e+01, 1.000e-12, 1.000e+01, 1.000e+01, 1.000e-12, 1.000e+01,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01,
        1.000e-12, 1.000e-12, 1.000e-12, 5.056e+00, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e+01, 1.000e+01, 1.000e-12, 1.000e+01,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e+01,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 2.454e+00,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e+01,
        1.000e-12, 2.449e+00, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e+01,
        1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01,
        1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 5.203e+00, 1.000e-12,
        1.000e+01, 1.000e+01, 1.000e+01, 1.000e+01, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e+01, 1.000e-12, 1.000e+01, 1.000e+01, 1.000e+01,
        1.000e+01, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12], device='cuda:0')
v before min max tensor([[[-40.038],
         [-23.417],
         [-54.275],
         [220.554],
         [-38.729],
         [193.227],
         [ 30.836],
         [  2.690],
         [-21.009],
         [-69.502]],

        [[-67.272],
         [ 12.916],
         [-22.435],
         [-28.720],
         [  5.846],
         [224.642],
         [-55.492],
         [224.464],
         [-56.586],
         [-54.285]],

        [[-64.556],
         [-51.634],
         [101.391],
         [-29.408],
         [ 62.566],
         [-15.239],
         [ 71.199],
         [-38.212],
         [-31.743],
         [-39.237]],

        [[-68.404],
         [ 64.850],
         [-50.582],
         [ 26.873],
         [247.385],
         [-56.255],
         [ 39.786],
         [261.405],
         [186.543],
         [-62.832]],

        [[-48.225],
         [  8.720],
         [209.833],
         [ -8.695],
         [-69.534],
         [-46.043],
         [-82.942],
         [-38.040],
         [-34.790],
         [-34.632]],

        [[  5.700],
         [ 54.294],
         [155.674],
         [-55.612],
         [-33.353],
         [-57.796],
         [-51.485],
         [-41.031],
         [ 88.297],
         [580.362]],

        [[ 29.770],
         [-49.955],
         [ 22.801],
         [-58.258],
         [-72.133],
         [ 13.139],
         [-54.955],
         [183.584],
         [ 76.495],
         [ 34.016]],

        [[ 79.175],
         [-49.618],
         [ 21.442],
         [177.893],
         [-66.389],
         [ 46.277],
         [-44.378],
         [-35.402],
         [-67.109],
         [-77.907]],

        [[-72.528],
         [ -8.888],
         [-33.687],
         [ -9.246],
         [ 76.252],
         [ 61.538],
         [-67.078],
         [-54.454],
         [-27.332],
         [ 52.029]],

        [[-10.582],
         [306.730],
         [-49.977],
         [-45.997],
         [-51.508],
         [231.228],
         [-42.759],
         [ 19.354],
         [282.945],
         [287.565]],

        [[-59.655],
         [  2.419],
         [ 10.010],
         [  3.996],
         [133.025],
         [ 55.316],
         [  0.772],
         [-74.723],
         [ -4.670],
         [-44.573]],

        [[147.349],
         [-46.151],
         [ 27.986],
         [-71.806],
         [ -9.592],
         [-64.286],
         [ 98.762],
         [-55.905],
         [-51.584],
         [134.466]],

        [[ 57.892],
         [-44.152],
         [-46.083],
         [ 30.858],
         [  5.582],
         [-65.367],
         [ 33.176],
         [-42.103],
         [-38.911],
         [-63.168]]], device='cuda:0')
v tensor([[[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [2.690e+00],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [5.846e+00],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12]],

        [[1.000e-12],
         [8.720e+00],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[5.700e+00],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01]],

        [[1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01]],

        [[1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01]],

        [[1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01]],

        [[1.000e-12],
         [2.419e+00],
         [1.000e+01],
         [3.996e+00],
         [1.000e+01],
         [1.000e+01],
         [7.724e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01]],

        [[1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [5.582e+00],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]]], device='cuda:0')
v before min max tensor([[-40.818],
        [-31.602],
        [-21.582],
        [-79.769],
        [169.831],
        [ 74.007],
        [-46.981],
        [-36.450],
        [-18.913],
        [-60.317],
        [-72.064],
        [-76.369],
        [-15.889]], device='cuda:0')
v tensor([[1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e+01],
        [1.000e+01],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12]], device='cuda:0')
a after update for 1 param tensor([[ 0.038,  0.014,  0.157,  ...,  0.034,  0.080, -0.037],
        [ 0.022,  0.055,  0.050,  ..., -0.024,  0.032,  0.191],
        [-0.017, -0.001,  0.058,  ..., -0.043,  0.130,  0.104],
        ...,
        [ 0.046, -0.083, -0.026,  ..., -0.006, -0.037, -0.052],
        [ 0.042, -0.060, -0.042,  ...,  0.074,  0.075, -0.067],
        [ 0.045,  0.025,  0.026,  ..., -0.082, -0.055,  0.034]],
       device='cuda:0')
s after update for 1 param tensor([[2.135, 1.803, 1.886,  ..., 1.570, 1.315, 1.727],
        [1.663, 1.766, 1.781,  ..., 1.998, 1.470, 1.633],
        [1.379, 1.953, 1.660,  ..., 1.100, 1.676, 1.687],
        ...,
        [1.049, 1.925, 1.826,  ..., 1.474, 2.164, 1.873],
        [1.771, 1.912, 2.454,  ..., 1.594, 1.812, 2.384],
        [1.896, 2.219, 1.315,  ..., 1.682, 1.899, 1.621]], device='cuda:0')
b after update for 1 param tensor([[85.541, 78.598, 80.390,  ..., 73.362, 67.132, 76.930],
        [75.484, 77.787, 78.115,  ..., 82.753, 70.974, 74.819],
        [68.740, 81.818, 75.416,  ..., 61.386, 75.787, 76.034],
        ...,
        [59.953, 81.231, 79.108,  ..., 71.079, 86.110, 80.114],
        [77.912, 80.938, 91.713,  ..., 73.906, 78.810, 90.380],
        [80.618, 87.211, 67.129,  ..., 75.928, 80.664, 74.541]],
       device='cuda:0')
clipping threshold 1.025819853440826
a after update for 1 param tensor([ 0.068, -0.054,  0.040,  0.152, -0.194,  0.064, -0.025, -0.364,  0.106,
        -0.065, -0.122,  0.031,  0.084, -0.110,  0.055,  0.041,  0.056,  0.090,
         0.056,  0.061,  0.033,  0.146,  0.072,  0.029, -0.064,  0.058, -0.056,
         0.205,  0.106, -0.055, -0.067, -0.012, -0.103,  0.044,  0.142,  0.113,
         0.300, -0.101,  0.003, -0.069, -0.105, -0.180, -0.085,  0.084, -0.078,
         0.051, -0.011,  0.031,  0.213, -0.013,  0.027, -0.021,  0.086, -0.034,
         0.044,  0.051,  0.254, -0.063,  0.143, -0.008, -0.071, -0.032,  0.053,
         0.052, -0.153,  0.057, -0.171, -0.037,  0.092,  0.018, -0.128, -0.041,
        -0.086,  0.130,  0.069,  0.042, -0.029, -0.054,  0.282, -0.094, -0.111,
         0.032, -0.006, -0.045,  0.098, -0.094,  0.081, -0.046,  0.196, -0.068,
        -0.065, -0.192, -0.097, -0.201,  0.081,  0.014,  0.089, -0.046,  0.019,
         0.188,  0.227,  0.101,  0.031,  0.065, -0.014,  0.268,  0.134, -0.006,
        -0.230, -0.087, -0.061,  0.087, -0.066, -0.002, -0.101, -0.112, -0.038,
         0.027, -0.170, -0.099,  0.092, -0.177, -0.080,  0.092,  0.234,  0.081,
        -0.130, -0.121, -0.183, -0.058], device='cuda:0')
s after update for 1 param tensor([1.699, 2.000, 2.024, 1.867, 1.125, 1.669, 1.215, 1.623, 2.416, 1.790,
        1.802, 1.374, 1.446, 1.487, 1.624, 1.653, 1.817, 2.149, 1.903, 1.813,
        1.821, 1.568, 1.458, 1.846, 2.297, 1.506, 1.355, 1.718, 1.978, 2.222,
        1.757, 1.629, 1.534, 1.150, 1.889, 1.192, 1.559, 0.933, 1.413, 2.152,
        2.180, 1.535, 1.993, 1.098, 1.856, 1.971, 1.601, 1.997, 1.405, 2.014,
        2.046, 1.992, 1.581, 2.140, 1.754, 1.980, 1.827, 1.772, 2.144, 1.638,
        1.862, 1.745, 2.074, 1.516, 1.619, 2.053, 2.004, 1.578, 1.669, 1.807,
        1.884, 1.662, 1.927, 1.283, 2.006, 1.420, 0.634, 1.177, 1.826, 1.668,
        1.243, 1.329, 2.029, 1.918, 1.767, 1.788, 1.058, 1.608, 1.443, 1.993,
        1.900, 1.535, 2.061, 1.129, 1.512, 2.065, 1.240, 1.744, 1.575, 1.736,
        1.631, 1.839, 1.576, 1.731, 1.577, 1.517, 2.013, 1.969, 1.921, 1.495,
        1.887, 1.893, 1.356, 1.949, 1.827, 2.114, 2.128, 2.109, 2.034, 1.379,
        2.028, 1.252, 1.662, 1.460, 1.948, 1.128, 1.581, 1.663, 1.766, 1.469],
       device='cuda:0')
b after update for 1 param tensor([76.295, 82.791, 83.288, 80.000, 62.084, 75.625, 64.516, 74.590, 90.997,
        78.317, 78.595, 68.612, 70.394, 71.393, 74.595, 75.260, 78.922, 85.813,
        80.752, 78.817, 79.000, 73.296, 70.681, 79.548, 88.715, 71.842, 68.147,
        76.742, 82.328, 87.262, 77.589, 74.718, 72.495, 62.771, 80.459, 63.926,
        73.105, 56.561, 69.585, 85.885, 86.442, 72.524, 82.648, 61.349, 79.757,
        82.182, 74.066, 82.734, 69.381, 83.085, 83.731, 82.634, 73.608, 85.634,
        77.537, 82.376, 79.130, 77.927, 85.710, 74.923, 79.889, 77.335, 84.309,
        72.069, 74.484, 83.870, 82.870, 73.547, 75.636, 78.685, 80.345, 75.467,
        81.263, 66.321, 82.915, 69.771, 46.616, 63.517, 79.101, 75.609, 65.267,
        67.497, 83.394, 81.069, 77.819, 78.271, 60.205, 74.239, 70.334, 82.654,
        80.690, 72.522, 84.053, 62.193, 71.984, 84.120, 65.180, 77.315, 73.480,
        77.137, 74.766, 79.397, 73.487, 77.023, 73.512, 72.094, 83.062, 82.138,
        81.134, 71.587, 80.416, 80.535, 68.163, 81.719, 79.124, 85.125, 85.404,
        85.017, 83.487, 68.752, 83.376, 65.498, 75.480, 70.739, 81.717, 62.171,
        73.612, 75.501, 77.796, 70.961], device='cuda:0')
clipping threshold 1.025819853440826
a after update for 1 param tensor([[[ 0.033],
         [ 0.078],
         [-0.023],
         [ 0.027],
         [-0.063],
         [-0.016],
         [ 0.047],
         [-0.062],
         [ 0.085],
         [ 0.076]],

        [[ 0.050],
         [ 0.135],
         [-0.029],
         [ 0.082],
         [ 0.038],
         [-0.033],
         [ 0.146],
         [ 0.011],
         [-0.040],
         [-0.122]],

        [[ 0.059],
         [-0.136],
         [ 0.003],
         [-0.090],
         [ 0.131],
         [-0.004],
         [ 0.113],
         [ 0.116],
         [ 0.096],
         [ 0.329]],

        [[ 0.111],
         [-0.276],
         [-0.017],
         [ 0.170],
         [ 0.047],
         [ 0.092],
         [ 0.156],
         [-0.125],
         [ 0.105],
         [ 0.128]],

        [[-0.107],
         [ 0.124],
         [-0.070],
         [-0.057],
         [-0.035],
         [ 0.237],
         [-0.245],
         [ 0.067],
         [ 0.041],
         [ 0.114]],

        [[-0.083],
         [-0.029],
         [ 0.022],
         [ 0.110],
         [ 0.029],
         [ 0.013],
         [-0.072],
         [ 0.023],
         [-0.190],
         [ 0.172]],

        [[ 0.110],
         [ 0.082],
         [ 0.139],
         [-0.054],
         [ 0.062],
         [ 0.074],
         [-0.023],
         [ 0.060],
         [-0.015],
         [ 0.141]],

        [[ 0.011],
         [ 0.181],
         [-0.072],
         [-0.137],
         [ 0.016],
         [-0.078],
         [ 0.062],
         [ 0.048],
         [-0.178],
         [ 0.125]],

        [[ 0.196],
         [ 0.065],
         [ 0.060],
         [-0.043],
         [ 0.102],
         [-0.009],
         [-0.027],
         [-0.027],
         [-0.141],
         [ 0.108]],

        [[ 0.031],
         [-0.065],
         [-0.054],
         [-0.021],
         [ 0.102],
         [-0.127],
         [ 0.259],
         [-0.124],
         [-0.054],
         [-0.112]],

        [[-0.135],
         [ 0.126],
         [-0.134],
         [ 0.082],
         [ 0.112],
         [ 0.128],
         [ 0.180],
         [ 0.010],
         [-0.044],
         [ 0.096]],

        [[ 0.101],
         [-0.220],
         [-0.021],
         [ 0.184],
         [ 0.055],
         [ 0.229],
         [-0.120],
         [-0.107],
         [ 0.151],
         [-0.080]],

        [[-0.194],
         [ 0.167],
         [-0.070],
         [ 0.029],
         [ 0.212],
         [-0.184],
         [-0.398],
         [ 0.010],
         [ 0.040],
         [-0.063]]], device='cuda:0')
s after update for 1 param tensor([[[1.363],
         [1.853],
         [1.646],
         [1.784],
         [1.791],
         [1.987],
         [2.037],
         [1.628],
         [1.587],
         [1.781]],

        [[1.743],
         [2.278],
         [1.461],
         [1.511],
         [1.619],
         [2.006],
         [1.409],
         [2.007],
         [1.443],
         [1.682]],

        [[1.639],
         [1.598],
         [1.853],
         [0.746],
         [2.211],
         [1.107],
         [1.701],
         [1.832],
         [1.825],
         [1.773]],

        [[1.793],
         [2.220],
         [1.577],
         [2.030],
         [1.609],
         [1.856],
         [1.742],
         [1.803],
         [2.178],
         [1.676]],

        [[1.386],
         [1.980],
         [1.986],
         [1.154],
         [1.993],
         [1.457],
         [2.239],
         [1.623],
         [1.477],
         [1.421]],

        [[1.905],
         [2.146],
         [2.300],
         [2.096],
         [1.498],
         [1.473],
         [1.718],
         [1.872],
         [1.853],
         [2.206]],

        [[1.837],
         [1.341],
         [1.604],
         [1.483],
         [1.856],
         [1.572],
         [1.604],
         [1.489],
         [1.458],
         [1.378]],

        [[2.043],
         [1.459],
         [1.645],
         [2.029],
         [1.688],
         [1.648],
         [1.961],
         [1.663],
         [1.919],
         [2.007]],

        [[1.846],
         [1.917],
         [2.083],
         [0.950],
         [1.886],
         [1.545],
         [1.712],
         [1.387],
         [1.175],
         [2.204]],

        [[1.618],
         [1.778],
         [1.714],
         [1.634],
         [1.734],
         [1.813],
         [1.910],
         [2.062],
         [1.706],
         [1.878]],

        [[1.851],
         [1.540],
         [1.683],
         [1.819],
         [1.535],
         [1.697],
         [1.668],
         [1.900],
         [1.360],
         [1.300]],

        [[1.837],
         [1.371],
         [1.987],
         [1.827],
         [1.736],
         [1.662],
         [1.595],
         [1.619],
         [1.525],
         [2.098]],

        [[2.194],
         [1.856],
         [1.586],
         [1.729],
         [1.727],
         [1.865],
         [1.991],
         [1.922],
         [1.601],
         [1.604]]], device='cuda:0')
b after update for 1 param tensor([[[68.334],
         [79.685],
         [75.111],
         [78.187],
         [78.344],
         [82.520],
         [83.547],
         [74.705],
         [73.740],
         [78.126]],

        [[77.296],
         [88.352],
         [70.750],
         [71.949],
         [74.485],
         [82.905],
         [69.480],
         [82.935],
         [70.324],
         [75.933]],

        [[74.956],
         [73.992],
         [79.698],
         [50.577],
         [87.038],
         [61.594],
         [76.355],
         [79.230],
         [79.089],
         [77.949]],

        [[78.393],
         [87.222],
         [73.520],
         [83.404],
         [74.254],
         [79.763],
         [77.275],
         [78.605],
         [86.404],
         [75.785]],

        [[68.911],
         [82.379],
         [82.494],
         [62.884],
         [82.648],
         [70.655],
         [87.592],
         [74.572],
         [71.141],
         [69.774]],

        [[80.802],
         [85.765],
         [88.791],
         [84.760],
         [71.650],
         [71.060],
         [76.741],
         [80.102],
         [79.695],
         [86.953]],

        [[79.349],
         [67.790],
         [74.137],
         [71.285],
         [79.761],
         [73.393],
         [74.138],
         [71.439],
         [70.694],
         [68.729]],

        [[83.669],
         [70.704],
         [75.085],
         [83.390],
         [76.065],
         [75.153],
         [81.985],
         [75.483],
         [81.088],
         [82.940]],

        [[79.539],
         [81.047],
         [84.492],
         [57.056],
         [80.395],
         [72.769],
         [76.607],
         [68.953],
         [63.449],
         [86.909]],

        [[74.465],
         [78.066],
         [76.633],
         [74.843],
         [77.099],
         [78.824],
         [80.905],
         [84.071],
         [76.459],
         [80.227]],

        [[79.654],
         [72.637],
         [75.936],
         [78.945],
         [72.531],
         [76.257],
         [75.613],
         [80.702],
         [68.270],
         [66.754]],

        [[79.354],
         [68.541],
         [82.511],
         [79.134],
         [77.133],
         [75.460],
         [73.929],
         [74.483],
         [72.284],
         [84.786]],

        [[86.708],
         [79.755],
         [73.723],
         [76.974],
         [76.928],
         [79.948],
         [82.614],
         [81.164],
         [74.079],
         [74.137]]], device='cuda:0')
clipping threshold 1.025819853440826
a after update for 1 param tensor([[ 0.081],
        [-0.026],
        [ 0.038],
        [-0.050],
        [-0.118],
        [-0.038],
        [ 0.111],
        [ 0.023],
        [-0.029],
        [ 0.156],
        [-0.001],
        [-0.173],
        [-0.144]], device='cuda:0')
s after update for 1 param tensor([[1.142],
        [1.364],
        [1.540],
        [2.149],
        [1.826],
        [2.181],
        [1.390],
        [1.573],
        [1.514],
        [1.533],
        [1.844],
        [1.981],
        [1.475]], device='cuda:0')
b after update for 1 param tensor([[62.568],
        [68.374],
        [72.640],
        [85.821],
        [79.113],
        [86.456],
        [69.025],
        [73.421],
        [72.039],
        [72.490],
        [79.499],
        [82.400],
        [71.095]], device='cuda:0')
clipping threshold 1.025819853440826
cuda
Objective function 15.18 = squared loss an data 9.73 + 0.5*rho*h**2 2.166910 + alpha*h 1.435533 + L2reg 1.71 + L1reg 0.14 ; SHD = 55 ; DAG False
Proportion of microbatches that were clipped  0.7736167476996022
iteration 2 in inner loop, alpha 2.180608915323271 rho 10.0 h 0.658317603367264
1963
cuda
Objective function 34.69 = squared loss an data 9.73 + 0.5*rho*h**2 21.669103 + alpha*h 1.435533 + L2reg 1.71 + L1reg 0.14 ; SHD = 55 ; DAG False
||w||^2 6.176727287185431
exp ma of ||w||^2 364406.79649679863
||w|| 2.4853022526818402
exp ma of ||w|| 2.774192018777789
||w||^2 5.725592379952322
exp ma of ||w||^2 5628.685210094169
||w|| 2.3928210087577217
exp ma of ||w|| 1.6009105658076652
||w||^2 2.575343374388952
exp ma of ||w||^2 3.105021513143756
||w|| 1.6047876415242461
exp ma of ||w|| 1.6741937646087806
||w||^2 4.292704343382334
exp ma of ||w||^2 2.7278250943739586
||w|| 2.071884249513552
exp ma of ||w|| 1.5747147212726451
||w||^2 1.8238827022919382
exp ma of ||w||^2 3.0542063920026585
||w|| 1.3505120148639693
exp ma of ||w|| 1.6586576132286461
||w||^2 1.7232669839430388
exp ma of ||w||^2 3.08456889660957
||w|| 1.3127326399320765
exp ma of ||w|| 1.6656475503419277
||w||^2 3.6012871439544596
exp ma of ||w||^2 3.128783077951291
||w|| 1.8977057580021355
exp ma of ||w|| 1.6848133287125735
||w||^2 3.722687093281991
exp ma of ||w||^2 3.2928021224138573
||w|| 1.9294266229328316
exp ma of ||w|| 1.7325300412986344
||w||^2 4.461676904284538
exp ma of ||w||^2 3.0196107156296654
||w|| 2.112268189478916
exp ma of ||w|| 1.6649025313391743
||w||^2 2.8982336465688667
exp ma of ||w||^2 3.2710173426482085
||w|| 1.702419938372688
exp ma of ||w|| 1.7310014546361117
||w||^2 1.7511130082766029
exp ma of ||w||^2 3.0104747800256972
||w|| 1.3232962662520449
exp ma of ||w|| 1.6382460826193943
||w||^2 3.018857728488946
exp ma of ||w||^2 2.8756147763150754
||w|| 1.7374860369191305
exp ma of ||w|| 1.614818634961595
||w||^2 2.4100616274071105
exp ma of ||w||^2 2.8238339037813205
||w|| 1.5524373183504416
exp ma of ||w|| 1.6113079615955423
||w||^2 1.7561776544487895
exp ma of ||w||^2 2.7323023023294555
||w|| 1.3252085324388723
exp ma of ||w|| 1.5825430474940607
||w||^2 2.679450383503581
exp ma of ||w||^2 2.9526338988898306
||w|| 1.6369026799121507
exp ma of ||w|| 1.645458534053072
||w||^2 4.419649988833208
exp ma of ||w||^2 2.9865188449512328
||w|| 2.102296360847635
exp ma of ||w|| 1.6560666896482545
||w||^2 4.26302592185139
exp ma of ||w||^2 3.271532064130626
||w|| 2.064709645894887
exp ma of ||w|| 1.7332895420604044
||w||^2 4.186991782086749
exp ma of ||w||^2 3.3859092902376897
||w|| 2.046214011800024
exp ma of ||w|| 1.751918243788001
||w||^2 2.2432919695182707
exp ma of ||w||^2 3.2592417590579124
||w|| 1.4977623207699782
exp ma of ||w|| 1.7154501741326489
||w||^2 1.7453578601933544
exp ma of ||w||^2 2.981871434538238
||w|| 1.3211199264992388
exp ma of ||w|| 1.6532433415195085
||w||^2 6.436865385528967
exp ma of ||w||^2 3.0071331074383054
||w|| 2.5370978273470195
exp ma of ||w|| 1.6509769215639956
||w||^2 2.2670696632360348
exp ma of ||w||^2 3.0709621233204203
||w|| 1.5056791368801106
exp ma of ||w|| 1.6693159042480243
||w||^2 3.0222910302679526
exp ma of ||w||^2 3.3261030793481225
||w|| 1.7384737646188257
exp ma of ||w|| 1.7209362282485743
||w||^2 1.1802339704819778
exp ma of ||w||^2 3.033337757235005
||w|| 1.086385737425698
exp ma of ||w|| 1.6501774935697289
v before min max tensor([[ 158.294,   58.259,   81.819,  ..., -119.664,  -39.959,  -44.940],
        [   8.299,  -60.213,  -35.899,  ...,  265.812,  -60.591,  127.987],
        [   2.397,  -73.877,   74.004,  ...,  -95.918, 1107.869,  278.283],
        ...,
        [  66.892,   49.531,  -66.041,  ...,  -92.596,  -42.854,  156.841],
        [-126.569, -102.472,  172.171,  ..., -116.966,  -93.710,  -33.217],
        [ -97.979,  251.449, -122.092,  ...,  -13.531,  -66.524,  -94.622]],
       device='cuda:0')
v tensor([[1.000e+01, 1.000e+01, 1.000e+01,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [8.299e+00, 1.000e-12, 1.000e-12,  ..., 1.000e+01, 1.000e-12,
         1.000e+01],
        [2.397e+00, 1.000e-12, 1.000e+01,  ..., 1.000e-12, 1.000e+01,
         1.000e+01],
        ...,
        [1.000e+01, 1.000e+01, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e+01],
        [1.000e-12, 1.000e-12, 1.000e+01,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [1.000e-12, 1.000e+01, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12]], device='cuda:0')
v before min max tensor([-114.415,  -33.107,  -62.531,  -44.972,  -60.312,  -92.512,  -74.862,
          28.669,  -67.657,  -80.317,  -87.347,  717.550,  -36.811,  -28.564,
         -81.772,  -86.872,  363.326,  597.455, -100.740,  -76.913,  -62.993,
          -4.856,  133.189, -104.905, -102.232,  -98.658,  -80.874, -146.365,
         -48.866,  -39.534,   47.066,  199.189, -103.446,  -41.904,  -98.826,
         -71.894, -114.466,  260.834,  -50.560,  -51.057,  202.642, -108.438,
         348.420,  -28.793,  -44.974,   66.091,  -96.694,  -51.652,  -54.935,
         -75.461,  -70.788,  492.266,  -97.954,  -40.738, -125.434,  353.358,
         -89.674,  -37.908, -117.330,  -66.090,  -56.788,  -71.600,  109.457,
         107.162,  323.648,  -87.236, -115.453,  -86.807,  312.509,  -31.147,
           5.145,  -32.570, -100.322,  -59.684,  -53.286,  -44.978,  -24.101,
        -102.035,  -99.498,  -87.372, -100.103,    1.742,  129.555,  -33.914,
          74.837,   74.322,   82.884,   73.632,   53.420,  -32.802,  -88.157,
         -67.178,  -96.146,  517.297, -100.742,   26.906,   17.375,   34.222,
         -71.411, -107.296,  350.043,  -84.146,  -69.736,    7.208,   27.457,
         -35.396,    7.557,  -79.261,   51.313,   60.897,  -38.113,  -43.718,
         -50.379,  -72.188,  175.866,  -81.214,   11.352,   38.400,  -64.882,
         -84.571,  -88.526,  849.855,  -92.427,  -64.876,  178.960,  -79.168,
         -91.024,  -20.126,   48.919,  -71.775], device='cuda:0')
v tensor([1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e+01,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e+01, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 5.145e+00, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.742e+00, 1.000e+01, 1.000e-12,
        1.000e+01, 1.000e+01, 1.000e+01, 1.000e+01, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e+01,
        1.000e+01, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e-12, 7.208e+00, 1.000e+01, 1.000e-12, 7.557e+00, 1.000e-12,
        1.000e+01, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e+01, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12], device='cuda:0')
v before min max tensor([[[ 2.887e+01],
         [-9.538e+01],
         [-1.140e+02],
         [ 2.459e+01],
         [-5.942e+01],
         [-5.082e+01],
         [-1.038e+02],
         [-3.778e+01],
         [ 4.512e+02],
         [-8.688e+01]],

        [[-6.512e+01],
         [-3.120e+01],
         [-1.283e+02],
         [-5.897e+01],
         [ 5.320e+01],
         [-1.176e+02],
         [-5.964e+01],
         [ 5.047e+01],
         [-6.203e+01],
         [-9.317e+01]],

        [[ 1.212e+02],
         [-5.754e+01],
         [ 7.737e+01],
         [-1.339e+02],
         [-3.586e-01],
         [-8.053e+01],
         [ 5.545e+00],
         [-9.609e+01],
         [-6.053e+01],
         [-3.582e+01]],

        [[-9.122e+01],
         [-1.043e+02],
         [-7.235e+01],
         [ 1.377e+01],
         [-9.050e+01],
         [-8.525e+01],
         [ 5.157e+01],
         [ 3.763e+02],
         [-1.098e+02],
         [-9.036e+01]],

        [[-4.465e+01],
         [ 1.669e+02],
         [ 5.330e+01],
         [ 2.208e+02],
         [ 1.625e+02],
         [ 9.151e+01],
         [ 3.338e+01],
         [-7.922e+01],
         [-1.220e+02],
         [-8.431e+01]],

        [[-8.227e+01],
         [-7.956e+01],
         [-2.753e+00],
         [-1.191e+02],
         [ 2.001e+01],
         [-1.158e+01],
         [ 7.804e+01],
         [-1.014e+02],
         [-8.299e+01],
         [-7.384e+00]],

        [[ 1.381e+02],
         [-7.445e+01],
         [ 1.384e+02],
         [-1.809e+01],
         [-8.958e+01],
         [ 1.214e+02],
         [-9.988e+01],
         [-4.606e+01],
         [-5.771e+01],
         [-1.079e+02]],

        [[-8.678e+01],
         [-1.057e+02],
         [ 3.423e+01],
         [-5.397e+01],
         [ 2.385e+02],
         [-8.141e+01],
         [-8.212e+01],
         [-7.859e+01],
         [-6.705e+01],
         [ 2.197e+02]],

        [[-8.501e+01],
         [-7.771e+01],
         [ 1.936e+02],
         [-1.078e+02],
         [-8.004e+01],
         [-1.115e+02],
         [-7.183e+01],
         [-1.155e+02],
         [-5.833e+01],
         [ 7.374e+01]],

        [[ 7.017e+01],
         [-3.234e+01],
         [-8.398e+01],
         [-5.870e+01],
         [-1.174e+02],
         [-6.697e+01],
         [-7.106e+01],
         [ 2.874e+01],
         [-3.806e+01],
         [-3.295e+01]],

        [[-1.347e+02],
         [-1.147e+02],
         [-7.783e+01],
         [ 5.171e+01],
         [ 8.252e+01],
         [-9.006e+01],
         [-8.858e+01],
         [-8.871e+01],
         [-1.007e+02],
         [-8.158e+01]],

        [[-8.023e+01],
         [-8.757e+01],
         [-6.201e+01],
         [-1.018e+02],
         [-7.568e+01],
         [-7.163e+01],
         [ 1.139e+02],
         [-9.432e+01],
         [-1.036e+02],
         [-6.944e+01]],

        [[ 2.655e+02],
         [-4.835e+00],
         [-1.201e+02],
         [-1.042e+02],
         [ 1.375e+01],
         [-7.292e+01],
         [-5.670e+01],
         [-7.976e+01],
         [-4.184e+01],
         [-9.031e+01]]], device='cuda:0')
v tensor([[[1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [5.545e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01]],

        [[1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]]], device='cuda:0')
v before min max tensor([[-115.133],
        [ -61.468],
        [ 151.393],
        [  33.883],
        [-103.429],
        [ -89.695],
        [-136.140],
        [  -0.855],
        [ -72.518],
        [ -57.772],
        [-109.583],
        [ -46.284],
        [ 173.558]], device='cuda:0')
v tensor([[1.000e-12],
        [1.000e-12],
        [1.000e+01],
        [1.000e+01],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e+01]], device='cuda:0')
a after update for 1 param tensor([[ 0.059, -0.140, -0.015,  ..., -0.011,  0.047,  0.081],
        [-0.046, -0.057, -0.133,  ..., -0.017,  0.033,  0.167],
        [ 0.052, -0.060,  0.088,  ..., -0.047,  0.157,  0.021],
        ...,
        [-0.048, -0.019,  0.056,  ...,  0.063, -0.011,  0.060],
        [-0.005, -0.028, -0.059,  ...,  0.146,  0.001, -0.048],
        [-0.048,  0.059,  0.144,  ..., -0.031,  0.026,  0.080]],
       device='cuda:0')
s after update for 1 param tensor([[1.849, 2.391, 1.941,  ..., 1.815, 0.954, 1.455],
        [1.550, 1.542, 1.763,  ..., 1.511, 1.255, 2.188],
        [2.138, 2.121, 1.727,  ..., 1.516, 2.044, 2.136],
        ...,
        [2.369, 1.999, 1.032,  ..., 1.553, 1.546, 1.878],
        [2.118, 1.780, 1.957,  ..., 1.873, 1.532, 1.319],
        [1.477, 1.884, 1.879,  ..., 1.482, 1.054, 1.938]], device='cuda:0')
b after update for 1 param tensor([[78.500, 89.254, 80.432,  ..., 77.770, 56.393, 69.634],
        [71.877, 71.679, 76.654,  ..., 70.957, 64.669, 85.397],
        [84.407, 84.075, 75.856,  ..., 71.078, 82.535, 84.366],
        ...,
        [88.842, 81.610, 58.637,  ..., 71.949, 71.780, 79.110],
        [84.019, 77.006, 80.755,  ..., 78.993, 71.452, 66.308],
        [70.148, 79.229, 79.128,  ..., 70.270, 59.256, 80.364]],
       device='cuda:0')
clipping threshold 1.347113129040854
a after update for 1 param tensor([ 0.341, -0.043,  0.009, -0.190,  0.004, -0.095, -0.044,  0.360, -0.110,
        -0.129, -0.015, -0.119, -0.243,  0.023,  0.028, -0.071,  0.186,  0.022,
        -0.217,  0.126,  0.095, -0.213,  0.006,  0.140,  0.031,  0.048, -0.021,
        -0.175, -0.046, -0.086, -0.076,  0.015,  0.043,  0.090, -0.032, -0.081,
         0.098,  0.158,  0.094,  0.022,  0.116,  0.243, -0.219,  0.183,  0.047,
         0.016,  0.249, -0.054,  0.125, -0.293,  0.050, -0.154,  0.128, -0.040,
         0.127, -0.062,  0.010,  0.031, -0.408, -0.023,  0.106,  0.124, -0.249,
        -0.059, -0.015,  0.147, -0.100, -0.291,  0.122, -0.002,  0.123,  0.020,
         0.128, -0.119, -0.201,  0.093, -0.115, -0.123, -0.109,  0.066, -0.048,
         0.222, -0.009, -0.045,  0.109,  0.015,  0.028,  0.004,  0.020, -0.061,
         0.120,  0.028, -0.043, -0.289, -0.090, -0.047,  0.136,  0.015, -0.012,
        -0.081,  0.233,  0.010, -0.073, -0.123, -0.109, -0.065,  0.068,  0.107,
         0.145,  0.026,  0.056, -0.101,  0.042, -0.222, -0.164,  0.215, -0.023,
        -0.130, -0.002, -0.213,  0.192,  0.099,  0.235, -0.151,  0.162, -0.030,
        -0.008, -0.005, -0.204, -0.223], device='cuda:0')
s after update for 1 param tensor([1.822, 1.697, 1.614, 1.749, 1.828, 1.629, 1.708, 2.130, 1.658, 1.800,
        1.446, 2.287, 1.474, 1.109, 1.393, 1.436, 1.637, 2.189, 1.553, 1.302,
        1.054, 1.468, 2.167, 1.590, 1.549, 1.620, 1.234, 2.205, 1.442, 1.572,
        1.707, 1.978, 1.883, 1.465, 1.860, 1.724, 1.885, 1.729, 1.722, 1.791,
        1.518, 1.641, 2.212, 1.771, 1.129, 1.796, 1.769, 1.685, 2.105, 1.452,
        1.089, 1.961, 1.604, 1.773, 2.173, 1.835, 1.504, 1.886, 1.804, 1.114,
        1.614, 1.394, 2.079, 2.055, 1.725, 1.368, 2.063, 1.621, 1.850, 1.367,
        1.824, 1.513, 1.585, 1.490, 0.849, 1.396, 2.093, 1.671, 1.668, 1.461,
        1.801, 1.903, 1.777, 1.358, 1.743, 1.399, 2.057, 1.358, 2.036, 1.097,
        1.341, 1.458, 1.632, 1.937, 1.575, 1.706, 1.969, 1.876, 1.230, 1.617,
        1.698, 1.708, 1.051, 1.392, 1.583, 2.159, 2.018, 1.207, 2.140, 1.349,
        1.350, 1.404, 1.434, 1.324, 1.411, 1.684, 1.722, 1.749, 1.763, 2.202,
        1.548, 1.862, 1.394, 1.015, 1.835, 1.623, 1.885, 1.545, 2.333, 1.171],
       device='cuda:0')
b after update for 1 param tensor([77.919, 75.192, 73.347, 76.338, 78.058, 73.687, 75.448, 84.252, 74.320,
        77.455, 69.425, 87.294, 70.088, 60.783, 68.129, 69.170, 73.857, 85.399,
        71.933, 65.857, 59.259, 69.931, 84.986, 72.782, 71.837, 73.485, 64.135,
        85.722, 69.316, 72.380, 75.419, 81.183, 79.215, 69.861, 78.728, 75.786,
        79.259, 75.902, 75.757, 77.247, 71.114, 73.941, 85.856, 76.825, 61.347,
        77.352, 76.788, 74.939, 83.759, 69.551, 60.227, 80.846, 73.112, 76.864,
        85.091, 78.193, 70.787, 79.282, 77.533, 60.932, 73.343, 68.157, 83.244,
        82.753, 75.818, 67.507, 82.908, 73.495, 78.526, 67.497, 77.958, 71.010,
        72.674, 70.461, 53.182, 68.200, 83.523, 74.626, 74.553, 69.783, 77.476,
        79.628, 76.948, 67.280, 76.218, 68.272, 82.802, 67.278, 82.368, 60.472,
        66.849, 69.704, 73.737, 80.339, 72.458, 75.408, 80.999, 79.071, 64.030,
        73.401, 75.214, 75.434, 59.183, 68.103, 72.633, 84.814, 82.009, 63.416,
        84.453, 67.054, 67.072, 68.390, 69.133, 66.428, 68.570, 74.905, 75.755,
        76.348, 76.643, 85.662, 71.814, 78.762, 68.161, 58.147, 78.203, 73.550,
        79.266, 71.744, 88.167, 62.471], device='cuda:0')
clipping threshold 1.347113129040854
a after update for 1 param tensor([[[ 0.293],
         [ 0.011],
         [ 0.016],
         [-0.083],
         [ 0.022],
         [-0.088],
         [ 0.099],
         [ 0.155],
         [ 0.085],
         [-0.192]],

        [[ 0.106],
         [-0.081],
         [ 0.149],
         [ 0.171],
         [-0.144],
         [ 0.222],
         [-0.345],
         [ 0.055],
         [-0.125],
         [-0.187]],

        [[-0.138],
         [-0.051],
         [-0.085],
         [-0.100],
         [-0.042],
         [-0.155],
         [ 0.085],
         [ 0.040],
         [-0.277],
         [ 0.049]],

        [[ 0.076],
         [ 0.241],
         [ 0.071],
         [ 0.140],
         [-0.093],
         [ 0.059],
         [ 0.267],
         [ 0.014],
         [ 0.013],
         [ 0.188]],

        [[ 0.096],
         [ 0.100],
         [-0.200],
         [-0.078],
         [ 0.121],
         [ 0.348],
         [-0.018],
         [-0.287],
         [ 0.092],
         [ 0.089]],

        [[ 0.103],
         [-0.352],
         [ 0.011],
         [-0.145],
         [ 0.051],
         [-0.107],
         [ 0.158],
         [-0.248],
         [ 0.045],
         [-0.020]],

        [[-0.048],
         [ 0.103],
         [-0.100],
         [ 0.136],
         [ 0.132],
         [-0.251],
         [ 0.009],
         [ 0.157],
         [ 0.032],
         [-0.080]],

        [[ 0.033],
         [ 0.369],
         [-0.144],
         [ 0.155],
         [-0.021],
         [-0.065],
         [ 0.026],
         [-0.296],
         [-0.198],
         [-0.074]],

        [[ 0.007],
         [ 0.032],
         [-0.240],
         [ 0.060],
         [-0.095],
         [-0.181],
         [ 0.223],
         [-0.028],
         [ 0.050],
         [-0.080]],

        [[-0.223],
         [-0.162],
         [-0.125],
         [ 0.116],
         [ 0.079],
         [-0.196],
         [ 0.287],
         [-0.044],
         [ 0.069],
         [ 0.055]],

        [[ 0.429],
         [ 0.012],
         [ 0.118],
         [-0.075],
         [-0.005],
         [ 0.122],
         [-0.064],
         [ 0.048],
         [-0.108],
         [-0.005]],

        [[-0.094],
         [ 0.036],
         [ 0.037],
         [-0.050],
         [-0.298],
         [-0.125],
         [ 0.026],
         [-0.028],
         [-0.074],
         [ 0.153]],

        [[-0.228],
         [ 0.190],
         [ 0.020],
         [-0.335],
         [ 0.039],
         [ 0.009],
         [ 0.092],
         [-0.138],
         [-0.115],
         [ 0.074]]], device='cuda:0')
s after update for 1 param tensor([[[1.812],
         [1.798],
         [1.744],
         [1.914],
         [0.912],
         [1.999],
         [1.697],
         [0.576],
         [1.863],
         [1.770]],

        [[1.524],
         [1.758],
         [1.954],
         [1.421],
         [1.545],
         [1.859],
         [1.626],
         [1.903],
         [1.537],
         [1.405]],

        [[2.080],
         [1.616],
         [1.987],
         [2.216],
         [1.549],
         [1.227],
         [2.038],
         [1.534],
         [1.718],
         [1.537]],

        [[1.615],
         [1.661],
         [1.455],
         [1.358],
         [1.682],
         [1.525],
         [1.650],
         [2.169],
         [2.014],
         [1.606]],

        [[1.049],
         [1.586],
         [1.823],
         [1.963],
         [2.098],
         [1.513],
         [2.203],
         [1.705],
         [1.905],
         [1.654]],

        [[1.345],
         [1.487],
         [1.361],
         [1.816],
         [1.951],
         [1.135],
         [1.814],
         [1.679],
         [1.674],
         [1.925]],

        [[1.918],
         [1.495],
         [2.116],
         [1.465],
         [1.619],
         [1.727],
         [1.511],
         [1.992],
         [1.667],
         [1.688]],

        [[1.315],
         [1.617],
         [1.376],
         [1.379],
         [1.837],
         [1.423],
         [1.855],
         [1.923],
         [1.601],
         [1.844]],

        [[1.303],
         [1.924],
         [1.368],
         [1.629],
         [1.558],
         [1.680],
         [1.228],
         [1.740],
         [1.472],
         [1.827]],

        [[1.983],
         [1.507],
         [1.607],
         [1.674],
         [1.783],
         [1.583],
         [1.918],
         [1.398],
         [1.821],
         [1.818]],

        [[2.127],
         [1.731],
         [1.179],
         [1.631],
         [1.835],
         [1.770],
         [1.345],
         [1.366],
         [1.718],
         [1.340]],

        [[1.718],
         [1.445],
         [0.939],
         [1.568],
         [1.242],
         [2.055],
         [2.411],
         [1.421],
         [1.671],
         [1.418]],

        [[1.932],
         [1.701],
         [1.863],
         [1.600],
         [1.741],
         [1.107],
         [1.222],
         [1.203],
         [0.744],
         [1.363]]], device='cuda:0')
b after update for 1 param tensor([[[77.700],
         [77.399],
         [76.242],
         [79.867],
         [55.136],
         [81.616],
         [75.191],
         [43.798],
         [78.798],
         [76.806]],

        [[71.258],
         [76.534],
         [80.685],
         [68.825],
         [71.763],
         [78.714],
         [73.616],
         [79.639],
         [71.568],
         [68.436]],

        [[83.257],
         [73.388],
         [81.377],
         [85.943],
         [71.850],
         [63.945],
         [82.419],
         [71.494],
         [75.654],
         [71.559]],

        [[73.371],
         [74.389],
         [69.643],
         [67.268],
         [74.857],
         [71.296],
         [74.141],
         [85.011],
         [81.915],
         [73.147]],

        [[59.118],
         [72.697],
         [77.932],
         [80.878],
         [83.605],
         [71.005],
         [85.685],
         [75.386],
         [79.668],
         [74.246]],

        [[66.960],
         [70.385],
         [67.343],
         [77.796],
         [80.641],
         [61.504],
         [77.739],
         [74.810],
         [74.678],
         [80.101]],

        [[79.953],
         [70.576],
         [83.966],
         [69.863],
         [73.443],
         [75.854],
         [70.963],
         [81.466],
         [74.526],
         [75.004]],

        [[66.206],
         [73.414],
         [67.725],
         [67.789],
         [78.238],
         [68.850],
         [78.614],
         [80.061],
         [73.041],
         [78.395]],

        [[65.900],
         [80.078],
         [67.527],
         [73.675],
         [72.044],
         [74.819],
         [63.968],
         [76.153],
         [70.048],
         [78.018]],

        [[81.281],
         [70.870],
         [73.168],
         [74.684],
         [77.088],
         [72.631],
         [79.955],
         [68.249],
         [77.899],
         [77.825]],

        [[84.187],
         [75.947],
         [62.686],
         [73.724],
         [78.202],
         [76.807],
         [66.960],
         [67.466],
         [75.659],
         [66.826]],

        [[75.665],
         [69.382],
         [55.931],
         [72.280],
         [64.335],
         [82.762],
         [89.640],
         [68.824],
         [74.627],
         [68.733]],

        [[80.229],
         [75.286],
         [78.799],
         [73.019],
         [76.174],
         [60.736],
         [63.819],
         [63.311],
         [49.802],
         [67.399]]], device='cuda:0')
clipping threshold 1.347113129040854
a after update for 1 param tensor([[-0.018],
        [ 0.300],
        [-0.114],
        [ 0.231],
        [-0.112],
        [-0.350],
        [-0.058],
        [ 0.059],
        [-0.147],
        [-0.196],
        [ 0.072],
        [-0.064],
        [-0.289]], device='cuda:0')
s after update for 1 param tensor([[1.814],
        [2.199],
        [1.905],
        [1.631],
        [1.789],
        [1.558],
        [2.056],
        [1.340],
        [1.094],
        [1.581],
        [1.662],
        [1.706],
        [1.761]], device='cuda:0')
b after update for 1 param tensor([[77.748],
        [85.603],
        [79.683],
        [73.732],
        [77.213],
        [72.052],
        [82.777],
        [66.832],
        [60.377],
        [72.573],
        [74.415],
        [75.392],
        [76.607]], device='cuda:0')
clipping threshold 1.347113129040854
||w||^2 2.343062091469764
exp ma of ||w||^2 2.693287025775862
||w|| 1.5307064027663058
exp ma of ||w|| 1.562699550474013
cuda
Objective function 18.04 = squared loss an data 12.77 + 0.5*rho*h**2 2.727838 + alpha*h 0.509333 + L2reg 1.89 + L1reg 0.14 ; SHD = 49 ; DAG True
Proportion of microbatches that were clipped  0.7757267558260591
iteration 3 in inner loop, alpha 2.180608915323271 rho 100.0 h 0.23357389408022478
iteration 2 in outer loop, alpha = 25.537998323345747, rho = 100.0, h = 0.23357389408022478
cuda
1963
cuda
Objective function 23.50 = squared loss an data 12.77 + 0.5*rho*h**2 2.727838 + alpha*h 5.965010 + L2reg 1.89 + L1reg 0.14 ; SHD = 49 ; DAG True
||w||^2 0.6934984107377775
exp ma of ||w||^2 13172797.259653592
||w|| 0.8327655196619139
exp ma of ||w|| 33.62408636024911
||w||^2 1.735723838890474
exp ma of ||w||^2 163029.75134317065
||w|| 1.3174687240653853
exp ma of ||w|| 2.142199580152413
||w||^2 4.409933467372849
exp ma of ||w||^2 3581.466713111481
||w|| 2.0999841588385495
exp ma of ||w|| 1.7998135637881894
||w||^2 7.030293091136743
exp ma of ||w||^2 4.28402259609563
||w|| 2.6514699868444187
exp ma of ||w|| 1.796604071323408
||w||^2 3.3689409269153754
exp ma of ||w||^2 3.320346867144815
||w|| 1.8354674954668566
exp ma of ||w|| 1.7340598973113364
||w||^2 1.766213502511854
exp ma of ||w||^2 3.4823112902113955
||w|| 1.3289896547798459
exp ma of ||w|| 1.7757648226473965
||w||^2 7.864938268923614
exp ma of ||w||^2 3.09717818540716
||w|| 2.8044497265816006
exp ma of ||w|| 1.6720183636815065
v before min max tensor([[  26.107,  373.599,  -89.262,  ...,  -78.300,    2.598,   -8.044],
        [ -79.594,  -22.767,   16.509,  ...,  -20.906, -120.861, -113.894],
        [-108.448, -103.957,   -1.925,  ...,  -23.708,  -91.198,  745.447],
        ...,
        [ -68.832, -118.656,   58.011,  ..., -125.730, -124.224,    5.242],
        [ -43.608,  -81.710,  360.166,  ...,  -77.344,  -64.280, -111.402],
        [ 319.122,  -50.550, -132.796,  ...,  -49.963,   65.262,   27.387]],
       device='cuda:0')
v tensor([[1.000e+01, 1.000e+01, 1.000e-12,  ..., 1.000e-12, 2.598e+00,
         1.000e-12],
        [1.000e-12, 1.000e-12, 1.000e+01,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e+01],
        ...,
        [1.000e-12, 1.000e-12, 1.000e+01,  ..., 1.000e-12, 1.000e-12,
         5.242e+00],
        [1.000e-12, 1.000e-12, 1.000e+01,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [1.000e+01, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e+01,
         1.000e+01]], device='cuda:0')
v before min max tensor([  -1.997, -102.588,    1.829,   83.870,  -74.935,  -75.444,  -48.027,
          -7.817,  -89.889,  -71.617,  110.243,  -73.985,  -50.082,  -91.653,
          -3.423,  -56.979, -117.238,   42.599,  -16.084,  -37.577,  -65.177,
          73.748,  -70.016,  277.844,  -65.409,   -1.330,  256.842,   -9.638,
         -17.699,  -78.523,    9.609,  -83.001,  122.827,   -9.770,  -64.703,
         -77.843,  252.147,  196.287,   47.431,  -94.864,  462.791,   39.072,
          65.978, -119.785,  476.935,  -93.835,  -39.868,  -85.974, -100.232,
         -93.534,  -39.277,  349.695,  -98.681,   85.024,   60.013, -111.750,
         -96.717,  469.718, -149.884,  -78.704,   45.638,  -96.865, -129.850,
          15.910,  -69.156,  -81.779,  -77.011,  426.155,   43.894,  -82.804,
         -79.206,  -12.026, -117.293,  294.064,   48.599,  321.832, -103.662,
         -96.464, -107.449,   10.900, -117.708,   15.436,  -25.984,  -46.170,
         453.828,  480.616, -110.167,  -14.837,  -69.172,  173.263,  -44.325,
        -104.863,  -94.491,  -22.767, -107.349, -120.410,   61.984,  -66.733,
         -78.266,   94.768,  -70.440, -128.391,  -94.545,  -68.403,  -33.096,
          81.367,  -77.967,   -9.165,   73.705,   15.160,  -94.682,   48.430,
         -92.741, -146.418,  224.460,  -25.326,  -46.654,  -60.679,  -16.574,
         558.272,  180.163,  127.622,  -39.202,   32.007, -118.390,  -43.608,
         -58.381, -100.519,   26.715,  115.337], device='cuda:0')
v tensor([1.000e-12, 1.000e-12, 1.829e+00, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e+01,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12,
        9.609e+00, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e+01, 1.000e+01, 1.000e-12, 1.000e+01, 1.000e+01,
        1.000e+01, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e+01,
        1.000e+01, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e+01, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e+01, 1.000e+01, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e+01, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e+01, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01,
        1.000e+01, 1.000e+01, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e+01], device='cuda:0')
v before min max tensor([[[-1.843e+01],
         [ 5.364e+02],
         [-8.366e+01],
         [-4.217e+01],
         [ 6.055e+01],
         [ 2.104e+01],
         [ 3.596e+01],
         [ 6.410e+01],
         [-4.766e+01],
         [-8.428e+01]],

        [[-1.009e+02],
         [-7.638e+01],
         [-6.334e+01],
         [-9.291e+01],
         [-9.049e+01],
         [ 9.642e+01],
         [ 1.705e+02],
         [-8.907e+01],
         [-5.335e+01],
         [-1.094e+02]],

        [[-3.917e+01],
         [-7.398e+01],
         [-6.114e+01],
         [-1.088e+02],
         [-1.708e+01],
         [-7.518e+01],
         [-6.049e+01],
         [ 2.982e+02],
         [ 3.848e+01],
         [-1.004e+02]],

        [[-8.273e+01],
         [-9.238e+01],
         [-7.395e+01],
         [-7.917e+01],
         [-5.407e+01],
         [-1.027e+02],
         [ 2.849e+02],
         [-6.695e+01],
         [-8.408e+01],
         [ 9.127e+00]],

        [[ 4.469e+02],
         [-4.606e+01],
         [-9.806e+01],
         [ 7.245e+00],
         [-5.361e+01],
         [-3.245e+01],
         [-5.173e+01],
         [-1.007e+02],
         [-8.237e+01],
         [-4.038e+01]],

        [[ 7.552e+01],
         [-7.895e+01],
         [-4.041e+01],
         [-1.003e+02],
         [ 1.119e+02],
         [-8.511e+00],
         [-1.257e+02],
         [-9.551e+01],
         [ 1.906e-01],
         [-9.268e+01]],

        [[ 1.461e+01],
         [-1.127e+02],
         [-1.169e+02],
         [-1.112e+02],
         [-1.070e+02],
         [-3.325e+01],
         [ 1.891e+02],
         [-6.956e+01],
         [-7.234e+01],
         [ 7.977e+01]],

        [[-9.882e+01],
         [ 4.092e+02],
         [-6.838e+01],
         [-1.145e+02],
         [-6.687e+01],
         [ 1.959e+02],
         [ 1.747e+01],
         [-1.759e+01],
         [-9.669e+01],
         [-5.786e+01]],

        [[-1.246e+02],
         [-9.285e+01],
         [-3.788e+01],
         [-9.494e+01],
         [-1.003e+02],
         [-2.926e+01],
         [-5.704e+01],
         [-8.012e+01],
         [ 9.799e+00],
         [ 5.973e+01]],

        [[-3.676e+01],
         [ 4.537e+01],
         [-7.887e+01],
         [-4.368e+01],
         [ 5.047e+02],
         [-9.265e+01],
         [-8.143e+01],
         [ 6.655e+02],
         [-4.531e+01],
         [ 2.753e+01]],

        [[-8.876e+01],
         [ 3.692e+02],
         [-3.962e+01],
         [-6.413e+01],
         [-1.080e+02],
         [-7.375e+01],
         [-1.287e+02],
         [-9.331e+01],
         [ 3.520e+01],
         [ 1.128e+02]],

        [[ 3.811e+02],
         [-1.214e+02],
         [ 3.633e+02],
         [-4.582e+01],
         [ 6.073e+01],
         [-1.239e+02],
         [-1.309e+02],
         [ 3.883e+01],
         [-4.536e+01],
         [-9.887e+01]],

        [[-8.104e+01],
         [ 8.750e+01],
         [-4.641e+01],
         [-1.255e+02],
         [-9.879e+01],
         [-5.150e+01],
         [-1.062e+01],
         [ 4.841e+00],
         [-1.299e+02],
         [ 2.700e+01]]], device='cuda:0')
v tensor([[[1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [9.127e+00]],

        [[1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [7.245e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.906e-01],
         [1.000e-12]],

        [[1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01]],

        [[1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [9.799e+00],
         [1.000e+01]],

        [[1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01]],

        [[1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01]],

        [[1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [4.841e+00],
         [1.000e-12],
         [1.000e+01]]], device='cuda:0')
v before min max tensor([[ -70.370],
        [ -75.723],
        [ -70.449],
        [  99.003],
        [ -66.415],
        [ -54.111],
        [  42.937],
        [ -93.059],
        [ -72.597],
        [ -95.999],
        [ -42.238],
        [-123.057],
        [-118.133]], device='cuda:0')
v tensor([[1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e+01],
        [1.000e-12],
        [1.000e-12],
        [1.000e+01],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12]], device='cuda:0')
a after update for 1 param tensor([[-0.054,  0.157,  0.105,  ...,  0.124, -0.058, -0.064],
        [-0.018, -0.011, -0.089,  ..., -0.005,  0.068,  0.147],
        [ 0.007,  0.082,  0.006,  ..., -0.069,  0.200, -0.124],
        ...,
        [ 0.091,  0.058,  0.007,  ...,  0.035,  0.018,  0.048],
        [-0.003, -0.034, -0.019,  ..., -0.097,  0.027, -0.027],
        [ 0.050, -0.022, -0.167,  ...,  0.164, -0.001,  0.009]],
       device='cuda:0')
s after update for 1 param tensor([[1.768, 2.218, 1.328,  ..., 1.897, 1.571, 1.078],
        [1.568, 1.278, 2.409,  ..., 1.018, 2.126, 2.235],
        [1.754, 1.585, 1.450,  ..., 1.850, 1.481, 1.980],
        ...,
        [1.745, 1.850, 1.916,  ..., 1.861, 1.839, 1.581],
        [1.410, 1.808, 1.707,  ..., 1.720, 1.293, 1.791],
        [2.089, 1.824, 2.007,  ..., 0.882, 1.523, 1.855]], device='cuda:0')
b after update for 1 param tensor([[76.757, 85.972, 66.517,  ..., 79.504, 72.362, 59.949],
        [72.293, 65.260, 89.600,  ..., 58.247, 84.169, 86.294],
        [76.449, 72.685, 69.522,  ..., 78.508, 70.254, 81.234],
        ...,
        [76.253, 78.512, 79.897,  ..., 78.759, 78.290, 72.581],
        [68.541, 77.629, 75.425,  ..., 75.720, 65.653, 77.256],
        [83.443, 77.972, 81.787,  ..., 54.206, 71.252, 78.632]],
       device='cuda:0')
clipping threshold 1.364213396274776
a after update for 1 param tensor([ 1.520e-01,  1.155e-01,  1.184e-01, -2.172e-01, -9.589e-02,  2.743e-03,
        -5.826e-02, -7.906e-02,  1.832e-01, -1.142e-01, -4.067e-01, -2.186e-02,
         1.460e-01,  3.820e-01,  2.696e-01,  1.407e-01, -1.048e-04,  3.923e-01,
         1.341e-01, -1.240e-01,  6.528e-02,  2.722e-02,  2.195e-01,  3.060e-01,
        -2.347e-01,  6.985e-02, -7.456e-02, -1.474e-02, -2.113e-01,  2.836e-02,
         1.281e-02, -1.104e-01, -3.234e-02,  1.182e-01,  4.404e-02, -1.195e-01,
        -1.273e-01,  4.234e-02,  2.150e-01, -2.511e-01, -8.528e-02,  1.938e-01,
         1.862e-01, -7.460e-03,  1.624e-01, -3.616e-02, -2.572e-01,  1.629e-01,
        -1.047e-01,  2.041e-01,  1.832e-01, -2.213e-02,  7.693e-02, -9.382e-02,
         2.171e-02, -2.713e-02, -8.103e-02, -7.008e-02,  1.365e-01, -8.261e-03,
        -1.606e-01,  8.978e-04,  1.427e-01,  4.514e-02,  3.140e-01,  8.187e-02,
        -1.728e-03,  1.003e-01,  6.835e-02, -1.204e-02,  8.547e-02,  7.937e-02,
         3.501e-01,  1.374e-02,  1.234e-01,  2.282e-01, -2.217e-01, -7.276e-02,
        -3.956e-02,  4.469e-02,  2.091e-02,  5.900e-02, -1.532e-02,  7.739e-02,
        -3.723e-01,  2.744e-01,  2.605e-01, -8.584e-02,  1.866e-01,  1.103e-01,
        -1.026e-01, -1.856e-01,  3.323e-02, -6.615e-02, -2.643e-02, -2.973e-01,
        -1.103e-01,  1.038e-01, -1.630e-01, -2.223e-01,  5.234e-03, -2.973e-02,
         1.725e-01,  1.568e-01,  2.316e-02,  4.475e-02,  8.005e-02, -3.039e-02,
         1.699e-01, -1.171e-01,  7.248e-02,  3.559e-01, -8.244e-02,  1.648e-01,
        -5.355e-02,  1.136e-01, -1.476e-02,  2.177e-01,  4.246e-01,  1.237e-01,
        -1.369e-02, -3.529e-01,  1.327e-01,  3.489e-02,  1.791e-01,  3.381e-01,
         1.411e-01,  8.082e-02,  7.670e-02, -5.270e-02], device='cuda:0')
s after update for 1 param tensor([1.906, 1.641, 1.901, 2.030, 1.232, 1.885, 1.418, 1.463, 1.619, 1.101,
        1.683, 1.768, 1.462, 1.419, 1.829, 1.958, 1.735, 2.089, 1.769, 1.772,
        1.150, 1.629, 1.505, 1.503, 1.505, 1.463, 1.858, 1.232, 1.643, 1.237,
        1.808, 1.498, 1.688, 1.419, 1.293, 1.226, 1.681, 1.964, 1.792, 1.624,
        1.667, 1.816, 1.722, 1.886, 1.779, 1.524, 1.244, 1.309, 1.745, 1.418,
        1.526, 1.884, 1.464, 2.106, 1.727, 1.837, 2.085, 2.065, 2.220, 1.745,
        1.529, 1.741, 1.972, 2.160, 1.502, 1.424, 1.227, 2.293, 1.817, 1.228,
        1.477, 1.684, 1.801, 1.551, 1.939, 1.529, 1.895, 1.906, 1.600, 2.463,
        1.888, 1.554, 1.844, 1.369, 2.044, 2.014, 1.744, 1.208, 1.042, 1.646,
        0.958, 1.596, 1.600, 1.902, 1.589, 1.787, 1.754, 1.391, 1.215, 1.761,
        1.447, 1.957, 1.464, 1.792, 0.510, 1.500, 1.515, 1.670, 1.504, 1.787,
        1.439, 1.931, 1.373, 2.167, 1.844, 1.426, 1.466, 0.935, 1.600, 1.390,
        1.734, 2.092, 1.944, 1.595, 1.806, 1.517, 1.992, 1.627, 1.670, 1.688],
       device='cuda:0')
b after update for 1 param tensor([79.697, 73.944, 79.590, 82.243, 64.088, 79.260, 68.735, 69.834, 73.444,
        60.560, 74.890, 76.752, 69.794, 68.764, 78.079, 80.775, 76.048, 83.428,
        76.771, 76.836, 61.898, 73.684, 70.827, 70.780, 70.808, 69.824, 78.691,
        64.062, 73.985, 64.196, 77.624, 70.657, 75.010, 68.778, 65.643, 63.909,
        74.845, 80.901, 77.287, 73.563, 74.541, 77.791, 75.749, 79.278, 76.988,
        71.259, 64.394, 66.057, 76.251, 68.737, 71.320, 79.246, 69.849, 83.767,
        75.856, 78.243, 83.348, 82.953, 86.015, 76.267, 71.384, 76.162, 81.063,
        84.836, 70.739, 68.892, 63.953, 87.408, 77.812, 63.971, 70.152, 74.921,
        77.473, 71.897, 80.382, 71.383, 79.471, 79.687, 73.023, 90.594, 79.329,
        71.962, 78.386, 67.555, 82.524, 81.915, 76.243, 63.435, 58.914, 74.066,
        56.516, 72.918, 73.029, 79.622, 72.774, 77.165, 76.458, 68.086, 63.619,
        76.613, 69.441, 80.751, 69.851, 77.280, 41.222, 70.698, 71.046, 74.601,
        70.797, 77.166, 69.260, 80.211, 67.650, 84.986, 78.388, 68.935, 69.891,
        55.834, 73.017, 68.055, 76.024, 83.504, 80.496, 72.915, 77.587, 71.103,
        81.472, 73.631, 74.600, 74.992], device='cuda:0')
clipping threshold 1.364213396274776
a after update for 1 param tensor([[[ 0.124],
         [ 0.090],
         [ 0.060],
         [ 0.375],
         [ 0.014],
         [-0.029],
         [-0.254],
         [ 0.073],
         [ 0.268],
         [-0.298]],

        [[-0.001],
         [-0.062],
         [ 0.119],
         [ 0.186],
         [ 0.167],
         [-0.271],
         [ 0.236],
         [ 0.148],
         [-0.027],
         [ 0.041]],

        [[-0.112],
         [ 0.107],
         [ 0.156],
         [-0.004],
         [-0.287],
         [ 0.349],
         [ 0.130],
         [ 0.036],
         [-0.470],
         [ 0.215]],

        [[-0.238],
         [ 0.246],
         [-0.346],
         [-0.071],
         [-0.100],
         [ 0.171],
         [ 0.105],
         [ 0.011],
         [-0.023],
         [-0.052]],

        [[ 0.065],
         [ 0.192],
         [ 0.022],
         [-0.126],
         [-0.026],
         [-0.137],
         [ 0.170],
         [ 0.235],
         [-0.018],
         [ 0.042]],

        [[-0.114],
         [-0.267],
         [ 0.207],
         [-0.005],
         [-0.119],
         [ 0.313],
         [ 0.132],
         [ 0.204],
         [-0.025],
         [-0.045]],

        [[ 0.173],
         [-0.009],
         [-0.144],
         [-0.038],
         [ 0.203],
         [ 0.260],
         [ 0.017],
         [-0.129],
         [ 0.010],
         [ 0.197]],

        [[ 0.092],
         [ 0.129],
         [-0.041],
         [-0.333],
         [ 0.133],
         [ 0.169],
         [-0.089],
         [ 0.189],
         [ 0.256],
         [-0.072]],

        [[ 0.172],
         [-0.073],
         [ 0.268],
         [ 0.178],
         [ 0.211],
         [-0.090],
         [-0.027],
         [ 0.128],
         [-0.271],
         [ 0.066]],

        [[ 0.092],
         [ 0.002],
         [ 0.012],
         [-0.125],
         [-0.276],
         [ 0.099],
         [-0.016],
         [-0.036],
         [-0.155],
         [-0.273]],

        [[-0.027],
         [ 0.020],
         [ 0.393],
         [-0.070],
         [ 0.030],
         [-0.074],
         [ 0.010],
         [ 0.056],
         [-0.326],
         [-0.181]],

        [[ 0.108],
         [-0.232],
         [ 0.035],
         [ 0.292],
         [-0.023],
         [ 0.054],
         [ 0.233],
         [ 0.098],
         [ 0.010],
         [-0.099]],

        [[ 0.362],
         [-0.144],
         [-0.249],
         [-0.177],
         [-0.086],
         [-0.132],
         [ 0.008],
         [ 0.194],
         [ 0.159],
         [ 0.127]]], device='cuda:0')
s after update for 1 param tensor([[[1.433],
         [1.779],
         [1.362],
         [1.609],
         [1.922],
         [1.528],
         [1.574],
         [1.778],
         [1.557],
         [1.613]],

        [[1.696],
         [1.257],
         [1.274],
         [1.481],
         [1.412],
         [1.490],
         [1.500],
         [1.458],
         [1.838],
         [1.620]],

        [[1.037],
         [1.475],
         [1.878],
         [1.642],
         [1.376],
         [1.302],
         [1.068],
         [1.795],
         [1.733],
         [1.607]],

        [[1.238],
         [1.501],
         [1.148],
         [1.781],
         [1.105],
         [1.591],
         [1.843],
         [1.079],
         [1.871],
         [1.684]],

        [[1.911],
         [1.705],
         [1.536],
         [1.473],
         [1.364],
         [1.736],
         [1.437],
         [1.541],
         [2.046],
         [1.875]],

        [[1.859],
         [1.707],
         [1.088],
         [1.737],
         [1.457],
         [1.146],
         [1.914],
         [1.524],
         [1.654],
         [1.484]],

        [[1.701],
         [1.669],
         [1.989],
         [1.654],
         [1.631],
         [1.289],
         [1.313],
         [1.380],
         [1.564],
         [1.660]],

        [[1.464],
         [2.287],
         [1.815],
         [1.702],
         [1.982],
         [2.333],
         [2.065],
         [1.556],
         [1.524],
         [0.945]],

        [[1.938],
         [1.468],
         [0.928],
         [1.502],
         [1.711],
         [1.548],
         [1.007],
         [1.414],
         [1.698],
         [1.954]],

        [[1.809],
         [1.801],
         [1.616],
         [1.459],
         [2.037],
         [1.619],
         [1.301],
         [1.959],
         [1.192],
         [2.352]],

        [[1.632],
         [1.785],
         [1.457],
         [1.107],
         [1.622],
         [1.402],
         [2.255],
         [1.543],
         [2.077],
         [1.998]],

        [[1.879],
         [1.967],
         [1.742],
         [1.353],
         [2.037],
         [1.884],
         [1.967],
         [2.144],
         [1.831],
         [2.005]],

        [[1.929],
         [1.457],
         [0.799],
         [1.858],
         [1.504],
         [0.964],
         [1.631],
         [1.649],
         [2.014],
         [1.335]]], device='cuda:0')
b after update for 1 param tensor([[[69.096],
         [77.005],
         [67.361],
         [73.227],
         [80.022],
         [71.347],
         [72.432],
         [76.965],
         [72.027],
         [73.309]],

        [[75.168],
         [64.731],
         [65.157],
         [70.257],
         [68.599],
         [70.460],
         [70.711],
         [69.711],
         [78.257],
         [73.471]],

        [[58.788],
         [70.105],
         [79.118],
         [73.974],
         [67.723],
         [65.876],
         [59.658],
         [77.335],
         [76.004],
         [73.186]],

        [[64.231],
         [70.717],
         [61.844],
         [77.045],
         [60.694],
         [72.825],
         [78.363],
         [59.967],
         [78.967],
         [74.918]],

        [[79.805],
         [75.382],
         [71.537],
         [70.071],
         [67.420],
         [76.063],
         [69.204],
         [71.661],
         [82.566],
         [79.047]],

        [[78.704],
         [75.416],
         [60.217],
         [76.074],
         [69.684],
         [61.801],
         [79.865],
         [71.255],
         [74.246],
         [70.322]],

        [[75.296],
         [74.570],
         [81.417],
         [74.234],
         [73.721],
         [65.547],
         [66.140],
         [67.806],
         [72.184],
         [74.373]],

        [[69.859],
         [87.297],
         [77.770],
         [75.307],
         [81.272],
         [88.169],
         [82.964],
         [72.020],
         [71.260],
         [56.129]],

        [[80.374],
         [69.944],
         [55.600],
         [70.754],
         [75.511],
         [71.823],
         [57.916],
         [68.633],
         [75.222],
         [80.688]],

        [[77.650],
         [77.467],
         [73.382],
         [69.718],
         [82.394],
         [73.452],
         [65.837],
         [80.795],
         [63.036],
         [88.538]],

        [[73.744],
         [77.132],
         [69.688],
         [60.744],
         [73.532],
         [68.342],
         [86.680],
         [71.697],
         [83.200],
         [81.601]],

        [[79.136],
         [80.970],
         [76.192],
         [67.145],
         [82.395],
         [79.230],
         [80.962],
         [84.520],
         [78.108],
         [81.736]],

        [[80.187],
         [69.692],
         [51.597],
         [78.691],
         [70.802],
         [56.674],
         [73.725],
         [74.124],
         [81.930],
         [66.698]]], device='cuda:0')
clipping threshold 1.364213396274776
a after update for 1 param tensor([[-0.045],
        [ 0.106],
        [-0.017],
        [-0.160],
        [-0.001],
        [-0.168],
        [ 0.046],
        [-0.092],
        [ 0.162],
        [ 0.070],
        [-0.035],
        [ 0.153],
        [ 0.158]], device='cuda:0')
s after update for 1 param tensor([[1.060],
        [1.306],
        [1.501],
        [1.586],
        [0.983],
        [1.619],
        [1.825],
        [1.379],
        [1.619],
        [1.484],
        [1.926],
        [2.094],
        [1.902]], device='cuda:0')
b after update for 1 param tensor([[59.447],
        [65.968],
        [70.723],
        [72.705],
        [57.239],
        [73.458],
        [77.987],
        [67.799],
        [73.446],
        [70.317],
        [80.118],
        [83.541],
        [79.620]], device='cuda:0')
clipping threshold 1.364213396274776
||w||^2 3.598286036297804
exp ma of ||w||^2 3.0829006856165853
||w|| 1.8969148732343801
exp ma of ||w|| 1.6838682738507451
||w||^2 1.0818614346994526
exp ma of ||w||^2 2.8632568349481295
||w|| 1.0401256821651184
exp ma of ||w|| 1.6221932177894167
||w||^2 6.359044190672476
exp ma of ||w||^2 3.0092441849637863
||w|| 2.521714533937669
exp ma of ||w|| 1.650814731266025
||w||^2 1.6235483329249294
exp ma of ||w||^2 3.2253808114192344
||w|| 1.2741853605048714
exp ma of ||w|| 1.7125588478389446
||w||^2 7.565171633616167
exp ma of ||w||^2 3.0142291355203503
||w|| 2.7504857086733185
exp ma of ||w|| 1.6446183957531983
||w||^2 5.1145621674860955
exp ma of ||w||^2 2.6896323647432507
||w|| 2.261539778002168
exp ma of ||w|| 1.5780629953023873
||w||^2 1.5153115478690835
exp ma of ||w||^2 2.644986434936184
||w|| 1.2309799136740955
exp ma of ||w|| 1.5630859884381603
||w||^2 3.3503492291064676
exp ma of ||w||^2 2.5569526709959063
||w|| 1.8303959214078434
exp ma of ||w|| 1.5318249911347173
||w||^2 6.124134048714272
exp ma of ||w||^2 2.5251542017104303
||w|| 2.4746987793899833
exp ma of ||w|| 1.5252942962255247
||w||^2 2.9924426788709173
exp ma of ||w||^2 2.949606371688623
||w|| 1.729867821213782
exp ma of ||w|| 1.656543182609762
||w||^2 4.388064085345442
exp ma of ||w||^2 3.03384793134414
||w|| 2.0947706522064515
exp ma of ||w|| 1.6763763383599828
||w||^2 2.064667783233694
exp ma of ||w||^2 3.2184937109649407
||w|| 1.436895188673723
exp ma of ||w|| 1.7200527601320448
||w||^2 3.151702639077257
exp ma of ||w||^2 2.808849008303555
||w|| 1.7753035343504662
exp ma of ||w|| 1.5991948000441094
||w||^2 1.2372563187524428
exp ma of ||w||^2 2.880286917553901
||w|| 1.1123202410962603
exp ma of ||w|| 1.6376629790081039
||w||^2 1.3448279871566042
exp ma of ||w||^2 2.5963216065444326
||w|| 1.1596671881003637
exp ma of ||w|| 1.5452651204905394
||w||^2 0.8605076940824826
exp ma of ||w||^2 2.47751071072565
||w|| 0.9276355394671351
exp ma of ||w|| 1.505157291687502
cuda
Objective function 19.41 = squared loss an data 12.65 + 0.5*rho*h**2 0.984189 + alpha*h 3.582953 + L2reg 2.03 + L1reg 0.16 ; SHD = 43 ; DAG True
Proportion of microbatches that were clipped  0.7743760532862531
iteration 1 in inner loop, alpha 25.537998323345747 rho 100.0 h 0.14029890446321147
1963
cuda
Objective function 28.26 = squared loss an data 12.65 + 0.5*rho*h**2 9.841891 + alpha*h 3.582953 + L2reg 2.03 + L1reg 0.16 ; SHD = 43 ; DAG True
||w||^2 5.155367667259529
exp ma of ||w||^2 2098.7560557869283
||w|| 2.2705434739858052
exp ma of ||w|| 1.672376024206288
||w||^2 0.8423948250112056
exp ma of ||w||^2 2.628519820820536
||w|| 0.9178206932790334
exp ma of ||w|| 1.5481049792108428
||w||^2 0.9840438841639783
exp ma of ||w||^2 2.6300872642759234
||w|| 0.9919898609179321
exp ma of ||w|| 1.5662642054321967
||w||^2 3.0765215407100888
exp ma of ||w||^2 2.896598717793286
||w|| 1.754001579449143
exp ma of ||w|| 1.6150070042821143
||w||^2 1.276113530310344
exp ma of ||w||^2 2.6326098925371437
||w|| 1.1296519509611551
exp ma of ||w|| 1.5572234265480989
||w||^2 1.3752648785310437
exp ma of ||w||^2 2.500846435439228
||w|| 1.1727168791021316
exp ma of ||w|| 1.5108071996317667
||w||^2 0.5057104288670004
exp ma of ||w||^2 2.4241461255984325
||w|| 0.7111332005095813
exp ma of ||w|| 1.498538965620207
||w||^2 2.4484273898910853
exp ma of ||w||^2 2.543659020921913
||w|| 1.564745151739121
exp ma of ||w|| 1.5375399937360754
||w||^2 0.6454601679303169
exp ma of ||w||^2 2.4617645351241078
||w|| 0.8034053571705363
exp ma of ||w|| 1.5142758411280712
||w||^2 2.9568611629807693
exp ma of ||w||^2 2.394852025357494
||w|| 1.7195526054706118
exp ma of ||w|| 1.4835442430979446
||w||^2 1.4539248030279521
exp ma of ||w||^2 2.4502183530731543
||w|| 1.2057880423308038
exp ma of ||w|| 1.5053094115486019
||w||^2 1.473207025084665
exp ma of ||w||^2 2.6102507773533485
||w|| 1.2137573996003752
exp ma of ||w|| 1.5546862350229953
||w||^2 1.4965170694491343
exp ma of ||w||^2 2.346891104639433
||w|| 1.2233221445919853
exp ma of ||w|| 1.474121387466714
||w||^2 2.990784681881487
exp ma of ||w||^2 2.17439221282422
||w|| 1.7293885283190376
exp ma of ||w|| 1.426692218399942
||w||^2 2.462939463992231
exp ma of ||w||^2 2.298568405462022
||w|| 1.5693755012718373
exp ma of ||w|| 1.467779297771211
||w||^2 1.0310139747268912
exp ma of ||w||^2 2.5002205385192102
||w|| 1.0153885831182519
exp ma of ||w|| 1.5261467378258164
||w||^2 1.3426814479182831
exp ma of ||w||^2 2.765427632080843
||w|| 1.1587413205363324
exp ma of ||w|| 1.604236832342811
||w||^2 1.0453567558474859
exp ma of ||w||^2 2.403503923112834
||w|| 1.0224268951115703
exp ma of ||w|| 1.4971800610770252
||w||^2 5.965106727728803
exp ma of ||w||^2 2.583254944202377
||w|| 2.44235679779364
exp ma of ||w|| 1.547198017577064
||w||^2 0.981265017607876
exp ma of ||w||^2 2.440096349160268
||w|| 0.9905882179835757
exp ma of ||w|| 1.5118461767011095
v before min max tensor([[ -72.889,  -94.949,  404.244,  ...,   -6.340,  -78.782,    5.032],
        [ -32.565,   77.962,  129.627,  ...,  -73.094,  -94.682,  -50.038],
        [ 119.217,  512.781,   42.060,  ...,   75.378,  -90.657,  -87.841],
        ...,
        [-102.750, -111.478,  183.896,  ...,   13.784,  -48.117,   -1.629],
        [-128.389,  -67.526,   96.188,  ...,  -44.565,  143.053,   28.729],
        [ -42.599,  118.914,  -39.881,  ...,  235.781, -108.459,   18.974]],
       device='cuda:0')
v tensor([[1.000e-12, 1.000e-12, 1.000e+01,  ..., 1.000e-12, 1.000e-12,
         5.032e+00],
        [1.000e-12, 1.000e+01, 1.000e+01,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [1.000e+01, 1.000e+01, 1.000e+01,  ..., 1.000e+01, 1.000e-12,
         1.000e-12],
        ...,
        [1.000e-12, 1.000e-12, 1.000e+01,  ..., 1.000e+01, 1.000e-12,
         1.000e-12],
        [1.000e-12, 1.000e-12, 1.000e+01,  ..., 1.000e-12, 1.000e+01,
         1.000e+01],
        [1.000e-12, 1.000e+01, 1.000e-12,  ..., 1.000e+01, 1.000e-12,
         1.000e+01]], device='cuda:0')
v before min max tensor([-5.467e+01, -7.580e+01, -3.270e+01,  4.938e+01, -1.032e+02, -7.033e+01,
        -4.711e+01, -6.901e+01,  2.422e+02, -2.588e+01, -8.684e+01,  2.064e+01,
         2.657e+02, -3.532e+01, -6.043e+01, -6.198e+01,  6.117e+02, -1.114e+02,
        -9.584e+01, -1.065e+02,  2.264e-01, -7.221e+01, -6.564e+01, -7.080e+01,
        -3.698e+01, -7.130e+01,  6.676e+01, -6.067e+01,  2.685e+01, -4.627e+01,
        -9.602e+01, -7.772e+01, -1.111e+02, -3.092e+01, -7.597e+01, -7.851e+01,
         1.375e+02, -7.273e+01, -8.014e+01, -4.505e+01, -8.123e+01, -1.075e+02,
        -9.642e+01, -4.487e+01, -2.413e+01,  2.534e+02, -9.696e+00, -1.137e+02,
        -2.767e+01, -7.777e+01, -9.736e+01, -7.568e+01, -7.639e+01,  1.327e+02,
         7.163e+02, -9.109e+01,  9.259e+01, -5.905e+01, -2.148e+01, -7.737e+01,
        -6.617e+01,  4.012e+01, -8.274e+01,  2.835e+02,  6.640e+01, -7.207e+01,
        -6.266e+01, -9.719e+01,  1.075e+01, -9.539e+01, -8.305e+01, -1.071e+02,
         3.247e+01, -9.652e+01, -8.795e+01, -1.585e+00, -3.468e+00, -9.948e+01,
        -5.231e+01,  9.747e+00, -5.719e+01,  2.315e+01, -4.301e+01, -5.388e+01,
        -3.209e+01, -9.243e+01,  3.180e+01, -7.162e+01,  2.697e+01, -3.232e+01,
         2.788e+02, -8.336e+01, -1.684e+01, -6.586e+01, -8.446e+01, -5.572e+01,
         2.536e+01,  9.725e+01, -6.687e+01, -4.526e+01, -1.100e+02, -1.445e+01,
         1.861e+01, -9.139e+01, -6.359e+01, -5.623e+01, -8.778e+01, -4.074e+01,
         7.425e+02, -7.905e+01, -8.987e+01,  1.359e+01, -8.767e+01, -8.507e+00,
        -2.892e+01, -5.306e+01, -1.036e+02,  2.559e+02, -9.434e+00, -8.038e+01,
         1.173e+02, -7.547e+01, -2.632e+01, -8.622e+01, -7.724e+01, -3.738e+01,
         4.035e+01, -9.537e+01, -9.530e+00, -5.506e+01], device='cuda:0')
v tensor([1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e+01,
        1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 2.264e-01, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01,
        1.000e+01, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e+01, 1.000e-12, 1.000e+01, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 9.747e+00, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12], device='cuda:0')
v before min max tensor([[[ 146.475],
         [ -77.638],
         [ -43.248],
         [ -99.917],
         [ -52.523],
         [ -46.823],
         [ 104.111],
         [ -94.201],
         [  73.584],
         [ -41.841]],

        [[ -66.502],
         [ 207.153],
         [ -40.080],
         [ -13.883],
         [ 119.484],
         [ -85.791],
         [ -11.896],
         [ -62.354],
         [ -17.308],
         [ -12.495]],

        [[ 102.899],
         [ -57.303],
         [  33.234],
         [ -90.138],
         [ -64.807],
         [ -28.026],
         [-103.480],
         [ -68.793],
         [ -76.856],
         [-103.372]],

        [[  -3.026],
         [ -58.720],
         [  84.905],
         [ -75.133],
         [ -92.412],
         [ -49.802],
         [ -22.442],
         [ -38.348],
         [ -70.479],
         [ 121.946]],

        [[ -70.978],
         [ -53.463],
         [  -4.803],
         [  15.135],
         [ -82.673],
         [ -31.513],
         [-109.842],
         [ -70.889],
         [  19.879],
         [ 112.854]],

        [[ -75.050],
         [ -77.978],
         [  91.022],
         [ -41.427],
         [-103.761],
         [ 166.573],
         [ -27.988],
         [ -66.399],
         [ -67.144],
         [  18.482]],

        [[ 339.144],
         [ -69.403],
         [ -77.874],
         [ -57.785],
         [ -20.903],
         [ -72.705],
         [   2.983],
         [ -88.138],
         [ -66.621],
         [-100.612]],

        [[ -73.483],
         [ -34.581],
         [ -76.027],
         [ -52.616],
         [ -62.237],
         [  94.914],
         [   3.225],
         [ -36.741],
         [ 121.915],
         [  94.347]],

        [[-115.382],
         [ -89.495],
         [ -23.409],
         [   8.955],
         [ -75.592],
         [ -84.029],
         [ 140.600],
         [ -92.972],
         [ 262.392],
         [ -91.633]],

        [[ -78.985],
         [ -33.069],
         [ -31.829],
         [ -71.916],
         [ -81.051],
         [ -24.978],
         [ -60.187],
         [-109.045],
         [ -85.766],
         [ -13.588]],

        [[ -72.141],
         [ -95.172],
         [ -88.749],
         [ -76.288],
         [ -94.866],
         [ -60.186],
         [-114.745],
         [  47.205],
         [ -16.926],
         [ -12.090]],

        [[ -79.423],
         [ -74.118],
         [ -53.921],
         [ -79.796],
         [ -85.607],
         [ 266.560],
         [ -73.905],
         [  50.213],
         [ -70.294],
         [ -73.846]],

        [[ -83.230],
         [ -11.720],
         [ -96.867],
         [ -99.664],
         [  38.962],
         [ 135.437],
         [ -63.423],
         [ -83.344],
         [-104.238],
         [ -39.877]]], device='cuda:0')
v tensor([[[1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01]],

        [[1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.983e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [3.225e+00],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [8.955e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]]], device='cuda:0')
v before min max tensor([[  11.394],
        [  81.796],
        [ -74.626],
        [-100.160],
        [   4.746],
        [ -93.002],
        [ -31.671],
        [ -63.430],
        [ -90.214],
        [ -56.211],
        [ -52.120],
        [  83.674],
        [ 125.569]], device='cuda:0')
v tensor([[1.000e+01],
        [1.000e+01],
        [1.000e-12],
        [1.000e-12],
        [4.746e+00],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e+01],
        [1.000e+01]], device='cuda:0')
a after update for 1 param tensor([[-0.053, -0.086, -0.032,  ...,  0.035,  0.038, -0.080],
        [-0.021, -0.006, -0.031,  ..., -0.061,  0.040,  0.000],
        [-0.059, -0.068,  0.000,  ..., -0.039,  0.004,  0.014],
        ...,
        [ 0.005,  0.099, -0.060,  ..., -0.067,  0.038,  0.013],
        [-0.083,  0.066, -0.025,  ..., -0.027,  0.056, -0.010],
        [-0.008,  0.045, -0.051,  ...,  0.090, -0.035,  0.033]],
       device='cuda:0')
s after update for 1 param tensor([[1.536, 1.869, 2.127,  ..., 1.659, 1.586, 1.544],
        [1.601, 2.089, 2.035,  ..., 1.940, 2.300, 1.205],
        [2.133, 2.083, 1.799,  ..., 1.711, 1.794, 1.862],
        ...,
        [1.859, 2.164, 2.387,  ..., 1.548, 2.017, 1.582],
        [2.312, 1.542, 1.935,  ..., 1.218, 2.216, 1.730],
        [1.275, 1.993, 2.144,  ..., 1.762, 1.953, 1.783]], device='cuda:0')
b after update for 1 param tensor([[74.004, 81.637, 87.091,  ..., 76.925, 75.201, 74.210],
        [75.571, 86.313, 85.186,  ..., 83.170, 90.567, 65.546],
        [87.229, 86.189, 80.099,  ..., 78.106, 79.997, 81.485],
        ...,
        [81.422, 87.861, 92.274,  ..., 74.295, 84.807, 75.107],
        [90.804, 74.159, 83.063,  ..., 65.909, 88.900, 78.539],
        [67.423, 84.316, 87.454,  ..., 79.266, 83.449, 79.747]],
       device='cuda:0')
clipping threshold 1.18405649412504
a after update for 1 param tensor([ 1.135e-01,  5.017e-03, -2.560e-02,  4.332e-02,  6.122e-02,  1.748e-01,
        -7.886e-02, -7.166e-02,  3.192e-02, -6.684e-02, -2.733e-02, -2.154e-02,
         4.791e-02,  2.667e-01,  5.526e-02, -2.791e-01, -1.692e-01, -2.024e-01,
        -2.082e-01,  2.316e-01,  8.656e-02,  2.932e-01, -1.027e-01,  7.136e-02,
        -1.224e-01,  2.328e-04,  2.512e-02,  3.023e-01, -4.108e-02, -4.046e-01,
         1.323e-01, -1.433e-01,  2.668e-01, -3.931e-02,  6.937e-02, -1.070e-02,
         2.564e-02,  1.372e-01, -1.256e-01, -1.963e-01,  1.530e-02, -4.071e-02,
        -3.906e-02,  9.582e-02,  1.070e-01, -2.354e-02, -7.129e-02,  2.412e-01,
        -1.898e-01, -1.727e-01,  2.492e-01,  1.239e-01, -1.728e-01, -6.718e-02,
         1.315e-01, -2.088e-01, -7.759e-02,  1.716e-01, -4.910e-02, -3.415e-02,
        -2.593e-01, -1.088e-02, -3.096e-01,  4.583e-02, -1.760e-01, -1.339e-01,
        -3.329e-02, -2.388e-01, -3.675e-02,  9.297e-02,  8.680e-02, -4.395e-02,
        -4.783e-02,  4.375e-02,  1.905e-02, -3.106e-02,  1.235e-01, -1.207e-04,
        -7.103e-02, -1.400e-01, -1.272e-03, -1.188e-01, -2.527e-02, -3.646e-01,
         2.182e-01, -6.509e-02,  3.074e-02,  5.043e-02, -2.016e-01, -3.792e-02,
        -1.223e-01, -9.427e-02,  1.524e-01,  6.753e-02, -5.340e-02,  2.011e-01,
        -4.113e-02, -2.007e-01,  9.579e-02, -1.027e-01, -1.394e-01, -2.689e-02,
        -1.623e-01, -1.928e-01, -7.890e-02,  4.346e-02,  1.321e-01,  1.216e-01,
         1.424e-01, -2.174e-01, -9.516e-02, -7.519e-02, -3.024e-01, -2.845e-02,
         1.699e-01,  1.507e-01,  1.939e-01,  2.136e-01, -2.323e-01,  1.369e-01,
         5.545e-02,  1.354e-01, -6.859e-03,  5.472e-02, -2.416e-01,  6.413e-02,
         3.785e-01, -1.095e-01, -3.250e-01,  2.111e-01], device='cuda:0')
s after update for 1 param tensor([2.031, 1.472, 1.629, 1.834, 1.866, 1.727, 1.591, 1.958, 1.890, 1.830,
        1.563, 1.790, 1.694, 1.306, 1.181, 1.647, 2.113, 2.044, 1.873, 1.918,
        1.563, 2.019, 1.692, 1.816, 1.830, 1.922, 2.075, 1.371, 2.122, 1.492,
        1.797, 1.401, 2.032, 1.874, 2.271, 1.923, 2.171, 2.040, 1.478, 1.993,
        1.489, 2.034, 1.826, 1.069, 1.476, 2.145, 1.951, 2.055, 1.486, 1.400,
        2.244, 1.432, 2.010, 2.245, 2.351, 2.003, 2.311, 1.650, 2.287, 1.455,
        1.888, 2.267, 1.808, 2.209, 1.486, 1.723, 1.219, 1.765, 2.322, 1.752,
        1.719, 1.928, 1.402, 1.899, 1.609, 1.409, 1.890, 1.796, 1.028, 2.123,
        1.526, 2.083, 1.560, 1.267, 1.630, 1.694, 1.617, 1.825, 1.142, 1.260,
        2.090, 1.502, 1.122, 1.995, 2.073, 1.641, 1.932, 2.114, 1.398, 2.050,
        2.032, 1.216, 1.831, 1.944, 1.481, 1.740, 1.867, 1.499, 2.446, 1.616,
        1.847, 1.765, 2.109, 1.477, 1.305, 1.627, 2.086, 1.857, 1.735, 1.855,
        1.589, 1.433, 1.509, 1.618, 1.477, 1.651, 1.670, 1.718, 1.719, 1.252],
       device='cuda:0')
b after update for 1 param tensor([85.108, 72.445, 76.225, 80.870, 81.584, 78.481, 75.317, 83.560, 82.096,
        80.778, 74.670, 79.900, 77.723, 68.237, 64.891, 76.646, 86.816, 85.389,
        81.722, 82.698, 74.656, 84.864, 77.689, 80.469, 80.795, 82.799, 86.025,
        69.920, 86.986, 72.941, 80.062, 70.675, 85.120, 81.752, 89.998, 82.813,
        87.994, 85.292, 72.600, 84.305, 72.872, 85.163, 80.706, 61.750, 72.565,
        87.458, 83.408, 85.609, 72.810, 70.671, 89.455, 71.477, 84.667, 89.472,
        91.575, 84.520, 90.794, 76.709, 90.305, 72.029, 82.057, 89.926, 80.311,
        88.764, 72.794, 78.399, 65.937, 79.349, 91.003, 79.045, 78.291, 82.932,
        70.701, 82.292, 75.759, 70.900, 82.112, 80.045, 60.559, 87.015, 73.765,
        86.196, 74.596, 67.225, 76.237, 77.721, 75.936, 80.673, 63.831, 67.047,
        86.338, 73.185, 63.262, 84.357, 85.983, 76.493, 83.005, 86.840, 70.602,
        85.499, 85.131, 65.857, 80.820, 83.267, 72.687, 78.779, 81.598, 73.124,
        93.408, 75.915, 81.153, 79.347, 86.735, 72.567, 68.219, 76.168, 86.262,
        81.380, 78.657, 81.346, 75.272, 71.482, 73.359, 75.970, 72.586, 76.735,
        77.173, 78.265, 78.301, 66.811], device='cuda:0')
clipping threshold 1.18405649412504
a after update for 1 param tensor([[[ 0.010],
         [-0.323],
         [-0.010],
         [ 0.098],
         [ 0.124],
         [ 0.057],
         [ 0.189],
         [-0.045],
         [-0.233],
         [-0.020]],

        [[-0.238],
         [ 0.121],
         [ 0.286],
         [ 0.048],
         [-0.201],
         [-0.055],
         [-0.095],
         [ 0.104],
         [ 0.124],
         [-0.059]],

        [[-0.137],
         [-0.087],
         [ 0.143],
         [ 0.039],
         [ 0.180],
         [ 0.036],
         [ 0.035],
         [-0.054],
         [ 0.024],
         [-0.020]],

        [[-0.033],
         [-0.015],
         [-0.149],
         [ 0.118],
         [-0.176],
         [ 0.042],
         [ 0.142],
         [ 0.026],
         [ 0.012],
         [ 0.164]],

        [[ 0.076],
         [-0.242],
         [-0.028],
         [ 0.047],
         [-0.034],
         [-0.337],
         [ 0.329],
         [-0.004],
         [-0.195],
         [ 0.027]],

        [[-0.224],
         [-0.001],
         [-0.310],
         [ 0.124],
         [ 0.392],
         [-0.255],
         [-0.097],
         [-0.092],
         [ 0.064],
         [ 0.066]],

        [[ 0.171],
         [ 0.096],
         [ 0.101],
         [-0.051],
         [ 0.106],
         [ 0.072],
         [ 0.173],
         [-0.207],
         [ 0.040],
         [-0.021]],

        [[-0.214],
         [-0.155],
         [ 0.122],
         [ 0.172],
         [ 0.224],
         [ 0.072],
         [-0.159],
         [ 0.198],
         [ 0.011],
         [-0.015]],

        [[-0.191],
         [-0.255],
         [-0.166],
         [-0.080],
         [-0.217],
         [-0.275],
         [ 0.064],
         [ 0.031],
         [-0.165],
         [ 0.038]],

        [[ 0.318],
         [-0.183],
         [ 0.176],
         [-0.145],
         [-0.119],
         [ 0.062],
         [ 0.200],
         [ 0.140],
         [ 0.157],
         [ 0.211]],

        [[ 0.240],
         [ 0.214],
         [ 0.013],
         [-0.086],
         [ 0.244],
         [-0.194],
         [ 0.247],
         [ 0.186],
         [ 0.172],
         [ 0.024]],

        [[ 0.007],
         [-0.177],
         [ 0.196],
         [-0.043],
         [ 0.267],
         [-0.072],
         [ 0.139],
         [-0.009],
         [-0.067],
         [ 0.175]],

        [[ 0.034],
         [-0.199],
         [ 0.089],
         [ 0.019],
         [-0.048],
         [ 0.008],
         [-0.276],
         [-0.099],
         [-0.119],
         [ 0.286]]], device='cuda:0')
s after update for 1 param tensor([[[1.985],
         [1.473],
         [1.442],
         [1.858],
         [1.385],
         [1.323],
         [1.578],
         [1.780],
         [2.032],
         [1.347]],

        [[2.117],
         [2.404],
         [1.732],
         [1.414],
         [1.760],
         [1.853],
         [1.340],
         [1.645],
         [1.960],
         [1.913]],

        [[2.001],
         [2.017],
         [1.498],
         [1.755],
         [2.181],
         [1.126],
         [1.950],
         [1.875],
         [1.408],
         [1.876]],

        [[1.963],
         [1.949],
         [2.135],
         [1.568],
         [2.061],
         [1.069],
         [0.804],
         [1.519],
         [1.364],
         [1.903]],

        [[1.835],
         [1.491],
         [1.997],
         [1.772],
         [1.617],
         [1.385],
         [1.991],
         [1.332],
         [2.241],
         [1.314]],

        [[1.723],
         [1.644],
         [1.913],
         [1.600],
         [1.874],
         [1.672],
         [2.051],
         [1.195],
         [2.078],
         [1.827]],

        [[1.634],
         [1.885],
         [1.407],
         [1.041],
         [1.572],
         [1.322],
         [1.910],
         [1.623],
         [1.834],
         [1.813]],

        [[1.350],
         [1.202],
         [1.397],
         [0.973],
         [1.799],
         [2.009],
         [2.039],
         [0.769],
         [2.237],
         [2.166]],

        [[2.107],
         [1.651],
         [1.245],
         [2.217],
         [1.934],
         [1.513],
         [2.080],
         [1.724],
         [1.974],
         [1.805]],

        [[1.422],
         [1.945],
         [1.516],
         [1.320],
         [1.518],
         [1.952],
         [1.271],
         [2.103],
         [1.790],
         [1.349]],

        [[1.299],
         [1.793],
         [1.723],
         [1.812],
         [1.860],
         [1.541],
         [2.109],
         [1.784],
         [1.862],
         [1.879]],

        [[1.469],
         [1.472],
         [2.080],
         [1.556],
         [1.657],
         [2.086],
         [1.332],
         [2.042],
         [1.682],
         [1.356]],

        [[1.661],
         [1.672],
         [1.934],
         [1.797],
         [1.816],
         [1.904],
         [1.149],
         [1.557],
         [1.878],
         [1.553]]], device='cuda:0')
b after update for 1 param tensor([[[84.149],
         [72.474],
         [71.703],
         [81.404],
         [70.290],
         [68.700],
         [75.017],
         [79.686],
         [85.130],
         [69.303]],

        [[86.886],
         [92.602],
         [78.601],
         [71.020],
         [79.232],
         [81.289],
         [69.136],
         [76.593],
         [83.607],
         [82.606]],

        [[84.476],
         [84.807],
         [73.105],
         [79.120],
         [88.191],
         [63.377],
         [83.398],
         [81.776],
         [70.871],
         [81.803]],

        [[83.673],
         [83.381],
         [87.268],
         [74.788],
         [85.743],
         [61.757],
         [53.542],
         [73.601],
         [69.740],
         [82.374]],

        [[80.902],
         [72.919],
         [84.384],
         [79.494],
         [75.937],
         [70.288],
         [84.271],
         [68.917],
         [89.393],
         [68.464]],

        [[78.383],
         [76.574],
         [82.595],
         [75.550],
         [81.749],
         [77.224],
         [85.537],
         [65.290],
         [86.092],
         [80.720]],

        [[76.334],
         [81.992],
         [70.845],
         [60.931],
         [74.883],
         [68.656],
         [82.544],
         [76.091],
         [80.869],
         [80.413]],

        [[69.398],
         [65.473],
         [70.573],
         [58.901],
         [80.094],
         [84.652],
         [85.286],
         [52.374],
         [89.317],
         [87.893]],

        [[86.686],
         [76.735],
         [66.635],
         [88.918],
         [83.062],
         [73.454],
         [86.137],
         [78.422],
         [83.913],
         [80.243]],

        [[71.212],
         [83.282],
         [73.536],
         [68.602],
         [73.584],
         [83.427],
         [67.331],
         [86.610],
         [79.898],
         [69.375]],

        [[68.068],
         [79.968],
         [78.386],
         [80.391],
         [81.448],
         [74.123],
         [86.725],
         [79.759],
         [81.480],
         [81.859]],

        [[72.386],
         [72.464],
         [86.126],
         [74.501],
         [76.876],
         [86.259],
         [68.924],
         [85.336],
         [77.449],
         [69.548]],

        [[76.957],
         [77.212],
         [83.060],
         [80.053],
         [80.487],
         [82.410],
         [64.024],
         [74.508],
         [81.838],
         [74.426]]], device='cuda:0')
clipping threshold 1.18405649412504
a after update for 1 param tensor([[ 0.124],
        [-0.124],
        [ 0.044],
        [-0.027],
        [ 0.065],
        [-0.049],
        [-0.390],
        [ 0.107],
        [ 0.026],
        [ 0.213],
        [-0.051],
        [-0.035],
        [-0.089]], device='cuda:0')
s after update for 1 param tensor([[1.687],
        [1.615],
        [1.398],
        [1.815],
        [1.558],
        [1.731],
        [1.570],
        [2.048],
        [1.703],
        [1.360],
        [2.058],
        [2.097],
        [2.051]], device='cuda:0')
b after update for 1 param tensor([[77.561],
        [75.901],
        [70.615],
        [80.453],
        [74.535],
        [78.581],
        [74.836],
        [85.457],
        [77.941],
        [69.645],
        [85.675],
        [86.482],
        [85.520]], device='cuda:0')
clipping threshold 1.18405649412504
||w||^2 1.470847555156177
exp ma of ||w||^2 2.4628697861497217
||w|| 1.212785040786774
exp ma of ||w|| 1.5180672768655337
cuda
Objective function 18.40 = squared loss an data 12.50 + 0.5*rho*h**2 1.988555 + alpha*h 1.610537 + L2reg 2.13 + L1reg 0.17 ; SHD = 43 ; DAG True
Proportion of microbatches that were clipped  0.7772748928060982
iteration 2 in inner loop, alpha 25.537998323345747 rho 1000.0 h 0.06306432910648319
1963
cuda
Objective function 36.29 = squared loss an data 12.50 + 0.5*rho*h**2 19.885548 + alpha*h 1.610537 + L2reg 2.13 + L1reg 0.17 ; SHD = 43 ; DAG True
||w||^2 1.6866345052260352
exp ma of ||w||^2 910166.9443158183
||w|| 1.2987049338575853
exp ma of ||w|| 2.2011762196140525
||w||^2 6.4203794700524
exp ma of ||w||^2 76.49082736840539
||w|| 2.5338467731992793
exp ma of ||w|| 1.7419752951249459
||w||^2 5.0221558216175985
exp ma of ||w||^2 13.521449363318023
||w|| 2.2410166937391605
exp ma of ||w|| 1.6635781089018729
||w||^2 1.5168263089395957
exp ma of ||w||^2 2.771599034261135
||w|| 1.2315950263538724
exp ma of ||w|| 1.6155162156674574
v before min max tensor([[ 2.667e+02,  5.601e+01, -3.270e+01,  ..., -1.098e+02,  8.229e+01,
          1.171e+02],
        [ 2.242e+02,  7.056e+01,  4.179e+02,  ..., -7.813e+01,  6.095e+00,
          8.837e+01],
        [-6.564e+01, -1.256e+01,  1.662e+03,  ..., -3.067e+01,  1.041e+03,
          5.613e+02],
        ...,
        [ 3.733e-01, -1.369e+02, -7.736e+01,  ..., -9.839e+01,  4.776e+01,
          3.096e+02],
        [ 2.052e+02, -1.126e+01,  1.324e+01,  ..., -6.676e+01,  1.918e+02,
          1.784e+02],
        [-5.635e+01, -1.088e+01,  1.419e+03,  ..., -3.097e+01,  3.094e+02,
         -6.658e+01]], device='cuda:0')
v tensor([[1.000e+01, 1.000e+01, 1.000e-12,  ..., 1.000e-12, 1.000e+01,
         1.000e+01],
        [1.000e+01, 1.000e+01, 1.000e+01,  ..., 1.000e-12, 6.095e+00,
         1.000e+01],
        [1.000e-12, 1.000e-12, 1.000e+01,  ..., 1.000e-12, 1.000e+01,
         1.000e+01],
        ...,
        [3.733e-01, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e+01,
         1.000e+01],
        [1.000e+01, 1.000e-12, 1.000e+01,  ..., 1.000e-12, 1.000e+01,
         1.000e+01],
        [1.000e-12, 1.000e-12, 1.000e+01,  ..., 1.000e-12, 1.000e+01,
         1.000e-12]], device='cuda:0')
v before min max tensor([ 5.044e+02,  1.183e+03, -9.151e+01,  3.474e+01,  3.081e+02, -1.389e+02,
        -1.154e+02, -1.168e+02,  1.569e+02,  6.340e+02,  1.944e+02, -8.930e+01,
        -6.970e+01, -9.937e+01, -2.163e+01, -7.189e+01,  2.278e+02, -3.440e+01,
         1.218e+02,  1.370e+02, -9.125e+01, -4.312e+01,  1.261e+03,  1.314e+02,
         2.870e+02, -1.172e+02,  4.953e+02,  2.069e+02,  6.460e+00, -5.607e+01,
        -9.384e+00, -7.636e+01,  1.380e+02,  8.151e+00, -3.452e+01,  8.142e+01,
         7.075e+02,  4.300e+01,  1.630e+02, -9.506e+01,  1.870e+02, -7.702e+01,
         7.887e+01, -3.917e+01, -7.561e+01, -4.084e+01,  1.699e+02, -9.083e+01,
         1.055e+02,  2.691e+02,  1.632e+02, -3.928e+01, -4.862e+01,  3.186e+02,
        -9.370e+01, -8.692e+01,  1.889e+02, -8.271e+01, -1.057e+02, -7.474e+01,
         6.469e+01, -7.601e+01, -6.657e+01, -9.375e+01,  3.117e+01,  2.444e+01,
         2.605e+02,  1.189e+02, -4.994e+01,  4.755e+01,  6.112e+02, -9.909e+01,
        -7.207e+01, -1.210e+01,  7.993e+01, -5.954e+01,  2.095e+02,  1.549e+02,
        -5.321e+01, -3.043e+01, -3.275e+01, -1.371e+01, -1.154e+02, -1.414e+01,
        -3.467e-01, -4.620e+01,  6.731e+02, -7.953e+01, -6.490e+01,  2.013e+02,
        -8.041e+01,  3.744e+02, -1.001e+02,  2.852e+01,  4.610e+02, -8.061e+01,
        -7.449e+01, -7.848e+01, -9.120e+01,  6.736e+01,  1.068e+03,  1.221e+02,
        -1.147e+02,  1.825e+01, -7.504e+01, -9.185e+01, -1.073e+02,  1.166e+02,
         4.062e+02,  1.615e+02, -1.789e+01, -1.096e+02, -9.537e+01,  3.685e+01,
        -5.657e+01, -1.194e+02,  2.745e+02,  1.785e+02,  1.140e+03, -6.123e+01,
        -7.088e+00,  9.156e+00, -7.983e+01,  2.954e+01,  2.432e+00, -1.002e+02,
        -4.774e+01, -1.336e+01, -8.042e+01,  1.748e+02], device='cuda:0')
v tensor([1.000e+01, 1.000e+01, 1.000e-12, 1.000e+01, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e+01, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e+01, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e+01,
        1.000e+01, 1.000e-12, 1.000e+01, 1.000e+01, 6.460e+00, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e+01, 8.151e+00, 1.000e-12, 1.000e+01,
        1.000e+01, 1.000e+01, 1.000e+01, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e+01, 1.000e+01, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e+01,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e+01,
        1.000e+01, 1.000e+01, 1.000e-12, 1.000e+01, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e+01, 1.000e+01,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e+01,
        1.000e-12, 1.000e+01, 1.000e-12, 1.000e+01, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e+01, 1.000e+01,
        1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01,
        1.000e+01, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e+01, 1.000e+01, 1.000e-12,
        1.000e-12, 9.156e+00, 1.000e-12, 1.000e+01, 2.432e+00, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01], device='cuda:0')
v before min max tensor([[[-7.880e+01],
         [ 1.961e+02],
         [-7.205e+01],
         [-1.006e+02],
         [-5.361e+01],
         [ 7.894e+01],
         [ 4.001e+02],
         [-2.097e+01],
         [ 3.022e+02],
         [ 8.812e+01]],

        [[-6.339e+01],
         [ 4.137e+02],
         [-7.601e+01],
         [-8.977e+01],
         [-7.432e+01],
         [ 4.182e+02],
         [-1.028e+01],
         [-6.896e+01],
         [ 5.989e+01],
         [ 5.972e+01]],

        [[-4.656e+01],
         [ 5.969e+01],
         [-9.696e+01],
         [-5.730e+01],
         [-1.074e+02],
         [-1.460e+02],
         [-1.398e+02],
         [-9.119e+01],
         [ 1.986e+02],
         [ 4.005e+02]],

        [[-6.652e+01],
         [ 1.074e+02],
         [ 8.688e+01],
         [-3.012e+01],
         [ 4.521e+01],
         [ 2.789e+02],
         [-5.657e+01],
         [-1.206e+02],
         [-1.129e+02],
         [-9.626e+01]],

        [[ 7.899e+01],
         [ 4.936e+01],
         [ 2.504e+02],
         [ 2.137e+01],
         [-4.219e+01],
         [-7.738e+01],
         [-9.976e+01],
         [ 1.145e+01],
         [-9.207e+01],
         [-9.825e+01]],

        [[ 3.835e+02],
         [ 1.834e+02],
         [-1.311e+02],
         [ 3.395e+02],
         [-8.353e+01],
         [-1.058e+02],
         [ 1.430e+02],
         [ 2.636e+01],
         [-1.123e+02],
         [ 6.264e+01]],

        [[ 1.818e+02],
         [-2.252e+00],
         [ 7.897e+01],
         [ 3.842e+01],
         [-9.558e+01],
         [ 2.657e+02],
         [ 2.189e+02],
         [-8.741e+01],
         [ 5.694e+01],
         [-1.169e+02]],

        [[-1.079e+01],
         [ 1.907e+02],
         [-9.675e+01],
         [-7.835e+01],
         [ 3.198e+02],
         [-9.652e+01],
         [-4.390e+01],
         [-1.149e+02],
         [ 3.457e+01],
         [ 6.845e+01]],

        [[ 9.819e+01],
         [ 2.550e+02],
         [-4.549e+01],
         [ 2.751e+02],
         [-6.669e+01],
         [ 2.910e+02],
         [ 4.351e+01],
         [-8.544e+01],
         [ 2.637e+02],
         [-9.018e+01]],

        [[ 6.267e+01],
         [-5.288e+01],
         [ 4.682e+01],
         [-6.644e+01],
         [ 9.655e+01],
         [-6.612e+00],
         [-6.547e+01],
         [ 8.571e+01],
         [-2.576e+01],
         [ 7.621e+02]],

        [[ 4.776e+01],
         [ 2.836e+02],
         [ 2.337e+02],
         [ 1.847e+01],
         [ 6.747e+01],
         [-7.789e+01],
         [-9.508e+01],
         [-9.437e+01],
         [ 1.774e+03],
         [-1.004e+02]],

        [[ 4.240e+02],
         [-5.331e+01],
         [ 8.226e+01],
         [-6.276e+01],
         [-8.684e+01],
         [ 5.535e+01],
         [-9.598e+01],
         [ 1.701e+01],
         [ 3.654e+00],
         [-9.813e+01]],

        [[-1.251e+02],
         [-9.899e+01],
         [-7.858e+01],
         [ 1.523e+02],
         [-9.466e+01],
         [-9.241e+01],
         [ 2.374e-01],
         [ 2.528e+01],
         [ 3.069e+02],
         [-4.118e+01]]], device='cuda:0')
v tensor([[[1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01]],

        [[1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01]],

        [[1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01]],

        [[1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01]],

        [[1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01]],

        [[1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12]],

        [[1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01]],

        [[1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12]],

        [[1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [3.654e+00],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [2.374e-01],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12]]], device='cuda:0')
v before min max tensor([[ -53.326],
        [ 274.302],
        [ -45.879],
        [ 428.474],
        [ -77.365],
        [  -8.914],
        [ -83.113],
        [ -39.333],
        [-102.167],
        [ -49.268],
        [-115.882],
        [ 111.948],
        [-113.252]], device='cuda:0')
v tensor([[1.000e-12],
        [1.000e+01],
        [1.000e-12],
        [1.000e+01],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e+01],
        [1.000e-12]], device='cuda:0')
a after update for 1 param tensor([[ 0.030,  0.112,  0.118,  ..., -0.017,  0.043, -0.050],
        [ 0.059,  0.025,  0.049,  ..., -0.056, -0.030,  0.038],
        [ 0.009, -0.003, -0.060,  ...,  0.052,  0.104, -0.073],
        ...,
        [-0.041,  0.124, -0.011,  ..., -0.031, -0.016, -0.072],
        [-0.031, -0.014, -0.006,  ...,  0.034,  0.093, -0.011],
        [ 0.318, -0.024, -0.103,  ...,  0.003,  0.031, -0.037]],
       device='cuda:0')
s after update for 1 param tensor([[2.005, 2.114, 2.238,  ..., 1.692, 1.968, 1.955],
        [2.105, 2.226, 2.186,  ..., 1.853, 1.718, 1.954],
        [2.168, 0.827, 1.693,  ..., 1.935, 2.072, 2.008],
        ...,
        [1.397, 2.178, 1.576,  ..., 1.896, 2.310, 1.695],
        [1.637, 1.475, 1.849,  ..., 1.302, 2.220, 1.809],
        [1.385, 1.438, 2.307,  ..., 1.567, 2.114, 2.021]], device='cuda:0')
b after update for 1 param tensor([[84.798, 87.057, 89.588,  ..., 77.884, 83.998, 83.726],
        [86.884, 89.346, 88.527,  ..., 81.522, 78.484, 83.704],
        [88.175, 54.471, 77.905,  ..., 83.295, 86.201, 84.848],
        ...,
        [70.782, 88.373, 75.165,  ..., 82.457, 91.021, 77.961],
        [76.615, 72.716, 81.424,  ..., 68.333, 89.228, 80.543],
        [70.466, 71.819, 90.953,  ..., 74.957, 87.073, 85.138]],
       device='cuda:0')
clipping threshold 1.297035019429088
a after update for 1 param tensor([-4.579e-02,  1.672e-01,  2.127e-01, -1.362e-01,  8.995e-02, -8.719e-02,
         1.382e-02,  3.663e-01,  3.183e-01, -7.507e-02, -1.475e-01, -1.238e-01,
        -9.472e-03,  3.165e-01, -1.178e-01, -5.601e-05, -1.272e-01,  6.793e-02,
         1.083e-01,  5.239e-02, -2.496e-01, -6.256e-02,  8.908e-02, -2.087e-01,
        -1.626e-01, -1.577e-01,  2.768e-02, -4.159e-02, -1.250e-01, -1.548e-01,
         8.397e-02, -4.733e-02,  2.476e-02,  2.420e-01,  2.559e-01, -7.362e-02,
         9.273e-03, -7.111e-02,  1.502e-01,  1.562e-01, -2.080e-01,  1.888e-01,
         5.586e-02, -9.652e-02, -2.712e-02, -1.954e-01,  1.433e-01, -4.698e-02,
         2.595e-02, -2.462e-02,  8.770e-02, -1.662e-01,  9.194e-02,  3.076e-02,
        -2.690e-01, -4.196e-01,  5.150e-03, -2.846e-01,  1.632e-02, -1.888e-01,
         1.495e-01, -1.203e-01,  2.332e-01, -2.197e-02, -4.203e-01,  2.076e-02,
        -2.182e-02,  3.914e-02, -6.666e-02, -2.025e-01, -2.215e-02, -5.626e-02,
        -5.157e-01,  6.945e-02, -1.706e-01,  4.227e-03, -1.919e-01,  2.682e-02,
        -1.163e-02,  1.744e-01,  3.827e-02, -1.755e-01, -1.224e-01,  5.889e-02,
         1.285e-02, -3.954e-02, -3.385e-01,  8.529e-02,  7.060e-02,  1.852e-01,
        -1.010e-01,  1.244e-01, -1.032e-01, -6.414e-02,  1.671e-01, -1.547e-01,
         2.876e-02, -1.424e-01, -8.504e-02,  1.049e-01,  1.791e-01,  1.349e-01,
        -1.440e-01, -5.589e-03,  8.311e-02, -1.018e-01, -3.328e-02,  1.316e-01,
         2.570e-01,  9.180e-02, -3.942e-02, -2.199e-01, -8.665e-02, -8.258e-02,
        -5.050e-02, -2.822e-01, -4.615e-02,  1.761e-01,  1.289e-01, -2.815e-01,
        -3.495e-02, -7.603e-02, -2.156e-01, -7.612e-02,  3.789e-01, -3.392e-02,
        -2.691e-01, -6.566e-02, -7.630e-02, -3.608e-02], device='cuda:0')
s after update for 1 param tensor([2.128, 2.234, 1.735, 1.749, 2.384, 2.140, 1.772, 1.794, 1.930, 2.052,
        1.592, 1.780, 1.231, 1.597, 2.021, 1.107, 1.817, 1.881, 1.679, 1.840,
        1.585, 1.233, 1.981, 2.368, 2.042, 2.020, 2.060, 1.969, 1.533, 1.728,
        1.998, 1.521, 1.512, 1.734, 2.071, 1.684, 1.914, 2.110, 1.623, 1.467,
        2.308, 1.560, 2.312, 1.332, 1.593, 1.701, 2.153, 1.395, 1.918, 1.519,
        2.089, 1.702, 2.145, 2.224, 1.796, 1.334, 1.958, 1.271, 1.627, 1.367,
        1.802, 1.408, 1.511, 1.929, 1.963, 1.550, 1.155, 1.906, 1.491, 2.285,
        2.063, 1.765, 1.264, 1.355, 2.188, 1.118, 2.010, 2.091, 1.411, 0.608,
        0.757, 1.385, 1.859, 1.685, 2.235, 1.687, 1.748, 1.696, 1.701, 2.174,
        1.697, 2.307, 1.548, 1.751, 2.120, 1.286, 1.494, 1.537, 1.697, 2.147,
        2.377, 1.994, 1.766, 1.792, 1.405, 1.468, 1.786, 1.859, 2.221, 2.122,
        1.452, 1.797, 1.601, 1.050, 0.983, 1.872, 1.716, 1.716, 2.205, 1.446,
        1.553, 1.655, 1.770, 2.085, 1.722, 1.652, 2.426, 1.699, 1.330, 1.911],
       device='cuda:0')
b after update for 1 param tensor([87.355, 89.513, 78.869, 79.194, 92.468, 87.603, 79.710, 80.215, 83.196,
        85.770, 75.559, 79.892, 66.442, 75.674, 85.123, 63.010, 80.727, 82.133,
        77.601, 81.239, 75.379, 66.501, 84.278, 92.158, 85.575, 85.115, 85.950,
        84.025, 74.143, 78.723, 84.641, 73.841, 73.631, 78.848, 86.186, 77.715,
        82.837, 86.985, 76.279, 72.533, 90.972, 74.783, 91.043, 69.114, 75.579,
        78.092, 87.865, 70.719, 82.923, 73.811, 86.546, 78.129, 87.695, 89.311,
        80.257, 69.170, 83.784, 67.500, 76.371, 70.015, 80.389, 71.065, 73.620,
        83.160, 83.900, 74.555, 64.344, 82.682, 73.124, 90.512, 86.003, 79.567,
        67.334, 69.705, 88.583, 63.308, 84.893, 86.590, 71.130, 46.707, 52.109,
        70.476, 81.643, 77.743, 89.524, 77.781, 79.165, 77.974, 78.094, 88.303,
        78.011, 90.945, 74.515, 79.232, 87.190, 67.913, 73.183, 74.249, 78.006,
        87.742, 92.329, 84.566, 79.585, 80.152, 70.987, 72.545, 80.017, 81.647,
        89.240, 87.232, 72.153, 80.276, 75.767, 61.369, 59.359, 81.934, 78.452,
        78.451, 88.914, 72.012, 74.632, 77.046, 79.674, 86.463, 78.592, 76.966,
        93.280, 78.056, 69.071, 82.777], device='cuda:0')
clipping threshold 1.297035019429088
a after update for 1 param tensor([[[-0.004],
         [-0.021],
         [-0.314],
         [ 0.225],
         [ 0.140],
         [ 0.068],
         [ 0.082],
         [-0.140],
         [ 0.075],
         [-0.263]],

        [[-0.040],
         [-0.018],
         [ 0.334],
         [-0.035],
         [-0.278],
         [ 0.396],
         [-0.329],
         [-0.075],
         [-0.004],
         [ 0.161]],

        [[ 0.487],
         [ 0.017],
         [-0.271],
         [-0.174],
         [ 0.283],
         [ 0.080],
         [ 0.070],
         [-0.179],
         [ 0.090],
         [ 0.012]],

        [[-0.089],
         [ 0.069],
         [-0.079],
         [ 0.238],
         [-0.339],
         [ 0.067],
         [ 0.068],
         [-0.196],
         [-0.173],
         [-0.041]],

        [[-0.080],
         [-0.359],
         [ 0.040],
         [ 0.027],
         [-0.112],
         [ 0.091],
         [-0.075],
         [-0.026],
         [-0.255],
         [ 0.098]],

        [[-0.071],
         [-0.021],
         [-0.477],
         [-0.084],
         [-0.084],
         [-0.204],
         [-0.151],
         [-0.129],
         [ 0.231],
         [ 0.094]],

        [[ 0.080],
         [-0.105],
         [ 0.079],
         [ 0.004],
         [-0.281],
         [-0.145],
         [ 0.014],
         [-0.034],
         [-0.073],
         [ 0.080]],

        [[-0.345],
         [-0.063],
         [ 0.087],
         [ 0.051],
         [-0.282],
         [-0.035],
         [ 0.145],
         [ 0.026],
         [-0.132],
         [-0.160]],

        [[ 0.166],
         [ 0.007],
         [ 0.161],
         [-0.419],
         [-0.024],
         [ 0.037],
         [ 0.149],
         [ 0.267],
         [-0.018],
         [-0.017]],

        [[ 0.007],
         [-0.059],
         [-0.118],
         [-0.104],
         [ 0.156],
         [ 0.116],
         [-0.151],
         [ 0.236],
         [ 0.221],
         [-0.043]],

        [[-0.302],
         [-0.033],
         [-0.202],
         [ 0.176],
         [ 0.106],
         [-0.070],
         [-0.010],
         [-0.006],
         [-0.068],
         [ 0.218]],

        [[ 0.080],
         [-0.014],
         [ 0.193],
         [-0.104],
         [ 0.088],
         [-0.073],
         [ 0.252],
         [ 0.162],
         [ 0.063],
         [-0.203]],

        [[-0.093],
         [ 0.326],
         [-0.074],
         [-0.087],
         [ 0.033],
         [-0.029],
         [ 0.092],
         [-0.259],
         [ 0.201],
         [-0.188]]], device='cuda:0')
s after update for 1 param tensor([[[1.284],
         [2.195],
         [1.471],
         [1.560],
         [0.914],
         [1.876],
         [1.669],
         [1.509],
         [1.706],
         [1.824]],

        [[1.956],
         [1.943],
         [1.933],
         [1.622],
         [1.479],
         [2.034],
         [1.846],
         [1.278],
         [1.840],
         [1.460]],

        [[1.891],
         [1.948],
         [1.505],
         [1.285],
         [2.081],
         [2.336],
         [2.224],
         [1.500],
         [1.541],
         [1.816]],

        [[2.025],
         [2.146],
         [2.049],
         [1.316],
         [1.474],
         [1.872],
         [1.392],
         [1.877],
         [1.801],
         [1.479]],

        [[2.104],
         [1.609],
         [1.281],
         [1.534],
         [1.844],
         [1.268],
         [1.534],
         [2.048],
         [1.580],
         [1.575]],

        [[1.647],
         [1.843],
         [2.172],
         [2.049],
         [1.427],
         [1.639],
         [1.904],
         [1.429],
         [1.736],
         [2.258]],

        [[1.475],
         [1.107],
         [2.016],
         [2.086],
         [2.006],
         [1.906],
         [1.929],
         [1.390],
         [2.067],
         [1.935]],

        [[1.389],
         [2.449],
         [1.565],
         [1.298],
         [2.164],
         [1.522],
         [1.729],
         [1.785],
         [1.529],
         [1.811]],

        [[2.325],
         [2.115],
         [1.553],
         [1.491],
         [1.463],
         [2.069],
         [1.607],
         [1.334],
         [1.769],
         [2.416]],

        [[1.765],
         [1.267],
         [2.116],
         [1.030],
         [1.875],
         [1.984],
         [1.631],
         [2.001],
         [1.721],
         [2.006]],

        [[2.020],
         [2.012],
         [2.087],
         [1.416],
         [1.949],
         [1.346],
         [2.001],
         [1.479],
         [2.159],
         [1.770]],

        [[1.904],
         [1.483],
         [1.912],
         [1.725],
         [1.474],
         [1.620],
         [1.474],
         [1.777],
         [1.822],
         [1.588]],

        [[2.193],
         [1.556],
         [1.375],
         [1.768],
         [1.477],
         [1.429],
         [1.184],
         [2.114],
         [1.654],
         [1.332]]], device='cuda:0')
b after update for 1 param tensor([[[67.854],
         [88.713],
         [72.635],
         [74.799],
         [57.263],
         [82.027],
         [77.362],
         [73.557],
         [78.226],
         [80.864]],

        [[83.758],
         [83.464],
         [83.247],
         [76.260],
         [72.832],
         [85.402],
         [81.364],
         [67.683],
         [81.233],
         [72.356]],

        [[82.353],
         [83.583],
         [73.469],
         [67.882],
         [86.375],
         [91.528],
         [89.313],
         [73.351],
         [74.325],
         [80.695]],

        [[85.205],
         [87.716],
         [85.709],
         [68.702],
         [72.707],
         [81.930],
         [70.663],
         [82.038],
         [80.356],
         [72.820]],

        [[86.855],
         [75.954],
         [67.779],
         [74.166],
         [81.326],
         [67.418],
         [74.171],
         [85.692],
         [75.272],
         [75.159]],

        [[76.853],
         [81.305],
         [88.249],
         [85.725],
         [71.546],
         [76.658],
         [82.631],
         [71.584],
         [78.898],
         [89.989]],

        [[72.732],
         [63.011],
         [85.032],
         [86.495],
         [84.806],
         [82.663],
         [83.165],
         [70.608],
         [86.088],
         [83.307]],

        [[70.563],
         [93.720],
         [74.903],
         [68.215],
         [88.086],
         [73.865],
         [78.737],
         [80.013],
         [74.041],
         [80.588]],

        [[91.313],
         [87.085],
         [74.632],
         [73.109],
         [72.427],
         [86.142],
         [75.923],
         [69.152],
         [79.652],
         [93.077]],

        [[79.561],
         [67.401],
         [87.115],
         [60.775],
         [81.990],
         [84.342],
         [76.482],
         [84.711],
         [78.555],
         [84.808]],

        [[85.108],
         [84.930],
         [86.510],
         [71.252],
         [83.606],
         [69.470],
         [84.699],
         [72.825],
         [87.999],
         [79.667]],

        [[82.635],
         [72.934],
         [82.793],
         [78.638],
         [72.710],
         [76.208],
         [72.710],
         [79.827],
         [80.835],
         [75.450]],

        [[88.680],
         [74.708],
         [70.229],
         [79.629],
         [72.775],
         [71.579],
         [65.154],
         [87.068],
         [77.008],
         [69.121]]], device='cuda:0')
clipping threshold 1.297035019429088
a after update for 1 param tensor([[-0.120],
        [-0.140],
        [-0.232],
        [ 0.241],
        [ 0.094],
        [-0.031],
        [-0.115],
        [ 0.090],
        [ 0.040],
        [ 0.014],
        [-0.062],
        [ 0.111],
        [ 0.098]], device='cuda:0')
s after update for 1 param tensor([[1.282],
        [2.119],
        [1.961],
        [1.859],
        [1.295],
        [1.170],
        [1.640],
        [1.439],
        [1.714],
        [1.057],
        [1.828],
        [2.029],
        [1.808]], device='cuda:0')
b after update for 1 param tensor([[67.808],
        [87.165],
        [83.854],
        [81.656],
        [68.138],
        [64.775],
        [76.678],
        [71.835],
        [78.397],
        [61.558],
        [80.968],
        [85.305],
        [80.523]], device='cuda:0')
clipping threshold 1.297035019429088
||w||^2 1.7421043476173002
exp ma of ||w||^2 2.834056793688264
||w|| 1.319888005710068
exp ma of ||w|| 1.6335665852314396
||w||^2 1.3995765660323127
exp ma of ||w||^2 2.6145788342847722
||w|| 1.1830370095784462
exp ma of ||w|| 1.5853149417474581
||w||^2 3.074659757461322
exp ma of ||w||^2 2.9054643613236193
||w|| 1.753470774624237
exp ma of ||w|| 1.6612804558825383
||w||^2 4.863050558093138
exp ma of ||w||^2 3.040397921345823
||w|| 2.205232540593653
exp ma of ||w|| 1.697091612727592
||w||^2 1.9418036273380503
exp ma of ||w||^2 2.901457658743204
||w|| 1.3934861417818443
exp ma of ||w|| 1.6582802618640633
||w||^2 3.4905703267441006
exp ma of ||w||^2 2.990521760691754
||w|| 1.8683068074446714
exp ma of ||w|| 1.6862789003729146
||w||^2 4.493240872233752
exp ma of ||w||^2 3.173549047418777
||w|| 2.1197266031811157
exp ma of ||w|| 1.7282662875657666
||w||^2 2.371493082336412
exp ma of ||w||^2 3.083751079997324
||w|| 1.539965286081609
exp ma of ||w|| 1.7141079147094103
||w||^2 1.9430334937546394
exp ma of ||w||^2 2.682735723671147
||w|| 1.3939273631558566
exp ma of ||w|| 1.5885937338074687
||w||^2 1.5650074292337073
exp ma of ||w||^2 2.4503099240798147
||w|| 1.2510025696351337
exp ma of ||w|| 1.524895962710716
||w||^2 2.9421619749281875
exp ma of ||w||^2 2.6761772534434365
||w|| 1.715273148780738
exp ma of ||w|| 1.5858050397616836
||w||^2 2.663312470631541
exp ma of ||w||^2 2.776935496967127
||w|| 1.6319658301053797
exp ma of ||w|| 1.6310196456120563
||w||^2 4.3261929144070415
exp ma of ||w||^2 3.219798791574995
||w|| 2.0799502192136816
exp ma of ||w|| 1.7528621660285808
||w||^2 1.9227080227080364
exp ma of ||w||^2 2.696177486582268
||w|| 1.38661747526419
exp ma of ||w|| 1.5884500529744565
||w||^2 1.2984017636241778
exp ma of ||w||^2 2.845417387596478
||w|| 1.139474336536009
exp ma of ||w|| 1.6412161893269033
||w||^2 1.1199056497342397
exp ma of ||w||^2 2.920313712771089
||w|| 1.0582559471764095
exp ma of ||w|| 1.6583345680204835
||w||^2 2.1896633243686345
exp ma of ||w||^2 2.5452880362491124
||w|| 1.4797511021684135
exp ma of ||w|| 1.558972125573898
||w||^2 4.648956898613028
exp ma of ||w||^2 2.8814559553665
||w|| 2.1561439883767104
exp ma of ||w|| 1.656174643803162
||w||^2 2.024610602913729
exp ma of ||w||^2 2.8836424994568293
||w|| 1.4228881203080337
exp ma of ||w|| 1.6589957404429376
||w||^2 3.7107840495719584
exp ma of ||w||^2 2.9948600800159575
||w|| 1.9263395468016427
exp ma of ||w|| 1.6880154285212896
||w||^2 1.5502491562678349
exp ma of ||w||^2 2.66683149330074
||w|| 1.2450900193431136
exp ma of ||w|| 1.5981567372073813
cuda
Objective function 18.61 = squared loss an data 13.04 + 0.5*rho*h**2 2.527342 + alpha*h 0.574161 + L2reg 2.30 + L1reg 0.17 ; SHD = 43 ; DAG True
Proportion of microbatches that were clipped  0.77584148961566
iteration 3 in inner loop, alpha 25.537998323345747 rho 10000.0 h 0.022482624625512315
iteration 3 in outer loop, alpha = 250.3642445784689, rho = 10000.0, h = 0.022482624625512315
cuda
1963
cuda
Objective function 23.67 = squared loss an data 13.04 + 0.5*rho*h**2 2.527342 + alpha*h 5.628845 + L2reg 2.30 + L1reg 0.17 ; SHD = 43 ; DAG True
||w||^2 9.11419097838895
exp ma of ||w||^2 6616381373.889936
||w|| 3.018971841271288
exp ma of ||w|| 1636.2321780691886
||w||^2 8.585321692823523
exp ma of ||w||^2 170542010.51828074
||w|| 2.9300719603490157
exp ma of ||w|| 44.513788882887184
||w||^2 2.035245512433098
exp ma of ||w||^2 414301.3780089831
||w|| 1.4266203112366997
exp ma of ||w|| 1.8821165419061017
||w||^2 4.196162597984609
exp ma of ||w||^2 2.8309712317416627
||w|| 2.0484537090167816
exp ma of ||w|| 1.6399783580937117
||w||^2 4.402551100127119
exp ma of ||w||^2 2.950684578060474
||w|| 2.0982257028563724
exp ma of ||w|| 1.6789116489953522
||w||^2 7.610161847670339
exp ma of ||w||^2 3.3329035260082613
||w|| 2.7586521795381054
exp ma of ||w|| 1.7871053619877464
||w||^2 3.341048541521582
exp ma of ||w||^2 3.307062727221614
||w|| 1.827853533935797
exp ma of ||w|| 1.7810100086586573
||w||^2 4.274441252794301
exp ma of ||w||^2 3.1193005063518777
||w|| 2.067472189122335
exp ma of ||w|| 1.7364507736390848
||w||^2 3.5802487855619987
exp ma of ||w||^2 3.2996261897731425
||w|| 1.8921545353279152
exp ma of ||w|| 1.7837770150122165
||w||^2 2.767434828737835
exp ma of ||w||^2 3.2705922175937587
||w|| 1.6635608881967126
exp ma of ||w|| 1.776100192729856
||w||^2 2.6239101479074334
exp ma of ||w||^2 3.128750253228003
||w|| 1.619848804026917
exp ma of ||w|| 1.7270726537009846
||w||^2 5.316841646768258
exp ma of ||w||^2 3.288142160903845
||w|| 2.3058277573939163
exp ma of ||w|| 1.7791368518988837
||w||^2 2.4927941382045815
exp ma of ||w||^2 3.492689385270388
||w|| 1.5788584921406292
exp ma of ||w|| 1.8405332552243379
||w||^2 3.8179979406535565
exp ma of ||w||^2 3.3150580107011565
||w|| 1.9539697901077069
exp ma of ||w|| 1.8006813169967022
||w||^2 4.255319156292615
exp ma of ||w||^2 4.2780708793847975
||w|| 2.0628424943006713
exp ma of ||w|| 2.0442874494355383
||w||^2 3.4260050302166247
exp ma of ||w||^2 4.299211905946452
||w|| 1.8509470630508655
exp ma of ||w|| 2.0512863047041106
||w||^2 2.7646436593734207
exp ma of ||w||^2 4.168490719596436
||w|| 1.6627217624646105
exp ma of ||w|| 2.019115590079767
||w||^2 3.7987953311438973
exp ma of ||w||^2 4.66714449613012
||w|| 1.9490498534270224
exp ma of ||w|| 2.138209855478487
||w||^2 2.9958309962396648
exp ma of ||w||^2 4.021791551061926
||w|| 1.7308469014443955
exp ma of ||w|| 1.9826765749999407
||w||^2 3.564006706359272
exp ma of ||w||^2 3.8841636376167497
||w|| 1.8878577028895138
exp ma of ||w|| 1.9368592124853725
||w||^2 7.266605850816503
exp ma of ||w||^2 3.7729479779359965
||w|| 2.695664268935674
exp ma of ||w|| 1.9069535861887477
cuda
Objective function 19.72 = squared loss an data 12.64 + 0.5*rho*h**2 0.982362 + alpha*h 3.509321 + L2reg 2.42 + L1reg 0.17 ; SHD = 34 ; DAG True
Proportion of microbatches that were clipped  0.776124775044991
iteration 1 in inner loop, alpha 250.3642445784689 rho 10000.0 h 0.01401686120470913
1963
cuda
Objective function 28.56 = squared loss an data 12.64 + 0.5*rho*h**2 9.823620 + alpha*h 3.509321 + L2reg 2.42 + L1reg 0.17 ; SHD = 34 ; DAG True
||w||^2 49.564477488633266
exp ma of ||w||^2 33582370465.143852
||w|| 7.040204364124188
exp ma of ||w|| 684.8707245556168
||w||^2 6.283359264880081
exp ma of ||w||^2 4468531.6309273895
||w|| 2.5066629739316935
exp ma of ||w|| 2.7047054644991633
||w||^2 1.9021796305981304
exp ma of ||w||^2 23.501695017481104
||w|| 1.3791952837064556
exp ma of ||w|| 1.5425575426643652
||w||^2 1.5541407627888275
exp ma of ||w||^2 10.948421953755282
||w|| 1.2466518209944697
exp ma of ||w|| 1.4895672325217146
v before min max tensor([[-125.534, -114.915,  -10.818,  ...,  -83.709,  -64.541, -105.252],
        [-128.676,  -14.267,  261.891,  ...,  255.162,  -85.236,  -96.211],
        [ -64.243,   -6.722, -112.711,  ...,  -92.275,  -79.660, -116.002],
        ...,
        [ 139.760, -105.637, -111.141,  ...,  -77.357,  -85.110,  445.157],
        [ 276.106, -140.917,  428.606,  ...,  -98.651, 1280.549,   23.435],
        [ -67.950,  -95.769,  -95.701,  ...,  375.614, -109.076, -135.066]],
       device='cuda:0')
v tensor([[1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [1.000e-12, 1.000e-12, 1.000e+01,  ..., 1.000e+01, 1.000e-12,
         1.000e-12],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        ...,
        [1.000e+01, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e+01],
        [1.000e+01, 1.000e-12, 1.000e+01,  ..., 1.000e-12, 1.000e+01,
         1.000e+01],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e+01, 1.000e-12,
         1.000e-12]], device='cuda:0')
v before min max tensor([   3.953,  -77.656,   -3.370,  -12.982,    6.514, -112.712, -108.458,
          47.044,  -65.675,  -69.492,  -67.379,   19.010,   93.863,  -33.896,
         -98.598,  -83.922, -103.077,  -59.167, -102.141,   -8.464,  -61.123,
         185.554,  -41.049,  -49.656,  -76.871,  115.829, -110.243,  -68.619,
         -54.966, -127.080,  -30.727,  -52.698,  -87.320,  -76.734,  165.224,
         -93.732, -113.284,  -16.923,  -25.442,  -39.724,  381.223, -140.855,
        -118.273,  -72.123,   34.090,  -71.599,  -90.679,  -69.503,  -48.061,
          38.902,  -87.276,  -90.377,  -21.309,  142.385,  -98.642, -114.048,
          16.900,   15.789,  -56.682,  -27.657,  -24.805, -110.191,  174.330,
          16.012,  -64.212,  225.933, -140.532,   48.642,  -65.878,  -61.052,
        -113.469,  -48.854,  -38.684,  -87.859, -101.924,  -56.282,  117.956,
         -38.303,   -0.872,  -95.436, -128.493,  -89.144,  468.245,  -59.134,
          31.238,  212.272,  -80.109, -127.902,  -93.334,  -74.095, -116.294,
        -126.733, -108.007,  -44.136,   22.845,   -2.019,  148.390, -112.992,
         285.340,  -49.935,  203.847,   10.006,  154.087,  -71.568, -145.850,
         123.440,  -98.388,  -77.604,  -48.832,  -18.679,  -62.017, -126.729,
         -45.556,  -32.115, -128.604,   -4.032,  -95.265, -109.971,  -64.359,
         187.107,  -77.114,  -38.403,  -75.554,  -72.213,   62.563,  -91.937,
          39.116,  -43.522,  -98.591,  -74.131], device='cuda:0')
v tensor([3.953e+00, 1.000e-12, 1.000e-12, 1.000e-12, 6.514e+00, 1.000e-12,
        1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01,
        1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e+01, 1.000e-12, 1.000e+01,
        1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e+01, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e+01, 1.000e+01,
        1.000e+01, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12], device='cuda:0')
v before min max tensor([[[ -45.663],
         [  35.245],
         [ -21.875],
         [ -33.666],
         [ -31.342],
         [ -76.429],
         [-120.086],
         [ -67.869],
         [ 518.357],
         [ -51.465]],

        [[   6.452],
         [ -82.216],
         [ -84.152],
         [  17.395],
         [  -6.261],
         [-105.780],
         [-117.091],
         [ -26.523],
         [ -90.701],
         [  48.582]],

        [[-112.021],
         [ -22.186],
         [-114.943],
         [ -82.710],
         [ -83.234],
         [ -86.433],
         [-109.403],
         [ -85.229],
         [-126.196],
         [ -50.616]],

        [[-115.642],
         [-113.248],
         [  40.912],
         [-143.965],
         [-106.903],
         [ -68.045],
         [ -52.853],
         [ -76.898],
         [ -88.691],
         [ -61.416]],

        [[ -83.154],
         [ -34.593],
         [-101.722],
         [ 190.897],
         [ -73.217],
         [ -52.944],
         [ -55.278],
         [-116.248],
         [ 173.598],
         [  50.585]],

        [[ -95.698],
         [ -44.566],
         [  -9.676],
         [-109.387],
         [  -2.227],
         [ -96.285],
         [ -58.679],
         [ 199.851],
         [ -73.694],
         [  16.093]],

        [[-112.790],
         [-147.618],
         [-110.607],
         [  27.544],
         [  -2.589],
         [ 140.643],
         [-115.105],
         [ -89.080],
         [  39.194],
         [ -94.027]],

        [[-102.097],
         [-111.559],
         [ -75.120],
         [ -59.464],
         [ 193.380],
         [  -3.812],
         [ -85.884],
         [ -97.359],
         [ -58.919],
         [ -10.012]],

        [[ -36.870],
         [ -22.857],
         [ -85.868],
         [ -40.892],
         [ -22.423],
         [ -99.017],
         [-118.329],
         [ -26.602],
         [ -91.988],
         [-116.793]],

        [[ -84.207],
         [-119.659],
         [-101.247],
         [ -55.225],
         [ -54.613],
         [-129.441],
         [ -98.375],
         [  61.940],
         [ -96.988],
         [ -44.433]],

        [[-125.995],
         [-124.197],
         [ -35.231],
         [   9.001],
         [ -91.766],
         [ -64.281],
         [ -72.180],
         [ -95.467],
         [ -89.838],
         [-120.815]],

        [[ -31.829],
         [  29.003],
         [  30.649],
         [ -82.799],
         [-154.022],
         [ -88.364],
         [ -49.328],
         [-101.480],
         [ -60.423],
         [-111.801]],

        [[ 145.722],
         [ -10.889],
         [ -57.120],
         [-107.353],
         [ -30.691],
         [ -68.549],
         [  85.152],
         [ -83.848],
         [ -75.038],
         [  58.579]]], device='cuda:0')
v tensor([[[1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12]],

        [[6.452e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [9.001e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01]]], device='cuda:0')
v before min max tensor([[  14.530],
        [-103.134],
        [-121.268],
        [-110.751],
        [ 229.669],
        [ -56.893],
        [-117.257],
        [  -1.992],
        [-106.625],
        [  -6.997],
        [ -92.137],
        [-119.060],
        [ -84.566]], device='cuda:0')
v tensor([[1.000e+01],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e+01],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12]], device='cuda:0')
a after update for 1 param tensor([[-7.873e-02, -6.917e-03, -7.586e-02,  ...,  6.257e-02, -4.502e-02,
          4.286e-02],
        [ 6.168e-02, -1.506e-02, -8.198e-02,  ...,  1.204e-01, -1.595e-04,
          3.262e-02],
        [ 5.367e-02,  1.190e-02, -7.943e-03,  ..., -3.603e-02, -4.615e-02,
          1.460e-03],
        ...,
        [-8.245e-02, -2.727e-02,  6.915e-02,  ..., -2.453e-02, -5.701e-02,
         -2.707e-02],
        [ 2.066e-01, -1.120e-02,  5.926e-03,  ...,  2.483e-02, -5.171e-02,
         -4.350e-03],
        [ 5.584e-01, -2.736e-02, -4.440e-02,  ..., -6.305e-02, -4.439e-02,
          5.168e-02]], device='cuda:0')
s after update for 1 param tensor([[1.953, 1.790, 2.142,  ..., 1.684, 2.129, 1.736],
        [2.239, 2.135, 2.497,  ..., 2.262, 1.643, 1.518],
        [1.362, 1.881, 2.408,  ..., 1.841, 1.648, 1.756],
        ...,
        [1.575, 2.092, 1.694,  ..., 1.196, 2.224, 2.661],
        [1.778, 2.145, 1.816,  ..., 1.659, 2.068, 1.914],
        [1.595, 1.863, 1.442,  ..., 2.326, 1.811, 2.033]], device='cuda:0')
b after update for 1 param tensor([[82.611, 79.090, 86.526,  ..., 76.726, 86.263, 77.885],
        [88.466, 86.373, 93.424,  ..., 88.909, 75.768, 72.836],
        [69.005, 81.089, 91.741,  ..., 80.219, 75.903, 78.333],
        ...,
        [74.200, 85.511, 76.955,  ..., 64.661, 88.166, 96.436],
        [78.824, 86.592, 79.671,  ..., 76.135, 85.013, 81.798],
        [74.664, 80.693, 70.993,  ..., 90.168, 79.558, 84.298]],
       device='cuda:0')
clipping threshold 1.3093512159718073
a after update for 1 param tensor([ 0.391, -0.352,  0.689,  0.270, -0.072,  0.612,  0.082, -0.209,  0.459,
         0.242,  0.049,  0.367, -0.036, -0.628,  0.462, -0.443, -0.292, -0.179,
        -0.142,  0.286, -0.023,  0.201, -0.011,  0.194, -0.154,  0.239,  0.161,
         0.563, -0.064,  0.010,  0.004, -0.069, -0.105,  0.500, -0.285,  0.355,
         0.337, -0.018,  0.200,  0.111, -0.070, -0.029, -0.233,  0.095,  0.131,
        -0.289, -0.141, -0.055,  0.192, -0.429,  0.248,  0.163,  0.199,  0.085,
         0.059, -0.285,  0.111, -0.122, -0.151, -0.184,  0.520, -0.207,  0.119,
         0.077, -0.337,  0.568,  0.215,  0.205,  0.023, -0.190,  0.169,  0.399,
        -0.088,  0.167,  0.497, -0.155,  0.495, -0.265, -0.183, -0.743, -0.089,
        -0.200, -0.025, -0.030, -0.055,  0.140, -0.180,  0.139, -0.191,  0.292,
        -0.219,  0.305, -0.016,  0.229,  0.226, -0.044,  0.583,  0.049, -0.266,
        -0.027,  0.483,  0.292,  0.109,  0.096,  0.224,  0.219,  0.229, -0.307,
        -0.457,  0.069,  0.468, -0.297,  0.258, -0.044,  0.150, -0.042,  0.080,
        -0.085, -0.652, -0.002,  0.254, -0.208, -0.144,  0.170, -0.231, -0.210,
        -0.071, -0.040, -0.347, -0.361], device='cuda:0')
s after update for 1 param tensor([1.374, 1.818, 1.616, 1.159, 1.534, 1.733, 1.898, 1.833, 1.678, 1.080,
        1.725, 1.433, 1.831, 1.307, 1.572, 1.712, 1.555, 1.128, 1.813, 1.687,
        1.365, 1.988, 2.221, 1.076, 1.219, 1.767, 1.787, 1.618, 1.794, 1.917,
        1.510, 1.258, 1.710, 2.045, 1.989, 1.508, 2.041, 1.808, 1.339, 1.737,
        2.081, 2.127, 1.781, 1.834, 1.912, 1.144, 1.865, 1.442, 1.504, 1.855,
        1.670, 1.584, 1.951, 2.286, 1.485, 1.717, 1.901, 2.168, 1.180, 1.553,
        1.439, 1.664, 2.435, 2.226, 1.317, 2.208, 2.117, 1.434, 1.088, 1.685,
        1.783, 1.673, 0.988, 1.333, 1.580, 0.983, 1.922, 1.276, 1.550, 1.584,
        2.095, 1.548, 2.049, 1.848, 2.026, 1.418, 1.307, 2.431, 2.021, 1.309,
        2.100, 2.015, 1.632, 1.613, 2.457, 1.623, 2.031, 1.758, 1.745, 1.675,
        1.829, 1.975, 1.852, 1.562, 2.241, 1.994, 1.735, 1.470, 1.432, 1.606,
        1.472, 1.913, 1.012, 1.454, 2.067, 1.498, 1.748, 1.735, 1.778, 1.806,
        1.269, 1.317, 1.406, 1.429, 1.719, 1.697, 1.813, 1.519, 1.601, 1.783],
       device='cuda:0')
b after update for 1 param tensor([69.298, 79.720, 75.162, 63.654, 73.213, 77.816, 81.452, 80.031, 76.590,
        61.440, 77.656, 70.764, 79.998, 67.579, 74.131, 77.348, 73.729, 62.784,
        79.606, 76.796, 69.068, 83.360, 88.111, 61.328, 65.280, 78.584, 79.026,
        75.204, 79.187, 81.846, 72.636, 66.319, 77.317, 84.541, 83.369, 72.586,
        84.453, 79.483, 68.405, 77.907, 85.292, 86.218, 78.887, 80.067, 81.752,
        63.243, 80.728, 70.990, 72.506, 80.514, 76.403, 74.397, 82.582, 89.392,
        72.050, 77.474, 81.502, 87.047, 64.226, 73.661, 70.923, 76.260, 92.253,
        88.212, 67.849, 87.845, 86.017, 70.805, 61.660, 76.740, 78.936, 76.455,
        58.758, 68.247, 74.316, 58.614, 81.964, 66.788, 73.590, 74.411, 85.576,
        73.563, 84.628, 80.360, 84.155, 70.404, 67.595, 92.177, 84.043, 67.634,
        85.673, 83.919, 75.530, 75.073, 92.673, 75.321, 84.256, 78.389, 78.099,
        76.521, 79.944, 83.089, 80.450, 73.897, 88.491, 83.485, 77.863, 71.668,
        70.745, 74.916, 71.729, 81.762, 59.473, 71.279, 84.989, 72.358, 78.154,
        77.870, 78.824, 79.454, 66.606, 67.852, 70.090, 70.663, 77.510, 77.016,
        79.604, 72.856, 74.814, 78.929], device='cuda:0')
clipping threshold 1.3093512159718073
a after update for 1 param tensor([[[-0.153],
         [ 0.170],
         [-0.391],
         [ 0.126],
         [ 0.199],
         [ 0.137],
         [ 0.053],
         [-0.001],
         [-0.003],
         [ 0.161]],

        [[ 0.414],
         [ 0.076],
         [-0.405],
         [ 0.102],
         [ 0.125],
         [-0.046],
         [-0.661],
         [ 0.442],
         [-0.069],
         [-0.421]],

        [[ 0.066],
         [ 0.455],
         [ 0.011],
         [-0.274],
         [-0.195],
         [-0.336],
         [-0.423],
         [ 0.036],
         [-0.061],
         [ 0.245]],

        [[ 0.335],
         [ 0.390],
         [ 0.094],
         [-0.363],
         [ 0.064],
         [ 0.218],
         [-0.151],
         [-0.394],
         [-0.036],
         [ 0.037]],

        [[-0.318],
         [-0.556],
         [-0.257],
         [ 0.212],
         [-0.247],
         [-0.282],
         [ 0.440],
         [-0.001],
         [-0.371],
         [-0.127]],

        [[ 0.069],
         [-0.249],
         [-0.558],
         [-0.228],
         [ 0.195],
         [ 0.035],
         [ 0.329],
         [ 0.122],
         [-0.102],
         [-0.347]],

        [[-0.287],
         [-0.481],
         [-0.045],
         [-0.027],
         [-0.095],
         [-0.454],
         [-0.494],
         [-0.088],
         [ 0.016],
         [-0.178]],

        [[ 0.132],
         [-0.029],
         [ 0.062],
         [ 0.252],
         [-0.436],
         [-0.103],
         [-0.021],
         [-0.188],
         [ 0.186],
         [ 0.195]],

        [[-0.156],
         [-0.136],
         [ 0.457],
         [-0.472],
         [ 0.068],
         [ 0.207],
         [-0.248],
         [ 0.288],
         [-0.193],
         [ 0.289]],

        [[ 0.163],
         [-0.275],
         [ 0.373],
         [-0.082],
         [-0.357],
         [ 0.443],
         [ 0.007],
         [-0.768],
         [-0.148],
         [-0.120]],

        [[-0.034],
         [-0.512],
         [ 0.092],
         [-0.064],
         [-0.319],
         [ 0.210],
         [ 0.020],
         [ 0.283],
         [ 0.318],
         [-0.297]],

        [[ 0.125],
         [-0.728],
         [-0.492],
         [-0.099],
         [ 0.093],
         [ 0.017],
         [-0.099],
         [ 0.418],
         [ 0.338],
         [-0.381]],

        [[ 0.500],
         [-0.582],
         [-0.234],
         [ 0.055],
         [ 0.356],
         [ 0.361],
         [-0.173],
         [ 0.351],
         [-0.297],
         [ 0.240]]], device='cuda:0')
s after update for 1 param tensor([[[1.137],
         [2.172],
         [1.335],
         [1.326],
         [1.446],
         [1.421],
         [1.816],
         [1.301],
         [2.311],
         [1.009]],

        [[1.583],
         [1.514],
         [1.441],
         [1.896],
         [1.465],
         [1.673],
         [1.852],
         [2.000],
         [1.397],
         [2.468]],

        [[1.721],
         [0.958],
         [1.897],
         [1.454],
         [1.801],
         [1.960],
         [1.831],
         [1.284],
         [2.026],
         [1.162]],

        [[1.761],
         [1.731],
         [1.407],
         [2.176],
         [2.119],
         [1.252],
         [1.516],
         [1.888],
         [1.345],
         [1.827]],

        [[1.252],
         [1.764],
         [1.531],
         [1.856],
         [2.183],
         [1.618],
         [1.212],
         [1.777],
         [1.801],
         [1.869]],

        [[1.443],
         [0.854],
         [1.629],
         [1.674],
         [1.876],
         [1.647],
         [0.888],
         [1.779],
         [1.168],
         [2.175]],

        [[1.830],
         [2.236],
         [1.686],
         [1.902],
         [1.584],
         [1.676],
         [1.820],
         [1.802],
         [1.639],
         [2.085]],

        [[1.569],
         [1.679],
         [1.591],
         [1.650],
         [2.382],
         [1.578],
         [1.802],
         [2.057],
         [1.562],
         [1.116]],

        [[1.378],
         [0.929],
         [1.341],
         [1.388],
         [1.600],
         [1.505],
         [1.783],
         [1.450],
         [1.418],
         [2.049]],

        [[1.471],
         [1.818],
         [1.756],
         [1.466],
         [1.689],
         [1.949],
         [1.602],
         [1.827],
         [1.864],
         [1.859]],

        [[1.918],
         [1.913],
         [1.165],
         [1.619],
         [1.411],
         [1.526],
         [1.168],
         [2.001],
         [1.691],
         [1.994]],

        [[1.946],
         [1.780],
         [2.035],
         [1.506],
         [2.362],
         [1.604],
         [1.301],
         [1.657],
         [1.282],
         [1.693]],

        [[2.203],
         [1.081],
         [1.402],
         [1.697],
         [1.097],
         [1.747],
         [1.983],
         [1.266],
         [1.350],
         [1.987]]], device='cuda:0')
b after update for 1 param tensor([[[63.050],
         [87.123],
         [68.318],
         [68.067],
         [71.093],
         [70.484],
         [79.669],
         [67.429],
         [89.880],
         [59.394]],

        [[74.372],
         [72.743],
         [70.970],
         [81.411],
         [71.545],
         [76.457],
         [80.446],
         [83.616],
         [69.885],
         [92.864]],

        [[77.565],
         [57.877],
         [81.426],
         [71.290],
         [79.345],
         [82.759],
         [79.992],
         [66.977],
         [84.152],
         [63.734]],

        [[78.441],
         [77.786],
         [70.134],
         [87.205],
         [86.063],
         [66.153],
         [72.790],
         [81.240],
         [68.561],
         [79.906]],

        [[66.151],
         [78.513],
         [73.156],
         [80.531],
         [87.338],
         [75.210],
         [65.078],
         [78.804],
         [79.346],
         [80.814]],

        [[71.022],
         [54.622],
         [75.450],
         [76.493],
         [80.965],
         [75.877],
         [55.717],
         [78.850],
         [63.886],
         [87.178]],

        [[79.967],
         [88.395],
         [76.771],
         [81.530],
         [74.409],
         [76.524],
         [79.756],
         [79.355],
         [75.688],
         [85.357]],

        [[74.047],
         [76.614],
         [74.580],
         [75.931],
         [91.245],
         [74.271],
         [79.361],
         [84.782],
         [73.880],
         [62.448]],

        [[69.392],
         [56.966],
         [68.459],
         [69.640],
         [74.775],
         [72.535],
         [78.941],
         [71.183],
         [70.401],
         [84.618]],

        [[71.703],
         [79.712],
         [78.342],
         [71.579],
         [76.822],
         [82.537],
         [74.817],
         [79.915],
         [80.706],
         [80.605]],

        [[81.882],
         [81.759],
         [63.819],
         [75.232],
         [70.228],
         [73.030],
         [63.897],
         [83.633],
         [76.868],
         [83.481]],

        [[82.466],
         [78.868],
         [84.326],
         [72.549],
         [90.855],
         [74.879],
         [67.436],
         [76.095],
         [66.940],
         [76.924]],

        [[87.751],
         [61.479],
         [69.994],
         [77.014],
         [61.918],
         [78.129],
         [83.250],
         [66.507],
         [68.692],
         [83.328]]], device='cuda:0')
clipping threshold 1.3093512159718073
a after update for 1 param tensor([[-0.019],
        [ 0.372],
        [ 0.364],
        [-0.253],
        [-0.024],
        [-0.390],
        [-0.492],
        [-0.023],
        [ 0.300],
        [ 0.376],
        [ 0.106],
        [-0.277],
        [ 0.428]], device='cuda:0')
s after update for 1 param tensor([[1.757],
        [1.602],
        [1.834],
        [1.760],
        [2.336],
        [1.275],
        [1.953],
        [1.325],
        [1.605],
        [1.903],
        [1.387],
        [1.811],
        [1.500]], device='cuda:0')
b after update for 1 param tensor([[78.362],
        [74.836],
        [80.059],
        [78.419],
        [90.355],
        [66.760],
        [82.619],
        [68.047],
        [74.899],
        [81.561],
        [69.630],
        [79.564],
        [72.395]], device='cuda:0')
clipping threshold 1.3093512159718073
||w||^2 2.158346019922661
exp ma of ||w||^2 2.8032220615318932
||w|| 1.4691310424610398
exp ma of ||w|| 1.620569439164001
||w||^2 3.254171438975138
exp ma of ||w||^2 2.8753018185926957
||w|| 1.8039322157373703
exp ma of ||w|| 1.6375173146600517
||w||^2 1.2695133344457428
exp ma of ||w||^2 2.7107978070697736
||w|| 1.1267268233452787
exp ma of ||w|| 1.5936517777492436
||w||^2 4.735908781087132
exp ma of ||w||^2 2.8250671469316972
||w|| 2.176214323334706
exp ma of ||w|| 1.6208785889563184
||w||^2 1.9340079230272595
exp ma of ||w||^2 2.6096299021146128
||w|| 1.3906861339019885
exp ma of ||w|| 1.5575058499068384
||w||^2 2.619212936420971
exp ma of ||w||^2 2.879520706555824
||w|| 1.6183982626105884
exp ma of ||w|| 1.6431574446468686
||w||^2 2.8391193482710535
exp ma of ||w||^2 3.2966780125531554
||w|| 1.684968649046935
exp ma of ||w|| 1.77921964115069
||w||^2 4.28148044748883
exp ma of ||w||^2 4.361851288505842
||w|| 2.069173856274245
exp ma of ||w|| 2.063507002668965
||w||^2 2.6858368836089928
exp ma of ||w||^2 4.315741487464132
||w|| 1.6388523068321297
exp ma of ||w|| 2.043841168017246
||w||^2 4.960335163387982
exp ma of ||w||^2 5.57838900845484
||w|| 2.227180990262799
exp ma of ||w|| 2.3418600001734906
||w||^2 7.94961407525234
exp ma of ||w||^2 6.7520568517626955
||w|| 2.8195059984423407
exp ma of ||w|| 2.575337956415947
||w||^2 12.815696204406436
exp ma of ||w||^2 6.399801948138446
||w|| 3.57990170317656
exp ma of ||w|| 2.5041137426498556
||w||^2 29.758616387186986
exp ma of ||w||^2 28.731070877896904
||w|| 5.45514586305325
exp ma of ||w|| 5.2869064164773025
||w||^2 248.0138269865862
exp ma of ||w||^2 160.75336964595814
||w|| 15.748454749167811
exp ma of ||w|| 12.031999188591616
||w||^2 1640.5763262792084
exp ma of ||w||^2 937.8846808057245
||w|| 40.50402851913879
exp ma of ||w|| 28.789899405550443
||w||^2 19570.912938107107
exp ma of ||w||^2 19916.332314356147
||w|| 139.89607906623797
exp ma of ||w|| 137.9899134273731
||w||^2 4.1105364232773605
exp ma of ||w||^2 6.197327929448463
||w|| 2.02744578799961
exp ma of ||w|| 2.44202521028133
||w||^2 2.1979188968837846
exp ma of ||w||^2 4.507753016396065
||w|| 1.4825379917168344
exp ma of ||w|| 2.0634135215319547
||w||^2 3.713705742234264
exp ma of ||w||^2 3.89854996159001
||w|| 1.9270977510843252
exp ma of ||w|| 1.8964346272932664
||w||^2 1.0423208062350633
exp ma of ||w||^2 3.3456213734700007
||w|| 1.0209411374976831
exp ma of ||w|| 1.7407303365467743
||w||^2 6.963978867107256
exp ma of ||w||^2 3.135236472137157
||w|| 2.6389351767535434
exp ma of ||w|| 1.6837144201210554
||w||^2 2.0838375318724656
exp ma of ||w||^2 3.298622863973124
||w|| 1.443550321905151
exp ma of ||w|| 1.723047423773704
||w||^2 5.923294346324124
exp ma of ||w||^2 2.929319174495073
||w|| 2.4337819019633056
exp ma of ||w|| 1.6207788870221569
cuda
Objective function 21.10 = squared loss an data 17.89 + 0.5*rho*h**2 0.138328 + alpha*h 0.416430 + L2reg 2.48 + L1reg 0.18 ; SHD = 44 ; DAG True
Proportion of microbatches that were clipped  0.7779230038022814
iteration 2 in inner loop, alpha 250.3642445784689 rho 100000.0 h 0.0016632949951969067
iteration 4 in outer loop, alpha = 416.6937440981596, rho = 100000.0, h = 0.0016632949951969067
cuda
1963
cuda
Objective function 21.38 = squared loss an data 17.89 + 0.5*rho*h**2 0.138328 + alpha*h 0.693085 + L2reg 2.48 + L1reg 0.18 ; SHD = 44 ; DAG True
||w||^2 130318965.12554932
exp ma of ||w||^2 294805240025792.56
||w|| 11415.733227679653
exp ma of ||w|| 3619434.448973728
||w||^2 209.0384157123328
exp ma of ||w||^2 1195699017724.965
||w|| 14.458160868946395
exp ma of ||w|| 14714.031066725229
||w||^2 101.3555645404326
exp ma of ||w||^2 23027847823.128357
||w|| 10.067550076380678
exp ma of ||w|| 292.10978601998954
||w||^2 16.86128209641427
exp ma of ||w||^2 29699723.925810445
||w|| 4.106249151770296
exp ma of ||w|| 4.329819802786278
||w||^2 5.427273654205448
exp ma of ||w||^2 419.4872873128028
||w|| 2.329650972614878
exp ma of ||w|| 1.7933732368123534
||w||^2 2.3534679323188255
exp ma of ||w||^2 3.0194572741158137
||w|| 1.5341016694857044
exp ma of ||w|| 1.6625216831425458
||w||^2 4.754937387067667
exp ma of ||w||^2 3.0229709073492113
||w|| 2.180581891850812
exp ma of ||w|| 1.6709599181420776
||w||^2 2.3741563653738718
exp ma of ||w||^2 2.800045789132177
||w|| 1.5408297652154412
exp ma of ||w|| 1.6293767558627252
||w||^2 1.906142991961953
exp ma of ||w||^2 2.8893442838080654
||w|| 1.3806313743943215
exp ma of ||w|| 1.6534785900418825
||w||^2 2.39815577670694
exp ma of ||w||^2 3.2212683051607853
||w|| 1.5485980035848361
exp ma of ||w|| 1.736769558100285
v before min max tensor([[ 505.574,  -89.186,  -16.241,  ...,  393.440, -181.127, -121.992],
        [ 415.860, -120.588,  198.662,  ...,  -37.617, -108.539, -121.706],
        [-152.155,  914.964,  670.668,  ...,  -26.595, -175.181, 1175.680],
        ...,
        [-125.067, -108.460, 1184.897,  ..., -110.160, -124.906, -139.299],
        [   4.788,  -36.772, -143.055,  ...,  -66.031,  -42.882,   36.857],
        [-132.024,  -17.122,   -3.331,  ...,  -62.353,   19.781,  988.435]],
       device='cuda:0')
v tensor([[1.000e+01, 1.000e-12, 1.000e-12,  ..., 1.000e+01, 1.000e-12,
         1.000e-12],
        [1.000e+01, 1.000e-12, 1.000e+01,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [1.000e-12, 1.000e+01, 1.000e+01,  ..., 1.000e-12, 1.000e-12,
         1.000e+01],
        ...,
        [1.000e-12, 1.000e-12, 1.000e+01,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [4.788e+00, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e+01],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e+01,
         1.000e+01]], device='cuda:0')
v before min max tensor([-3.328e+01,  2.164e+02, -8.394e+01,  1.647e+01, -1.145e+02, -1.480e+02,
        -2.401e+01, -2.438e+00,  1.568e+02,  4.561e+01, -7.320e+01, -5.205e+01,
        -1.144e+02, -9.463e+01, -7.902e+01, -6.799e+01,  7.224e+02,  4.763e+02,
         4.048e+01, -7.105e+01, -1.079e+02, -8.665e+01, -6.343e+01, -1.389e+02,
        -1.997e+01, -9.002e+01,  2.702e+01,  4.417e+00, -9.535e-01, -1.079e+02,
         1.984e+02,  7.928e+02, -1.112e+02, -1.315e+02, -1.180e+01,  1.010e+02,
         6.348e+02, -1.109e+02, -6.611e+01, -8.206e+01,  3.920e+02, -5.376e+01,
        -1.087e+02, -5.854e+01, -1.243e+02, -8.488e+01, -1.577e+02, -2.172e+01,
         1.745e+02, -6.414e+01,  1.439e+02, -4.294e+01,  6.942e+01,  1.280e+02,
        -6.586e+01, -1.433e+02,  4.117e+02,  8.004e+01, -1.342e+02,  4.227e+02,
        -6.779e+01,  1.637e+01,  6.222e+00, -9.243e+01, -1.590e+02, -4.628e+01,
        -6.637e+01, -9.798e+01,  4.435e+02, -1.378e+02,  9.176e+01,  1.832e+02,
         7.529e+01, -1.370e+02,  1.159e+02, -1.075e+02, -9.630e+01, -7.235e+01,
        -2.462e+01, -8.615e+01, -8.369e+01,  1.280e+03, -7.289e+01, -8.704e+01,
        -1.012e+02, -1.474e+02, -1.223e+02, -1.162e+02, -1.181e+01,  2.724e+02,
        -1.271e+02, -1.150e+02,  6.392e+01, -1.044e+02, -4.100e+01, -6.705e+01,
        -8.277e+01,  8.588e+02, -8.676e+01, -1.358e+02, -1.480e+02,  2.010e+02,
        -4.334e+01, -1.424e+02, -2.181e+00, -7.898e+01, -8.513e+01, -1.285e+02,
        -3.012e+00, -1.150e+02,  3.148e+02, -1.264e+02,  2.670e+02, -6.186e+01,
         4.105e+02, -1.374e+01,  4.785e+01, -3.751e+01,  7.097e+01, -1.264e+02,
        -1.149e+02,  3.291e+02, -1.089e+02, -9.781e+01,  1.038e+02, -1.581e+02,
         2.242e+02,  1.679e+02, -1.148e+01, -8.154e+01], device='cuda:0')
v tensor([1.000e-12, 1.000e+01, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e+01,
        1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e+01, 4.417e+00, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01,
        1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e+01, 1.000e+01,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e+01, 1.000e-12, 1.000e+01,
        1.000e-12, 1.000e+01, 6.222e+00, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e+01, 1.000e+01,
        1.000e+01, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e+01, 1.000e+01, 1.000e-12, 1.000e-12], device='cuda:0')
v before min max tensor([[[ 197.544],
         [ 104.567],
         [-102.800],
         [ 127.413],
         [-120.044],
         [ -91.221],
         [ -60.671],
         [  98.929],
         [-117.272],
         [  21.953]],

        [[ 426.087],
         [-121.985],
         [ -20.865],
         [-100.339],
         [-135.090],
         [-109.694],
         [ -15.432],
         [ -67.164],
         [ 125.394],
         [-133.660]],

        [[  77.211],
         [-111.292],
         [-101.789],
         [ 272.353],
         [-101.286],
         [ -89.709],
         [-118.429],
         [ -12.884],
         [1990.855],
         [ -99.966]],

        [[ 311.125],
         [  11.705],
         [  14.163],
         [ -46.941],
         [   3.216],
         [-167.188],
         [  55.603],
         [-123.196],
         [ -17.941],
         [  59.508]],

        [[-106.677],
         [  42.967],
         [ -66.381],
         [ -29.025],
         [ -14.093],
         [ -33.609],
         [ 267.488],
         [  42.113],
         [-117.249],
         [  29.539]],

        [[ -32.715],
         [-102.840],
         [-110.520],
         [  21.586],
         [-130.647],
         [ -59.949],
         [ -61.060],
         [ -22.700],
         [ -80.960],
         [1250.024]],

        [[-121.201],
         [ -91.149],
         [ -19.118],
         [ 149.333],
         [ -40.198],
         [  33.918],
         [   8.419],
         [ 587.717],
         [ 177.392],
         [ -38.029]],

        [[-100.858],
         [ 438.600],
         [-155.353],
         [ 737.528],
         [-140.124],
         [-136.140],
         [ -96.896],
         [-113.924],
         [  74.080],
         [   7.473]],

        [[  -6.024],
         [-122.933],
         [-107.059],
         [ -12.989],
         [-153.615],
         [-155.701],
         [ -59.544],
         [-135.452],
         [-114.705],
         [ -46.900]],

        [[-128.985],
         [ -80.899],
         [ -92.272],
         [ -84.173],
         [-122.088],
         [-121.200],
         [ -45.526],
         [-124.408],
         [  43.586],
         [ -11.483]],

        [[  25.500],
         [ 116.670],
         [-136.099],
         [ -71.144],
         [ -73.224],
         [ -62.993],
         [ -18.245],
         [ -72.771],
         [  47.798],
         [ 572.213]],

        [[-128.982],
         [  38.677],
         [-116.365],
         [-144.394],
         [-125.383],
         [-109.101],
         [-168.167],
         [ -74.663],
         [ 152.898],
         [ -79.664]],

        [[ -54.920],
         [ -95.811],
         [-169.694],
         [ -79.765],
         [  77.654],
         [ -23.610],
         [  89.310],
         [  28.359],
         [-124.542],
         [-169.348]]], device='cuda:0')
v tensor([[[1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01]],

        [[1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12]],

        [[1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12]],

        [[1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [3.216e+00],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01]],

        [[1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [8.419e+00],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [7.473e+00]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12]],

        [[1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01]],

        [[1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12]]], device='cuda:0')
v before min max tensor([[ 3.950e+02],
        [-1.453e+02],
        [-1.302e+02],
        [-1.306e+02],
        [ 2.946e+02],
        [-2.905e+01],
        [ 5.600e+01],
        [-4.423e+01],
        [-1.373e+02],
        [-1.247e+02],
        [ 3.792e-01],
        [-5.089e+01],
        [ 8.184e+01]], device='cuda:0')
v tensor([[1.000e+01],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e+01],
        [1.000e-12],
        [1.000e+01],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [3.792e-01],
        [1.000e-12],
        [1.000e+01]], device='cuda:0')
a after update for 1 param tensor([[-0.086, -0.017, -0.054,  ..., -0.102, -0.139,  0.059],
        [ 0.050,  0.025,  0.076,  ...,  0.006, -0.122,  0.049],
        [-0.065,  0.013,  0.011,  ...,  0.126,  0.023, -0.073],
        ...,
        [ 0.029, -0.074, -0.053,  ...,  0.225,  0.033, -0.042],
        [-0.092, -0.073, -0.022,  ..., -0.136,  0.015,  0.018],
        [-0.038, -0.066, -0.049,  ..., -0.108, -0.054, -0.083]],
       device='cuda:0')
s after update for 1 param tensor([[2.451, 1.329, 2.004,  ..., 1.794, 2.513, 1.606],
        [2.328, 1.878, 2.590,  ..., 1.523, 2.621, 1.562],
        [1.975, 2.021, 2.028,  ..., 1.694, 2.141, 2.171],
        ...,
        [1.654, 2.205, 2.150,  ..., 1.383, 1.672, 2.028],
        [1.568, 1.705, 2.225,  ..., 1.115, 1.120, 2.233],
        [1.613, 2.078, 1.622,  ..., 1.142, 2.369, 2.454]], device='cuda:0')
b after update for 1 param tensor([[95.476, 70.312, 86.338,  ..., 81.681, 96.678, 77.279],
        [93.053, 83.564, 98.145,  ..., 75.250, 98.718, 76.219],
        [85.711, 86.690, 86.844,  ..., 79.359, 89.228, 89.856],
        ...,
        [78.416, 90.556, 89.408,  ..., 71.715, 78.854, 86.854],
        [76.371, 79.624, 90.968,  ..., 64.387, 64.544, 91.130],
        [77.458, 87.901, 77.659,  ..., 65.159, 93.862, 95.525]],
       device='cuda:0')
clipping threshold 1.4180128620740675
a after update for 1 param tensor([-0.073,  0.276,  0.096,  0.107, -0.056,  0.044,  0.293,  0.144,  0.294,
         0.097, -0.138, -0.004, -0.268,  0.175, -0.060, -0.047,  0.276, -0.088,
         0.053, -0.183, -0.220, -0.246,  0.003,  0.114, -0.220, -0.172,  0.140,
         0.154,  0.068, -0.191,  0.043,  0.044,  0.150, -0.213, -0.175,  0.212,
        -0.299,  0.039,  0.005,  0.230,  0.461,  0.120, -0.165, -0.003,  0.202,
        -0.228, -0.235,  0.002,  0.024, -0.002,  0.151, -0.154, -0.123,  0.209,
         0.049,  0.223, -0.104, -0.176, -0.222, -0.240, -0.044, -0.018,  0.246,
        -0.128,  0.193, -0.185, -0.339,  0.209, -0.024,  0.136,  0.261, -0.195,
        -0.023, -0.221, -0.353,  0.047, -0.004, -0.204, -0.155, -0.151, -0.022,
         0.063, -0.313, -0.093, -0.170, -0.139, -0.139,  0.261, -0.136, -0.532,
         0.066, -0.148,  0.137,  0.050,  0.015,  0.143, -0.040, -0.179,  0.224,
        -0.275,  0.094, -0.174, -0.091,  0.057,  0.379,  0.019,  0.131,  0.328,
         0.313,  0.297,  0.249,  0.040, -0.074, -0.006,  0.042,  0.106,  0.213,
         0.004,  0.056, -0.042, -0.033,  0.101, -0.104,  0.113, -0.098, -0.301,
         0.161,  0.181,  0.238,  0.214], device='cuda:0')
s after update for 1 param tensor([1.640, 2.107, 1.050, 1.821, 1.399, 1.854, 1.651, 1.469, 1.385, 1.695,
        1.585, 1.424, 1.585, 1.379, 1.334, 1.796, 2.096, 1.331, 1.630, 1.064,
        1.347, 1.790, 1.721, 1.805, 1.830, 1.455, 2.210, 1.681, 0.726, 1.780,
        1.758, 1.793, 1.729, 1.901, 1.618, 1.807, 1.981, 1.404, 1.540, 2.186,
        2.221, 1.995, 1.711, 1.769, 2.143, 1.959, 2.225, 1.463, 1.380, 1.153,
        2.306, 1.209, 1.806, 2.176, 1.786, 1.861, 2.002, 1.611, 1.735, 2.108,
        1.313, 1.774, 2.049, 1.444, 2.012, 1.194, 0.836, 2.034, 1.857, 2.002,
        1.964, 1.735, 1.810, 1.756, 1.736, 1.502, 1.645, 1.915, 1.598, 1.192,
        1.669, 2.118, 1.365, 1.062, 1.992, 1.813, 1.534, 1.431, 1.726, 2.018,
        1.652, 1.422, 1.464, 1.935, 1.492, 0.823, 1.048, 2.055, 1.082, 1.661,
        1.831, 2.019, 1.940, 1.783, 1.750, 2.292, 1.693, 1.793, 1.072, 1.521,
        1.831, 1.638, 1.876, 1.756, 2.080, 1.014, 1.834, 1.859, 2.049, 1.703,
        1.738, 1.989, 1.344, 1.607, 1.947, 2.244, 2.015, 2.477, 1.532, 1.088],
       device='cuda:0')
b after update for 1 param tensor([78.090, 88.517, 62.502, 82.285, 72.136, 83.040, 78.357, 73.916, 71.760,
        79.390, 76.776, 72.771, 76.773, 71.606, 70.443, 81.729, 88.295, 70.346,
        77.847, 62.911, 70.767, 81.583, 79.989, 81.939, 82.486, 73.554, 90.658,
        79.074, 51.954, 81.361, 80.859, 81.668, 80.178, 84.076, 77.570, 81.964,
        85.822, 72.248, 75.681, 90.165, 90.882, 86.127, 79.777, 81.100, 89.263,
        85.343, 90.960, 73.772, 71.645, 65.473, 92.608, 67.045, 81.960, 89.964,
        81.494, 83.187, 86.279, 77.404, 80.334, 88.537, 69.882, 81.227, 87.287,
        73.268, 86.505, 66.627, 55.749, 86.971, 83.094, 86.288, 85.458, 80.335,
        82.038, 80.813, 80.347, 74.733, 78.203, 84.387, 77.086, 66.580, 78.776,
        88.746, 71.236, 62.856, 86.077, 82.122, 75.530, 72.944, 80.122, 86.620,
        78.384, 72.722, 73.790, 84.832, 74.492, 55.325, 62.432, 87.414, 63.446,
        78.600, 82.508, 86.647, 84.937, 81.427, 80.678, 92.323, 79.335, 81.666,
        63.150, 75.199, 82.521, 78.047, 83.532, 80.812, 87.947, 61.395, 82.576,
        83.137, 87.298, 79.576, 80.403, 86.015, 70.686, 77.316, 85.100, 91.357,
        86.573, 95.981, 75.478, 63.623], device='cuda:0')
clipping threshold 1.4180128620740675
a after update for 1 param tensor([[[-0.223],
         [-0.274],
         [-0.079],
         [ 0.085],
         [-0.410],
         [ 0.060],
         [-0.188],
         [-0.408],
         [ 0.231],
         [-0.447]],

        [[-0.080],
         [ 0.062],
         [ 0.282],
         [-0.216],
         [ 0.209],
         [-0.180],
         [ 0.116],
         [ 0.087],
         [-0.146],
         [-0.018]],

        [[ 0.248],
         [-0.106],
         [ 0.169],
         [ 0.292],
         [-0.301],
         [-0.082],
         [ 0.248],
         [ 0.043],
         [-0.219],
         [-0.200]],

        [[ 0.203],
         [-0.155],
         [-0.250],
         [-0.031],
         [-0.067],
         [ 0.167],
         [-0.229],
         [ 0.306],
         [ 0.059],
         [ 0.142]],

        [[-0.150],
         [ 0.009],
         [-0.040],
         [ 0.095],
         [ 0.125],
         [ 0.020],
         [ 0.071],
         [ 0.118],
         [-0.058],
         [ 0.229]],

        [[-0.137],
         [ 0.090],
         [-0.005],
         [-0.066],
         [-0.317],
         [ 0.070],
         [ 0.231],
         [-0.200],
         [-0.179],
         [ 0.193]],

        [[-0.091],
         [-0.104],
         [-0.380],
         [ 0.225],
         [-0.339],
         [-0.214],
         [-0.024],
         [-0.113],
         [ 0.317],
         [-0.325]],

        [[-0.397],
         [-0.143],
         [-0.262],
         [-0.238],
         [-0.016],
         [ 0.278],
         [ 0.139],
         [ 0.017],
         [-0.305],
         [ 0.185]],

        [[-0.102],
         [ 0.193],
         [-0.031],
         [-0.084],
         [-0.337],
         [-0.132],
         [-0.036],
         [-0.014],
         [-0.386],
         [ 0.138]],

        [[-0.140],
         [ 0.292],
         [-0.018],
         [ 0.070],
         [-0.013],
         [ 0.172],
         [ 0.125],
         [-0.074],
         [ 0.170],
         [ 0.468]],

        [[ 0.358],
         [-0.018],
         [-0.002],
         [ 0.253],
         [ 0.190],
         [ 0.139],
         [ 0.229],
         [-0.061],
         [-0.055],
         [ 0.051]],

        [[ 0.240],
         [ 0.051],
         [-0.195],
         [ 0.238],
         [-0.266],
         [-0.071],
         [-0.149],
         [-0.214],
         [-0.398],
         [ 0.152]],

        [[-0.151],
         [ 0.044],
         [ 0.003],
         [-0.101],
         [ 0.164],
         [-0.119],
         [-0.124],
         [ 0.196],
         [-0.008],
         [-0.014]]], device='cuda:0')
s after update for 1 param tensor([[[1.853],
         [1.814],
         [1.570],
         [1.791],
         [1.765],
         [1.567],
         [1.961],
         [1.866],
         [1.537],
         [2.276]],

        [[1.795],
         [1.515],
         [1.191],
         [1.539],
         [1.731],
         [1.525],
         [2.243],
         [1.517],
         [1.896],
         [1.872]],

        [[1.984],
         [1.388],
         [1.546],
         [1.610],
         [1.368],
         [1.197],
         [1.494],
         [2.101],
         [2.006],
         [1.780]],

        [[1.888],
         [1.782],
         [1.844],
         [1.718],
         [1.492],
         [2.117],
         [2.025],
         [2.090],
         [1.590],
         [1.718]],

        [[1.766],
         [1.846],
         [1.238],
         [1.962],
         [1.875],
         [1.579],
         [2.046],
         [1.488],
         [1.432],
         [1.380]],

        [[1.512],
         [1.364],
         [1.842],
         [2.083],
         [1.596],
         [1.599],
         [1.224],
         [1.151],
         [1.539],
         [1.731]],

        [[1.876],
         [2.030],
         [2.251],
         [2.217],
         [2.080],
         [1.800],
         [1.995],
         [2.214],
         [2.249],
         [1.716]],

        [[1.748],
         [2.357],
         [2.094],
         [1.687],
         [1.713],
         [1.974],
         [1.500],
         [1.421],
         [1.239],
         [1.857]],

        [[1.582],
         [1.551],
         [1.400],
         [1.530],
         [1.875],
         [2.072],
         [1.390],
         [2.162],
         [1.533],
         [1.453]],

        [[1.728],
         [1.150],
         [1.258],
         [1.804],
         [1.957],
         [2.139],
         [1.694],
         [1.773],
         [1.928],
         [1.973]],

        [[2.176],
         [2.344],
         [1.828],
         [1.694],
         [0.899],
         [1.882],
         [1.074],
         [1.402],
         [1.997],
         [2.213]],

        [[1.775],
         [1.943],
         [1.496],
         [1.805],
         [1.543],
         [1.415],
         [2.105],
         [1.721],
         [1.964],
         [1.600]],

        [[1.918],
         [1.325],
         [2.127],
         [1.297],
         [1.843],
         [1.598],
         [2.021],
         [2.112],
         [1.558],
         [2.072]]], device='cuda:0')
b after update for 1 param tensor([[[83.015],
         [82.130],
         [76.399],
         [81.603],
         [81.014],
         [76.347],
         [85.392],
         [83.297],
         [75.599],
         [92.009]],

        [[81.706],
         [75.062],
         [66.548],
         [75.659],
         [80.226],
         [75.300],
         [91.336],
         [75.121],
         [83.960],
         [83.447]],

        [[85.899],
         [71.840],
         [75.832],
         [77.373],
         [71.328],
         [66.716],
         [74.541],
         [88.395],
         [86.370],
         [81.365]],

        [[83.789],
         [81.408],
         [82.817],
         [79.928],
         [74.486],
         [88.726],
         [86.781],
         [88.152],
         [76.898],
         [79.934]],

        [[81.036],
         [82.845],
         [67.839],
         [85.418],
         [83.502],
         [76.640],
         [87.222],
         [74.399],
         [72.974],
         [71.640]],

        [[74.976],
         [71.214],
         [82.773],
         [88.006],
         [77.047],
         [77.102],
         [67.462],
         [65.426],
         [75.662],
         [80.243]],

        [[83.520],
         [86.880],
         [91.495],
         [90.804],
         [87.948],
         [81.814],
         [86.140],
         [90.730],
         [91.452],
         [79.894]],

        [[80.637],
         [93.615],
         [88.250],
         [79.215],
         [79.805],
         [85.671],
         [74.693],
         [72.703],
         [67.892],
         [83.108]],

        [[76.692],
         [75.950],
         [72.153],
         [75.439],
         [83.505],
         [87.790],
         [71.886],
         [89.657],
         [75.501],
         [73.518]],

        [[80.159],
         [65.386],
         [68.390],
         [81.902],
         [85.310],
         [89.183],
         [79.363],
         [81.196],
         [84.671],
         [85.661]],

        [[89.952],
         [93.355],
         [82.449],
         [79.380],
         [57.833],
         [83.651],
         [63.209],
         [72.210],
         [86.170],
         [90.721]],

        [[81.246],
         [85.007],
         [74.599],
         [81.923],
         [75.758],
         [72.533],
         [88.487],
         [80.002],
         [85.454],
         [77.134]],

        [[84.465],
         [70.205],
         [88.939],
         [69.448],
         [82.789],
         [77.091],
         [86.684],
         [88.624],
         [76.109],
         [87.775]]], device='cuda:0')
clipping threshold 1.4180128620740675
a after update for 1 param tensor([[-0.124],
        [-0.341],
        [ 0.160],
        [-0.149],
        [-0.101],
        [ 0.095],
        [-0.162],
        [-0.091],
        [-0.022],
        [ 0.018],
        [ 0.055],
        [-0.208],
        [-0.043]], device='cuda:0')
s after update for 1 param tensor([[2.148],
        [1.790],
        [1.645],
        [1.638],
        [1.915],
        [1.624],
        [2.089],
        [1.311],
        [1.714],
        [2.076],
        [1.339],
        [1.404],
        [2.224]], device='cuda:0')
b after update for 1 param tensor([[89.366],
        [81.599],
        [78.213],
        [78.052],
        [84.391],
        [77.705],
        [88.134],
        [69.813],
        [79.845],
        [87.875],
        [70.576],
        [72.253],
        [90.953]], device='cuda:0')
clipping threshold 1.4180128620740675
||w||^2 3.798765205386882
exp ma of ||w||^2 3.576852742908979
||w|| 1.9490421250929602
exp ma of ||w|| 1.8589542315228542
||w||^2 1.9483772232363672
exp ma of ||w||^2 4.295071674419377
||w|| 1.3958428361518238
exp ma of ||w|| 2.036808775123773
||w||^2 6.524886745173999
exp ma of ||w||^2 3.8808078932609535
||w|| 2.554385786284836
exp ma of ||w|| 1.9301138188692146
||w||^2 9.385896135251308
exp ma of ||w||^2 4.44524048392044
||w|| 3.063640993205847
exp ma of ||w|| 2.0644781358074495
||w||^2 3.0399113731475835
exp ma of ||w||^2 4.265282878771116
||w|| 1.743534161738044
exp ma of ||w|| 2.035797086448964
||w||^2 3.628458323823229
exp ma of ||w||^2 4.372114617552508
||w|| 1.9048512602886423
exp ma of ||w|| 2.0625959888683894
||w||^2 6.212168193166446
exp ma of ||w||^2 5.962379399624549
||w|| 2.4924221538829343
exp ma of ||w|| 2.413294656224114
v before min max tensor([[  770.270,  4376.588,   529.684,  ...,  -400.326,   -15.174,
          -313.760],
        [  240.370,  -461.088, 13238.029,  ...,  -280.966,  3399.537,
          -241.345],
        [ -518.618,   438.729,  -296.219,  ...,  -465.161,  1671.007,
           -21.631],
        ...,
        [ -436.742,  -121.210,  1371.806,  ...,  -133.217,  1847.063,
            48.277],
        [ -248.432,  -256.594,  -295.186,  ...,   -46.100,   -69.167,
          4486.245],
        [ -308.347,  2051.074,  -293.220,  ...,   540.743,  -320.985,
          1927.515]], device='cuda:0')
v tensor([[1.000e+01, 1.000e+01, 1.000e+01,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [1.000e+01, 1.000e-12, 1.000e+01,  ..., 1.000e-12, 1.000e+01,
         1.000e-12],
        [1.000e-12, 1.000e+01, 1.000e-12,  ..., 1.000e-12, 1.000e+01,
         1.000e-12],
        ...,
        [1.000e-12, 1.000e-12, 1.000e+01,  ..., 1.000e-12, 1.000e+01,
         1.000e+01],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e+01],
        [1.000e-12, 1.000e+01, 1.000e-12,  ..., 1.000e+01, 1.000e-12,
         1.000e+01]], device='cuda:0')
v before min max tensor([-254.919, -425.528,  342.644,   11.926, -209.829,  455.255, -469.500,
        -365.862,  -96.672, 1011.140, -368.566,  887.597, -388.701, -330.522,
         910.785, -227.549, -233.075, -256.885, -337.284,  810.359, -418.482,
        -388.875, -332.252, -363.746,  237.276,  340.865, -381.870, -107.021,
         552.693, -448.506, -292.196, -641.536,  -21.799,  518.282, -443.005,
        -179.814, -479.736,  -92.997, -215.781, -311.954, -545.847, -500.768,
        -488.178, -343.891, -356.156, -229.965, -404.077, -414.670, -179.013,
         -32.411,  147.993, 1108.736, -443.643, -390.855, -183.453,  711.308,
         -99.365,   82.129, -461.709, -322.608, -181.920,  -29.449, -406.544,
        1019.470, -340.906, -363.971, 1490.706, -354.051, -350.676, -512.754,
        -308.133,  200.663, -362.579,   71.725, -403.966,  -34.381,    7.334,
        -421.628,  668.617, -374.900,   82.383, -559.597, -364.027,   -7.122,
         -52.131,  924.104,  -36.501, 1390.749, -112.863, -372.701,  744.155,
         132.694, -181.935,  265.362, -407.029, -406.072, -282.632, -492.556,
        -417.306,   76.369,   79.244, -258.599, -414.075, 1384.013,   38.683,
        -105.263,   93.601, -403.554, -114.286, -152.921, -159.350,  639.295,
        -467.035,  801.608,  606.662, -189.360,  253.989,  -15.012, -396.898,
        -382.179,  -15.249, -320.873, -233.044, -179.999, -431.631, -303.042,
        -499.713, -184.533,  -90.552, -360.909], device='cuda:0')
v tensor([1.000e-12, 1.000e-12, 1.000e+01, 1.000e+01, 1.000e-12, 1.000e+01,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e+01,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e+01, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01,
        1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 7.334e+00, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e+01, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e+01, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e+01, 1.000e+01, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e+01,
        1.000e+01, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12], device='cuda:0')
v before min max tensor([[[-516.142],
         [-364.620],
         [-281.969],
         [-517.654],
         [-356.929],
         [-464.619],
         [ -30.034],
         [-434.859],
         [-415.179],
         [ -74.580]],

        [[-414.894],
         [-518.182],
         [-467.324],
         [-259.886],
         [-217.822],
         [-449.898],
         [ -46.860],
         [  30.920],
         [-381.855],
         [  15.213]],

        [[1659.315],
         [ 140.366],
         [  53.135],
         [1027.115],
         [-141.806],
         [-403.701],
         [-398.609],
         [-323.537],
         [1797.892],
         [1489.761]],

        [[-571.635],
         [ -85.250],
         [-412.014],
         [-412.552],
         [ 725.146],
         [ -79.849],
         [-459.879],
         [-611.433],
         [  -6.064],
         [-494.910]],

        [[-288.380],
         [-114.882],
         [-370.050],
         [-323.772],
         [ 735.224],
         [-389.384],
         [ 586.535],
         [ -81.983],
         [-486.301],
         [-277.189]],

        [[ 215.021],
         [-377.477],
         [-511.431],
         [ -53.650],
         [-464.420],
         [-412.809],
         [-353.718],
         [-134.452],
         [-498.094],
         [-204.951]],

        [[-420.620],
         [-402.592],
         [-346.330],
         [-119.353],
         [-150.506],
         [-547.018],
         [-330.009],
         [-433.482],
         [-434.591],
         [-303.849]],

        [[ 494.250],
         [ 276.769],
         [-355.447],
         [-456.023],
         [-314.197],
         [ 848.443],
         [-172.722],
         [ 221.423],
         [-200.816],
         [-194.227]],

        [[  91.758],
         [-406.976],
         [ 457.886],
         [-278.668],
         [ 470.265],
         [ 360.243],
         [-463.818],
         [ 498.581],
         [-346.203],
         [-337.041]],

        [[-299.581],
         [-443.608],
         [-145.188],
         [-520.359],
         [-132.801],
         [-334.936],
         [-549.150],
         [-474.139],
         [-474.693],
         [ 413.623]],

        [[2672.395],
         [-310.133],
         [  63.892],
         [-155.562],
         [-398.493],
         [-463.941],
         [ 505.174],
         [-597.903],
         [-202.944],
         [ -50.246]],

        [[-381.887],
         [1059.875],
         [-431.265],
         [-488.767],
         [-187.602],
         [-541.787],
         [-442.451],
         [-577.128],
         [-271.783],
         [-531.746]],

        [[-343.721],
         [-432.071],
         [-458.543],
         [-416.141],
         [-550.460],
         [-119.084],
         [-522.976],
         [-531.074],
         [-530.189],
         [-461.211]]], device='cuda:0')
v tensor([[[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01]],

        [[1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01]],

        [[1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]]], device='cuda:0')
v before min max tensor([[-215.538],
        [-168.436],
        [ -45.708],
        [-147.724],
        [-427.454],
        [ 105.234],
        [-201.721],
        [-388.207],
        [-158.895],
        [-150.914],
        [-233.542],
        [-232.325],
        [-416.305]], device='cuda:0')
v tensor([[1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e+01],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12]], device='cuda:0')
a after update for 1 param tensor([[-3.561e-04, -1.986e-01,  7.041e-02,  ..., -3.622e-02, -1.040e-01,
          8.239e-02],
        [ 2.878e-03, -1.451e-01,  1.114e-01,  ..., -1.208e-01, -1.117e-01,
          2.393e-01],
        [-1.335e-01,  6.440e-02, -8.237e-03,  ..., -2.750e-02, -8.807e-02,
          8.400e-02],
        ...,
        [ 3.707e-02,  6.231e-02, -5.246e-02,  ..., -3.706e-02, -6.554e-02,
         -1.880e-02],
        [ 9.654e-02,  4.606e-02, -1.116e-01,  ...,  1.493e-01, -3.828e-02,
          2.279e-01],
        [ 1.004e-01,  2.083e-02,  1.837e-01,  ..., -1.767e-01,  4.326e-05,
         -8.333e-02]], device='cuda:0')
s after update for 1 param tensor([[1.881, 2.265, 2.529,  ..., 1.431, 2.285, 1.625],
        [2.272, 2.549, 2.559,  ..., 1.330, 2.750, 1.795],
        [1.958, 2.388, 1.967,  ..., 1.732, 2.475, 1.571],
        ...,
        [1.560, 1.691, 2.121,  ..., 1.786, 2.324, 2.601],
        [1.407, 1.961, 1.619,  ..., 1.809, 1.471, 2.452],
        [1.599, 2.144, 2.294,  ..., 1.925, 1.443, 2.382]], device='cuda:0')
b after update for 1 param tensor([[ 84.025,  92.205,  97.433,  ...,  73.303,  92.614,  78.116],
        [ 92.349,  97.824,  98.025,  ...,  70.667, 101.604,  82.101],
        [ 85.729,  94.676,  85.939,  ...,  80.646,  96.396,  76.809],
        ...,
        [ 76.539,  79.676,  89.242,  ...,  81.880,  93.401,  98.811],
        [ 72.692,  85.805,  77.952,  ...,  82.420,  74.304,  95.949],
        [ 77.482,  89.711,  92.796,  ...,  85.012,  73.604,  94.556]],
       device='cuda:0')
clipping threshold 2.60171355793113
a after update for 1 param tensor([-4.106e-01,  5.087e-01,  2.810e-01,  1.255e-01, -3.248e-01,  1.837e-01,
        -2.468e-01,  2.256e-02,  2.704e-01,  2.588e-01,  2.849e-01, -2.982e-01,
        -7.506e-02,  7.456e-02,  7.146e-02, -2.755e-01,  1.465e-01, -1.733e-01,
        -1.380e-01, -1.103e-01,  2.769e-01,  1.314e-01,  8.045e-02, -4.599e-03,
        -4.608e-02, -5.708e-01,  2.069e-01, -2.337e-01, -9.839e-02, -3.689e-01,
        -2.356e-01, -4.660e-01, -2.524e-02, -4.469e-01,  1.991e-01, -2.747e-01,
        -1.095e-01,  4.417e-02, -2.100e-01,  3.738e-01,  4.590e-01, -9.691e-02,
        -3.712e-01,  8.667e-02,  8.253e-02,  1.535e-01,  6.988e-02,  5.557e-02,
        -4.953e-02, -1.943e-01,  2.107e-01,  5.993e-02, -2.050e-01, -4.903e-02,
         2.838e-01, -1.123e-02, -1.819e-02,  1.709e-01,  1.149e-01,  4.445e-01,
         5.839e-02,  1.158e-01, -1.301e-01,  2.605e-01, -2.900e-01,  1.590e-01,
        -2.316e-01, -4.275e-01, -1.908e-01,  1.825e-01,  3.354e-01,  1.191e-01,
         3.241e-01,  3.102e-02,  1.935e-01, -4.161e-01, -3.047e-03, -7.101e-01,
        -7.427e-01, -5.181e-01,  3.125e-01, -2.947e-01, -1.918e-01,  1.851e-01,
        -3.072e-01, -1.531e-01, -1.403e-01,  4.246e-01,  5.131e-02, -7.121e-02,
         3.510e-01,  3.491e-03, -1.405e-01,  7.337e-02, -4.150e-01, -1.083e-02,
         2.383e-02, -6.482e-02,  1.437e-01,  2.600e-02,  1.019e-01,  1.925e-01,
        -3.127e-02,  4.264e-01,  8.597e-02, -2.355e-01,  2.414e-01,  3.744e-01,
         1.899e-02, -2.723e-01,  2.358e-01,  1.250e-01, -5.417e-02, -1.983e-01,
         8.305e-02, -8.661e-03,  4.397e-01,  4.934e-01,  3.836e-04, -3.300e-02,
         3.889e-01, -4.336e-01, -3.685e-01, -1.996e-01,  1.907e-01,  1.751e-01,
        -5.946e-01, -1.049e-01,  1.671e-01,  1.431e-01], device='cuda:0')
s after update for 1 param tensor([1.844, 1.579, 2.216, 1.993, 0.964, 1.538, 1.678, 1.318, 2.240, 2.002,
        1.990, 1.726, 1.968, 1.755, 2.112, 1.734, 1.615, 1.551, 1.434, 2.030,
        1.498, 1.421, 1.696, 1.586, 2.059, 2.421, 1.943, 1.815, 1.980, 2.242,
        1.220, 2.275, 2.236, 1.700, 1.683, 1.842, 1.963, 1.415, 1.160, 1.242,
        1.968, 1.827, 1.873, 1.223, 1.292, 1.324, 1.556, 1.470, 1.527, 1.559,
        2.131, 1.880, 1.961, 1.528, 2.176, 2.435, 1.873, 2.012, 1.886, 1.765,
        1.850, 1.254, 1.749, 1.625, 1.477, 1.413, 2.135, 1.325, 1.836, 1.982,
        1.748, 1.700, 1.791, 1.690, 1.658, 1.993, 1.532, 1.685, 2.334, 1.424,
        1.657, 2.014, 1.376, 1.862, 1.776, 2.554, 1.052, 1.912, 1.953, 1.359,
        2.227, 1.728, 1.181, 1.654, 2.009, 1.453, 1.151, 1.789, 1.899, 2.051,
        1.658, 1.308, 1.537, 1.906, 2.049, 1.547, 1.907, 1.601, 1.558, 1.468,
        1.255, 1.572, 1.655, 2.264, 1.766, 1.010, 1.909, 1.929, 1.736, 1.493,
        1.646, 1.605, 1.774, 1.732, 1.599, 1.134, 1.873, 1.594, 1.688, 1.349],
       device='cuda:0')
b after update for 1 param tensor([83.211, 76.995, 91.210, 86.493, 60.158, 75.976, 79.374, 70.351, 91.698,
        86.704, 86.445, 80.500, 85.959, 81.175, 89.045, 80.693, 77.873, 76.304,
        73.382, 87.291, 74.987, 73.042, 79.785, 77.171, 87.920, 95.345, 85.400,
        82.552, 86.208, 91.745, 67.673, 92.407, 91.618, 79.898, 79.488, 83.159,
        85.843, 72.882, 65.988, 68.287, 85.962, 82.825, 83.861, 67.774, 69.636,
        70.496, 76.431, 74.282, 75.726, 76.505, 89.437, 84.007, 85.805, 75.740,
        90.381, 95.612, 83.854, 86.905, 84.148, 81.409, 83.345, 68.623, 81.039,
        78.098, 74.458, 72.846, 89.519, 70.530, 83.013, 86.257, 81.017, 79.882,
        82.006, 79.645, 78.906, 86.503, 75.828, 79.539, 93.617, 73.120, 78.867,
        86.964, 71.874, 83.613, 81.660, 97.923, 62.839, 84.722, 85.630, 71.436,
        91.435, 80.534, 66.577, 78.797, 86.839, 73.854, 65.737, 81.948, 84.430,
        87.758, 78.886, 70.075, 75.971, 84.598, 87.707, 76.221, 84.618, 77.533,
        76.475, 74.229, 68.636, 76.822, 78.834, 92.184, 81.433, 61.578, 84.652,
        85.106, 80.723, 74.874, 78.605, 77.615, 81.600, 80.647, 77.477, 65.254,
        83.866, 77.349, 79.616, 71.172], device='cuda:0')
clipping threshold 2.60171355793113
a after update for 1 param tensor([[[-0.235],
         [ 0.009],
         [ 0.016],
         [-0.211],
         [-0.047],
         [ 0.110],
         [-0.228],
         [-0.224],
         [ 0.164],
         [-0.377]],

        [[ 0.214],
         [ 0.272],
         [-0.227],
         [-0.203],
         [ 0.019],
         [-0.059],
         [-0.604],
         [ 0.037],
         [ 0.419],
         [-0.167]],

        [[ 0.271],
         [ 0.034],
         [-0.436],
         [ 0.137],
         [-0.327],
         [-0.106],
         [ 0.421],
         [ 0.023],
         [-0.158],
         [ 0.123]],

        [[ 0.293],
         [-0.101],
         [ 0.204],
         [ 0.014],
         [ 0.321],
         [ 0.209],
         [-0.209],
         [ 0.075],
         [ 0.292],
         [ 0.180]],

        [[ 0.042],
         [-0.412],
         [ 0.342],
         [-0.098],
         [-0.088],
         [ 0.133],
         [ 0.110],
         [-0.209],
         [-0.466],
         [-0.248]],

        [[ 0.281],
         [ 0.203],
         [ 0.061],
         [-0.048],
         [ 0.055],
         [ 0.175],
         [-0.280],
         [ 0.216],
         [-0.236],
         [ 0.228]],

        [[ 0.018],
         [ 0.026],
         [-0.383],
         [-0.110],
         [-0.146],
         [-0.066],
         [-0.390],
         [-0.051],
         [-0.167],
         [-0.331]],

        [[-0.053],
         [ 0.159],
         [-0.227],
         [ 0.236],
         [-0.178],
         [-0.104],
         [ 0.051],
         [ 0.267],
         [-0.188],
         [-0.231]],

        [[ 0.202],
         [ 0.226],
         [ 0.027],
         [-0.086],
         [ 0.043],
         [-0.194],
         [ 0.137],
         [-0.107],
         [-0.344],
         [-0.026]],

        [[ 0.170],
         [-0.376],
         [ 0.374],
         [-0.379],
         [-0.112],
         [ 0.237],
         [-0.067],
         [-0.130],
         [ 0.102],
         [ 0.161]],

        [[ 0.172],
         [ 0.610],
         [-0.300],
         [ 0.323],
         [-0.057],
         [-0.024],
         [ 0.181],
         [-0.368],
         [ 0.333],
         [ 0.293]],

        [[ 0.308],
         [-0.097],
         [ 0.077],
         [ 0.425],
         [-0.109],
         [-0.195],
         [-0.084],
         [ 0.439],
         [ 0.420],
         [ 0.210]],

        [[ 0.124],
         [-0.017],
         [ 0.219],
         [-0.431],
         [ 0.201],
         [-0.260],
         [ 0.084],
         [-0.109],
         [ 0.101],
         [ 0.043]]], device='cuda:0')
s after update for 1 param tensor([[[1.830],
         [1.293],
         [1.522],
         [1.836],
         [1.743],
         [1.927],
         [1.934],
         [1.658],
         [1.951],
         [1.243]],

        [[1.482],
         [1.843],
         [1.676],
         [1.491],
         [1.808],
         [1.696],
         [1.148],
         [2.361],
         [1.516],
         [1.901]],

        [[1.783],
         [1.887],
         [2.133],
         [1.970],
         [1.401],
         [1.717],
         [1.443],
         [1.685],
         [2.418],
         [1.680]],

        [[2.085],
         [1.748],
         [1.744],
         [1.729],
         [2.406],
         [1.599],
         [1.699],
         [2.205],
         [1.148],
         [2.053]],

        [[1.554],
         [1.255],
         [1.349],
         [1.776],
         [1.922],
         [1.496],
         [1.621],
         [2.033],
         [2.159],
         [1.097]],

        [[1.990],
         [1.338],
         [1.817],
         [0.902],
         [1.649],
         [1.800],
         [1.441],
         [1.526],
         [1.777],
         [1.877]],

        [[1.513],
         [1.446],
         [1.409],
         [1.411],
         [1.778],
         [1.945],
         [1.817],
         [2.018],
         [1.545],
         [1.545]],

        [[1.716],
         [1.611],
         [1.261],
         [1.680],
         [1.835],
         [1.848],
         [1.510],
         [2.164],
         [0.993],
         [1.467]],

        [[1.780],
         [1.546],
         [1.864],
         [1.102],
         [1.696],
         [2.220],
         [1.668],
         [1.969],
         [1.284],
         [1.234]],

        [[1.460],
         [1.584],
         [1.993],
         [1.847],
         [1.955],
         [1.616],
         [1.950],
         [2.304],
         [1.747],
         [2.070]],

        [[1.812],
         [1.472],
         [1.774],
         [1.396],
         [1.602],
         [1.678],
         [1.740],
         [2.130],
         [2.149],
         [1.445]],

        [[1.382],
         [1.916],
         [1.543],
         [1.764],
         [2.199],
         [1.984],
         [1.770],
         [2.069],
         [1.452],
         [1.924]],

        [[1.241],
         [1.542],
         [2.236],
         [1.871],
         [1.963],
         [1.560],
         [1.864],
         [1.982],
         [1.985],
         [1.802]]], device='cuda:0')
b after update for 1 param tensor([[[82.896],
         [69.681],
         [75.584],
         [83.031],
         [80.897],
         [85.057],
         [85.221],
         [78.890],
         [85.589],
         [68.300]],

        [[74.584],
         [83.179],
         [79.319],
         [74.826],
         [82.385],
         [79.805],
         [65.645],
         [94.156],
         [75.451],
         [84.489]],

        [[81.807],
         [84.172],
         [89.486],
         [85.989],
         [72.533],
         [80.290],
         [73.613],
         [79.540],
         [95.274],
         [79.418]],

        [[88.472],
         [81.004],
         [80.909],
         [80.574],
         [95.044],
         [77.479],
         [79.872],
         [90.993],
         [65.646],
         [87.799]],

        [[76.376],
         [68.645],
         [71.169],
         [81.659],
         [84.953],
         [74.942],
         [78.012],
         [87.356],
         [90.024],
         [64.177]],

        [[86.429],
         [70.872],
         [82.598],
         [58.187],
         [78.673],
         [82.207],
         [73.546],
         [75.688],
         [81.679],
         [83.946]],

        [[75.377],
         [73.680],
         [72.739],
         [72.785],
         [81.711],
         [85.461],
         [82.601],
         [87.037],
         [76.153],
         [76.158]],

        [[80.255],
         [77.780],
         [68.813],
         [79.429],
         [82.999],
         [83.292],
         [75.292],
         [90.142],
         [61.061],
         [74.220]],

        [[81.744],
         [76.183],
         [83.662],
         [64.316],
         [79.790],
         [91.302],
         [79.144],
         [85.985],
         [69.416],
         [68.064]],

        [[74.041],
         [77.104],
         [86.500],
         [83.261],
         [85.675],
         [77.879],
         [85.553],
         [93.012],
         [80.990],
         [88.149]],

        [[82.471],
         [74.348],
         [81.606],
         [72.394],
         [77.561],
         [79.379],
         [80.829],
         [89.421],
         [89.822],
         [73.644]],

        [[72.039],
         [84.804],
         [76.115],
         [81.370],
         [90.851],
         [86.302],
         [81.506],
         [88.140],
         [73.820],
         [84.981]],

        [[68.262],
         [76.085],
         [91.612],
         [83.822],
         [85.853],
         [76.537],
         [83.645],
         [86.251],
         [86.330],
         [82.240]]], device='cuda:0')
clipping threshold 2.60171355793113
a after update for 1 param tensor([[-0.431],
        [-0.344],
        [-0.304],
        [-0.431],
        [ 0.217],
        [ 0.007],
        [-0.416],
        [-0.040],
        [ 0.190],
        [ 0.377],
        [ 0.094],
        [-0.275],
        [-0.082]], device='cuda:0')
s after update for 1 param tensor([[1.508],
        [1.379],
        [1.083],
        [1.735],
        [1.595],
        [1.650],
        [1.457],
        [1.565],
        [1.890],
        [1.667],
        [1.170],
        [1.430],
        [1.656]], device='cuda:0')
b after update for 1 param tensor([[75.249],
        [71.945],
        [63.758],
        [80.708],
        [77.385],
        [78.711],
        [73.955],
        [76.646],
        [84.243],
        [79.107],
        [66.280],
        [73.280],
        [78.852]], device='cuda:0')
clipping threshold 2.60171355793113
||w||^2 46.15176286246828
exp ma of ||w||^2 47.39005409914073
||w|| 6.793508877043459
exp ma of ||w|| 6.791438163412746
||w||^2 107846.54275916325
exp ma of ||w||^2 87209.76538042557
||w|| 328.3999737502475
exp ma of ||w|| 286.30263427675567
v before min max tensor([[-2.182e+02, -2.148e+02,  9.375e+01,  ..., -3.388e+02, -4.921e+02,
         -4.074e+02],
        [ 7.355e+02, -4.322e+02, -2.425e+02,  ..., -3.756e+01, -4.705e+01,
         -4.062e+02],
        [-1.082e+02,  5.269e+02,  3.282e+00,  ...,  1.226e+02, -6.149e+02,
          2.202e+03],
        ...,
        [ 3.210e+02, -3.814e+02,  8.445e+03,  ..., -6.591e+02,  2.743e+01,
         -3.483e+02],
        [-6.347e+02, -5.605e+02, -4.499e+02,  ..., -1.382e+02, -3.413e+02,
          1.741e+03],
        [ 1.286e+03, -1.971e+02, -6.635e+02,  ..., -7.876e+01, -6.305e+02,
          1.706e+03]], device='cuda:0')
v tensor([[1.000e-12, 1.000e-12, 1.000e+01,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [1.000e+01, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [1.000e-12, 1.000e+01, 3.282e+00,  ..., 1.000e+01, 1.000e-12,
         1.000e+01],
        ...,
        [1.000e+01, 1.000e-12, 1.000e+01,  ..., 1.000e-12, 1.000e+01,
         1.000e-12],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e+01],
        [1.000e+01, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e+01]], device='cuda:0')
v before min max tensor([-5.439e+02,  2.983e+02,  2.949e+02,  2.772e+02, -3.371e+02,  5.527e+02,
        -6.149e+02, -3.697e+02, -5.576e+02,  7.466e+03,  2.951e+03,  4.868e+03,
         4.686e+03,  2.300e+03, -4.325e+02, -7.097e+02, -6.427e+02,  1.853e+03,
        -6.278e+02, -2.304e+02, -6.522e+02,  5.734e+03,  5.025e+02,  1.052e+03,
         3.557e+02,  4.608e+03,  2.006e+02,  2.779e+03,  2.889e+02,  6.273e+03,
         3.350e+03,  3.657e+02, -6.035e+02,  3.171e+03, -7.507e+02,  2.745e+03,
         1.572e+02, -6.057e+02, -4.339e+02,  4.324e+02, -1.917e+02, -2.149e+02,
        -3.450e+02, -5.854e+02,  2.270e+03,  1.168e+03, -4.579e+02, -2.820e+02,
         4.444e+03,  5.111e+03,  6.494e+02,  6.903e+02, -4.657e+02,  4.416e+01,
         5.819e+02,  1.379e+03, -4.416e+02,  1.800e+03, -3.561e+02, -7.723e+02,
         1.832e+03,  8.925e+02,  1.676e+03, -7.560e+02, -1.272e+02,  5.655e+03,
         6.277e+02, -1.833e+01,  1.564e+03,  4.681e+02, -5.754e+02,  1.819e+03,
        -5.164e+02,  8.090e+03, -3.472e+02,  3.839e+03,  6.157e+02,  2.192e+03,
        -5.259e+02, -3.329e+02,  3.422e+03, -1.485e+02,  7.041e+00,  4.684e+02,
        -1.411e+02, -8.293e+02,  1.884e+04,  3.325e+03, -5.509e+02,  1.953e+03,
         1.359e+03,  9.697e+01,  3.151e+03, -2.084e+02, -2.942e+02,  9.250e-01,
         1.549e+03, -2.302e+02,  5.362e+03,  6.412e+02,  1.079e+02, -3.211e+02,
         6.636e+02, -3.735e+02, -7.897e+01, -6.502e+02,  2.769e+03,  7.907e+02,
         5.220e+03,  1.966e+02,  1.278e+02, -1.961e+02, -4.176e+02, -4.072e+02,
         8.402e+02, -5.025e+02,  7.688e+02,  2.769e+03,  6.397e+02, -8.355e+02,
         6.010e+03,  3.000e+04, -4.778e+02,  1.406e+03, -5.553e+02,  7.203e+03,
        -3.627e+02, -4.099e+02, -3.550e+02, -6.342e+02], device='cuda:0')
v tensor([1.000e-12, 1.000e+01, 1.000e+01, 1.000e+01, 1.000e-12, 1.000e+01,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e+01, 1.000e+01,
        1.000e+01, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e+01, 1.000e+01,
        1.000e+01, 1.000e+01, 1.000e+01, 1.000e+01, 1.000e+01, 1.000e+01,
        1.000e+01, 1.000e+01, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e+01,
        1.000e+01, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e+01, 1.000e+01, 1.000e+01, 1.000e-12, 1.000e+01,
        1.000e+01, 1.000e+01, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e+01, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e+01,
        1.000e+01, 1.000e-12, 1.000e+01, 1.000e+01, 1.000e-12, 1.000e+01,
        1.000e-12, 1.000e+01, 1.000e-12, 1.000e+01, 1.000e+01, 1.000e+01,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 7.041e+00, 1.000e+01,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e+01, 1.000e-12, 1.000e+01,
        1.000e+01, 1.000e+01, 1.000e+01, 1.000e-12, 1.000e-12, 9.250e-01,
        1.000e+01, 1.000e-12, 1.000e+01, 1.000e+01, 1.000e+01, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e+01,
        1.000e+01, 1.000e+01, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e+01, 1.000e+01, 1.000e+01, 1.000e-12,
        1.000e+01, 1.000e+01, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e+01,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12], device='cuda:0')
v before min max tensor([[[ 1.125e+01],
         [ 3.030e+01],
         [ 4.418e+03],
         [ 5.525e+02],
         [ 3.313e+03],
         [ 1.221e+04],
         [ 1.531e+03],
         [ 8.242e+03],
         [ 1.456e+02],
         [-6.680e+01]],

        [[-6.380e+02],
         [ 8.239e+02],
         [ 9.858e+03],
         [-4.019e+02],
         [ 6.211e+03],
         [ 1.636e+03],
         [-6.955e+02],
         [ 1.355e+03],
         [-4.759e+02],
         [ 8.093e+02]],

        [[-4.226e+02],
         [ 3.773e+03],
         [-2.634e+02],
         [ 4.650e+03],
         [ 5.313e+03],
         [-7.172e+02],
         [ 4.337e+02],
         [-1.943e+01],
         [-2.902e+02],
         [-3.950e+02]],

        [[-4.661e+02],
         [ 9.331e+03],
         [-4.936e+02],
         [ 1.981e+02],
         [-6.548e+02],
         [ 7.650e+03],
         [ 1.358e+04],
         [ 1.495e+03],
         [-6.737e+02],
         [-2.106e+02]],

        [[ 6.801e+02],
         [ 3.807e+03],
         [-4.884e+02],
         [ 4.204e+03],
         [ 9.057e+02],
         [ 3.044e+02],
         [-6.346e+02],
         [ 3.213e+03],
         [-5.979e+02],
         [ 3.119e+03]],

        [[ 5.092e+03],
         [ 3.624e+02],
         [-6.422e+02],
         [-4.549e+02],
         [ 2.866e+03],
         [ 9.849e+01],
         [-6.184e+02],
         [ 6.009e+01],
         [-5.569e+02],
         [ 1.298e+03]],

        [[-4.132e+02],
         [ 4.821e+02],
         [ 2.622e+01],
         [-6.059e+02],
         [-5.168e+01],
         [ 7.653e+02],
         [ 7.256e+03],
         [ 1.274e+03],
         [-6.630e+02],
         [ 5.875e+02]],

        [[ 1.101e+04],
         [ 4.381e+01],
         [ 8.965e+03],
         [ 2.016e+03],
         [-4.779e+02],
         [-1.856e+02],
         [ 1.237e+03],
         [-3.008e+02],
         [-4.070e+02],
         [ 2.259e+03]],

        [[ 1.276e+02],
         [ 3.097e+03],
         [ 4.208e+02],
         [ 2.533e+03],
         [ 2.196e+02],
         [ 2.483e+02],
         [-2.806e+02],
         [ 6.109e+02],
         [-6.406e+02],
         [-1.272e+02]],

        [[ 5.160e+02],
         [-9.730e+01],
         [-6.583e+02],
         [-6.025e+02],
         [-1.673e+02],
         [ 3.895e+02],
         [-5.156e+02],
         [ 5.089e+02],
         [-6.154e+02],
         [ 3.577e+02]],

        [[ 1.434e+01],
         [-4.352e+02],
         [-5.192e+02],
         [-5.731e+02],
         [ 7.773e+02],
         [ 8.510e+02],
         [ 7.739e+02],
         [ 7.469e+03],
         [ 5.663e+02],
         [ 6.882e+03]],

        [[ 8.267e+02],
         [ 1.333e+03],
         [ 3.034e+03],
         [ 2.377e+03],
         [ 5.143e+02],
         [ 1.476e+03],
         [-3.004e+02],
         [-1.058e+02],
         [ 5.866e+02],
         [-7.861e+02]],

        [[ 3.198e+03],
         [-8.005e+02],
         [ 4.762e+02],
         [ 2.143e+03],
         [ 1.467e+03],
         [ 2.121e+04],
         [ 1.863e+03],
         [ 2.589e+03],
         [-6.436e+02],
         [-5.610e+02]]], device='cuda:0')
v tensor([[[1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01]],

        [[1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01]],

        [[1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01]],

        [[1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01]],

        [[1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01]],

        [[1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01]],

        [[1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01]],

        [[1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12]],

        [[1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12]]], device='cuda:0')
v before min max tensor([[-477.347],
        [-880.340],
        [ 977.125],
        [8436.057],
        [-514.561],
        [-694.191],
        [-451.489],
        [-272.853],
        [-228.607],
        [-280.559],
        [-493.214],
        [1434.141],
        [ 909.429]], device='cuda:0')
v tensor([[1.000e-12],
        [1.000e-12],
        [1.000e+01],
        [1.000e+01],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e+01],
        [1.000e+01]], device='cuda:0')
a after update for 1 param tensor([[ 0.015, -0.147,  0.493,  ...,  0.703,  0.118,  1.984],
        [ 0.081,  0.544, -0.078,  ..., -0.718,  0.295, -3.944],
        [-0.251, -0.240, -0.354,  ...,  0.660,  0.289, -3.728],
        ...,
        [ 1.237,  0.114,  0.282,  ...,  0.232, -0.216,  0.012],
        [-1.511, -0.008, -0.119,  ...,  0.809,  0.079, -0.184],
        [-0.779,  0.344,  0.091,  ...,  0.375,  0.547, -0.083]],
       device='cuda:0')
s after update for 1 param tensor([[1.544, 1.988, 2.154,  ..., 1.554, 2.027, 2.124],
        [2.335, 1.678, 1.652,  ..., 1.659, 1.136, 2.030],
        [1.627, 2.209, 1.600,  ..., 2.167, 1.993, 2.528],
        ...,
        [2.021, 1.391, 2.387,  ..., 2.273, 2.167, 1.204],
        [2.077, 1.828, 1.554,  ..., 1.606, 1.202, 2.222],
        [1.807, 1.462, 2.232,  ..., 1.196, 2.090, 2.163]], device='cuda:0')
b after update for 1 param tensor([[ 79.160,  89.816,  93.475,  ...,  79.406,  90.679,  92.843],
        [ 97.333,  82.511,  81.876,  ...,  82.044,  67.880,  90.760],
        [ 81.258,  94.672,  80.563,  ...,  93.757,  89.932, 101.283],
        ...,
        [ 90.550,  75.113,  98.403,  ...,  96.029,  93.757,  69.900],
        [ 91.808,  86.117,  79.418,  ...,  80.711,  69.832,  94.948],
        [ 85.623,  77.017,  95.163,  ...,  69.649,  92.087,  93.679]],
       device='cuda:0')
clipping threshold 2.62420306185835
a after update for 1 param tensor([-11.639,   7.786,  -0.405,   1.587,  -6.539,   9.109,   5.223,   1.072,
        -17.918,  19.699,  -5.473,  -2.209,   7.812,   7.143,  -2.937,   8.329,
          2.832,  -6.514,  -5.698,   4.514,   3.248,  12.661,  -5.363,  16.901,
          2.104,  22.965,  -0.890,   9.901,  -1.139,  21.838,  10.433,   2.585,
          2.760, -12.101,  -8.671,  -8.941,   1.591,  12.187,   2.305,  -2.760,
        -10.913,  -8.715,  -4.990,   2.368,  -9.989,  12.291, -10.259,   2.727,
         13.453,   5.928,  -2.661,  -4.282,   0.380,  -3.576,   8.864, -11.245,
          4.974,  -4.262,  -3.364,  -6.864,   9.438,  -8.064,  -9.088,  -7.400,
          8.214,  -1.621,  -5.827,   1.373,   5.758,  11.112,   1.690, -13.220,
         -4.697,  10.227,  -3.239,   3.036, -10.326,  -8.901,  -0.819,  -1.817,
          8.015,   2.783,  -7.847,   9.136,  -4.622,   9.046,  16.411, -13.627,
         -6.799,   2.933,   8.069,   0.890,   6.721,  -3.516,   0.840,   8.964,
         -6.534,   2.067,  -8.141,   9.064, -11.091,  -1.521,   3.419,   4.799,
         -2.121,  -5.067, -17.721,   2.366,  12.051,  -3.555,  -4.827,   2.887,
         -2.790,  -0.514,   3.596,  -8.852,   8.098, -13.367,  -7.350,  -9.499,
         16.399,  17.534,   8.047,  -5.756,  -0.399, -15.921,   4.353,   0.660,
          1.106,  -8.234], device='cuda:0')
s after update for 1 param tensor([2.859, 2.501, 2.087, 1.934, 2.147, 2.913, 2.048, 1.578, 2.918, 3.154,
        2.666, 2.110, 2.717, 2.106, 1.595, 2.332, 2.118, 2.711, 2.038, 2.190,
        2.118, 3.097, 2.383, 3.154, 2.238, 3.162, 1.944, 2.648, 1.910, 3.162,
        2.897, 2.190, 2.127, 2.826, 2.516, 2.801, 1.734, 2.639, 1.472, 1.873,
        2.539, 2.486, 1.967, 1.933, 2.868, 3.061, 2.592, 1.892, 3.108, 2.019,
        2.334, 1.956, 1.620, 2.220, 2.746, 2.758, 2.199, 2.232, 2.134, 2.533,
        2.652, 2.402, 2.935, 2.452, 2.385, 2.442, 2.256, 1.421, 2.533, 2.994,
        2.065, 3.087, 1.914, 2.806, 1.387, 1.761, 2.843, 2.691, 1.713, 2.002,
        2.335, 1.659, 2.259, 2.715, 1.981, 2.737, 2.975, 2.941, 2.065, 1.726,
        2.775, 1.253, 2.333, 2.052, 1.658, 1.869, 2.556, 1.609, 2.643, 2.633,
        2.897, 2.074, 2.195, 2.170, 2.152, 2.245, 3.002, 2.159, 2.944, 1.955,
        2.222, 2.167, 1.609, 1.546, 2.377, 2.535, 2.629, 2.964, 2.563, 2.819,
        3.016, 3.000, 2.074, 2.513, 1.826, 2.959, 2.292, 1.403, 1.578, 2.726],
       device='cuda:0')
b after update for 1 param tensor([107.699, 100.728,  92.024,  88.585,  93.339, 108.717,  91.156,  80.011,
        108.815, 113.128, 103.997,  92.516, 104.987,  92.443,  80.434,  97.279,
         92.696, 104.878,  90.926,  94.262,  92.709, 112.093,  98.320, 113.116,
         95.286, 113.270,  88.801, 103.646,  88.026, 113.268, 108.415,  94.273,
         92.904, 107.083, 101.033, 106.599,  83.874, 103.482,  77.278,  87.165,
        101.501, 100.440,  89.345,  88.549, 107.869, 111.435, 102.554,  87.623,
        112.302,  90.515,  97.308,  89.096,  81.082,  94.910, 105.562, 105.786,
         94.449,  95.169,  93.048, 101.382, 103.740,  98.729, 109.133,  99.750,
         98.375,  99.540,  95.669,  75.926, 101.379, 110.214,  91.524, 111.909,
         88.117, 106.709,  75.024,  84.522, 107.400, 104.495,  83.371,  90.132,
         97.338,  82.052,  95.729, 104.958,  89.644, 105.377, 109.874, 109.245,
         91.535,  83.696, 106.117,  71.301,  97.294,  91.236,  82.031,  87.092,
        101.842,  80.803, 103.551, 103.361, 108.416,  91.738,  94.374,  93.826,
         93.446,  95.449, 110.357,  93.605, 109.298,  89.067,  94.954,  93.773,
         80.803,  79.212,  98.198, 101.412, 103.283, 109.655, 101.975, 106.944,
        110.619, 110.336,  91.739, 100.973,  86.071, 109.576,  96.429,  75.440,
         80.029, 105.172], device='cuda:0')
clipping threshold 2.62420306185835
a after update for 1 param tensor([[[-12.789],
         [  9.655],
         [-14.241],
         [  5.719],
         [  3.464],
         [-15.853],
         [  3.148],
         [-11.865],
         [  2.044],
         [ -1.064]],

        [[ -6.048],
         [  3.208],
         [-17.732],
         [  2.493],
         [ 12.864],
         [ -8.327],
         [  6.167],
         [  6.814],
         [  0.246],
         [  9.528]],

        [[ -4.584],
         [-12.901],
         [ -5.734],
         [ 10.354],
         [-11.702],
         [ -7.125],
         [ -4.693],
         [  1.159],
         [ -4.587],
         [  0.033]],

        [[  2.108],
         [ 11.387],
         [  0.551],
         [  6.596],
         [ -3.209],
         [ 11.482],
         [ 19.443],
         [ -2.994],
         [ 10.101],
         [ -0.670]],

        [[ -5.996],
         [ 14.670],
         [ -4.412],
         [ -8.874],
         [ -3.914],
         [ -4.939],
         [ -4.750],
         [  6.981],
         [ -2.464],
         [  7.572]],

        [[ -6.355],
         [  9.576],
         [ -6.415],
         [  3.331],
         [ -8.155],
         [-12.851],
         [  4.872],
         [  1.052],
         [ -0.466],
         [  4.994]],

        [[ -2.283],
         [  9.054],
         [ -4.097],
         [ -1.338],
         [ -5.039],
         [ -0.994],
         [ 16.481],
         [  6.662],
         [  0.429],
         [  5.928]],

        [[ 21.720],
         [-10.057],
         [ 13.694],
         [ -2.170],
         [ -4.760],
         [  6.774],
         [ 11.552],
         [  3.502],
         [ -1.572],
         [  7.816]],

        [[  0.540],
         [  6.198],
         [ 10.421],
         [-13.625],
         [  0.548],
         [ -7.831],
         [  2.609],
         [ -6.719],
         [  9.112],
         [ -3.308]],

        [[ -3.248],
         [ -3.407],
         [  2.497],
         [  0.760],
         [  2.540],
         [  8.254],
         [  1.167],
         [ -0.818],
         [  4.756],
         [ -0.235]],

        [[  7.224],
         [ -9.814],
         [-12.415],
         [  4.929],
         [ -6.826],
         [ -1.687],
         [ -7.274],
         [-12.347],
         [ -2.115],
         [ -8.695]],

        [[ -1.786],
         [ -8.060],
         [ -7.231],
         [  5.594],
         [ -4.821],
         [ -5.040],
         [ -0.941],
         [ -4.931],
         [-12.563],
         [ 10.703]],

        [[  9.841],
         [  7.931],
         [ -1.131],
         [-19.854],
         [  3.959],
         [ 30.225],
         [-10.367],
         [ -4.392],
         [ -5.236],
         [ -1.416]]], device='cuda:0')
s after update for 1 param tensor([[[2.836],
         [2.726],
         [2.842],
         [2.145],
         [2.291],
         [3.005],
         [2.290],
         [2.846],
         [1.708],
         [1.120]],

        [[2.698],
         [1.982],
         [3.155],
         [1.350],
         [2.937],
         [2.239],
         [2.263],
         [2.324],
         [1.545],
         [2.703]],

        [[1.962],
         [3.083],
         [2.183],
         [2.771],
         [2.720],
         [2.575],
         [2.164],
         [1.601],
         [2.355],
         [1.906]],

        [[1.655],
         [2.821],
         [1.806],
         [2.325],
         [2.289],
         [2.849],
         [3.129],
         [2.117],
         [2.659],
         [1.288]],

        [[2.337],
         [2.905],
         [1.629],
         [2.423],
         [2.102],
         [1.922],
         [2.198],
         [2.299],
         [1.938],
         [2.725]],

        [[2.455],
         [2.802],
         [2.409],
         [2.545],
         [2.279],
         [2.642],
         [2.215],
         [1.692],
         [1.857],
         [2.376]],

        [[1.764],
         [2.484],
         [2.751],
         [1.981],
         [1.789],
         [1.921],
         [2.816],
         [2.847],
         [2.240],
         [2.315]],

        [[3.162],
         [2.867],
         [2.750],
         [2.123],
         [2.101],
         [2.487],
         [3.042],
         [1.760],
         [1.327],
         [2.956]],

        [[2.039],
         [2.708],
         [3.078],
         [3.132],
         [1.968],
         [2.147],
         [1.770],
         [2.317],
         [2.482],
         [2.296]],

        [[2.443],
         [2.329],
         [2.173],
         [2.208],
         [1.962],
         [2.492],
         [2.081],
         [2.011],
         [2.100],
         [1.804]],

        [[2.695],
         [2.477],
         [2.910],
         [2.138],
         [2.712],
         [2.282],
         [2.448],
         [2.889],
         [1.682],
         [2.528]],

        [[1.904],
         [2.700],
         [2.479],
         [2.439],
         [2.336],
         [2.509],
         [1.959],
         [2.047],
         [3.010],
         [2.602]],

        [[2.893],
         [2.600],
         [1.803],
         [3.004],
         [2.064],
         [3.162],
         [2.825],
         [2.430],
         [2.261],
         [1.906]]], device='cuda:0')
b after update for 1 param tensor([[[107.265],
         [105.160],
         [107.381],
         [ 93.286],
         [ 96.416],
         [110.415],
         [ 96.393],
         [107.451],
         [ 83.253],
         [ 67.412]],

        [[104.619],
         [ 89.665],
         [113.136],
         [ 74.007],
         [109.169],
         [ 95.307],
         [ 95.831],
         [ 97.100],
         [ 79.188],
         [104.730]],

        [[ 89.219],
         [111.835],
         [ 94.117],
         [106.029],
         [105.057],
         [102.207],
         [ 93.713],
         [ 80.588],
         [ 97.746],
         [ 87.938]],

        [[ 81.944],
         [106.989],
         [ 85.600],
         [ 97.121],
         [ 96.375],
         [107.515],
         [112.671],
         [ 92.689],
         [103.867],
         [ 72.301]],

        [[ 97.383],
         [108.560],
         [ 81.302],
         [ 99.156],
         [ 92.346],
         [ 88.304],
         [ 94.441],
         [ 96.588],
         [ 88.676],
         [105.144]],

        [[ 99.802],
         [106.630],
         [ 98.863],
         [101.628],
         [ 96.164],
         [103.540],
         [ 94.806],
         [ 82.858],
         [ 86.792],
         [ 98.191]],

        [[ 84.607],
         [100.391],
         [105.658],
         [ 89.659],
         [ 85.197],
         [ 88.285],
         [106.898],
         [107.484],
         [ 95.333],
         [ 96.925]],

        [[113.267],
         [107.862],
         [105.630],
         [ 92.815],
         [ 92.340],
         [100.454],
         [111.104],
         [ 84.500],
         [ 73.371],
         [109.511]],

        [[ 90.962],
         [104.823],
         [111.761],
         [112.720],
         [ 89.358],
         [ 93.337],
         [ 84.744],
         [ 96.951],
         [100.357],
         [ 96.514]],

        [[ 99.551],
         [ 97.201],
         [ 93.908],
         [ 94.648],
         [ 89.214],
         [100.550],
         [ 91.892],
         [ 90.341],
         [ 92.305],
         [ 85.565]],

        [[104.567],
         [100.243],
         [108.664],
         [ 93.142],
         [104.907],
         [ 96.228],
         [ 99.655],
         [108.267],
         [ 82.603],
         [101.287]],

        [[ 87.890],
         [104.669],
         [100.288],
         [ 99.484],
         [ 97.360],
         [100.893],
         [ 89.155],
         [ 91.143],
         [110.515],
         [102.749]],

        [[108.335],
         [102.714],
         [ 85.524],
         [110.404],
         [ 91.517],
         [113.271],
         [107.063],
         [ 99.299],
         [ 95.777],
         [ 87.941]]], device='cuda:0')
clipping threshold 2.62420306185835
a after update for 1 param tensor([[  9.542],
        [ 14.180],
        [ 11.165],
        [-13.683],
        [ -2.133],
        [  6.905],
        [ 12.410],
        [ -1.553],
        [  0.235],
        [  4.316],
        [ -8.212],
        [ -8.891],
        [  7.509]], device='cuda:0')
s after update for 1 param tensor([[2.505],
        [2.882],
        [2.646],
        [2.922],
        [1.899],
        [2.250],
        [2.848],
        [1.382],
        [1.846],
        [2.010],
        [2.385],
        [2.519],
        [2.630]], device='cuda:0')
b after update for 1 param tensor([[100.809],
        [108.135],
        [103.613],
        [108.893],
        [ 87.786],
        [ 95.554],
        [107.491],
        [ 74.886],
        [ 86.551],
        [ 90.311],
        [ 98.380],
        [101.099],
        [103.298]], device='cuda:0')
clipping threshold 2.62420306185835
||w||^2 5.6357555087159685
exp ma of ||w||^2 8.959381362912897
||w|| 2.3739746225930825
exp ma of ||w|| 2.9571271015302987
||w||^2 2.793893666793945
exp ma of ||w||^2 5.358384472210723
||w|| 1.6714944411495796
exp ma of ||w|| 2.2516465510082933
||w||^2 5.319337544219284
exp ma of ||w||^2 4.458716990491237
||w|| 2.306368908960421
exp ma of ||w|| 2.042770066653408
||w||^2 2.5439861975465745
exp ma of ||w||^2 4.72590888694899
||w|| 1.5949878361751146
exp ma of ||w|| 2.0475908086757926
v before min max tensor([[-198.667,   67.749, -165.625,  ...,  -77.112,  -58.601, -103.509],
        [-110.484, -226.209, -236.700,  ...,    4.264, -199.900,  235.409],
        [ -38.268, -180.906,  591.189,  ...,  224.157,  -82.795, -124.121],
        ...,
        [ -27.364,  -59.456, -143.987,  ..., -134.767,  -98.269, -184.570],
        [-182.825,  -13.660,  -99.276,  ...,   11.628,  -43.049, -151.625],
        [ 138.547,  -60.703,  884.086,  ...,  495.403,   -3.169, -164.056]],
       device='cuda:0')
v tensor([[1.000e-12, 1.000e+01, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 4.264e+00, 1.000e-12,
         1.000e+01],
        [1.000e-12, 1.000e-12, 1.000e+01,  ..., 1.000e+01, 1.000e-12,
         1.000e-12],
        ...,
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e+01, 1.000e-12,
         1.000e-12],
        [1.000e+01, 1.000e-12, 1.000e+01,  ..., 1.000e+01, 1.000e-12,
         1.000e-12]], device='cuda:0')
v before min max tensor([-1.883e+02, -2.114e+02, -1.815e+02, -7.300e+01, -1.492e+02, -1.518e+02,
        -2.050e+02, -1.570e+02,  2.494e+03,  6.388e+01, -1.812e+02, -1.316e+02,
        -2.231e+02,  6.847e+02, -1.926e+02,  1.167e+02, -1.159e+02, -1.642e+02,
        -1.473e+02, -1.855e+02, -1.496e+02, -1.962e+02, -1.888e+02,  1.075e+03,
        -4.968e+01,  1.035e+03, -1.259e+02, -2.671e+02, -1.197e+02,  2.796e+02,
         7.278e+02,  4.299e+02, -1.968e+02,  1.063e+03, -2.541e+02,  1.709e+02,
         4.906e+01,  3.029e+02,  5.871e+02, -1.493e+02,  1.202e+03, -2.387e+02,
        -1.771e+02, -3.939e+01,  6.828e+01,  1.546e+01,  1.064e+02, -1.192e+02,
         7.745e+01,  1.369e+02, -1.287e+02, -1.941e+02, -8.266e+01,  5.483e+01,
        -2.714e+01, -8.792e+01, -1.574e+02,  1.426e+03,  2.194e+02, -1.010e+02,
         9.854e+01, -5.282e+01,  5.398e+02, -1.954e+02, -1.431e+02, -1.607e+02,
        -2.109e+02, -3.774e+01, -2.086e+02,  1.116e+02, -1.556e+02, -4.052e+01,
        -1.749e+02,  8.246e+02, -1.759e+02,  3.614e+02,  2.115e+02, -2.122e+02,
        -7.711e+01,  6.679e+01, -5.773e+01, -1.516e+02, -1.758e+02,  2.532e+02,
         3.469e+02, -1.289e+02, -5.946e+01,  8.943e+02,  3.440e+01, -6.396e+01,
        -1.705e+01, -1.406e+02, -1.007e+02, -9.961e+01, -5.596e+01,  8.320e+02,
         8.402e+02, -1.023e+02, -1.975e+02,  7.549e+01,  3.859e+02, -1.200e+02,
         1.379e+02, -5.988e+01, -1.830e+02, -1.726e+02, -2.645e+02, -1.882e+00,
        -1.777e+02, -1.672e+02, -2.158e+02, -1.319e+02,  7.998e+01, -1.032e+02,
         8.944e+01,  1.499e+03, -2.190e+02, -3.059e+01, -3.259e+01, -3.628e+01,
         7.690e+02,  9.736e+02,  1.989e+03, -2.267e+02, -9.519e+01,  7.883e+02,
         3.711e+02, -1.526e+02, -1.616e+02,  3.059e+02], device='cuda:0')
v tensor([1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e+01, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01,
        1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01,
        1.000e+01, 1.000e+01, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e+01,
        1.000e+01, 1.000e+01, 1.000e+01, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e+01, 1.000e+01, 1.000e-12,
        1.000e+01, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e+01, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e+01, 1.000e-12, 1.000e+01, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01,
        1.000e+01, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01,
        1.000e+01, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e+01, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e+01, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e+01, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e+01,
        1.000e+01, 1.000e-12, 1.000e-12, 1.000e+01], device='cuda:0')
v before min max tensor([[[-4.507e+00],
         [ 2.313e+02],
         [-2.743e+02],
         [ 2.745e+02],
         [-2.232e+02],
         [ 1.039e+03],
         [ 2.461e+02],
         [-1.856e+02],
         [ 6.962e+01],
         [-1.231e+02]],

        [[ 1.019e+02],
         [ 8.160e+02],
         [-1.213e+02],
         [-1.427e+02],
         [ 1.985e+03],
         [ 2.691e+02],
         [-1.296e+02],
         [ 1.850e+02],
         [ 8.767e+02],
         [ 1.462e+02]],

        [[-1.422e+02],
         [ 3.565e+01],
         [-1.361e+02],
         [ 1.481e+02],
         [-1.224e+02],
         [ 5.576e+02],
         [-9.281e+01],
         [ 6.913e+01],
         [ 3.282e+01],
         [ 3.837e+02]],

        [[-1.607e+02],
         [ 1.296e+02],
         [-1.312e+02],
         [-1.704e+02],
         [ 1.152e+02],
         [ 5.656e+02],
         [ 2.210e+03],
         [-2.357e+02],
         [ 1.683e+02],
         [-1.620e+02]],

        [[ 1.343e+02],
         [ 2.279e+03],
         [ 2.702e+02],
         [ 1.181e+02],
         [-1.264e+02],
         [-1.000e+02],
         [-1.121e+02],
         [-2.072e+02],
         [ 1.744e+02],
         [ 7.408e+02]],

        [[-1.482e+02],
         [ 5.588e+02],
         [ 1.092e+02],
         [-7.171e+01],
         [ 7.338e+01],
         [ 1.371e+02],
         [ 2.646e+02],
         [ 3.279e+02],
         [ 2.732e+02],
         [ 2.134e+02]],

        [[-9.525e+01],
         [-1.818e+02],
         [-1.704e+02],
         [ 2.395e+02],
         [ 6.250e+02],
         [-1.332e+02],
         [ 8.075e+02],
         [ 2.874e+02],
         [-2.221e+02],
         [-2.110e+02]],

        [[ 2.715e+03],
         [-1.545e+02],
         [ 2.887e+02],
         [-2.669e+00],
         [-7.534e+01],
         [-2.444e+02],
         [-4.616e+01],
         [ 3.757e+02],
         [ 2.265e+01],
         [-4.772e+01]],

        [[ 2.254e+02],
         [-1.625e+02],
         [ 5.523e+01],
         [ 1.364e+03],
         [ 5.892e+02],
         [-2.265e+02],
         [-1.460e+02],
         [ 1.751e+02],
         [ 4.894e+02],
         [ 2.820e+02]],

        [[ 7.941e+01],
         [ 8.054e+01],
         [-1.230e+02],
         [ 6.279e+02],
         [ 4.848e+02],
         [ 7.106e+02],
         [-1.163e+02],
         [-1.465e+02],
         [ 1.398e+01],
         [-1.457e+02]],

        [[-6.136e+01],
         [-1.562e+02],
         [ 3.727e+01],
         [-1.811e+02],
         [-1.497e+02],
         [-7.375e+01],
         [ 1.345e+01],
         [-2.936e+02],
         [-5.503e+01],
         [-2.108e+02]],

        [[ 1.909e+02],
         [-2.480e+02],
         [ 7.441e+02],
         [-1.350e+02],
         [-8.279e+01],
         [ 2.131e+02],
         [-1.753e+02],
         [-1.063e+02],
         [ 2.690e+03],
         [-2.184e+02]],

        [[ 3.968e+02],
         [ 9.739e+02],
         [-3.868e+01],
         [ 1.033e+03],
         [-1.297e+02],
         [ 1.548e+03],
         [ 3.389e+02],
         [ 4.567e+02],
         [-2.252e+01],
         [-9.751e+01]]], device='cuda:0')
v tensor([[[1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12]],

        [[1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01]],

        [[1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01]],

        [[1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12]],

        [[1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01]],

        [[1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12]],

        [[1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01]],

        [[1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12]],

        [[1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12]]], device='cuda:0')
v before min max tensor([[  68.186],
        [ 987.979],
        [ -21.107],
        [  62.415],
        [ 415.660],
        [-104.300],
        [ 830.638],
        [-204.056],
        [ 225.730],
        [ 202.072],
        [ -51.392],
        [-225.826],
        [ 173.524]], device='cuda:0')
v tensor([[1.000e+01],
        [1.000e+01],
        [1.000e-12],
        [1.000e+01],
        [1.000e+01],
        [1.000e-12],
        [1.000e+01],
        [1.000e-12],
        [1.000e+01],
        [1.000e+01],
        [1.000e-12],
        [1.000e-12],
        [1.000e+01]], device='cuda:0')
a after update for 1 param tensor([[-0.037,  0.014,  0.165,  ...,  0.005,  0.088,  0.914],
        [-0.106, -0.008,  0.160,  ..., -0.589, -0.020, -1.333],
        [-0.142, -0.055, -0.154,  ..., -0.018,  0.037, -1.548],
        ...,
        [ 0.110,  0.151,  0.074,  ..., -0.137, -0.182,  0.097],
        [-0.712,  0.158, -0.171,  ..., -0.170,  0.178, -0.072],
        [-0.684,  0.074,  0.081,  ...,  0.358,  0.356, -0.132]],
       device='cuda:0')
s after update for 1 param tensor([[1.912, 1.711, 2.052,  ..., 1.602, 1.438, 1.374],
        [1.494, 2.106, 2.198,  ..., 1.977, 1.857, 1.963],
        [2.181, 1.685, 2.307,  ..., 2.243, 1.942, 1.923],
        ...,
        [1.911, 1.715, 2.019,  ..., 2.064, 1.947, 1.745],
        [1.729, 1.721, 1.659,  ..., 2.028, 1.682, 2.064],
        [2.229, 1.653, 2.122,  ..., 2.127, 1.509, 1.593]], device='cuda:0')
b after update for 1 param tensor([[84.279, 79.740, 87.311,  ..., 77.146, 73.101, 71.459],
        [74.513, 88.470, 90.366,  ..., 85.713, 83.066, 85.414],
        [90.018, 79.126, 92.593,  ..., 91.291, 84.950, 84.534],
        ...,
        [84.256, 79.836, 86.617,  ..., 87.570, 85.054, 80.518],
        [80.155, 79.957, 78.521,  ..., 86.811, 79.054, 87.567],
        [91.012, 78.365, 88.794,  ..., 88.897, 74.869, 76.944]],
       device='cuda:0')
clipping threshold 1.6241347605809535
a after update for 1 param tensor([-4.829e+00,  3.311e+00,  4.973e-02,  8.155e-01, -2.736e+00,  3.801e+00,
         2.060e+00,  2.435e-01, -7.238e+00,  8.146e+00, -2.003e+00, -7.217e-01,
         3.014e+00,  3.071e+00, -7.262e-01,  3.715e+00,  1.022e+00, -2.586e+00,
        -2.066e+00,  1.740e+00,  1.511e+00,  5.469e+00, -2.034e+00,  6.874e+00,
         6.741e-01,  9.712e+00, -6.454e-01,  3.551e+00, -3.508e-01,  8.500e+00,
         4.043e+00,  1.225e+00,  6.510e-01, -4.367e+00, -2.940e+00, -3.519e+00,
         8.436e-01,  4.571e+00,  8.463e-01, -7.500e-01, -4.580e+00, -3.767e+00,
        -2.117e+00,  9.181e-01, -4.045e+00,  4.947e+00, -4.053e+00,  1.407e+00,
         5.257e+00,  2.737e+00, -1.156e+00, -1.566e+00, -6.111e-02, -1.718e+00,
         3.447e+00, -4.825e+00,  1.926e+00, -1.702e+00, -1.810e+00, -3.092e+00,
         3.624e+00, -3.007e+00, -3.450e+00, -2.750e+00,  3.522e+00, -2.416e-01,
        -2.198e+00,  3.160e-01,  2.101e+00,  4.264e+00,  6.971e-01, -5.466e+00,
        -1.515e+00,  4.057e+00, -1.128e+00,  1.689e+00, -4.036e+00, -3.498e+00,
        -3.046e-01, -6.348e-01,  3.306e+00,  1.096e+00, -3.007e+00,  4.025e+00,
        -2.242e+00,  3.506e+00,  6.406e+00, -5.124e+00, -2.816e+00,  8.298e-01,
         3.616e+00, -7.339e-02,  2.662e+00, -1.390e+00,  3.978e-01,  3.653e+00,
        -2.431e+00,  5.587e-01, -3.524e+00,  3.570e+00, -4.364e+00, -1.034e-01,
         1.486e+00,  1.801e+00, -4.109e-01, -2.238e+00, -6.959e+00,  8.729e-01,
         4.854e+00, -1.748e+00, -1.683e+00,  1.363e+00, -1.077e+00, -1.156e-03,
         1.472e+00, -3.338e+00,  3.288e+00, -5.987e+00, -3.034e+00, -3.778e+00,
         6.637e+00,  7.315e+00,  2.852e+00, -2.623e+00,  1.778e-01, -6.452e+00,
         1.519e+00,  2.061e-02,  4.084e-01, -3.038e+00], device='cuda:0')
s after update for 1 param tensor([1.817, 2.213, 1.923, 2.132, 1.503, 2.175, 1.935, 1.527, 2.657, 2.866,
        1.838, 1.683, 2.217, 2.307, 1.781, 2.374, 1.550, 1.781, 2.149, 1.720,
        1.495, 2.674, 1.746, 2.880, 1.202, 2.914, 1.765, 2.469, 1.235, 3.077,
        2.291, 2.110, 2.304, 2.587, 2.424, 2.113, 1.741, 2.241, 2.027, 1.560,
        2.440, 2.237, 1.741, 1.834, 2.024, 2.462, 2.421, 1.385, 2.638, 2.161,
        1.415, 1.894, 1.849, 2.108, 2.185, 2.298, 1.963, 1.949, 1.717, 2.028,
        2.140, 2.095, 2.631, 2.039, 1.785, 1.511, 1.960, 1.588, 2.061, 2.630,
        1.488, 2.208, 1.974, 2.632, 1.662, 1.996, 2.398, 2.148, 1.758, 2.033,
        1.984, 1.426, 2.135, 2.535, 1.884, 2.351, 2.704, 2.625, 1.987, 0.916,
        2.029, 1.435, 1.683, 1.495, 1.303, 2.123, 2.374, 1.789, 2.271, 2.477,
        2.331, 1.859, 2.250, 1.564, 1.850, 1.617, 2.759, 1.177, 2.579, 1.745,
        2.058, 1.330, 1.674, 2.119, 1.677, 2.301, 2.148, 2.489, 1.680, 2.102,
        2.898, 2.880, 2.625, 2.118, 1.295, 2.700, 1.830, 1.665, 1.494, 2.133],
       device='cuda:0')
b after update for 1 param tensor([ 82.160,  90.673,  84.532,  89.012,  74.742,  89.889,  84.783,  75.319,
         99.363, 103.193,  82.636,  79.087,  90.765,  92.584,  81.345,  93.916,
         75.899,  81.338,  89.368,  79.941,  74.533,  99.678,  80.541, 103.450,
         66.839, 104.062,  80.990,  95.790,  67.746, 106.920,  92.270,  88.553,
         92.520,  98.047,  94.906,  88.613,  80.436,  91.243,  86.791,  76.131,
         95.224,  91.166,  80.434,  82.556,  86.712,  95.642,  94.840,  71.747,
         99.000,  89.614,  72.508,  83.882,  82.893,  88.507,  90.110,  92.405,
         85.414,  85.104,  79.881,  86.808,  89.169,  88.238,  98.869,  87.041,
         81.441,  74.934,  85.331,  76.819,  87.500,  98.863,  74.351,  90.579,
         85.654,  98.888,  78.596,  86.119,  94.388,  89.331,  80.830,  86.921,
         85.869,  72.790,  89.076,  97.059,  83.659,  93.455, 100.239,  98.765,
         85.934,  58.346,  86.828,  73.031,  79.073,  74.527,  69.583,  88.817,
         93.916,  81.526,  91.859,  95.927,  93.074,  83.105,  91.429,  76.232,
         82.900,  77.522, 101.246,  66.145,  97.889,  80.519,  87.439,  70.304,
         78.863,  88.723,  78.941,  92.474,  89.337,  96.161,  79.004,  88.370,
        103.767, 103.443,  98.765,  88.711,  69.378, 100.156,  82.452,  78.653,
         74.510,  89.017], device='cuda:0')
clipping threshold 1.6241347605809535
a after update for 1 param tensor([[[-5.063e+00],
         [ 4.086e+00],
         [-5.524e+00],
         [ 2.531e+00],
         [ 1.251e+00],
         [-6.258e+00],
         [ 1.319e+00],
         [-4.608e+00],
         [ 8.738e-01],
         [-4.159e-01]],

        [[-1.853e+00],
         [ 1.828e+00],
         [-6.172e+00],
         [ 1.232e+00],
         [ 5.206e+00],
         [-2.259e+00],
         [ 3.222e+00],
         [ 3.496e+00],
         [ 9.857e-01],
         [ 3.909e+00]],

        [[-1.505e+00],
         [-4.978e+00],
         [-2.419e+00],
         [ 3.851e+00],
         [-4.973e+00],
         [-2.896e+00],
         [-1.806e+00],
         [ 6.566e-01],
         [-1.763e+00],
         [-1.017e-01]],

        [[ 9.684e-01],
         [ 4.026e+00],
         [ 8.863e-02],
         [ 2.473e+00],
         [-1.651e+00],
         [ 4.065e+00],
         [ 6.896e+00],
         [-1.058e+00],
         [ 3.949e+00],
         [-5.809e-01]],

        [[-3.352e+00],
         [ 5.209e+00],
         [-2.649e+00],
         [-4.596e+00],
         [-1.663e+00],
         [-2.935e+00],
         [-2.452e+00],
         [ 2.387e+00],
         [-9.984e-01],
         [ 2.003e+00]],

        [[-2.197e+00],
         [ 3.599e+00],
         [-2.384e+00],
         [ 1.172e+00],
         [-2.731e+00],
         [-5.067e+00],
         [ 2.328e+00],
         [ 6.707e-01],
         [ 3.631e-03],
         [ 1.749e+00]],

        [[-9.413e-01],
         [ 3.438e+00],
         [-1.976e+00],
         [-7.589e-01],
         [-2.391e+00],
         [-6.974e-01],
         [ 6.155e+00],
         [ 2.206e+00],
         [ 5.122e-01],
         [ 2.054e+00]],

        [[ 8.452e+00],
         [-4.268e+00],
         [ 5.174e+00],
         [-9.527e-01],
         [-2.176e+00],
         [ 2.898e+00],
         [ 4.402e+00],
         [ 1.035e+00],
         [-1.223e+00],
         [ 3.439e+00]],

        [[ 1.552e-01],
         [ 2.314e+00],
         [ 4.305e+00],
         [-5.687e+00],
         [ 1.744e-01],
         [-3.301e+00],
         [ 8.749e-01],
         [-2.940e+00],
         [ 3.563e+00],
         [-1.483e+00]],

        [[-1.400e+00],
         [-1.280e+00],
         [ 1.257e+00],
         [ 3.122e-01],
         [ 1.291e+00],
         [ 2.904e+00],
         [ 4.622e-01],
         [-5.874e-01],
         [ 1.523e+00],
         [ 2.169e-01]],

        [[ 3.816e+00],
         [-3.071e+00],
         [-4.698e+00],
         [ 2.117e+00],
         [-2.009e+00],
         [-3.950e-01],
         [-2.555e+00],
         [-4.108e+00],
         [-4.891e-01],
         [-3.177e+00]],

        [[-7.523e-01],
         [-2.663e+00],
         [-2.996e+00],
         [ 3.179e+00],
         [-1.792e+00],
         [-1.925e+00],
         [-2.817e-01],
         [-1.791e+00],
         [-5.037e+00],
         [ 4.440e+00]],

        [[ 3.974e+00],
         [ 2.574e+00],
         [-5.931e-01],
         [-8.117e+00],
         [ 9.968e-01],
         [ 1.130e+01],
         [-4.399e+00],
         [-2.248e+00],
         [-2.654e+00],
         [-6.656e-01]]], device='cuda:0')
s after update for 1 param tensor([[[2.227],
         [2.326],
         [2.568],
         [2.337],
         [2.428],
         [2.997],
         [1.915],
         [2.465],
         [2.188],
         [1.279]],

        [[2.055],
         [1.851],
         [2.685],
         [1.719],
         [2.240],
         [2.425],
         [2.090],
         [1.923],
         [1.507],
         [2.640]],

        [[1.449],
         [2.666],
         [1.750],
         [2.563],
         [2.012],
         [2.120],
         [1.852],
         [1.704],
         [2.166],
         [1.728]],

        [[1.502],
         [2.739],
         [1.356],
         [1.746],
         [1.908],
         [2.701],
         [2.855],
         [2.195],
         [2.399],
         [1.498]],

        [[2.019],
         [2.684],
         [1.964],
         [2.410],
         [1.644],
         [1.721],
         [1.970],
         [1.986],
         [2.033],
         [2.981]],

        [[1.778],
         [2.636],
         [2.487],
         [1.668],
         [1.647],
         [2.736],
         [2.058],
         [1.731],
         [1.714],
         [1.821]],

        [[1.728],
         [2.039],
         [2.215],
         [1.753],
         [2.112],
         [1.276],
         [2.897],
         [2.036],
         [2.117],
         [2.021]],

        [[2.968],
         [1.906],
         [2.706],
         [2.154],
         [1.129],
         [2.302],
         [2.622],
         [2.318],
         [2.469],
         [1.791]],

        [[1.780],
         [1.603],
         [2.423],
         [2.609],
         [1.946],
         [2.265],
         [1.381],
         [2.065],
         [2.374],
         [1.473]],

        [[2.102],
         [2.323],
         [1.745],
         [2.088],
         [2.074],
         [2.411],
         [1.925],
         [1.898],
         [2.233],
         [1.785]],

        [[1.831],
         [2.392],
         [2.620],
         [1.740],
         [2.253],
         [1.509],
         [2.299],
         [2.817],
         [1.286],
         [2.104]],

        [[1.886],
         [2.556],
         [2.320],
         [1.743],
         [1.873],
         [2.290],
         [1.760],
         [1.507],
         [2.788],
         [2.041]],

        [[2.234],
         [2.496],
         [1.380],
         [2.653],
         [1.696],
         [3.106],
         [2.362],
         [2.196],
         [2.301],
         [1.090]]], device='cuda:0')
b after update for 1 param tensor([[[ 90.973],
         [ 92.961],
         [ 97.675],
         [ 93.177],
         [ 94.984],
         [105.528],
         [ 84.363],
         [ 95.702],
         [ 90.159],
         [ 68.945]],

        [[ 87.390],
         [ 82.941],
         [ 99.889],
         [ 79.925],
         [ 91.235],
         [ 94.918],
         [ 88.115],
         [ 84.534],
         [ 74.840],
         [ 99.039]],

        [[ 73.376],
         [ 99.528],
         [ 80.649],
         [ 97.586],
         [ 86.468],
         [ 88.756],
         [ 82.963],
         [ 79.578],
         [ 89.716],
         [ 80.126]],

        [[ 74.706],
         [100.889],
         [ 70.985],
         [ 80.554],
         [ 84.200],
         [100.185],
         [103.000],
         [ 90.316],
         [ 94.410],
         [ 74.616]],

        [[ 86.614],
         [ 99.857],
         [ 85.420],
         [ 94.626],
         [ 78.166],
         [ 79.978],
         [ 85.564],
         [ 85.914],
         [ 86.905],
         [105.253]],

        [[ 81.287],
         [ 98.961],
         [ 96.131],
         [ 78.722],
         [ 78.233],
         [100.824],
         [ 87.446],
         [ 80.209],
         [ 79.812],
         [ 82.255]],

        [[ 80.121],
         [ 87.049],
         [ 90.710],
         [ 80.709],
         [ 88.592],
         [ 68.860],
         [103.759],
         [ 86.977],
         [ 88.697],
         [ 86.667]],

        [[105.021],
         [ 84.152],
         [100.278],
         [ 89.460],
         [ 64.769],
         [ 92.483],
         [ 98.712],
         [ 92.811],
         [ 95.786],
         [ 81.579]],

        [[ 81.320],
         [ 77.175],
         [ 94.883],
         [ 98.453],
         [ 85.042],
         [ 91.732],
         [ 71.632],
         [ 87.586],
         [ 93.929],
         [ 73.971]],

        [[ 88.378],
         [ 92.909],
         [ 80.523],
         [ 88.073],
         [ 87.787],
         [ 94.659],
         [ 84.575],
         [ 83.971],
         [ 91.078],
         [ 81.432]],

        [[ 82.483],
         [ 94.268],
         [ 98.669],
         [ 80.408],
         [ 91.490],
         [ 74.875],
         [ 92.416],
         [102.314],
         [ 69.114],
         [ 88.425]],

        [[ 83.713],
         [ 97.451],
         [ 92.844],
         [ 80.471],
         [ 83.432],
         [ 92.249],
         [ 80.864],
         [ 74.819],
         [101.774],
         [ 87.077]],

        [[ 91.107],
         [ 96.302],
         [ 71.602],
         [ 99.282],
         [ 79.374],
         [107.437],
         [ 93.687],
         [ 90.323],
         [ 92.456],
         [ 63.636]]], device='cuda:0')
clipping threshold 1.6241347605809535
a after update for 1 param tensor([[ 3.701],
        [ 6.502],
        [ 4.348],
        [-5.936],
        [-1.674],
        [ 3.442],
        [ 4.232],
        [-1.100],
        [-0.395],
        [ 1.485],
        [-2.148],
        [-3.327],
        [ 2.466]], device='cuda:0')
s after update for 1 param tensor([[2.691],
        [2.658],
        [2.079],
        [2.836],
        [2.203],
        [2.058],
        [2.573],
        [1.889],
        [1.895],
        [2.167],
        [2.071],
        [2.452],
        [2.639]], device='cuda:0')
b after update for 1 param tensor([[100.003],
        [ 99.373],
        [ 87.886],
        [102.654],
        [ 90.471],
        [ 87.456],
        [ 97.776],
        [ 83.784],
        [ 83.904],
        [ 89.726],
        [ 87.716],
        [ 95.450],
        [ 99.021]], device='cuda:0')
clipping threshold 1.6241347605809535
||w||^2 1.096367705850025
exp ma of ||w||^2 4.2519685606957305
||w|| 1.047075788016333
exp ma of ||w|| 1.9535477054088346
||w||^2 1.8372155959552552
exp ma of ||w||^2 3.777856904951397
||w|| 1.3554392631008056
exp ma of ||w|| 1.8493307205274614
cuda
Objective function 28.69 = squared loss an data 24.64 + 0.5*rho*h**2 0.225212 + alpha*h 0.884358 + L2reg 2.75 + L1reg 0.19 ; SHD = 45 ; DAG True
Proportion of microbatches that were clipped  0.7762491526099613
iteration 1 in inner loop, alpha 416.6937440981596 rho 100000.0 h 0.0021223218359960327
iteration 5 in outer loop, alpha = 2539.0155800941925, rho = 1000000.0, h = 0.0021223218359960327
Threshold 0.3
[[0.002 1.452 1.088 0.629 1.76  0.654 2.219 0.01  0.018 0.908 0.231 0.713
  0.017]
 [0.001 0.001 0.253 0.024 0.409 0.111 0.613 0.002 0.002 0.272 0.006 0.028
  0.002]
 [0.001 0.014 0.006 0.01  0.289 0.013 0.843 0.001 0.    0.025 0.001 0.055
  0.002]
 [0.004 0.203 0.584 0.004 1.052 0.605 1.617 0.001 0.003 0.755 0.002 0.023
  0.004]
 [0.001 0.029 0.033 0.002 0.007 0.008 0.315 0.002 0.001 0.043 0.002 0.002
  0.001]
 [0.002 0.068 0.388 0.005 0.539 0.002 0.893 0.    0.001 0.178 0.003 0.005
  0.002]
 [0.    0.003 0.003 0.    0.008 0.002 0.003 0.    0.    0.003 0.001 0.001
  0.   ]
 [0.496 0.864 1.343 1.007 1.904 2.585 2.179 0.002 0.062 2.682 0.278 1.315
  0.049]
 [0.289 1.195 2.073 0.64  2.491 1.31  1.879 0.172 0.001 1.786 0.157 0.971
  0.11 ]
 [0.001 0.039 0.23  0.005 0.318 0.106 0.685 0.001 0.002 0.009 0.003 0.008
  0.002]
 [0.021 0.434 1.15  0.53  1.682 0.738 1.434 0.007 0.044 1.004 0.001 0.539
  0.009]
 [0.002 0.241 0.103 0.248 1.308 0.299 0.932 0.003 0.005 0.485 0.009 0.003
  0.006]
 [0.332 0.787 1.067 0.615 3.083 1.278 2.345 0.123 0.092 1.934 0.292 1.089
  0.002]]
[[0.    1.452 1.088 0.629 1.76  0.654 2.219 0.    0.    0.908 0.    0.713
  0.   ]
 [0.    0.    0.    0.    0.409 0.    0.613 0.    0.    0.    0.    0.
  0.   ]
 [0.    0.    0.    0.    0.    0.    0.843 0.    0.    0.    0.    0.
  0.   ]
 [0.    0.    0.584 0.    1.052 0.605 1.617 0.    0.    0.755 0.    0.
  0.   ]
 [0.    0.    0.    0.    0.    0.    0.315 0.    0.    0.    0.    0.
  0.   ]
 [0.    0.    0.388 0.    0.539 0.    0.893 0.    0.    0.    0.    0.
  0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.   ]
 [0.496 0.864 1.343 1.007 1.904 2.585 2.179 0.    0.    2.682 0.    1.315
  0.   ]
 [0.    1.195 2.073 0.64  2.491 1.31  1.879 0.    0.    1.786 0.    0.971
  0.   ]
 [0.    0.    0.    0.    0.318 0.    0.685 0.    0.    0.    0.    0.
  0.   ]
 [0.    0.434 1.15  0.53  1.682 0.738 1.434 0.    0.    1.004 0.    0.539
  0.   ]
 [0.    0.    0.    0.    1.308 0.    0.932 0.    0.    0.485 0.    0.
  0.   ]
 [0.332 0.787 1.067 0.615 3.083 1.278 2.345 0.    0.    1.934 0.    1.089
  0.   ]]
{'fdr': 0.6779661016949152, 'tpr': 0.7307692307692307, 'fpr': 0.7692307692307693, 'f1': 0.4470588235294118, 'shd': 45, 'npred': 59, 'ntrue': 26}
[1.452e+00 1.088e+00 6.291e-01 1.760e+00 6.539e-01 2.219e+00 9.841e-03
 1.808e-02 9.080e-01 2.306e-01 7.131e-01 1.716e-02 9.230e-04 2.532e-01
 2.367e-02 4.089e-01 1.110e-01 6.126e-01 1.565e-03 1.732e-03 2.722e-01
 5.689e-03 2.758e-02 2.398e-03 1.456e-03 1.442e-02 9.533e-03 2.885e-01
 1.341e-02 8.431e-01 6.638e-04 3.548e-04 2.499e-02 8.902e-04 5.525e-02
 1.550e-03 3.970e-03 2.031e-01 5.839e-01 1.052e+00 6.054e-01 1.617e+00
 1.095e-03 2.874e-03 7.548e-01 2.366e-03 2.288e-02 3.523e-03 6.201e-04
 2.859e-02 3.288e-02 2.247e-03 8.202e-03 3.152e-01 1.580e-03 1.015e-03
 4.342e-02 2.012e-03 1.709e-03 1.089e-03 2.133e-03 6.846e-02 3.881e-01
 5.442e-03 5.386e-01 8.932e-01 3.380e-04 1.273e-03 1.783e-01 3.287e-03
 5.482e-03 1.657e-03 4.258e-04 3.135e-03 2.661e-03 3.903e-04 8.421e-03
 1.870e-03 3.187e-04 3.340e-04 2.830e-03 6.309e-04 1.472e-03 3.667e-04
 4.955e-01 8.644e-01 1.343e+00 1.007e+00 1.904e+00 2.585e+00 2.179e+00
 6.229e-02 2.682e+00 2.782e-01 1.315e+00 4.925e-02 2.887e-01 1.195e+00
 2.073e+00 6.395e-01 2.491e+00 1.310e+00 1.879e+00 1.717e-01 1.786e+00
 1.567e-01 9.709e-01 1.096e-01 1.312e-03 3.913e-02 2.297e-01 5.294e-03
 3.185e-01 1.056e-01 6.848e-01 6.749e-04 1.503e-03 2.578e-03 8.082e-03
 1.727e-03 2.056e-02 4.340e-01 1.150e+00 5.300e-01 1.682e+00 7.381e-01
 1.434e+00 7.377e-03 4.423e-02 1.004e+00 5.391e-01 9.499e-03 2.311e-03
 2.408e-01 1.026e-01 2.478e-01 1.308e+00 2.986e-01 9.316e-01 3.196e-03
 4.582e-03 4.846e-01 8.975e-03 5.520e-03 3.322e-01 7.875e-01 1.067e+00
 6.153e-01 3.083e+00 1.278e+00 2.345e+00 1.232e-01 9.190e-02 1.934e+00
 2.924e-01 1.089e+00]
[[0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 1. 0. 0. 0.]
 [0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0. 0. 0.]
 [0. 1. 1. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 1. 0.]
 [1. 0. 1. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 0. 0.]
 [0. 1. 1. 0. 0. 0. 1. 0. 0. 1. 0. 0. 0.]]
[0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0.
 0. 0. 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0. 0.
 0. 1. 1. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 1. 0.
 1. 0. 1. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 0.
 0. 1. 1. 0. 0. 0. 1. 0. 0. 1. 0. 0.]
aucroc, aucpr (0.7763313609467455, 0.37469660930199056)
Iterations 10000
Achieves (24.580892305181028, 1e-05)-DP
