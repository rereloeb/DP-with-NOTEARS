samples  5000  graph  20 60 ER mim  minibatch size  50  noise  0.6  minibatches per NN training  250 adaclip_and_quantile
cuda
cuda
iteration 1 in inner loop,alpha 0.0 rho 1.0 h 1.8940950442230857
iteration 1 in outer loop, alpha = 1.8940950442230857, rho = 1.0, h = 1.8940950442230857
cuda
iteration 1 in inner loop,alpha 1.8940950442230857 rho 1.0 h 1.182773599915663
iteration 2 in inner loop,alpha 1.8940950442230857 rho 10.0 h 0.459195570993554
iteration 2 in outer loop, alpha = 6.486050754158626, rho = 10.0, h = 0.459195570993554
cuda
iteration 1 in inner loop,alpha 6.486050754158626 rho 10.0 h 0.25981398971351055
iteration 2 in inner loop,alpha 6.486050754158626 rho 100.0 h 0.09213537717594988
iteration 3 in outer loop, alpha = 15.699588471753614, rho = 100.0, h = 0.09213537717594988
cuda
iteration 1 in inner loop,alpha 15.699588471753614 rho 100.0 h 0.0537253435441194
iteration 2 in inner loop,alpha 15.699588471753614 rho 1000.0 h 0.020134930504809745
iteration 4 in outer loop, alpha = 35.83451897656336, rho = 1000.0, h = 0.020134930504809745
cuda
iteration 1 in inner loop,alpha 35.83451897656336 rho 1000.0 h 0.010694953196676238
iteration 2 in inner loop,alpha 35.83451897656336 rho 10000.0 h 0.0036039998558514696
iteration 5 in outer loop, alpha = 71.87451753507806, rho = 10000.0, h = 0.0036039998558514696
cuda
iteration 1 in inner loop,alpha 71.87451753507806 rho 10000.0 h 0.0014058886208871968
iteration 2 in inner loop,alpha 71.87451753507806 rho 100000.0 h 0.0005547019376734852
iteration 6 in outer loop, alpha = 127.34471130242657, rho = 100000.0, h = 0.0005547019376734852
cuda
iteration 1 in inner loop,alpha 127.34471130242657 rho 100000.0 h 0.0003426521132610105
iteration 7 in outer loop, alpha = 469.9968245634371, rho = 1000000.0, h = 0.0003426521132610105
Threshold 0.3
[[0.    0.026 0.01  0.055 0.155 0.186 0.049 0.009 0.037 0.059 0.486 0.665
  1.083 0.002 0.092 0.01  0.075 2.571 0.522 0.02 ]
 [0.    0.001 0.001 0.041 0.081 0.464 0.171 0.    0.007 0.047 0.044 0.
  0.    0.    0.075 0.143 0.019 0.    0.095 0.802]
 [0.001 0.288 0.002 0.124 0.54  0.113 0.071 0.    1.48  0.837 0.137 0.005
  0.006 0.    0.031 0.217 0.055 0.044 0.136 0.114]
 [0.    0.006 0.    0.002 0.002 0.004 0.    0.    0.    0.001 0.002 0.
  0.    0.    0.051 0.001 0.    0.    0.002 0.026]
 [0.    0.003 0.    0.153 0.002 0.008 0.004 0.    0.    0.012 0.009 0.
  0.    0.    0.037 0.106 0.003 0.    0.001 0.003]
 [0.    0.002 0.006 0.118 0.03  0.005 0.009 0.    0.023 0.047 0.002 0.
  0.003 0.    1.196 0.097 0.006 0.001 0.329 0.041]
 [0.    0.003 0.001 0.204 0.299 0.238 0.003 0.    0.002 0.005 0.003 0.001
  0.002 0.    0.094 0.015 0.001 0.    0.002 0.013]
 [0.004 0.1   0.008 1.072 0.048 0.06  0.187 0.    0.372 0.068 0.08  2.207
  1.365 0.033 0.109 0.013 0.032 2.22  0.047 0.04 ]
 [0.    0.022 0.    1.419 1.387 0.012 0.085 0.    0.003 0.43  1.25  0.
  0.001 0.    0.422 0.146 0.003 0.    0.006 0.018]
 [0.    0.003 0.001 0.052 0.013 0.125 0.115 0.    0.004 0.004 1.083 0.001
  0.002 0.    0.089 0.007 0.04  0.    0.005 0.668]
 [0.    0.007 0.    0.04  0.009 0.02  0.328 0.    0.    0.001 0.002 0.
  0.    0.    0.018 0.004 0.336 0.    0.003 0.739]
 [0.    2.089 0.002 1.571 1.302 0.055 0.575 0.    1.046 0.037 1.104 0.001
  0.001 0.    0.006 0.914 0.39  0.    0.068 0.122]
 [0.    0.034 0.002 0.172 0.08  0.128 0.446 0.    0.001 0.588 0.057 0.571
  0.003 0.    1.599 0.154 0.242 0.    0.008 0.062]
 [0.004 1.038 4.617 0.093 0.039 0.176 0.086 0.002 0.847 0.188 0.051 0.022
  0.053 0.    0.057 0.679 0.008 0.095 0.718 1.198]
 [0.    0.002 0.    0.013 0.021 0.001 0.001 0.    0.001 0.006 0.001 0.
  0.    0.    0.002 0.01  0.001 0.    0.001 0.002]
 [0.    0.001 0.002 0.061 0.006 0.012 0.005 0.    0.004 0.309 0.037 0.
  0.    0.    0.039 0.003 0.002 0.    0.001 0.091]
 [0.    0.01  0.001 0.977 0.105 0.001 0.933 0.    0.001 0.002 0.002 0.001
  0.002 0.    0.552 0.002 0.002 0.001 0.003 0.021]
 [0.    0.049 0.003 0.286 0.054 0.052 0.063 0.    0.107 0.059 0.111 0.893
  2.07  0.    0.001 0.074 0.049 0.002 0.025 1.252]
 [0.    0.001 0.01  0.094 0.771 0.014 0.009 0.    0.428 0.256 0.1   0.
  0.005 0.    0.695 1.054 0.002 0.006 0.004 0.064]
 [0.    0.    0.    0.008 0.008 0.022 0.068 0.    0.001 0.001 0.001 0.
  0.    0.    0.056 0.001 0.002 0.    0.002 0.002]]
[[0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.486 0.665
  1.083 0.    0.    0.    0.    2.571 0.522 0.   ]
 [0.    0.    0.    0.    0.    0.464 0.    0.    0.    0.    0.    0.
  0.    0.    0.    0.    0.    0.    0.    0.802]
 [0.    0.    0.    0.    0.54  0.    0.    0.    1.48  0.837 0.    0.
  0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.    0.    1.196 0.    0.    0.    0.329 0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    1.072 0.    0.    0.    0.    0.372 0.    0.    2.207
  1.365 0.    0.    0.    0.    2.22  0.    0.   ]
 [0.    0.    0.    1.419 1.387 0.    0.    0.    0.    0.43  1.25  0.
  0.    0.    0.422 0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    1.083 0.
  0.    0.    0.    0.    0.    0.    0.    0.668]
 [0.    0.    0.    0.    0.    0.    0.328 0.    0.    0.    0.    0.
  0.    0.    0.    0.    0.336 0.    0.    0.739]
 [0.    2.089 0.    1.571 1.302 0.    0.575 0.    1.046 0.    1.104 0.
  0.    0.    0.    0.914 0.39  0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.446 0.    0.    0.588 0.    0.571
  0.    0.    1.599 0.    0.    0.    0.    0.   ]
 [0.    1.038 4.617 0.    0.    0.    0.    0.    0.847 0.    0.    0.
  0.    0.    0.    0.679 0.    0.    0.718 1.198]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.309 0.    0.
  0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.977 0.    0.    0.933 0.    0.    0.    0.    0.
  0.    0.    0.552 0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.893
  2.07  0.    0.    0.    0.    0.    0.    1.252]
 [0.    0.    0.    0.    0.771 0.    0.    0.    0.428 0.    0.    0.
  0.    0.    0.695 1.054 0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.    0.    0.    0.    0.    0.    0.    0.   ]]
{'fdr': 0.14285714285714285, 'tpr': 0.8, 'fpr': 0.06153846153846154, 'f1': 0.8275862068965518, 'shd': 15, 'npred': 56, 'ntrue': 60}
[2.627e-02 9.763e-03 5.521e-02 1.554e-01 1.857e-01 4.908e-02 8.506e-03
 3.673e-02 5.880e-02 4.858e-01 6.653e-01 1.083e+00 2.287e-03 9.164e-02
 9.802e-03 7.526e-02 2.571e+00 5.219e-01 2.032e-02 5.726e-06 5.473e-04
 4.055e-02 8.073e-02 4.637e-01 1.714e-01 6.559e-06 7.173e-03 4.720e-02
 4.384e-02 9.065e-05 1.334e-04 9.853e-05 7.456e-02 1.435e-01 1.886e-02
 1.533e-04 9.500e-02 8.019e-01 1.389e-03 2.880e-01 1.245e-01 5.396e-01
 1.126e-01 7.141e-02 3.713e-04 1.480e+00 8.368e-01 1.375e-01 5.133e-03
 6.287e-03 5.703e-05 3.138e-02 2.175e-01 5.479e-02 4.440e-02 1.364e-01
 1.143e-01 1.013e-04 5.582e-03 2.436e-04 1.609e-03 3.565e-03 4.505e-04
 1.528e-06 4.526e-04 5.719e-04 2.063e-03 1.201e-04 2.449e-04 6.847e-06
 5.123e-02 7.354e-04 3.574e-04 9.353e-05 2.011e-03 2.613e-02 9.019e-05
 3.225e-03 1.770e-04 1.525e-01 7.625e-03 3.940e-03 4.091e-06 4.814e-04
 1.204e-02 9.071e-03 1.657e-04 2.476e-04 1.415e-05 3.661e-02 1.064e-01
 3.245e-03 9.211e-05 6.557e-04 2.852e-03 7.778e-05 1.779e-03 5.822e-03
 1.183e-01 2.993e-02 8.751e-03 9.486e-05 2.287e-02 4.734e-02 1.880e-03
 3.603e-04 2.907e-03 8.808e-05 1.196e+00 9.726e-02 6.152e-03 1.003e-03
 3.289e-01 4.102e-02 2.836e-05 2.745e-03 1.195e-03 2.036e-01 2.988e-01
 2.380e-01 5.995e-05 1.540e-03 4.887e-03 2.839e-03 7.988e-04 2.377e-03
 5.832e-05 9.388e-02 1.510e-02 1.085e-03 7.162e-05 2.098e-03 1.331e-02
 3.681e-03 9.959e-02 7.754e-03 1.072e+00 4.767e-02 5.959e-02 1.874e-01
 3.715e-01 6.814e-02 8.004e-02 2.207e+00 1.365e+00 3.273e-02 1.094e-01
 1.321e-02 3.221e-02 2.220e+00 4.707e-02 4.042e-02 6.599e-05 2.227e-02
 2.361e-04 1.419e+00 1.387e+00 1.182e-02 8.463e-02 1.269e-04 4.297e-01
 1.250e+00 2.491e-04 6.497e-04 8.465e-05 4.225e-01 1.455e-01 3.255e-03
 1.528e-04 5.511e-03 1.766e-02 6.020e-05 2.557e-03 5.998e-04 5.217e-02
 1.325e-02 1.253e-01 1.151e-01 4.668e-05 3.597e-03 1.083e+00 1.187e-03
 1.769e-03 7.298e-06 8.921e-02 6.588e-03 4.004e-02 1.392e-04 4.619e-03
 6.679e-01 1.598e-04 6.986e-03 1.720e-04 4.029e-02 9.388e-03 1.950e-02
 3.276e-01 7.807e-06 4.109e-04 8.543e-04 1.310e-04 9.273e-05 5.531e-06
 1.816e-02 4.114e-03 3.356e-01 9.764e-05 2.655e-03 7.386e-01 4.899e-05
 2.089e+00 2.463e-03 1.571e+00 1.302e+00 5.499e-02 5.754e-01 9.681e-06
 1.046e+00 3.675e-02 1.104e+00 1.173e-03 3.498e-04 5.959e-03 9.143e-01
 3.897e-01 1.619e-04 6.807e-02 1.222e-01 8.194e-06 3.444e-02 2.467e-03
 1.723e-01 8.002e-02 1.283e-01 4.459e-01 4.346e-06 1.422e-03 5.877e-01
 5.738e-02 5.708e-01 2.647e-04 1.599e+00 1.536e-01 2.417e-01 7.578e-05
 8.027e-03 6.161e-02 4.036e-03 1.038e+00 4.617e+00 9.306e-02 3.900e-02
 1.759e-01 8.567e-02 1.833e-03 8.473e-01 1.878e-01 5.083e-02 2.241e-02
 5.252e-02 5.653e-02 6.787e-01 8.207e-03 9.456e-02 7.181e-01 1.198e+00
 3.401e-06 1.751e-03 2.215e-04 1.332e-02 2.093e-02 8.330e-04 1.191e-03
 4.819e-06 1.488e-03 6.347e-03 1.462e-03 2.350e-04 4.465e-04 5.066e-05
 1.037e-02 7.665e-04 3.300e-05 1.301e-03 1.822e-03 1.197e-04 7.045e-04
 1.937e-03 6.091e-02 5.685e-03 1.195e-02 4.587e-03 9.144e-05 4.001e-03
 3.093e-01 3.700e-02 4.294e-04 4.428e-04 4.291e-05 3.917e-02 2.423e-03
 1.755e-04 1.398e-03 9.115e-02 7.732e-05 1.001e-02 1.111e-03 9.768e-01
 1.046e-01 1.286e-03 9.326e-01 6.935e-05 6.295e-04 2.178e-03 2.155e-03
 8.503e-04 2.418e-03 6.106e-05 5.523e-01 1.926e-03 1.073e-03 2.687e-03
 2.132e-02 4.559e-06 4.889e-02 2.956e-03 2.857e-01 5.439e-02 5.203e-02
 6.254e-02 1.455e-05 1.069e-01 5.880e-02 1.106e-01 8.933e-01 2.070e+00
 2.295e-04 1.018e-03 7.385e-02 4.885e-02 2.547e-02 1.252e+00 9.153e-05
 8.460e-04 9.808e-03 9.404e-02 7.708e-01 1.368e-02 9.320e-03 3.680e-04
 4.281e-01 2.557e-01 9.992e-02 4.128e-04 4.852e-03 1.213e-04 6.946e-01
 1.054e+00 1.994e-03 6.112e-03 6.385e-02 6.269e-06 3.329e-04 1.007e-04
 7.859e-03 8.016e-03 2.214e-02 6.811e-02 4.442e-06 6.033e-04 5.756e-04
 6.910e-04 1.051e-04 4.775e-04 1.149e-05 5.640e-02 7.868e-04 1.769e-03
 3.382e-04 1.731e-03]
[[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 1. 1. 0. 0. 0. 0. 1. 1. 0.]
 [0. 0. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 1. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [0. 0. 0. 1. 0. 0. 1. 0. 1. 0. 0. 1. 1. 0. 0. 0. 0. 1. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0. 0. 1. 1. 0. 0. 0. 1. 0. 0. 0. 1. 0.]
 [0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 1.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 1. 0. 1. 1. 0. 1. 0. 1. 0. 1. 0. 1. 0. 0. 1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 1. 1. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 1. 0. 0. 1. 1.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 1. 1. 0. 0. 0. 1. 0. 0. 0. 0. 1. 1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
[0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 1. 1. 0. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0. 1.
 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 1. 0. 0. 0. 1. 1. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 1. 0. 0. 1. 1. 0. 0. 1.
 1. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 1. 1. 0. 0. 0. 1. 1. 0. 0. 0. 1. 0. 0.
 0. 1. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 1. 0. 0.
 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 1. 1. 0. 1.
 0. 1. 0. 1. 1. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 1. 0. 0.
 0. 1. 0. 0. 0. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 1. 0. 0.
 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 1. 1. 0. 0. 0. 1. 0. 0. 0. 0. 1. 1. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
aucroc, aucpr (0.9315104166666667, 0.8632502071646184)
cuda
4420
cuda
Objective function 242.67 = squared loss an data 26.66 + 0.5*rho*h**2 215.201283 + alpha*h 0.000000 + L2reg 0.37 + L1reg 0.45 ; SHD = 207 ; DAG False
v before min max tensor([[-1.151e-03, -1.043e-06, -1.618e-04,  ..., -1.857e-05,  7.934e-04,
         -3.279e-05],
        [-1.621e-03, -1.904e-04, -1.082e-03,  ..., -1.774e-04, -6.099e-05,
         -1.559e-04],
        [-8.013e-04,  1.144e-04, -7.002e-04,  ..., -7.896e-05,  8.916e-05,
         -4.775e-05],
        ...,
        [ 6.151e-03, -1.581e-03, -1.628e-04,  ...,  7.804e-06,  3.467e-05,
         -5.326e-04],
        [-2.409e-04, -5.106e-04, -1.043e-04,  ..., -8.763e-05,  2.290e-06,
          7.310e-04],
        [ 1.242e-03, -1.117e-05, -2.588e-04,  ..., -5.509e-05,  2.303e-04,
         -1.967e-03]], device='cuda:0')
v tensor([[1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 7.934e-04,
         1.000e-12],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [1.000e-12, 1.144e-04, 1.000e-12,  ..., 1.000e-12, 8.916e-05,
         1.000e-12],
        ...,
        [6.151e-03, 1.000e-12, 1.000e-12,  ..., 7.804e-06, 3.467e-05,
         1.000e-12],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 2.290e-06,
         7.310e-04],
        [1.242e-03, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 2.303e-04,
         1.000e-12]], device='cuda:0')
v before min max tensor([-2.086e-05,  6.661e-04, -2.363e-06, -9.589e-06, -1.184e-04, -3.026e-03,
        -1.022e-04, -1.902e-05, -2.117e-04, -1.483e-04, -1.842e-04, -8.137e-05,
        -1.137e-06, -5.379e-04, -1.348e-06, -9.169e-04,  1.111e-05, -6.233e-05,
         8.165e-06, -2.965e-06, -1.620e-05, -4.039e-04, -4.320e-05, -6.292e-07,
         6.078e-03, -2.820e-05, -4.531e-04, -5.482e-06,  4.357e-05, -2.149e-05,
        -3.979e-04, -7.638e-04, -9.902e-04, -7.578e-07,  1.975e-05, -2.772e-04,
        -1.931e-05, -1.322e-03, -1.605e-04, -3.862e-05, -1.262e-05, -6.199e-04,
        -2.969e-05, -5.160e-04, -3.150e-05,  1.284e-05,  1.762e-05, -1.497e-05,
        -3.242e-05,  6.602e-04, -1.032e-03,  3.156e-05, -5.812e-06, -5.306e-06,
        -5.599e-04,  1.522e-04, -1.097e-04, -3.212e-05, -1.471e-04, -5.214e-04,
        -1.917e-06, -1.300e-04,  6.409e-05, -5.134e-05, -2.461e-04, -1.571e-06,
         3.435e-05, -1.525e-03, -1.118e-03, -9.470e-07, -1.540e-04, -3.390e-04,
        -2.854e-06, -1.141e-05,  1.208e-04, -2.071e-05,  4.561e-05, -1.938e-05,
        -1.484e-04, -2.830e-06,  2.657e-05,  3.436e-04, -6.377e-07, -1.354e-04,
        -3.634e-03, -8.465e-05, -4.688e-05, -2.899e-05,  2.785e-07, -1.062e-04,
         4.164e-04,  4.339e-04, -3.145e-05,  1.490e-03, -2.357e-05, -2.711e-05,
        -2.067e-05, -1.359e-05, -1.106e-03,  4.618e-05,  1.576e-05,  6.189e-06,
        -1.534e-04, -1.192e-04, -5.039e-04, -8.107e-05,  4.428e-03,  3.721e-07,
        -1.165e-05, -2.633e-04, -4.928e-07,  7.337e-06,  5.042e-05, -5.942e-04,
        -1.856e-04, -4.105e-05, -1.257e-04,  8.725e-07, -5.508e-04,  6.272e-05,
        -3.048e-06,  3.125e-04, -7.824e-05,  2.061e-04, -4.605e-05, -4.427e-05,
         6.875e-05,  2.677e-04, -3.530e-05, -1.023e-03,  1.400e-03,  2.817e-03,
         3.236e-05, -5.680e-05,  2.796e-05, -2.197e-04, -4.208e-06,  1.494e-06,
         2.515e-05, -2.394e-05, -4.370e-06,  2.257e-06, -6.442e-07, -2.792e-05,
         5.197e-07, -9.885e-07,  1.685e-06,  4.321e-03, -1.525e-03, -5.655e-05,
        -2.198e-05, -1.716e-04,  5.564e-05, -3.797e-03, -1.015e-03,  8.750e-05,
        -7.043e-04,  1.839e-05, -7.044e-05, -2.822e-05, -6.036e-04, -9.331e-06,
        -3.453e-04,  4.073e-06, -5.985e-04,  1.031e-04,  1.179e-03, -1.095e-05,
         9.608e-04,  1.056e-06, -9.230e-05, -3.468e-03, -1.134e-05, -4.388e-05,
        -1.940e-05,  1.268e-04, -1.246e-04, -6.581e-05, -2.903e-05,  2.667e-05,
        -2.620e-04, -5.223e-06, -9.628e-05, -5.436e-06, -6.218e-04,  2.770e-03,
        -3.756e-05,  1.319e-03,  3.043e-05, -2.769e-05, -3.615e-04,  6.936e-07,
        -3.412e-04, -7.279e-05,  6.901e-06,  5.179e-06,  3.229e-04, -4.040e-06,
         2.232e-04, -2.079e-04], device='cuda:0')
v tensor([1.000e-12, 6.661e-04, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.111e-05, 1.000e-12,
        8.165e-06, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        6.078e-03, 1.000e-12, 1.000e-12, 1.000e-12, 4.357e-05, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.975e-05, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.284e-05, 1.762e-05, 1.000e-12,
        1.000e-12, 6.602e-04, 1.000e-12, 3.156e-05, 1.000e-12, 1.000e-12,
        1.000e-12, 1.522e-04, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 6.409e-05, 1.000e-12, 1.000e-12, 1.000e-12,
        3.435e-05, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.208e-04, 1.000e-12, 4.561e-05, 1.000e-12,
        1.000e-12, 1.000e-12, 2.657e-05, 3.436e-04, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 2.785e-07, 1.000e-12,
        4.164e-04, 4.339e-04, 1.000e-12, 1.490e-03, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 4.618e-05, 1.576e-05, 6.189e-06,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 4.428e-03, 3.721e-07,
        1.000e-12, 1.000e-12, 1.000e-12, 7.337e-06, 5.042e-05, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 8.725e-07, 1.000e-12, 6.272e-05,
        1.000e-12, 3.125e-04, 1.000e-12, 2.061e-04, 1.000e-12, 1.000e-12,
        6.875e-05, 2.677e-04, 1.000e-12, 1.000e-12, 1.400e-03, 2.817e-03,
        3.236e-05, 1.000e-12, 2.796e-05, 1.000e-12, 1.000e-12, 1.494e-06,
        2.515e-05, 1.000e-12, 1.000e-12, 2.257e-06, 1.000e-12, 1.000e-12,
        5.197e-07, 1.000e-12, 1.685e-06, 4.321e-03, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 5.564e-05, 1.000e-12, 1.000e-12, 8.750e-05,
        1.000e-12, 1.839e-05, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 4.073e-06, 1.000e-12, 1.031e-04, 1.179e-03, 1.000e-12,
        9.608e-04, 1.056e-06, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.268e-04, 1.000e-12, 1.000e-12, 1.000e-12, 2.667e-05,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 2.770e-03,
        1.000e-12, 1.319e-03, 3.043e-05, 1.000e-12, 1.000e-12, 6.936e-07,
        1.000e-12, 1.000e-12, 6.901e-06, 5.179e-06, 3.229e-04, 1.000e-12,
        2.232e-04, 1.000e-12], device='cuda:0')
v before min max tensor([[[ 1.759e-03],
         [-3.222e-03],
         [ 5.135e-05],
         [-1.058e-03],
         [-4.134e-03],
         [ 3.510e-07],
         [ 1.078e-04],
         [ 4.857e-04],
         [ 1.292e-03],
         [-4.663e-04]],

        [[-6.503e-04],
         [ 8.297e-04],
         [-8.528e-04],
         [-6.733e-04],
         [-4.403e-04],
         [ 6.522e-04],
         [-6.480e-04],
         [ 3.951e-03],
         [ 2.021e-03],
         [-3.546e-04]],

        [[-3.152e-03],
         [ 4.241e-03],
         [ 9.194e-05],
         [-9.734e-04],
         [-1.653e-03],
         [-2.197e-04],
         [-1.746e-03],
         [-1.988e-04],
         [ 2.158e-03],
         [ 1.594e-03]],

        [[-1.168e-03],
         [-8.346e-05],
         [-6.636e-05],
         [-4.563e-04],
         [-1.203e-04],
         [-3.433e-04],
         [ 6.235e-06],
         [ 2.642e-04],
         [ 1.105e-03],
         [-5.241e-04]],

        [[-8.024e-04],
         [ 2.984e-04],
         [-8.153e-05],
         [-5.053e-04],
         [ 5.035e-03],
         [-7.616e-04],
         [ 4.596e-03],
         [ 2.102e-03],
         [-5.236e-04],
         [-1.112e-03]],

        [[ 8.431e-03],
         [-5.894e-05],
         [-1.552e-03],
         [-1.080e-03],
         [-7.733e-05],
         [-2.336e-03],
         [-2.756e-04],
         [ 1.715e-04],
         [ 1.006e-04],
         [-4.001e-04]],

        [[ 1.089e-03],
         [-3.719e-04],
         [-2.666e-04],
         [-1.064e-04],
         [-1.031e-03],
         [-6.223e-04],
         [-3.215e-03],
         [-5.243e-04],
         [-4.585e-05],
         [-1.819e-03]],

        [[-3.708e-05],
         [ 1.981e-03],
         [-1.585e-03],
         [-2.523e-03],
         [-7.690e-04],
         [-6.941e-04],
         [ 1.043e-03],
         [ 1.871e-03],
         [-7.458e-04],
         [ 1.794e-04]],

        [[ 6.132e-04],
         [-3.485e-05],
         [-5.756e-04],
         [ 1.804e-04],
         [-1.485e-04],
         [-8.008e-04],
         [ 1.845e-03],
         [ 1.039e-05],
         [-7.557e-05],
         [-3.771e-05]],

        [[-2.472e-04],
         [-1.904e-04],
         [-1.276e-03],
         [-2.880e-04],
         [-2.911e-04],
         [-2.173e-04],
         [-2.815e-04],
         [ 2.601e-06],
         [ 1.103e-03],
         [-2.871e-03]],

        [[-8.104e-05],
         [ 1.096e-04],
         [-9.607e-04],
         [-3.112e-04],
         [-3.677e-04],
         [-7.297e-06],
         [-4.366e-04],
         [ 7.037e-05],
         [ 5.332e-04],
         [ 6.899e-04]],

        [[ 4.857e-04],
         [-1.899e-05],
         [-7.549e-04],
         [-1.756e-04],
         [-2.024e-04],
         [-1.632e-05],
         [-1.010e-04],
         [ 6.403e-05],
         [-1.830e-04],
         [ 1.336e-06]],

        [[-2.460e-04],
         [-7.683e-04],
         [ 2.695e-02],
         [-2.887e-03],
         [-4.956e-04],
         [ 4.850e-03],
         [ 1.122e-03],
         [-1.102e-03],
         [-1.712e-03],
         [ 1.567e-03]],

        [[-2.575e-04],
         [-8.735e-05],
         [-1.813e-03],
         [-2.109e-04],
         [ 1.018e-04],
         [-1.828e-04],
         [ 3.823e-05],
         [ 4.834e-04],
         [ 7.081e-06],
         [-2.362e-04]],

        [[-4.022e-04],
         [-9.236e-04],
         [-2.989e-04],
         [-1.152e-04],
         [ 6.055e-04],
         [ 3.763e-04],
         [-5.371e-04],
         [ 3.514e-04],
         [ 1.385e-04],
         [-8.237e-05]],

        [[ 1.835e-04],
         [-1.780e-03],
         [-3.087e-04],
         [ 9.951e-04],
         [-6.303e-04],
         [ 8.414e-03],
         [-4.523e-04],
         [-1.452e-04],
         [-2.923e-04],
         [-1.026e-04]],

        [[-1.033e-04],
         [-3.632e-05],
         [-6.416e-04],
         [ 2.334e-04],
         [-4.924e-04],
         [ 4.593e-05],
         [-9.819e-05],
         [-4.476e-04],
         [-1.113e-04],
         [-2.720e-03]],

        [[-1.126e-03],
         [-1.616e-03],
         [-2.068e-03],
         [-1.854e-04],
         [-4.013e-03],
         [-1.651e-03],
         [-6.526e-04],
         [-1.552e-05],
         [ 2.209e-03],
         [-4.760e-04]],

        [[ 5.795e-04],
         [ 5.127e-04],
         [-3.680e-04],
         [ 2.710e-03],
         [ 6.021e-05],
         [-2.202e-04],
         [ 1.902e-04],
         [-1.819e-03],
         [-2.684e-04],
         [ 1.533e-03]],

        [[ 9.202e-04],
         [ 2.687e-04],
         [-6.264e-04],
         [ 2.444e-05],
         [-2.964e-05],
         [ 6.543e-06],
         [ 7.088e-05],
         [-2.581e-05],
         [ 4.320e-04],
         [-1.136e-04]]], device='cuda:0')
v tensor([[[1.759e-03],
         [1.000e-12],
         [5.135e-05],
         [1.000e-12],
         [1.000e-12],
         [3.510e-07],
         [1.078e-04],
         [4.857e-04],
         [1.292e-03],
         [1.000e-12]],

        [[1.000e-12],
         [8.297e-04],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [6.522e-04],
         [1.000e-12],
         [3.951e-03],
         [2.021e-03],
         [1.000e-12]],

        [[1.000e-12],
         [4.241e-03],
         [9.194e-05],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.158e-03],
         [1.594e-03]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [6.235e-06],
         [2.642e-04],
         [1.105e-03],
         [1.000e-12]],

        [[1.000e-12],
         [2.984e-04],
         [1.000e-12],
         [1.000e-12],
         [5.035e-03],
         [1.000e-12],
         [4.596e-03],
         [2.102e-03],
         [1.000e-12],
         [1.000e-12]],

        [[8.431e-03],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.715e-04],
         [1.006e-04],
         [1.000e-12]],

        [[1.089e-03],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.981e-03],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.043e-03],
         [1.871e-03],
         [1.000e-12],
         [1.794e-04]],

        [[6.132e-04],
         [1.000e-12],
         [1.000e-12],
         [1.804e-04],
         [1.000e-12],
         [1.000e-12],
         [1.845e-03],
         [1.039e-05],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.601e-06],
         [1.103e-03],
         [1.000e-12]],

        [[1.000e-12],
         [1.096e-04],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [7.037e-05],
         [5.332e-04],
         [6.899e-04]],

        [[4.857e-04],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [6.403e-05],
         [1.000e-12],
         [1.336e-06]],

        [[1.000e-12],
         [1.000e-12],
         [2.695e-02],
         [1.000e-12],
         [1.000e-12],
         [4.850e-03],
         [1.122e-03],
         [1.000e-12],
         [1.000e-12],
         [1.567e-03]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.018e-04],
         [1.000e-12],
         [3.823e-05],
         [4.834e-04],
         [7.081e-06],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [6.055e-04],
         [3.763e-04],
         [1.000e-12],
         [3.514e-04],
         [1.385e-04],
         [1.000e-12]],

        [[1.835e-04],
         [1.000e-12],
         [1.000e-12],
         [9.951e-04],
         [1.000e-12],
         [8.414e-03],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.334e-04],
         [1.000e-12],
         [4.593e-05],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.209e-03],
         [1.000e-12]],

        [[5.795e-04],
         [5.127e-04],
         [1.000e-12],
         [2.710e-03],
         [6.021e-05],
         [1.000e-12],
         [1.902e-04],
         [1.000e-12],
         [1.000e-12],
         [1.533e-03]],

        [[9.202e-04],
         [2.687e-04],
         [1.000e-12],
         [2.444e-05],
         [1.000e-12],
         [6.543e-06],
         [7.088e-05],
         [1.000e-12],
         [4.320e-04],
         [1.000e-12]]], device='cuda:0')
v before min max tensor([[ 0.003],
        [ 0.007],
        [ 0.000],
        [ 0.001],
        [ 0.000],
        [ 0.002],
        [ 0.003],
        [-0.001],
        [ 0.000],
        [-0.001],
        [ 0.000],
        [-0.001],
        [ 0.002],
        [-0.001],
        [-0.001],
        [-0.001],
        [-0.001],
        [ 0.000],
        [-0.003],
        [ 0.003]], device='cuda:0')
v tensor([[2.961e-03],
        [6.971e-03],
        [4.689e-04],
        [1.403e-03],
        [2.407e-04],
        [1.963e-03],
        [3.073e-03],
        [1.000e-12],
        [4.849e-04],
        [1.000e-12],
        [3.168e-04],
        [1.000e-12],
        [1.648e-03],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [3.282e-04],
        [1.000e-12],
        [3.498e-03]], device='cuda:0')
a after update for 1 param tensor([[-2.657e-05, -6.020e-07, -8.194e-06,  ...,  2.578e-05,  1.313e-05,
         -2.817e-05],
        [-4.853e-05, -2.368e-05,  1.327e-05,  ..., -8.160e-06, -5.727e-07,
         -1.294e-05],
        [ 6.207e-05, -4.841e-06, -2.161e-05,  ...,  4.351e-06, -5.125e-05,
          4.866e-06],
        ...,
        [ 2.151e-04,  1.711e-06, -3.824e-05,  ..., -5.078e-06,  1.168e-05,
          1.229e-04],
        [-1.652e-05, -2.189e-06, -1.737e-05,  ..., -2.913e-05,  1.855e-05,
         -9.541e-05],
        [ 2.994e-05,  6.161e-06,  8.992e-06,  ..., -8.403e-06,  4.037e-05,
         -6.215e-05]], device='cuda:0')
s after update for 1 param tensor([[3.349e-03, 3.100e-05, 4.184e-04,  ..., 9.987e-05, 8.932e-03,
         5.671e-04],
        [4.098e-03, 5.969e-04, 5.083e-03,  ..., 6.245e-04, 4.279e-04,
         3.814e-04],
        [2.163e-03, 3.394e-03, 2.161e-03,  ..., 1.945e-04, 3.465e-03,
         1.240e-04],
        ...,
        [2.920e-02, 4.647e-03, 9.261e-04,  ..., 8.838e-04, 1.863e-03,
         3.439e-03],
        [1.142e-03, 1.250e-03, 4.856e-04,  ..., 5.978e-04, 5.507e-04,
         9.633e-03],
        [1.135e-02, 6.051e-05, 7.867e-04,  ..., 1.616e-04, 4.930e-03,
         8.282e-03]], device='cuda:0')
b after update for 1 param tensor([[0.210, 0.020, 0.074,  ..., 0.036, 0.342, 0.086],
        [0.232, 0.088, 0.258,  ..., 0.091, 0.075, 0.071],
        [0.168, 0.211, 0.168,  ..., 0.051, 0.213, 0.040],
        ...,
        [0.619, 0.247, 0.110,  ..., 0.108, 0.156, 0.212],
        [0.122, 0.128, 0.080,  ..., 0.089, 0.085, 0.356],
        [0.386, 0.028, 0.102,  ..., 0.046, 0.254, 0.330]], device='cuda:0')
clipping threshold 2.782537623814828
a after update for 1 param tensor([ 6.155e-06,  7.962e-05, -3.409e-06, -2.395e-06,  2.802e-06, -2.388e-05,
         1.456e-05,  1.635e-05, -2.561e-06,  8.528e-06, -1.313e-05,  2.664e-06,
         2.822e-06, -1.559e-05, -1.110e-05, -4.467e-06,  5.640e-06, -1.073e-05,
         8.887e-06, -4.449e-08, -6.234e-06, -4.755e-06, -3.995e-06,  1.160e-07,
        -1.877e-04, -2.454e-06,  2.633e-06,  2.176e-06, -2.132e-05, -9.130e-06,
         1.442e-05, -3.347e-05,  5.914e-05,  3.830e-07,  1.478e-05, -7.380e-07,
         4.354e-06,  2.082e-05, -1.398e-06,  7.972e-06, -1.124e-05,  6.903e-06,
        -5.251e-06, -2.752e-05, -8.668e-06,  7.859e-06, -3.627e-06,  2.642e-07,
         6.133e-06,  5.092e-05, -9.729e-05,  3.512e-05,  1.290e-06, -2.742e-06,
         9.242e-06,  2.248e-05, -1.305e-05,  1.047e-05, -7.472e-06, -3.029e-05,
        -4.409e-06,  3.241e-06, -1.107e-04, -6.162e-06, -2.402e-05,  6.883e-07,
         1.330e-05,  1.361e-05, -5.744e-05,  7.525e-06,  1.517e-07,  3.061e-05,
         1.440e-07, -2.658e-06,  1.704e-05,  3.662e-06,  2.127e-05, -2.830e-06,
        -2.346e-06,  7.555e-07,  7.575e-06,  6.341e-05,  3.569e-07, -1.287e-06,
        -8.916e-05,  1.759e-05,  2.415e-06,  7.346e-06, -6.326e-07,  8.086e-06,
        -3.223e-05, -3.707e-05, -7.379e-06, -6.497e-05,  7.419e-06, -6.665e-06,
         8.513e-07,  6.940e-06, -3.934e-05, -6.996e-06, -1.129e-05, -7.657e-06,
        -5.213e-06,  4.273e-06,  2.173e-05,  1.113e-05,  1.403e-04,  2.026e-06,
         1.550e-06,  5.187e-05, -1.000e-06, -3.994e-06, -1.749e-05,  1.097e-05,
        -4.779e-06,  8.513e-06,  1.434e-05, -1.382e-05, -1.476e-05, -1.329e-05,
         1.052e-06,  2.856e-05, -6.038e-06,  2.617e-05,  3.754e-06, -1.196e-05,
         2.277e-05, -1.137e-05,  2.506e-05, -1.417e-05, -6.255e-05,  9.117e-05,
        -1.235e-05, -1.256e-05,  1.246e-05, -6.577e-06,  4.398e-06,  3.536e-06,
        -2.057e-05, -3.188e-05,  1.956e-06,  2.750e-06,  5.512e-07, -8.349e-06,
         1.832e-06, -6.310e-06, -3.332e-06, -1.492e-04, -1.550e-06, -1.107e-05,
        -7.665e-06, -9.077e-07,  2.964e-05,  8.424e-05, -5.900e-05, -1.813e-05,
        -8.878e-05, -3.902e-07, -3.477e-06,  1.588e-05,  9.182e-06, -4.428e-06,
         3.449e-05,  3.765e-06,  5.203e-06,  1.547e-05,  6.319e-05,  4.467e-06,
        -5.514e-05,  8.087e-07,  2.892e-06, -5.781e-05, -8.672e-07,  3.051e-06,
         2.646e-06,  1.873e-05, -1.057e-05,  4.581e-06,  1.152e-06, -1.423e-05,
         1.780e-05,  9.996e-06,  1.534e-05,  1.476e-06, -9.443e-06,  7.542e-05,
         3.851e-06,  2.629e-05, -5.811e-06, -3.142e-06, -1.649e-05, -1.693e-06,
         6.886e-06,  1.209e-05,  4.047e-05,  6.329e-06, -2.634e-05, -7.155e-06,
        -2.009e-05,  3.686e-08], device='cuda:0')
s after update for 1 param tensor([5.231e-05, 8.519e-03, 2.929e-05, 4.755e-05, 2.934e-04, 9.057e-03,
        2.696e-04, 3.190e-04, 6.057e-04, 3.636e-04, 4.879e-04, 2.627e-04,
        1.153e-05, 1.455e-03, 3.249e-05, 2.287e-03, 1.054e-03, 1.946e-04,
        9.589e-04, 1.905e-05, 1.754e-04, 1.665e-03, 2.084e-04, 2.856e-06,
        2.544e-02, 1.217e-04, 1.396e-03, 1.904e-05, 2.088e-03, 8.087e-05,
        1.020e-03, 2.271e-03, 4.236e-03, 1.882e-06, 1.418e-03, 7.548e-04,
        4.747e-05, 3.381e-03, 4.492e-04, 1.369e-04, 6.206e-05, 1.733e-03,
        7.259e-05, 2.278e-03, 8.336e-05, 1.133e-03, 1.327e-03, 3.734e-05,
        8.065e-05, 8.154e-03, 6.234e-03, 1.880e-03, 1.443e-05, 2.539e-05,
        1.585e-03, 3.904e-03, 5.213e-04, 1.623e-04, 3.699e-04, 1.531e-03,
        4.036e-05, 3.202e-04, 4.987e-03, 1.855e-04, 1.521e-03, 4.108e-06,
        1.855e-03, 3.857e-03, 3.718e-03, 1.540e-04, 4.827e-04, 8.941e-04,
        7.244e-06, 2.900e-05, 3.478e-03, 5.078e-05, 2.139e-03, 4.981e-05,
        4.524e-04, 9.092e-06, 1.632e-03, 6.215e-03, 1.882e-06, 3.555e-04,
        8.942e-03, 2.696e-04, 1.180e-04, 7.869e-05, 1.669e-04, 4.643e-04,
        6.454e-03, 6.618e-03, 8.485e-05, 1.236e-02, 1.016e-04, 6.661e-05,
        1.002e-04, 4.716e-05, 3.241e-03, 2.162e-03, 1.267e-03, 7.868e-04,
        5.635e-04, 2.953e-04, 1.415e-03, 3.564e-04, 2.149e-02, 1.929e-04,
        3.034e-05, 8.866e-04, 2.940e-06, 8.566e-04, 2.291e-03, 1.666e-03,
        4.606e-04, 6.223e-04, 3.114e-04, 3.047e-04, 1.994e-03, 2.506e-03,
        7.514e-06, 5.592e-03, 2.144e-04, 4.564e-03, 1.131e-04, 1.380e-04,
        2.642e-03, 5.218e-03, 3.095e-04, 2.700e-03, 1.218e-02, 1.685e-02,
        1.801e-03, 2.148e-04, 1.673e-03, 5.432e-04, 1.390e-05, 3.865e-04,
        1.588e-03, 4.805e-04, 9.303e-05, 4.753e-04, 1.882e-06, 1.658e-04,
        2.280e-04, 2.261e-04, 4.106e-04, 2.166e-02, 4.218e-03, 1.707e-04,
        8.382e-05, 5.788e-04, 2.387e-03, 1.106e-02, 4.053e-03, 2.963e-03,
        4.676e-03, 1.358e-03, 3.599e-04, 1.788e-04, 1.478e-03, 2.287e-05,
        1.810e-03, 6.389e-04, 2.248e-03, 3.213e-03, 1.113e-02, 2.804e-05,
        9.818e-03, 3.249e-04, 1.137e-03, 8.489e-03, 2.954e-05, 1.116e-04,
        8.575e-05, 3.567e-03, 3.111e-04, 2.010e-04, 7.472e-05, 1.635e-03,
        6.416e-04, 6.206e-05, 2.356e-04, 1.330e-05, 1.545e-03, 1.811e-02,
        1.136e-04, 1.359e-02, 1.745e-03, 9.085e-05, 2.375e-03, 2.634e-04,
        8.581e-04, 1.885e-04, 3.310e-03, 7.197e-04, 5.687e-03, 8.559e-05,
        4.728e-03, 5.593e-04], device='cuda:0')
b after update for 1 param tensor([0.026, 0.334, 0.020, 0.025, 0.062, 0.345, 0.059, 0.065, 0.089, 0.069,
        0.080, 0.059, 0.012, 0.138, 0.021, 0.173, 0.118, 0.051, 0.112, 0.016,
        0.048, 0.148, 0.052, 0.006, 0.578, 0.040, 0.135, 0.016, 0.166, 0.033,
        0.116, 0.173, 0.236, 0.005, 0.136, 0.100, 0.025, 0.211, 0.077, 0.042,
        0.029, 0.151, 0.031, 0.173, 0.033, 0.122, 0.132, 0.022, 0.033, 0.327,
        0.286, 0.157, 0.014, 0.018, 0.144, 0.226, 0.083, 0.046, 0.070, 0.142,
        0.023, 0.065, 0.256, 0.049, 0.141, 0.007, 0.156, 0.225, 0.221, 0.045,
        0.080, 0.108, 0.010, 0.020, 0.214, 0.026, 0.168, 0.026, 0.077, 0.011,
        0.146, 0.286, 0.005, 0.068, 0.343, 0.059, 0.039, 0.032, 0.047, 0.078,
        0.291, 0.295, 0.033, 0.403, 0.037, 0.030, 0.036, 0.025, 0.206, 0.168,
        0.129, 0.102, 0.086, 0.062, 0.136, 0.068, 0.531, 0.050, 0.020, 0.108,
        0.006, 0.106, 0.173, 0.148, 0.078, 0.090, 0.064, 0.063, 0.162, 0.181,
        0.010, 0.271, 0.053, 0.245, 0.039, 0.043, 0.186, 0.262, 0.064, 0.188,
        0.400, 0.470, 0.154, 0.053, 0.148, 0.084, 0.014, 0.071, 0.144, 0.079,
        0.035, 0.079, 0.005, 0.047, 0.055, 0.054, 0.073, 0.533, 0.235, 0.047,
        0.033, 0.087, 0.177, 0.381, 0.231, 0.197, 0.248, 0.133, 0.069, 0.048,
        0.139, 0.017, 0.154, 0.092, 0.172, 0.205, 0.382, 0.019, 0.359, 0.065,
        0.122, 0.334, 0.020, 0.038, 0.034, 0.216, 0.064, 0.051, 0.031, 0.146,
        0.092, 0.029, 0.056, 0.013, 0.142, 0.487, 0.039, 0.422, 0.151, 0.035,
        0.177, 0.059, 0.106, 0.050, 0.208, 0.097, 0.273, 0.034, 0.249, 0.086],
       device='cuda:0')
clipping threshold 2.782537623814828
a after update for 1 param tensor([[[ 9.277e-05],
         [ 5.305e-05],
         [ 6.239e-05],
         [-5.476e-06],
         [-3.218e-05],
         [ 1.060e-04],
         [ 9.675e-05],
         [ 9.773e-05],
         [ 1.067e-04],
         [ 2.918e-05]],

        [[-2.695e-05],
         [-1.063e-04],
         [ 5.890e-07],
         [ 3.246e-06],
         [-9.850e-05],
         [ 2.706e-05],
         [-2.537e-05],
         [-1.964e-04],
         [-1.605e-04],
         [-2.170e-06]],

        [[-8.069e-05],
         [-1.014e-04],
         [-5.034e-05],
         [-8.865e-05],
         [-1.628e-05],
         [-6.671e-05],
         [-8.860e-05],
         [-6.679e-05],
         [-1.228e-04],
         [-1.154e-04]],

        [[ 1.569e-05],
         [-7.532e-06],
         [ 3.961e-06],
         [ 3.136e-06],
         [-5.368e-06],
         [-1.685e-05],
         [-1.998e-05],
         [ 2.836e-05],
         [ 5.811e-05],
         [ 1.152e-04]],

        [[ 1.122e-05],
         [-2.805e-05],
         [ 4.519e-06],
         [ 2.591e-05],
         [-1.668e-04],
         [ 1.716e-05],
         [ 9.301e-05],
         [-7.664e-05],
         [-1.316e-05],
         [ 9.899e-05]],

        [[ 1.816e-04],
         [-8.699e-06],
         [ 5.974e-05],
         [ 9.835e-06],
         [ 7.739e-05],
         [ 8.077e-05],
         [-2.308e-06],
         [ 9.318e-05],
         [ 3.861e-05],
         [ 4.138e-05]],

        [[-6.304e-05],
         [ 1.424e-05],
         [-6.525e-06],
         [-3.030e-06],
         [ 3.510e-05],
         [ 2.341e-05],
         [-5.262e-05],
         [-7.355e-06],
         [-2.322e-06],
         [ 5.716e-05]],

        [[ 1.609e-05],
         [ 1.119e-04],
         [ 6.024e-05],
         [ 3.615e-05],
         [ 3.969e-05],
         [ 2.688e-05],
         [-6.487e-05],
         [ 9.881e-05],
         [ 1.930e-05],
         [ 4.320e-05]],

        [[-5.637e-05],
         [-9.770e-06],
         [ 1.834e-06],
         [ 2.885e-05],
         [-1.658e-05],
         [-3.446e-05],
         [-6.940e-05],
         [-3.874e-05],
         [ 5.410e-05],
         [-4.382e-05]],

        [[-8.864e-06],
         [-8.296e-06],
         [-1.842e-05],
         [-4.458e-05],
         [-5.249e-05],
         [ 1.076e-06],
         [-1.603e-05],
         [-2.415e-05],
         [-3.798e-05],
         [-5.782e-05]],

        [[-2.803e-05],
         [ 1.835e-05],
         [-1.610e-05],
         [ 1.914e-05],
         [ 1.704e-06],
         [-5.038e-06],
         [-9.363e-06],
         [ 2.814e-05],
         [ 3.002e-05],
         [ 6.028e-05]],

        [[-5.060e-05],
         [ 2.970e-05],
         [-5.291e-05],
         [-9.922e-06],
         [-8.937e-06],
         [-6.494e-06],
         [-1.048e-05],
         [-1.674e-05],
         [-4.423e-06],
         [-1.359e-05]],

        [[ 5.447e-05],
         [-2.109e-05],
         [ 3.120e-04],
         [ 4.954e-05],
         [-1.656e-06],
         [ 1.000e-04],
         [ 7.319e-05],
         [ 2.777e-05],
         [ 1.131e-04],
         [ 7.406e-05]],

        [[ 1.043e-05],
         [ 1.587e-05],
         [ 1.804e-05],
         [ 1.373e-05],
         [-2.265e-05],
         [ 2.064e-05],
         [ 3.030e-05],
         [ 3.190e-05],
         [ 3.876e-05],
         [ 6.531e-06]],

        [[ 5.409e-05],
         [-1.555e-05],
         [-6.918e-06],
         [ 2.298e-05],
         [ 5.838e-05],
         [ 3.897e-05],
         [-1.706e-05],
         [ 2.300e-05],
         [ 2.875e-05],
         [ 1.039e-05]],

        [[ 5.776e-05],
         [ 9.225e-05],
         [-2.815e-05],
         [ 8.470e-05],
         [-4.432e-06],
         [ 2.294e-04],
         [-3.225e-07],
         [ 1.262e-05],
         [ 5.837e-06],
         [ 7.421e-06]],

        [[ 2.309e-06],
         [ 1.747e-05],
         [-4.751e-05],
         [ 1.235e-05],
         [ 6.926e-07],
         [ 1.494e-05],
         [-9.585e-06],
         [ 6.159e-05],
         [-6.965e-06],
         [-7.740e-05]],

        [[-6.614e-05],
         [-7.984e-05],
         [-1.183e-04],
         [-1.587e-05],
         [-7.308e-05],
         [-4.560e-05],
         [-2.113e-05],
         [-5.818e-05],
         [ 4.853e-05],
         [ 8.180e-05]],

        [[ 1.854e-04],
         [-3.361e-05],
         [ 1.681e-05],
         [ 9.518e-05],
         [ 4.573e-05],
         [ 2.890e-07],
         [ 3.743e-05],
         [ 2.220e-05],
         [ 1.587e-05],
         [ 3.721e-05]],

        [[ 5.455e-05],
         [ 4.242e-05],
         [-6.398e-08],
         [ 1.155e-05],
         [-8.378e-06],
         [ 3.428e-06],
         [ 1.677e-05],
         [ 8.070e-06],
         [ 5.076e-05],
         [-5.981e-06]]], device='cuda:0')
s after update for 1 param tensor([[[1.334e-02],
         [7.975e-03],
         [2.533e-03],
         [2.952e-03],
         [1.065e-02],
         [3.375e-03],
         [4.203e-03],
         [7.220e-03],
         [1.155e-02],
         [1.738e-03]],

        [[1.615e-03],
         [9.438e-03],
         [2.112e-03],
         [2.857e-03],
         [3.329e-03],
         [9.221e-03],
         [1.786e-03],
         [2.131e-02],
         [1.528e-02],
         [1.440e-02]],

        [[7.781e-03],
         [2.066e-02],
         [3.075e-03],
         [5.626e-03],
         [1.026e-02],
         [5.006e-03],
         [4.618e-03],
         [1.831e-03],
         [1.484e-02],
         [1.278e-02]],

        [[3.135e-03],
         [2.164e-04],
         [2.582e-04],
         [1.516e-03],
         [3.091e-04],
         [9.034e-04],
         [8.958e-04],
         [5.600e-03],
         [1.055e-02],
         [5.451e-03]],

        [[2.137e-03],
         [5.467e-03],
         [2.500e-04],
         [3.186e-03],
         [2.418e-02],
         [2.003e-03],
         [2.307e-02],
         [1.461e-02],
         [1.378e-03],
         [6.079e-03]],

        [[2.985e-02],
         [1.567e-04],
         [4.006e-03],
         [3.195e-03],
         [3.458e-03],
         [6.198e-03],
         [7.663e-04],
         [6.575e-03],
         [3.262e-03],
         [9.843e-04]],

        [[1.047e-02],
         [1.065e-03],
         [1.172e-03],
         [2.713e-04],
         [2.755e-03],
         [4.700e-03],
         [8.213e-03],
         [1.290e-03],
         [2.971e-04],
         [5.085e-03]],

        [[1.540e-04],
         [1.425e-02],
         [3.978e-03],
         [6.168e-03],
         [2.469e-03],
         [2.017e-03],
         [1.028e-02],
         [1.376e-02],
         [1.883e-03],
         [4.378e-03]],

        [[7.863e-03],
         [1.257e-04],
         [1.511e-03],
         [4.271e-03],
         [1.449e-03],
         [2.038e-03],
         [1.364e-02],
         [1.581e-03],
         [6.148e-04],
         [1.082e-03]],

        [[7.155e-04],
         [4.836e-04],
         [3.119e-03],
         [1.758e-03],
         [1.395e-03],
         [5.054e-03],
         [7.265e-04],
         [2.384e-03],
         [1.052e-02],
         [7.576e-03]],

        [[4.872e-04],
         [3.312e-03],
         [2.378e-03],
         [8.462e-04],
         [9.359e-04],
         [3.345e-04],
         [1.227e-03],
         [2.700e-03],
         [7.532e-03],
         [8.423e-03]],

        [[7.031e-03],
         [4.766e-04],
         [2.220e-03],
         [4.305e-04],
         [5.205e-04],
         [7.501e-05],
         [2.912e-04],
         [3.046e-03],
         [4.527e-04],
         [8.856e-04]],

        [[9.827e-03],
         [1.890e-03],
         [5.241e-02],
         [1.172e-02],
         [1.336e-03],
         [2.212e-02],
         [1.066e-02],
         [2.940e-03],
         [6.431e-03],
         [1.255e-02]],

        [[6.904e-04],
         [4.542e-04],
         [5.407e-03],
         [6.632e-04],
         [3.321e-03],
         [8.968e-04],
         [1.979e-03],
         [7.018e-03],
         [1.378e-03],
         [8.727e-04]],

        [[2.739e-03],
         [2.588e-03],
         [7.731e-04],
         [1.452e-03],
         [7.830e-03],
         [6.168e-03],
         [1.468e-03],
         [5.929e-03],
         [3.735e-03],
         [7.888e-04]],

        [[4.479e-03],
         [8.005e-03],
         [1.766e-03],
         [1.009e-02],
         [1.596e-03],
         [3.135e-02],
         [1.236e-03],
         [3.552e-04],
         [2.310e-03],
         [2.510e-04]],

        [[2.558e-04],
         [8.772e-04],
         [1.794e-03],
         [4.849e-03],
         [1.307e-03],
         [2.149e-03],
         [4.500e-04],
         [2.884e-03],
         [2.802e-04],
         [7.014e-03]],

        [[3.299e-03],
         [3.953e-03],
         [6.196e-03],
         [1.608e-03],
         [9.812e-03],
         [4.219e-03],
         [1.619e-03],
         [6.445e-04],
         [1.563e-02],
         [7.150e-03]],

        [[1.452e-02],
         [7.167e-03],
         [1.023e-03],
         [1.663e-02],
         [2.767e-03],
         [6.252e-04],
         [4.385e-03],
         [4.689e-03],
         [6.586e-04],
         [1.296e-02]],

        [[9.602e-03],
         [5.205e-03],
         [1.914e-03],
         [1.566e-03],
         [2.045e-04],
         [9.662e-04],
         [2.783e-03],
         [1.223e-04],
         [6.726e-03],
         [5.793e-04]]], device='cuda:0')
b after update for 1 param tensor([[[0.418],
         [0.323],
         [0.182],
         [0.197],
         [0.374],
         [0.210],
         [0.235],
         [0.308],
         [0.389],
         [0.151]],

        [[0.146],
         [0.352],
         [0.166],
         [0.194],
         [0.209],
         [0.348],
         [0.153],
         [0.529],
         [0.448],
         [0.435]],

        [[0.320],
         [0.521],
         [0.201],
         [0.272],
         [0.367],
         [0.256],
         [0.246],
         [0.155],
         [0.441],
         [0.409]],

        [[0.203],
         [0.053],
         [0.058],
         [0.141],
         [0.064],
         [0.109],
         [0.108],
         [0.271],
         [0.372],
         [0.267]],

        [[0.167],
         [0.268],
         [0.057],
         [0.204],
         [0.563],
         [0.162],
         [0.550],
         [0.438],
         [0.134],
         [0.282]],

        [[0.626],
         [0.045],
         [0.229],
         [0.205],
         [0.213],
         [0.285],
         [0.100],
         [0.294],
         [0.207],
         [0.114]],

        [[0.371],
         [0.118],
         [0.124],
         [0.060],
         [0.190],
         [0.248],
         [0.328],
         [0.130],
         [0.062],
         [0.258]],

        [[0.045],
         [0.432],
         [0.228],
         [0.284],
         [0.180],
         [0.163],
         [0.367],
         [0.425],
         [0.157],
         [0.240]],

        [[0.321],
         [0.041],
         [0.141],
         [0.237],
         [0.138],
         [0.164],
         [0.423],
         [0.144],
         [0.090],
         [0.119]],

        [[0.097],
         [0.080],
         [0.202],
         [0.152],
         [0.135],
         [0.258],
         [0.098],
         [0.177],
         [0.372],
         [0.315]],

        [[0.080],
         [0.208],
         [0.177],
         [0.105],
         [0.111],
         [0.066],
         [0.127],
         [0.188],
         [0.314],
         [0.332]],

        [[0.304],
         [0.079],
         [0.171],
         [0.075],
         [0.083],
         [0.031],
         [0.062],
         [0.200],
         [0.077],
         [0.108]],

        [[0.359],
         [0.157],
         [0.829],
         [0.392],
         [0.132],
         [0.539],
         [0.374],
         [0.196],
         [0.290],
         [0.406]],

        [[0.095],
         [0.077],
         [0.266],
         [0.093],
         [0.209],
         [0.108],
         [0.161],
         [0.303],
         [0.134],
         [0.107]],

        [[0.190],
         [0.184],
         [0.101],
         [0.138],
         [0.321],
         [0.284],
         [0.139],
         [0.279],
         [0.221],
         [0.102]],

        [[0.242],
         [0.324],
         [0.152],
         [0.364],
         [0.145],
         [0.641],
         [0.127],
         [0.068],
         [0.174],
         [0.057]],

        [[0.058],
         [0.107],
         [0.153],
         [0.252],
         [0.131],
         [0.168],
         [0.077],
         [0.195],
         [0.061],
         [0.303]],

        [[0.208],
         [0.228],
         [0.285],
         [0.145],
         [0.359],
         [0.235],
         [0.146],
         [0.092],
         [0.453],
         [0.306]],

        [[0.436],
         [0.307],
         [0.116],
         [0.467],
         [0.191],
         [0.091],
         [0.240],
         [0.248],
         [0.093],
         [0.412]],

        [[0.355],
         [0.261],
         [0.158],
         [0.143],
         [0.052],
         [0.113],
         [0.191],
         [0.040],
         [0.297],
         [0.087]]], device='cuda:0')
clipping threshold 2.782537623814828
a after update for 1 param tensor([[ 1.165e-04],
        [-3.464e-04],
        [-8.792e-05],
        [-1.358e-04],
        [-1.215e-04],
        [ 1.402e-04],
        [ 8.176e-05],
        [ 5.650e-05],
        [ 9.997e-06],
        [-2.592e-05],
        [ 2.063e-05],
        [-3.168e-05],
        [ 1.154e-04],
        [ 5.766e-06],
        [-4.784e-05],
        [ 1.691e-05],
        [-7.255e-05],
        [-7.582e-05],
        [ 7.919e-05],
        [ 6.668e-05]], device='cuda:0')
s after update for 1 param tensor([[0.017],
        [0.033],
        [0.007],
        [0.014],
        [0.008],
        [0.015],
        [0.018],
        [0.004],
        [0.007],
        [0.002],
        [0.006],
        [0.002],
        [0.013],
        [0.002],
        [0.002],
        [0.003],
        [0.002],
        [0.007],
        [0.007],
        [0.019]], device='cuda:0')
b after update for 1 param tensor([[0.477],
        [0.656],
        [0.305],
        [0.430],
        [0.333],
        [0.448],
        [0.483],
        [0.225],
        [0.304],
        [0.169],
        [0.272],
        [0.171],
        [0.413],
        [0.144],
        [0.159],
        [0.190],
        [0.169],
        [0.304],
        [0.306],
        [0.496]], device='cuda:0')
clipping threshold 2.782537623814828
||w||^2 0.12031267645797192
exp ma of ||w||^2 0.10424361032489375
||w|| 0.3468611775018529
exp ma of ||w|| 0.31601887371121024
||w||^2 0.12528557876682636
exp ma of ||w||^2 0.10217932018071413
||w|| 0.35395702954854047
exp ma of ||w|| 0.3137405957255639
||w||^2 0.061642855445072545
exp ma of ||w||^2 0.10933649283140122
||w|| 0.24827979266358458
exp ma of ||w|| 0.3224849628764583
||w||^2 0.12119663138439363
exp ma of ||w||^2 0.11545955501122183
||w|| 0.3481330656292126
exp ma of ||w|| 0.33149641396259516
||w||^2 0.12624342140538666
exp ma of ||w||^2 0.12031170322370968
||w|| 0.3553075026021638
exp ma of ||w|| 0.3370136985490936
||w||^2 0.10810764733735907
exp ma of ||w||^2 0.11775907443028316
||w|| 0.32879727392020613
exp ma of ||w|| 0.33546004467818175
||w||^2 0.16442879385020934
exp ma of ||w||^2 0.11436922623771098
||w|| 0.4054982044968995
exp ma of ||w|| 0.3285836581635845
v before min max tensor([[-1.130,  0.145, -0.473,  ..., -0.594, -0.294,  0.285],
        [-1.864,  0.956, -0.145,  ..., -0.363, -0.722, -0.691],
        [-0.668,  1.165, -1.361,  ..., -0.792, -1.337, -0.337],
        ...,
        [-0.568, -0.932, -0.734,  ..., -0.538, -0.386, -0.629],
        [-1.706, -0.867, -1.242,  ..., -0.012, -0.686,  0.326],
        [-0.420, -1.351,  0.961,  ...,  3.080, -0.734, -0.065]],
       device='cuda:0')
v tensor([[1.000e-12, 1.449e-01, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         2.855e-01],
        [1.000e-12, 9.556e-01, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [1.000e-12, 1.165e+00, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        ...,
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         3.261e-01],
        [1.000e-12, 1.000e-12, 9.607e-01,  ..., 3.080e+00, 1.000e-12,
         1.000e-12]], device='cuda:0')
v before min max tensor([-0.947, -0.570, -1.065, -0.598,  1.040, -0.600, -0.667, -0.532, -0.858,
        -0.400, -0.277,  0.081, -0.031, -0.795, -0.444, -1.108, -0.942,  0.592,
        -0.246,  0.870, -1.084,  1.093,  3.561,  3.817, -0.845, -0.380, -0.630,
        -0.053, -1.969, -1.567, -0.265, -1.174, -1.079, -1.377, -1.460, -1.051,
        -1.182, -1.302, -1.066, -0.679,  1.310, -0.581,  0.296, -1.827,  1.452,
        -0.291,  0.069, -0.093, -1.257,  0.047, -0.566, -0.527, -0.936, -0.959,
        -1.952,  2.814, -0.103, -0.547, -0.134, -1.384, -0.947,  6.110,  2.049,
        -0.942, -1.127, -1.095, -0.845,  2.078, -0.901,  2.595,  2.194, -0.964,
         0.412, -0.596, -0.794,  2.432, -0.319, -0.231,  0.696, -0.169,  0.115,
        -0.256, -0.243, -0.803, -0.977, -0.325,  0.626, -1.161, -1.513, -0.221,
         2.660,  0.689, -0.795, -1.194, -0.368, -0.397,  0.065, -1.252, -0.127,
        -0.558,  1.119, -1.363, -0.138, -0.301,  2.247,  1.575, -0.273, -1.285,
        -0.603, -1.298, -0.179, -0.767, -1.420, -0.596, -0.526, -0.474, -0.284,
        -0.199,  2.012, -1.255,  1.404, -0.123, -0.728, -0.961, -1.779, -1.107,
        -0.940, -1.194, -1.105, -0.895, -0.493, -1.772,  2.855,  1.619, -0.296,
        -0.899, -1.139, -0.373, -0.231,  0.281, -0.251, -0.253, -0.949,  0.096,
        -0.624, -0.737, -0.438, -0.996, -0.849, -1.343, -1.880, -0.132, -0.248,
         0.082, -0.364,  1.478, -0.466, -1.318,  4.152, -0.425, -1.030,  1.326,
        -0.102, -0.130,  2.214, -0.136, -0.565, -0.228,  1.235, -0.727, -0.882,
        -0.431, -1.220,  1.010, -0.053, -0.654, -1.136, -0.582, -0.419, -1.017,
        -0.383, -0.825, -0.480,  0.790, -0.976, -0.796, -0.495, -0.476, -0.307,
         7.632, -1.202, -0.863,  0.152, -0.907, -0.481, -0.277, -0.815,  0.221,
        -1.052, -0.921], device='cuda:0')
v tensor([1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.040e+00, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 8.112e-02,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 5.918e-01,
        1.000e-12, 8.703e-01, 1.000e-12, 1.093e+00, 3.561e+00, 3.817e+00,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.310e+00, 1.000e-12,
        2.957e-01, 1.000e-12, 1.452e+00, 1.000e-12, 6.888e-02, 1.000e-12,
        1.000e-12, 4.665e-02, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 2.814e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 6.110e+00, 2.049e+00, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 2.078e+00, 1.000e-12, 2.595e+00, 2.194e+00, 1.000e-12,
        4.116e-01, 1.000e-12, 1.000e-12, 2.432e+00, 1.000e-12, 1.000e-12,
        6.960e-01, 1.000e-12, 1.146e-01, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 6.263e-01, 1.000e-12, 1.000e-12, 1.000e-12,
        2.660e+00, 6.887e-01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        6.549e-02, 1.000e-12, 1.000e-12, 1.000e-12, 1.119e+00, 1.000e-12,
        1.000e-12, 1.000e-12, 2.247e+00, 1.575e+00, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 2.012e+00, 1.000e-12,
        1.404e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        2.855e+00, 1.619e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 2.805e-01, 1.000e-12, 1.000e-12, 1.000e-12, 9.561e-02,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 8.238e-02, 1.000e-12, 1.478e+00,
        1.000e-12, 1.000e-12, 4.152e+00, 1.000e-12, 1.000e-12, 1.326e+00,
        1.000e-12, 1.000e-12, 2.214e+00, 1.000e-12, 1.000e-12, 1.000e-12,
        1.235e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.010e+00,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 7.905e-01, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 7.632e+00, 1.000e-12, 1.000e-12,
        1.516e-01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 2.213e-01,
        1.000e-12, 1.000e-12], device='cuda:0')
v before min max tensor([[[-1.060e+00],
         [-1.389e+00],
         [-1.524e+00],
         [-3.171e-01],
         [-1.146e+00],
         [ 3.409e+00],
         [-1.669e+00],
         [-1.108e+00],
         [-8.709e-01],
         [ 3.461e+00]],

        [[-9.160e-01],
         [-2.733e-01],
         [-6.602e-01],
         [-1.251e+00],
         [-1.856e+00],
         [-7.065e-01],
         [ 4.228e+00],
         [-1.528e+00],
         [ 1.936e+00],
         [-3.910e-01]],

        [[-4.555e-01],
         [ 1.735e+01],
         [ 5.969e+00],
         [-1.424e+00],
         [-3.930e-01],
         [-1.508e+00],
         [-2.782e-01],
         [-6.626e-01],
         [ 2.682e+00],
         [ 1.566e-01]],

        [[-8.228e-01],
         [ 1.585e+00],
         [-7.024e-02],
         [-2.227e+00],
         [-8.119e-01],
         [-2.030e+00],
         [-8.386e-01],
         [-2.312e+00],
         [ 1.142e-02],
         [-1.424e+00]],

        [[-2.158e+00],
         [-6.344e-01],
         [ 1.951e+00],
         [-1.636e+00],
         [-1.223e+00],
         [ 3.518e+00],
         [-1.593e+00],
         [ 4.699e-01],
         [-7.962e-01],
         [ 2.894e+00]],

        [[-2.328e+00],
         [ 2.436e+00],
         [ 1.488e+00],
         [-1.579e+00],
         [-8.504e-01],
         [-1.502e+00],
         [ 1.556e+00],
         [ 4.647e-01],
         [ 1.431e+00],
         [ 1.573e+00]],

        [[ 1.799e+00],
         [-1.046e+00],
         [-2.432e-01],
         [-5.733e-01],
         [-1.583e+00],
         [-1.563e+00],
         [-6.903e-01],
         [ 1.186e+00],
         [ 1.548e-02],
         [ 1.026e+00]],

        [[ 3.856e+00],
         [ 9.360e-01],
         [-1.696e+00],
         [ 3.949e-01],
         [-1.047e+00],
         [ 2.898e-01],
         [ 3.160e+00],
         [ 3.647e-01],
         [-1.017e+00],
         [-1.059e-01]],

        [[ 5.262e+00],
         [ 3.189e+00],
         [ 5.089e+00],
         [-1.253e+00],
         [-1.278e+00],
         [-4.521e-01],
         [-2.506e+00],
         [ 8.699e+00],
         [-5.416e-01],
         [ 9.530e-01]],

        [[-1.785e+00],
         [ 3.335e+00],
         [-1.223e+00],
         [-1.033e+00],
         [-7.195e-01],
         [-1.240e+00],
         [-7.350e-01],
         [ 9.998e-01],
         [ 7.837e-01],
         [-1.229e+00]],

        [[-8.299e-01],
         [ 1.933e+00],
         [-6.686e-01],
         [-1.057e+00],
         [-6.254e-01],
         [-1.366e+00],
         [-1.610e-02],
         [-3.597e-01],
         [-1.313e+00],
         [-1.527e+00]],

        [[ 3.564e-01],
         [-1.610e+00],
         [ 3.945e-01],
         [-7.178e-01],
         [ 4.231e-02],
         [-5.642e-01],
         [-1.788e+00],
         [ 7.692e+00],
         [-7.160e-03],
         [-5.366e-01]],

        [[-9.131e-01],
         [-1.221e+00],
         [ 2.113e+00],
         [-1.449e+00],
         [-1.169e+00],
         [-5.892e-01],
         [ 7.452e-02],
         [-1.190e+00],
         [-1.505e+00],
         [-1.275e+00]],

        [[-1.013e+00],
         [ 2.305e+00],
         [-5.583e-01],
         [-8.085e-01],
         [ 4.140e-01],
         [-4.958e-01],
         [-4.952e-01],
         [ 1.611e+00],
         [ 1.763e-01],
         [-9.778e-01]],

        [[ 1.379e+00],
         [ 3.086e+00],
         [-1.613e+00],
         [-7.389e-01],
         [-8.253e-01],
         [-1.502e+00],
         [-4.150e-01],
         [ 4.677e-02],
         [-1.547e+00],
         [-6.288e-01]],

        [[-1.726e+00],
         [-1.260e+00],
         [-8.911e-01],
         [-1.561e+00],
         [-1.860e+00],
         [-1.457e+00],
         [ 2.784e+00],
         [-1.199e+00],
         [-1.522e+00],
         [-1.068e+00]],

        [[-9.340e-01],
         [-1.017e+00],
         [-6.970e-01],
         [-1.082e+00],
         [ 3.248e+00],
         [-8.970e-01],
         [ 4.400e+00],
         [ 4.616e-01],
         [-1.653e-01],
         [ 6.627e+00]],

        [[ 4.657e-01],
         [-9.139e-02],
         [ 6.850e+00],
         [-3.976e-01],
         [ 1.150e+00],
         [-1.319e+00],
         [-1.574e+00],
         [-8.455e-01],
         [-4.454e-01],
         [-1.397e+00]],

        [[ 9.197e-01],
         [ 1.190e+00],
         [-1.441e+00],
         [-1.624e+00],
         [-1.480e+00],
         [-1.101e+00],
         [-9.827e-01],
         [-7.580e-01],
         [-1.238e+00],
         [ 1.700e+00]],

        [[-7.686e-01],
         [ 1.089e+00],
         [-1.646e+00],
         [-1.740e+00],
         [ 1.813e-01],
         [-8.325e-01],
         [-1.364e+00],
         [ 4.570e-01],
         [ 1.461e+00],
         [-8.213e-01]]], device='cuda:0')
v tensor([[[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [3.409e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [3.461e+00]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [4.228e+00],
         [1.000e-12],
         [1.936e+00],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e+01],
         [5.969e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.682e+00],
         [1.566e-01]],

        [[1.000e-12],
         [1.585e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.142e-02],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.951e+00],
         [1.000e-12],
         [1.000e-12],
         [3.518e+00],
         [1.000e-12],
         [4.699e-01],
         [1.000e-12],
         [2.894e+00]],

        [[1.000e-12],
         [2.436e+00],
         [1.488e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.556e+00],
         [4.647e-01],
         [1.431e+00],
         [1.573e+00]],

        [[1.799e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.186e+00],
         [1.548e-02],
         [1.026e+00]],

        [[3.856e+00],
         [9.360e-01],
         [1.000e-12],
         [3.949e-01],
         [1.000e-12],
         [2.898e-01],
         [3.160e+00],
         [3.647e-01],
         [1.000e-12],
         [1.000e-12]],

        [[5.262e+00],
         [3.189e+00],
         [5.089e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [8.699e+00],
         [1.000e-12],
         [9.530e-01]],

        [[1.000e-12],
         [3.335e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [9.998e-01],
         [7.837e-01],
         [1.000e-12]],

        [[1.000e-12],
         [1.933e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[3.564e-01],
         [1.000e-12],
         [3.945e-01],
         [1.000e-12],
         [4.231e-02],
         [1.000e-12],
         [1.000e-12],
         [7.692e+00],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [2.113e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [7.452e-02],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [2.305e+00],
         [1.000e-12],
         [1.000e-12],
         [4.140e-01],
         [1.000e-12],
         [1.000e-12],
         [1.611e+00],
         [1.763e-01],
         [1.000e-12]],

        [[1.379e+00],
         [3.086e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [4.677e-02],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.784e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [3.248e+00],
         [1.000e-12],
         [4.400e+00],
         [4.616e-01],
         [1.000e-12],
         [6.627e+00]],

        [[4.657e-01],
         [1.000e-12],
         [6.850e+00],
         [1.000e-12],
         [1.150e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[9.197e-01],
         [1.190e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.700e+00]],

        [[1.000e-12],
         [1.089e+00],
         [1.000e-12],
         [1.000e-12],
         [1.813e-01],
         [1.000e-12],
         [1.000e-12],
         [4.570e-01],
         [1.461e+00],
         [1.000e-12]]], device='cuda:0')
v before min max tensor([[ 8.473],
        [-2.335],
        [-1.526],
        [-1.172],
        [-0.974],
        [ 5.062],
        [-0.340],
        [-0.052],
        [-2.340],
        [-2.242],
        [ 5.615],
        [ 5.093],
        [-0.227],
        [-1.490],
        [ 0.613],
        [-2.395],
        [-2.237],
        [-2.234],
        [ 4.201],
        [-1.008]], device='cuda:0')
v tensor([[8.473e+00],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [5.062e+00],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [5.615e+00],
        [5.093e+00],
        [1.000e-12],
        [1.000e-12],
        [6.133e-01],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [4.201e+00],
        [1.000e-12]], device='cuda:0')
a after update for 1 param tensor([[-0.004, -0.011, -0.005,  ...,  0.007,  0.003, -0.001],
        [-0.012, -0.003,  0.024,  ...,  0.007, -0.009, -0.005],
        [ 0.008, -0.012, -0.010,  ..., -0.008, -0.041,  0.020],
        ...,
        [-0.008,  0.011, -0.005,  ...,  0.001, -0.011,  0.019],
        [-0.006, -0.038, -0.007,  ...,  0.020, -0.011,  0.006],
        [ 0.008, -0.010,  0.008,  ...,  0.021, -0.013,  0.015]],
       device='cuda:0')
s after update for 1 param tensor([[0.692, 0.448, 0.537,  ..., 0.359, 0.424, 0.363],
        [1.131, 0.844, 0.251,  ..., 0.287, 0.581, 0.451],
        [0.492, 0.960, 0.783,  ..., 0.575, 0.744, 0.683],
        ...,
        [0.347, 0.531, 0.675,  ..., 0.592, 0.290, 0.649],
        [0.988, 0.658, 0.937,  ..., 1.138, 0.587, 0.769],
        [0.511, 0.752, 0.540,  ..., 0.673, 0.424, 0.391]], device='cuda:0')
b after update for 1 param tensor([[44.562, 35.847, 39.271,  ..., 32.097, 34.891, 32.300],
        [56.981, 49.224, 26.843,  ..., 28.683, 40.848, 35.987],
        [37.599, 52.488, 47.406,  ..., 40.641, 46.207, 44.277],
        ...,
        [31.556, 39.060, 44.031,  ..., 41.230, 28.866, 43.151],
        [53.247, 43.464, 51.871,  ..., 57.160, 41.054, 46.971],
        [38.284, 46.469, 39.385,  ..., 43.957, 34.895, 33.482]],
       device='cuda:0')
clipping threshold 0.2841006723291468
a after update for 1 param tensor([ 1.476e-02, -1.550e-02,  6.185e-03, -3.532e-04, -1.265e-02, -4.102e-03,
         4.303e-03, -1.230e-02,  6.522e-03,  2.771e-04,  4.557e-04,  1.045e-02,
        -5.494e-03, -5.475e-03, -2.170e-03,  3.747e-03, -2.171e-03, -1.220e-02,
         1.461e-02,  2.800e-02, -9.345e-03,  7.054e-03, -8.835e-03,  2.389e-02,
        -1.235e-03,  1.909e-02, -1.181e-02, -1.554e-04,  2.405e-02,  1.773e-03,
         1.621e-02, -1.202e-02, -2.097e-02, -1.095e-02, -1.126e-02, -8.538e-03,
         1.302e-02, -3.047e-02, -1.313e-03, -1.514e-02,  1.977e-03, -4.165e-02,
         1.000e-02, -2.188e-02, -5.501e-03, -1.257e-02,  1.748e-02, -8.210e-03,
        -2.838e-02, -6.260e-04, -4.382e-04, -7.268e-03,  1.335e-03, -3.857e-03,
         1.906e-02, -3.325e-03,  9.890e-03, -1.870e-02,  2.675e-02, -8.595e-03,
        -8.621e-03, -6.765e-03,  1.853e-02, -8.979e-03,  3.192e-03, -2.063e-02,
        -1.224e-02,  8.626e-03, -8.877e-03, -2.389e-02, -2.498e-02,  5.437e-03,
         1.989e-03,  1.817e-02, -1.369e-02,  1.115e-02, -1.179e-02,  1.998e-03,
         1.825e-02, -4.314e-03, -9.772e-03, -1.494e-02, -3.481e-03,  1.927e-02,
         3.604e-03, -7.607e-03,  6.496e-04, -2.471e-03,  7.768e-03, -4.707e-03,
         1.500e-02,  1.237e-02, -1.066e-02,  2.368e-02,  1.422e-02, -5.347e-03,
        -9.976e-03,  3.234e-03, -6.994e-03, -5.728e-04, -4.197e-03,  3.293e-03,
         7.843e-03,  8.946e-03, -1.465e-02, -5.377e-03, -6.704e-03, -8.538e-03,
        -3.287e-03, -2.542e-04, -5.166e-03,  8.838e-04, -1.750e-03, -7.327e-03,
         1.308e-02, -1.322e-02, -1.103e-02, -8.533e-04, -4.560e-03,  2.064e-03,
        -1.395e-02,  8.717e-03, -1.691e-02, -2.406e-03, -2.007e-02,  1.833e-04,
        -2.158e-02,  2.103e-02,  8.296e-03, -8.565e-03, -4.960e-04,  4.962e-03,
         3.499e-02,  1.295e-02, -1.151e-02, -2.164e-02,  1.074e-02,  3.573e-03,
        -4.865e-03,  8.969e-03,  1.132e-02,  1.348e-02, -1.017e-03, -5.748e-03,
        -1.153e-02, -5.124e-03, -2.771e-02,  7.486e-04, -4.768e-04,  6.582e-03,
         5.639e-03,  6.658e-03,  5.026e-05, -2.184e-03, -7.746e-03, -7.507e-03,
        -1.023e-02,  1.265e-02,  1.317e-03,  1.974e-02, -1.241e-02,  6.875e-03,
        -2.336e-02, -2.482e-03, -1.208e-04,  1.896e-02,  4.077e-03, -2.563e-03,
         2.153e-02,  1.208e-03, -4.674e-03, -9.102e-03, -7.385e-03, -1.037e-02,
         4.626e-03,  4.496e-03, -9.377e-03,  8.324e-03, -7.955e-03, -3.350e-03,
        -3.453e-03,  1.639e-02, -2.767e-02, -2.871e-03, -5.562e-04, -1.648e-02,
         1.323e-03,  6.181e-03,  6.861e-03, -2.313e-02,  7.442e-03, -2.809e-02,
         1.940e-02, -6.967e-03, -6.740e-04,  2.486e-02,  8.589e-03,  1.275e-02,
        -1.331e-02,  9.580e-03], device='cuda:0')
s after update for 1 param tensor([0.597, 0.601, 0.701, 0.474, 0.528, 0.348, 0.458, 0.386, 0.512, 0.225,
        0.900, 0.244, 0.517, 0.535, 0.343, 0.617, 0.525, 0.496, 0.365, 0.674,
        1.135, 0.588, 0.990, 1.112, 0.474, 0.472, 0.632, 0.278, 1.098, 0.922,
        1.249, 0.695, 0.615, 0.916, 1.043, 0.585, 0.702, 0.729, 1.096, 0.501,
        0.537, 0.602, 0.627, 1.126, 0.840, 0.489, 0.713, 0.443, 0.712, 0.518,
        0.467, 0.334, 0.728, 0.628, 1.087, 0.927, 0.143, 0.305, 0.416, 0.899,
        0.542, 0.918, 0.727, 0.671, 0.745, 0.643, 0.719, 0.525, 0.504, 0.846,
        0.963, 0.554, 0.608, 0.586, 0.442, 0.662, 0.328, 0.155, 0.708, 0.126,
        0.579, 0.632, 0.472, 0.506, 0.704, 0.460, 0.989, 0.656, 0.846, 0.283,
        1.133, 0.922, 0.443, 0.787, 1.126, 0.222, 0.427, 0.710, 0.423, 0.655,
        0.835, 0.945, 0.345, 0.373, 0.579, 1.105, 0.296, 0.816, 0.390, 0.820,
        0.227, 0.461, 0.805, 0.390, 0.488, 0.287, 0.686, 0.406, 1.084, 0.698,
        0.687, 0.241, 0.613, 0.701, 1.074, 0.697, 0.594, 0.683, 0.889, 0.498,
        0.869, 1.044, 0.896, 0.895, 0.409, 0.500, 0.640, 0.297, 0.491, 0.531,
        0.368, 0.362, 0.529, 0.434, 0.773, 0.410, 0.741, 0.641, 0.516, 0.751,
        1.061, 0.421, 0.217, 0.237, 0.631, 0.813, 0.361, 0.802, 1.126, 0.955,
        0.582, 0.751, 1.091, 0.361, 1.017, 0.408, 0.871, 0.763, 0.863, 0.430,
        0.671, 0.286, 0.681, 0.759, 0.579, 0.364, 0.706, 0.823, 0.832, 0.628,
        0.249, 0.464, 0.589, 0.912, 0.731, 0.664, 0.314, 0.398, 0.207, 1.277,
        0.717, 0.756, 1.052, 0.543, 0.553, 0.440, 0.494, 0.596, 0.609, 0.517],
       device='cuda:0')
b after update for 1 param tensor([41.414, 41.541, 44.849, 36.903, 38.946, 31.600, 36.261, 33.267, 38.341,
        25.392, 50.821, 26.465, 38.513, 39.174, 31.367, 42.094, 38.837, 37.731,
        32.391, 44.000, 57.082, 41.082, 53.321, 56.491, 36.873, 36.818, 42.596,
        28.252, 56.141, 51.454, 59.885, 44.680, 42.031, 51.290, 54.731, 40.968,
        44.890, 45.749, 56.099, 37.942, 39.272, 41.568, 42.435, 56.847, 49.102,
        37.485, 45.245, 35.666, 45.219, 38.573, 36.618, 30.969, 45.715, 42.452,
        55.849, 51.581, 20.249, 29.602, 34.543, 50.806, 39.448, 51.334, 45.687,
        43.878, 46.245, 42.959, 45.438, 38.821, 38.045, 49.279, 52.591, 39.895,
        41.770, 41.029, 35.618, 43.606, 30.678, 21.080, 45.080, 18.994, 40.778,
        42.588, 36.823, 38.097, 44.949, 36.331, 53.293, 43.401, 49.292, 28.486,
        57.023, 51.447, 35.679, 47.518, 56.862, 25.234, 35.014, 45.131, 34.834,
        43.359, 48.950, 52.088, 31.457, 32.704, 40.770, 56.325, 29.139, 48.407,
        33.464, 48.510, 25.549, 36.395, 48.071, 33.453, 37.435, 28.718, 44.372,
        34.151, 55.790, 44.774, 44.425, 26.283, 41.966, 44.854, 55.514, 44.741,
        41.287, 44.284, 50.509, 37.810, 49.953, 54.735, 50.722, 50.689, 34.282,
        37.891, 42.850, 29.179, 37.529, 39.059, 32.487, 32.241, 38.956, 35.313,
        47.097, 34.297, 46.132, 42.891, 38.503, 46.431, 55.186, 34.746, 24.976,
        26.082, 42.548, 48.299, 32.210, 47.990, 56.852, 52.372, 40.863, 46.416,
        55.960, 32.178, 54.033, 34.244, 49.996, 46.811, 49.766, 35.121, 43.875,
        28.661, 44.202, 46.672, 40.762, 32.338, 45.015, 48.598, 48.865, 42.443,
        26.736, 36.494, 41.105, 51.164, 45.796, 43.672, 30.029, 33.815, 24.371,
        60.539, 45.378, 46.576, 54.954, 39.476, 39.829, 35.552, 37.652, 41.360,
        41.796, 38.510], device='cuda:0')
clipping threshold 0.2841006723291468
a after update for 1 param tensor([[[ 1.705e-02],
         [ 9.118e-06],
         [-2.191e-02],
         [ 1.344e-02],
         [ 5.339e-02],
         [ 1.414e-03],
         [ 1.816e-02],
         [-2.089e-02],
         [ 3.391e-02],
         [ 2.127e-02]],

        [[-2.471e-02],
         [-2.648e-02],
         [-7.457e-03],
         [-3.318e-02],
         [ 1.627e-02],
         [ 2.809e-02],
         [-4.824e-03],
         [-1.594e-02],
         [-8.253e-03],
         [-2.742e-02]],

        [[ 6.496e-03],
         [-1.622e-02],
         [ 9.287e-02],
         [-5.969e-02],
         [-7.196e-02],
         [ 8.758e-02],
         [-4.745e-02],
         [ 2.089e-02],
         [-1.164e-02],
         [-7.829e-02]],

        [[ 1.514e-02],
         [ 4.643e-02],
         [ 2.940e-02],
         [ 3.388e-02],
         [-5.057e-02],
         [-5.348e-02],
         [ 2.999e-02],
         [-6.629e-02],
         [-9.123e-04],
         [ 2.784e-02]],

        [[ 4.412e-03],
         [-3.422e-02],
         [ 3.523e-02],
         [-5.396e-02],
         [ 3.948e-02],
         [ 6.010e-03],
         [-5.243e-02],
         [ 5.313e-02],
         [-8.507e-02],
         [ 4.315e-02]],

        [[ 7.720e-02],
         [ 6.461e-02],
         [ 1.259e-02],
         [ 1.494e-02],
         [-7.461e-02],
         [ 2.301e-02],
         [-9.565e-02],
         [-2.443e-02],
         [-4.681e-02],
         [-5.046e-02]],

        [[-2.392e-02],
         [ 4.552e-02],
         [-1.059e-01],
         [-1.822e-03],
         [-1.340e-02],
         [-2.993e-02],
         [ 4.269e-02],
         [-6.307e-02],
         [ 4.217e-02],
         [ 3.568e-02]],

        [[ 9.037e-04],
         [ 1.743e-02],
         [ 3.235e-02],
         [ 2.353e-02],
         [ 1.179e-02],
         [-1.313e-02],
         [-1.349e-02],
         [ 1.364e-03],
         [-3.457e-03],
         [ 2.971e-02]],

        [[ 1.308e-02],
         [ 2.029e-02],
         [-1.803e-02],
         [ 3.580e-02],
         [ 6.051e-02],
         [ 3.643e-02],
         [ 1.223e-02],
         [-4.518e-02],
         [-7.497e-02],
         [ 2.516e-02]],

        [[ 1.185e-02],
         [ 6.448e-02],
         [ 3.167e-03],
         [-6.952e-02],
         [ 4.176e-02],
         [-5.944e-02],
         [-1.454e-02],
         [ 5.244e-02],
         [-6.631e-02],
         [-1.060e-01]],

        [[ 6.061e-02],
         [ 6.654e-02],
         [-7.545e-02],
         [ 3.565e-02],
         [ 3.000e-02],
         [-3.600e-02],
         [ 5.761e-03],
         [-4.596e-02],
         [-2.965e-02],
         [-4.157e-02]],

        [[-1.713e-02],
         [-2.160e-02],
         [-6.588e-02],
         [-6.530e-02],
         [ 6.527e-02],
         [ 3.346e-02],
         [ 6.867e-02],
         [ 1.679e-02],
         [ 4.379e-02],
         [ 2.970e-02]],

        [[ 5.616e-02],
         [ 5.218e-03],
         [ 6.179e-02],
         [-8.021e-02],
         [ 5.993e-03],
         [ 3.418e-02],
         [-3.461e-02],
         [ 8.688e-02],
         [-4.788e-02],
         [ 4.310e-02]],

        [[-2.083e-02],
         [ 1.255e-03],
         [ 4.446e-03],
         [ 3.815e-03],
         [-1.786e-03],
         [ 4.134e-02],
         [-3.007e-02],
         [-3.993e-02],
         [-1.287e-02],
         [ 3.320e-02]],

        [[-5.922e-02],
         [-3.632e-02],
         [-6.691e-03],
         [ 4.440e-02],
         [-1.597e-03],
         [ 2.736e-02],
         [ 2.705e-02],
         [ 7.167e-02],
         [-3.764e-02],
         [-1.318e-02]],

        [[ 2.367e-02],
         [ 6.767e-02],
         [-4.784e-02],
         [ 2.757e-02],
         [-1.024e-02],
         [-3.938e-02],
         [-2.606e-02],
         [ 2.643e-02],
         [ 3.307e-02],
         [-5.418e-02]],

        [[ 3.435e-02],
         [ 5.389e-02],
         [-1.324e-02],
         [-5.206e-02],
         [ 3.332e-02],
         [-5.309e-03],
         [-5.054e-02],
         [ 1.765e-02],
         [-5.593e-03],
         [ 3.864e-03]],

        [[-8.775e-02],
         [-4.744e-02],
         [-4.369e-02],
         [ 7.227e-03],
         [-7.872e-02],
         [-1.694e-02],
         [ 3.885e-02],
         [ 5.686e-02],
         [-1.706e-02],
         [ 5.177e-02]],

        [[ 1.219e-01],
         [ 6.170e-02],
         [-6.897e-02],
         [ 6.917e-02],
         [-3.957e-02],
         [-7.048e-03],
         [-4.600e-02],
         [-5.973e-02],
         [-1.867e-02],
         [ 3.668e-02]],

        [[-4.213e-03],
         [ 4.612e-02],
         [-6.750e-03],
         [-1.623e-02],
         [-2.299e-02],
         [-5.308e-02],
         [ 2.303e-02],
         [ 2.650e-02],
         [ 6.257e-02],
         [ 2.417e-02]]], device='cuda:0')
s after update for 1 param tensor([[[0.590],
         [0.780],
         [0.978],
         [0.765],
         [0.720],
         [0.999],
         [1.258],
         [0.627],
         [0.491],
         [0.828]],

        [[0.816],
         [0.615],
         [0.502],
         [1.168],
         [1.033],
         [0.484],
         [1.095],
         [1.139],
         [0.919],
         [0.809]],

        [[0.850],
         [1.678],
         [1.503],
         [1.388],
         [0.893],
         [0.875],
         [0.919],
         [0.719],
         [1.171],
         [0.554]],

        [[0.970],
         [0.935],
         [0.972],
         [1.274],
         [0.933],
         [1.145],
         [0.921],
         [1.360],
         [0.881],
         [0.792]],

        [[1.215],
         [0.765],
         [1.055],
         [1.160],
         [0.804],
         [1.337],
         [1.105],
         [1.076],
         [0.937],
         [1.118]],

        [[1.296],
         [0.852],
         [0.835],
         [0.897],
         [0.498],
         [1.014],
         [0.844],
         [1.240],
         [1.157],
         [0.600]],

        [[1.033],
         [0.583],
         [0.650],
         [0.671],
         [0.915],
         [1.273],
         [0.402],
         [1.130],
         [0.422],
         [1.122]],

        [[0.929],
         [0.803],
         [1.105],
         [1.029],
         [0.584],
         [0.537],
         [0.889],
         [0.568],
         [0.573],
         [0.363]],

        [[1.500],
         [1.016],
         [1.320],
         [0.720],
         [1.032],
         [1.071],
         [1.603],
         [1.198],
         [0.945],
         [0.947]],

        [[1.007],
         [1.018],
         [0.688],
         [0.602],
         [0.454],
         [0.798],
         [0.515],
         [1.234],
         [1.344],
         [0.791]],

        [[0.507],
         [1.235],
         [0.870],
         [0.621],
         [0.676],
         [0.858],
         [0.628],
         [0.901],
         [0.738],
         [0.983]],

        [[0.843],
         [1.013],
         [0.897],
         [0.619],
         [0.856],
         [0.389],
         [1.614],
         [1.173],
         [0.578],
         [0.877]],

        [[0.583],
         [0.751],
         [0.992],
         [1.319],
         [1.011],
         [0.428],
         [0.796],
         [0.786],
         [0.839],
         [1.071]],

        [[0.620],
         [0.847],
         [0.648],
         [0.473],
         [0.897],
         [0.797],
         [0.298],
         [0.768],
         [0.431],
         [0.701]],

        [[1.394],
         [1.381],
         [0.910],
         [1.172],
         [0.932],
         [1.013],
         [1.198],
         [1.024],
         [0.861],
         [0.774]],

        [[1.003],
         [1.021],
         [1.177],
         [0.992],
         [1.093],
         [0.820],
         [1.124],
         [0.667],
         [1.023],
         [0.656]],

        [[0.539],
         [0.714],
         [0.463],
         [0.641],
         [0.998],
         [1.269],
         [0.867],
         [0.723],
         [1.042],
         [1.259]],

        [[1.106],
         [1.151],
         [1.174],
         [1.087],
         [1.354],
         [0.897],
         [0.876],
         [0.472],
         [0.695],
         [0.857]],

        [[1.220],
         [0.905],
         [0.801],
         [0.905],
         [0.829],
         [0.877],
         [0.666],
         [0.734],
         [0.706],
         [0.952]],

        [[0.883],
         [0.827],
         [0.923],
         [0.981],
         [1.235],
         [0.536],
         [0.766],
         [1.112],
         [0.967],
         [0.808]]], device='cuda:0')
b after update for 1 param tensor([[[41.163],
         [47.321],
         [52.985],
         [46.855],
         [45.465],
         [53.553],
         [60.089],
         [42.414],
         [37.536],
         [48.742]],

        [[48.409],
         [42.019],
         [37.960],
         [57.897],
         [54.446],
         [37.274],
         [56.060],
         [57.169],
         [51.352],
         [48.182]],

        [[49.408],
         [69.395],
         [65.692],
         [63.127],
         [50.627],
         [50.126],
         [51.357],
         [45.438],
         [57.983],
         [39.873]],

        [[52.779],
         [51.822],
         [52.817],
         [60.479],
         [51.761],
         [57.327],
         [51.425],
         [62.478],
         [50.298],
         [47.685]],

        [[59.070],
         [46.862],
         [55.044],
         [57.713],
         [48.056],
         [61.946],
         [56.320],
         [55.582],
         [51.852],
         [56.651]],

        [[61.001],
         [49.459],
         [48.950],
         [50.752],
         [37.802],
         [53.966],
         [49.217],
         [59.670],
         [57.638],
         [41.507]],

        [[54.459],
         [40.923],
         [43.208],
         [43.887],
         [51.253],
         [60.452],
         [33.971],
         [56.967],
         [34.823],
         [56.756]],

        [[51.654],
         [48.013],
         [56.321],
         [54.349],
         [40.938],
         [39.250],
         [50.518],
         [40.372],
         [40.550],
         [32.262]],

        [[65.610],
         [53.996],
         [61.550],
         [45.468],
         [54.421],
         [55.458],
         [67.832],
         [58.641],
         [52.076],
         [52.150]],

        [[53.762],
         [54.061],
         [44.439],
         [41.578],
         [36.109],
         [47.867],
         [38.443],
         [59.522],
         [62.113],
         [47.652]],

        [[38.161],
         [59.554],
         [49.979],
         [42.222],
         [44.043],
         [49.637],
         [42.446],
         [50.848],
         [46.020],
         [53.123]],

        [[49.205],
         [53.928],
         [50.736],
         [42.142],
         [49.575],
         [33.428],
         [68.071],
         [58.029],
         [40.751],
         [50.189]],

        [[40.909],
         [46.431],
         [53.377],
         [61.527],
         [53.864],
         [35.061],
         [47.795],
         [47.489],
         [49.063],
         [55.438]],

        [[42.194],
         [49.297],
         [43.135],
         [36.866],
         [50.734],
         [47.821],
         [29.231],
         [46.958],
         [35.177],
         [44.852]],

        [[63.262],
         [62.958],
         [51.107],
         [57.992],
         [51.731],
         [53.938],
         [58.635],
         [54.211],
         [49.703],
         [47.127]],

        [[53.672],
         [54.144],
         [58.124],
         [53.373],
         [56.016],
         [48.513],
         [56.807],
         [43.762],
         [54.179],
         [43.387]],

        [[39.344],
         [45.288],
         [36.450],
         [42.899],
         [53.538],
         [60.350],
         [49.875],
         [45.553],
         [54.693],
         [60.122]],

        [[56.341],
         [57.487],
         [58.051],
         [55.857],
         [62.348],
         [50.754],
         [50.133],
         [36.813],
         [44.682],
         [49.598]],

        [[59.190],
         [50.973],
         [47.967],
         [50.975],
         [48.780],
         [50.189],
         [43.730],
         [45.888],
         [45.021],
         [52.289]],

        [[50.355],
         [48.727],
         [51.479],
         [53.062],
         [59.535],
         [39.242],
         [46.891],
         [56.504],
         [52.693],
         [48.173]]], device='cuda:0')
clipping threshold 0.2841006723291468
a after update for 1 param tensor([[-0.001],
        [-0.014],
        [-0.010],
        [-0.004],
        [ 0.012],
        [-0.014],
        [ 0.001],
        [-0.026],
        [ 0.003],
        [ 0.011],
        [ 0.002],
        [-0.018],
        [-0.007],
        [ 0.014],
        [ 0.012],
        [-0.009],
        [-0.005],
        [ 0.048],
        [ 0.077],
        [-0.054]], device='cuda:0')
s after update for 1 param tensor([[1.205],
        [1.358],
        [0.926],
        [1.313],
        [1.496],
        [1.379],
        [1.092],
        [0.717],
        [1.452],
        [1.340],
        [1.261],
        [1.226],
        [0.904],
        [0.920],
        [1.190],
        [1.338],
        [1.330],
        [1.385],
        [1.853],
        [0.936]], device='cuda:0')
b after update for 1 param tensor([[58.826],
        [62.448],
        [51.564],
        [61.389],
        [65.528],
        [62.915],
        [55.999],
        [45.355],
        [64.566],
        [62.019],
        [60.157],
        [59.330],
        [50.929],
        [51.400],
        [58.448],
        [61.975],
        [61.781],
        [63.054],
        [72.939],
        [51.835]], device='cuda:0')
clipping threshold 0.2841006723291468
||w||^2 0.1748092675990363
exp ma of ||w||^2 0.14112791384106596
||w|| 0.41810198229503326
exp ma of ||w|| 0.365795439814302
||w||^2 0.12860405564318783
exp ma of ||w||^2 0.12807439189674635
||w|| 0.3586140761922039
exp ma of ||w|| 0.347667022280689
||w||^2 0.22669996324786054
exp ma of ||w||^2 0.1224758689883692
||w|| 0.476130195690066
exp ma of ||w|| 0.338266225717224
||w||^2 0.04890983373285888
exp ma of ||w||^2 0.11722783455158983
||w|| 0.22115567759580326
exp ma of ||w|| 0.33146313078110223
||w||^2 0.15098999872998078
exp ma of ||w||^2 0.13036305961850467
||w|| 0.3885743155819499
exp ma of ||w|| 0.34761800055028236
cuda
Objective function 17.58 = squared loss an data 15.77 + 0.5*rho*h**2 1.204802 + alpha*h 0.000000 + L2reg 0.38 + L1reg 0.23 ; SHD = 50 ; DAG False
Proportion of microbatches that were clipped  0.7609433047972863
iteration 1 in inner loop, alpha 0.0 rho 1.0 h 1.5522898821292088
iteration 1 in outer loop, alpha = 1.5522898821292088, rho = 1.0, h = 1.5522898821292088
cuda
4420
cuda
Objective function 19.99 = squared loss an data 15.77 + 0.5*rho*h**2 1.204802 + alpha*h 2.409604 + L2reg 0.38 + L1reg 0.23 ; SHD = 50 ; DAG False
||w||^2 854831174.2046854
exp ma of ||w||^2 3639026287.526282
||w|| 29237.49603171731
exp ma of ||w|| 47383.08589147095
||w||^2 1415.2396972717613
exp ma of ||w||^2 4824040.063592783
||w|| 37.619671679478564
exp ma of ||w|| 458.93710917130136
||w||^2 0.12078922514263088
exp ma of ||w||^2 103783.8430288572
||w|| 0.34754744300977225
exp ma of ||w|| 11.961354511295765
||w||^2 0.11911090335516385
exp ma of ||w||^2 0.11775598826484468
||w|| 0.3451244751610118
exp ma of ||w|| 0.3340352533998615
||w||^2 0.07386052934868256
exp ma of ||w||^2 0.1044476570897174
||w|| 0.2717729371160465
exp ma of ||w|| 0.31306417165521183
||w||^2 0.07456992216585237
exp ma of ||w||^2 0.13065989993857874
||w|| 0.27307493873633365
exp ma of ||w|| 0.3501425356734241
||w||^2 0.10414324398242719
exp ma of ||w||^2 0.1252382355849738
||w|| 0.32271232387751664
exp ma of ||w|| 0.34278735317825415
||w||^2 0.050728873258928366
exp ma of ||w||^2 0.12582996373477842
||w|| 0.22523071118062113
exp ma of ||w|| 0.3427129422981332
||w||^2 0.04923300809397031
exp ma of ||w||^2 0.11984350739462431
||w|| 0.2218851236427767
exp ma of ||w|| 0.33633539970976384
||w||^2 0.25590754791536174
exp ma of ||w||^2 0.10883312106294685
||w|| 0.5058730551386995
exp ma of ||w|| 0.3204374248637413
||w||^2 0.08255129880453965
exp ma of ||w||^2 0.13497214923717626
||w|| 0.28731741820596196
exp ma of ||w|| 0.3529998217166665
||w||^2 0.09347607758167673
exp ma of ||w||^2 0.13470443042120223
||w|| 0.3057385771892005
exp ma of ||w|| 0.357128115580006
cuda
Objective function 17.60 = squared loss an data 14.90 + 0.5*rho*h**2 0.451395 + alpha*h 1.474912 + L2reg 0.56 + L1reg 0.20 ; SHD = 46 ; DAG False
Proportion of microbatches that were clipped  0.7563298868354636
iteration 1 in inner loop, alpha 1.5522898821292088 rho 1.0 h 0.9501526123372344
4420
cuda
Objective function 21.66 = squared loss an data 14.90 + 0.5*rho*h**2 4.513950 + alpha*h 1.474912 + L2reg 0.56 + L1reg 0.20 ; SHD = 46 ; DAG False
||w||^2 80.86130770625066
exp ma of ||w||^2 1390293.5071640222
||w|| 8.992291571465566
exp ma of ||w|| 118.5847521816586
||w||^2 0.090342111625885
exp ma of ||w||^2 0.19163934112324632
||w|| 0.30056964521701957
exp ma of ||w|| 0.29619408584722157
v before min max tensor([[-2.298, -2.863, -0.238,  ..., -1.754, -2.946, 11.652],
        [ 4.147, -0.388, 28.971,  ...,  5.696,  8.065, -3.848],
        [ 4.978,  1.500,  4.178,  ...,  2.589,  0.047,  0.881],
        ...,
        [-1.458, -2.475, -1.925,  ...,  0.489, -1.731, -2.649],
        [-0.820, -3.456, -1.871,  ..., -3.549, -0.240, -1.101],
        [-0.817, -1.003, -1.636,  ..., -0.585, -0.782, -3.478]],
       device='cuda:0')
v tensor([[1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e+01],
        [4.147e+00, 1.000e-12, 1.000e+01,  ..., 5.696e+00, 8.065e+00,
         1.000e-12],
        [4.978e+00, 1.500e+00, 4.178e+00,  ..., 2.589e+00, 4.696e-02,
         8.815e-01],
        ...,
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 4.885e-01, 1.000e-12,
         1.000e-12],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12]], device='cuda:0')
v before min max tensor([-1.601e+00,  2.655e+00, -5.421e-01, -3.384e+00, -1.267e+00, -2.260e+00,
         5.346e+00, -1.219e+00,  5.784e-01,  2.022e-01,  2.096e+00, -1.892e+00,
        -1.157e+00, -1.277e+00, -1.708e+00, -5.491e-01,  1.685e+01, -2.944e+00,
         8.429e+00,  1.739e-01, -1.269e+00,  1.489e+00,  1.576e+00, -2.823e+00,
         3.062e+00, -3.744e-02, -3.054e+00, -1.417e+00,  2.689e+00,  1.167e+00,
        -1.133e+00, -2.476e+00,  1.247e+00,  1.647e-01, -1.735e+00, -1.582e+00,
        -3.000e+00,  3.450e+00, -1.547e+00, -2.555e+00,  1.381e+01, -2.081e+00,
        -3.127e+00, -1.715e+00, -3.521e+00, -3.239e+00,  1.054e-01, -1.050e+00,
         1.222e+01, -1.137e+00, -1.603e+00,  4.088e+00,  1.459e+00, -1.448e+00,
        -2.378e+00, -1.109e-02, -2.893e-01, -2.608e+00,  3.200e+00,  1.335e+00,
         2.895e-01, -2.821e+00, -2.336e+00, -3.372e+00,  5.906e-02, -2.869e+00,
        -1.614e+00,  1.815e+00,  4.546e+00,  6.919e-01, -3.116e+00, -8.185e-01,
        -1.192e+00,  3.695e+00, -2.517e+00, -2.165e+00,  5.432e-01, -2.523e+00,
         6.290e+00,  1.512e+00, -1.875e+00, -3.280e+00,  6.338e+00,  2.381e+00,
        -2.478e+00, -1.085e+00, -1.511e+00,  4.522e+00,  8.821e+00,  1.315e+01,
         3.429e+01,  3.367e+00,  8.858e+00, -9.722e-01,  4.574e+00,  2.139e+00,
        -3.670e+00, -2.604e-01,  4.523e+00, -2.009e+00, -3.312e+00, -3.350e+00,
        -1.836e+00,  1.362e+01, -2.304e+00, -3.281e+00,  1.916e+00, -1.092e+00,
         7.866e-01,  2.609e+00, -3.923e+00, -3.117e+00, -1.337e+00,  1.006e-01,
         2.247e+00, -1.487e+00, -2.207e+00, -2.556e+00, -3.084e+00,  1.052e+01,
        -2.141e+00, -2.114e+00,  1.853e+00,  1.011e+01, -2.392e+00, -2.426e+00,
        -2.776e+00,  3.645e+00, -2.370e+00,  1.972e+00, -2.105e+00, -2.513e+00,
         2.640e+00, -1.776e+00, -2.848e+00,  3.708e+00, -3.081e+00, -3.435e+00,
        -2.139e+00, -2.993e+00, -3.922e-01,  4.806e+00, -2.268e+00, -1.055e+00,
        -9.607e-01, -1.308e+00, -2.605e+00,  9.736e-01, -1.536e+00, -1.924e+00,
        -2.196e+00, -2.593e+00, -1.470e+00, -1.596e+00, -7.531e-01,  8.797e-01,
        -1.817e+00, -3.270e+00,  1.475e+01, -2.037e+00, -2.066e+00,  4.891e-01,
        -1.804e+00, -2.577e+00, -2.510e+00, -2.131e+00, -1.644e+00, -3.313e-01,
         2.563e+00, -4.228e+00, -2.533e+00,  3.705e+00, -1.519e+00,  4.462e-01,
        -1.558e+00, -2.644e+00, -6.879e-01, -1.423e+00, -3.008e+00, -2.198e+00,
        -3.415e+00, -2.840e+00, -2.910e+00,  9.899e+00, -3.054e+00, -2.859e+00,
         6.348e-01, -1.345e+00, -1.260e+00, -2.318e+00, -2.443e+00, -7.493e-01,
        -1.573e+00,  5.835e+00, -3.460e+00, -1.529e+00, -6.203e-01, -2.218e+00,
        -5.551e-01, -4.654e-01], device='cuda:0')
v tensor([1.000e-12, 2.655e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        5.346e+00, 1.000e-12, 5.784e-01, 2.022e-01, 2.096e+00, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12,
        8.429e+00, 1.739e-01, 1.000e-12, 1.489e+00, 1.576e+00, 1.000e-12,
        3.062e+00, 1.000e-12, 1.000e-12, 1.000e-12, 2.689e+00, 1.167e+00,
        1.000e-12, 1.000e-12, 1.247e+00, 1.647e-01, 1.000e-12, 1.000e-12,
        1.000e-12, 3.450e+00, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.054e-01, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e-12, 4.088e+00, 1.459e+00, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 3.200e+00, 1.335e+00,
        2.895e-01, 1.000e-12, 1.000e-12, 1.000e-12, 5.906e-02, 1.000e-12,
        1.000e-12, 1.815e+00, 4.546e+00, 6.919e-01, 1.000e-12, 1.000e-12,
        1.000e-12, 3.695e+00, 1.000e-12, 1.000e-12, 5.432e-01, 1.000e-12,
        6.290e+00, 1.512e+00, 1.000e-12, 1.000e-12, 6.338e+00, 2.381e+00,
        1.000e-12, 1.000e-12, 1.000e-12, 4.522e+00, 8.821e+00, 1.000e+01,
        1.000e+01, 3.367e+00, 8.858e+00, 1.000e-12, 4.574e+00, 2.139e+00,
        1.000e-12, 1.000e-12, 4.523e+00, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.916e+00, 1.000e-12,
        7.866e-01, 2.609e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.006e-01,
        2.247e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01,
        1.000e-12, 1.000e-12, 1.853e+00, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e-12, 3.645e+00, 1.000e-12, 1.972e+00, 1.000e-12, 1.000e-12,
        2.640e+00, 1.000e-12, 1.000e-12, 3.708e+00, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 4.806e+00, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 9.736e-01, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 8.797e-01,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 4.891e-01,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        2.563e+00, 1.000e-12, 1.000e-12, 3.705e+00, 1.000e-12, 4.462e-01,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 9.899e+00, 1.000e-12, 1.000e-12,
        6.348e-01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 5.835e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12], device='cuda:0')
v before min max tensor([[[ 0.544],
         [-1.273],
         [-1.527],
         [-0.581],
         [-1.514],
         [ 1.187],
         [-4.345],
         [ 0.681],
         [ 0.249],
         [-1.010]],

        [[ 0.288],
         [-1.861],
         [-3.395],
         [ 6.079],
         [ 0.731],
         [-0.799],
         [ 1.186],
         [12.638],
         [-1.271],
         [ 0.801]],

        [[-0.081],
         [-1.793],
         [-1.350],
         [ 4.655],
         [-2.292],
         [-0.350],
         [-0.499],
         [-3.149],
         [ 7.215],
         [-2.936]],

        [[-2.445],
         [ 0.152],
         [-3.062],
         [-3.936],
         [-1.506],
         [21.178],
         [-2.448],
         [ 0.681],
         [-2.923],
         [-2.154]],

        [[ 1.363],
         [-2.484],
         [-1.491],
         [-3.684],
         [ 2.324],
         [ 2.685],
         [ 2.851],
         [-0.360],
         [28.294],
         [ 2.031]],

        [[-2.768],
         [-0.861],
         [ 0.347],
         [ 0.447],
         [ 1.605],
         [-2.820],
         [ 4.705],
         [10.108],
         [-2.651],
         [-2.702]],

        [[ 1.639],
         [-1.552],
         [-0.126],
         [-1.508],
         [-1.426],
         [ 2.983],
         [-0.244],
         [-0.726],
         [ 3.774],
         [-0.908]],

        [[ 1.545],
         [ 1.573],
         [-2.384],
         [-2.648],
         [ 0.270],
         [ 7.951],
         [-0.512],
         [-3.237],
         [-1.556],
         [ 5.887]],

        [[-2.268],
         [-1.805],
         [ 3.541],
         [-2.854],
         [-0.943],
         [ 2.562],
         [10.042],
         [-3.111],
         [-2.359],
         [ 6.395]],

        [[-1.940],
         [-1.972],
         [-2.648],
         [-3.417],
         [ 4.681],
         [-0.744],
         [ 4.715],
         [-1.239],
         [-1.421],
         [-1.002]],

        [[-1.046],
         [ 3.347],
         [20.760],
         [-2.246],
         [-2.620],
         [-1.126],
         [-2.884],
         [-2.398],
         [-2.297],
         [ 0.426]],

        [[-2.326],
         [ 3.643],
         [-1.300],
         [-2.516],
         [ 3.174],
         [-1.890],
         [-1.612],
         [-1.862],
         [-1.347],
         [-2.213]],

        [[ 0.046],
         [-0.206],
         [-1.792],
         [-2.581],
         [-3.850],
         [ 0.423],
         [-0.925],
         [ 0.626],
         [ 1.253],
         [ 2.208]],

        [[-2.949],
         [-0.984],
         [-0.260],
         [-4.322],
         [ 3.093],
         [-1.618],
         [-1.841],
         [ 0.284],
         [-0.533],
         [-2.972]],

        [[-2.363],
         [ 4.833],
         [-2.302],
         [-1.527],
         [-0.658],
         [-2.414],
         [-2.554],
         [17.305],
         [ 8.533],
         [ 0.936]],

        [[-2.470],
         [-2.928],
         [-2.381],
         [ 2.137],
         [-1.520],
         [ 3.856],
         [12.605],
         [-3.435],
         [-2.320],
         [ 1.948]],

        [[-1.600],
         [-2.160],
         [ 1.022],
         [ 1.744],
         [-2.060],
         [ 1.322],
         [-1.036],
         [-2.500],
         [-1.588],
         [-0.719]],

        [[ 1.850],
         [-2.739],
         [-1.233],
         [ 3.992],
         [-3.875],
         [-3.967],
         [-2.449],
         [-2.232],
         [-2.469],
         [ 2.210]],

        [[-2.499],
         [ 1.311],
         [ 2.871],
         [-3.205],
         [-2.747],
         [ 1.201],
         [ 1.865],
         [-0.740],
         [-1.824],
         [-2.401]],

        [[-3.674],
         [ 3.583],
         [-3.695],
         [-3.392],
         [-2.986],
         [-2.422],
         [ 8.225],
         [-1.514],
         [-1.104],
         [-1.588]]], device='cuda:0')
v tensor([[[5.440e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.187e+00],
         [1.000e-12],
         [6.806e-01],
         [2.488e-01],
         [1.000e-12]],

        [[2.882e-01],
         [1.000e-12],
         [1.000e-12],
         [6.079e+00],
         [7.308e-01],
         [1.000e-12],
         [1.186e+00],
         [1.000e+01],
         [1.000e-12],
         [8.010e-01]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [4.655e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [7.215e+00],
         [1.000e-12]],

        [[1.000e-12],
         [1.520e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [6.810e-01],
         [1.000e-12],
         [1.000e-12]],

        [[1.363e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.324e+00],
         [2.685e+00],
         [2.851e+00],
         [1.000e-12],
         [1.000e+01],
         [2.031e+00]],

        [[1.000e-12],
         [1.000e-12],
         [3.469e-01],
         [4.472e-01],
         [1.605e+00],
         [1.000e-12],
         [4.705e+00],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12]],

        [[1.639e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.983e+00],
         [1.000e-12],
         [1.000e-12],
         [3.774e+00],
         [1.000e-12]],

        [[1.545e+00],
         [1.573e+00],
         [1.000e-12],
         [1.000e-12],
         [2.704e-01],
         [7.951e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [5.887e+00]],

        [[1.000e-12],
         [1.000e-12],
         [3.541e+00],
         [1.000e-12],
         [1.000e-12],
         [2.562e+00],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [6.395e+00]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [4.681e+00],
         [1.000e-12],
         [4.715e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [3.347e+00],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [4.259e-01]],

        [[1.000e-12],
         [3.643e+00],
         [1.000e-12],
         [1.000e-12],
         [3.174e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[4.581e-02],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [4.231e-01],
         [1.000e-12],
         [6.263e-01],
         [1.253e+00],
         [2.208e+00]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [3.093e+00],
         [1.000e-12],
         [1.000e-12],
         [2.842e-01],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [4.833e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [8.533e+00],
         [9.356e-01]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.137e+00],
         [1.000e-12],
         [3.856e+00],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.948e+00]],

        [[1.000e-12],
         [1.000e-12],
         [1.022e+00],
         [1.744e+00],
         [1.000e-12],
         [1.322e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.850e+00],
         [1.000e-12],
         [1.000e-12],
         [3.992e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.210e+00]],

        [[1.000e-12],
         [1.311e+00],
         [2.871e+00],
         [1.000e-12],
         [1.000e-12],
         [1.201e+00],
         [1.865e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [3.583e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [8.225e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]]], device='cuda:0')
v before min max tensor([[-0.901],
        [-4.381],
        [-0.701],
        [-1.280],
        [10.307],
        [ 5.619],
        [ 1.886],
        [-0.896],
        [-0.233],
        [-2.373],
        [-1.163],
        [17.364],
        [ 3.958],
        [-2.453],
        [21.710],
        [-4.288],
        [ 2.898],
        [-2.017],
        [-0.288],
        [-3.209]], device='cuda:0')
v tensor([[1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e+01],
        [5.619e+00],
        [1.886e+00],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e+01],
        [3.958e+00],
        [1.000e-12],
        [1.000e+01],
        [1.000e-12],
        [2.898e+00],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12]], device='cuda:0')
a after update for 1 param tensor([[ 0.008,  0.008, -0.091,  ..., -0.026,  0.006, -0.014],
        [-0.045, -0.056,  0.017,  ...,  0.071,  0.005,  0.042],
        [-0.007, -0.014, -0.004,  ..., -0.013,  0.050, -0.032],
        ...,
        [-0.002, -0.030,  0.003,  ...,  0.004,  0.017,  0.026],
        [-0.001,  0.042,  0.033,  ..., -0.005, -0.003, -0.008],
        [ 0.022, -0.002, -0.038,  ..., -0.001, -0.004,  0.032]],
       device='cuda:0')
s after update for 1 param tensor([[1.287, 1.136, 1.657,  ..., 0.959, 1.238, 1.352],
        [1.454, 0.841, 1.675,  ..., 1.740, 1.280, 1.610],
        [1.044, 1.283, 1.210,  ..., 1.485, 0.595, 0.843],
        ...,
        [0.842, 0.998, 1.590,  ..., 0.837, 0.980, 1.697],
        [0.785, 1.415, 0.972,  ..., 1.424, 0.935, 1.806],
        [1.229, 1.161, 0.783,  ..., 0.794, 0.940, 1.650]], device='cuda:0')
b after update for 1 param tensor([[82.878, 77.877, 94.049,  ..., 71.534, 81.278, 84.950],
        [88.093, 67.008, 94.550,  ..., 96.374, 82.655, 92.699],
        [74.650, 82.751, 80.373,  ..., 89.038, 56.370, 67.092],
        ...,
        [67.027, 72.987, 92.112,  ..., 66.847, 72.311, 95.176],
        [64.716, 86.885, 72.027,  ..., 87.175, 70.638, 98.175],
        [80.985, 78.704, 64.660,  ..., 65.108, 70.829, 93.829]],
       device='cuda:0')
clipping threshold 0.2481878101651305
a after update for 1 param tensor([-0.039,  0.034,  0.015, -0.024, -0.002, -0.044,  0.089,  0.052,  0.026,
         0.022, -0.016,  0.048,  0.075, -0.037,  0.089,  0.005,  0.088,  0.006,
        -0.049,  0.004,  0.045,  0.071,  0.003,  0.011, -0.046,  0.072, -0.039,
         0.050,  0.015,  0.032, -0.003, -0.037, -0.002, -0.020,  0.066, -0.045,
        -0.016,  0.031, -0.002, -0.012,  0.124, -0.008, -0.100, -0.026,  0.019,
        -0.033,  0.041, -0.002, -0.072,  0.025,  0.013,  0.134, -0.033, -0.068,
         0.002,  0.097,  0.065, -0.027,  0.008, -0.024, -0.020,  0.050, -0.064,
        -0.109,  0.069,  0.005,  0.075,  0.007, -0.086,  0.059,  0.004, -0.116,
        -0.051, -0.040,  0.061,  0.047,  0.027,  0.062,  0.088,  0.022,  0.033,
        -0.043, -0.030,  0.133, -0.002,  0.002, -0.004, -0.090,  0.045, -0.074,
        -0.017, -0.003, -0.065,  0.042,  0.084,  0.019, -0.127, -0.099, -0.030,
        -0.029,  0.005,  0.058, -0.015,  0.064, -0.022, -0.008, -0.049, -0.037,
        -0.050,  0.087, -0.061,  0.016, -0.072,  0.002,  0.005,  0.011,  0.088,
        -0.008, -0.015, -0.059,  0.034,  0.050, -0.037, -0.031, -0.031, -0.117,
         0.113,  0.010,  0.036, -0.006,  0.001, -0.014, -0.004,  0.022, -0.071,
        -0.073,  0.014,  0.029,  0.176,  0.072,  0.053,  0.043,  0.060, -0.036,
        -0.082, -0.002, -0.010,  0.043, -0.002,  0.012,  0.011,  0.028, -0.073,
         0.048, -0.009,  0.049,  0.049, -0.060,  0.077, -0.012,  0.054,  0.041,
         0.093,  0.008,  0.012,  0.060,  0.017,  0.085,  0.018, -0.024, -0.075,
        -0.005,  0.070, -0.050,  0.036,  0.068,  0.017,  0.085,  0.000,  0.029,
         0.084, -0.002,  0.054,  0.098,  0.045,  0.020, -0.034,  0.014, -0.036,
        -0.048, -0.016,  0.081,  0.032, -0.137, -0.070,  0.019, -0.042,  0.013,
        -0.008,  0.025], device='cuda:0')
s after update for 1 param tensor([1.025, 0.783, 0.594, 1.367, 0.576, 1.438, 1.246, 1.125, 0.784, 0.832,
        0.585, 0.795, 0.875, 1.283, 1.002, 1.163, 1.461, 1.168, 1.301, 0.689,
        0.793, 1.073, 1.302, 1.218, 1.308, 1.228, 1.220, 1.315, 0.759, 0.848,
        0.810, 1.100, 1.480, 1.262, 1.377, 0.640, 1.206, 1.197, 0.906, 1.049,
        1.408, 0.920, 1.237, 1.162, 1.477, 1.283, 1.609, 0.904, 1.762, 1.461,
        0.807, 1.292, 0.883, 0.851, 1.225, 0.495, 1.053, 1.116, 1.612, 0.973,
        1.010, 1.171, 0.965, 1.333, 0.689, 1.188, 0.643, 0.919, 1.711, 0.749,
        1.232, 1.187, 0.938, 1.571, 1.193, 1.293, 1.136, 1.208, 1.274, 1.139,
        0.954, 1.317, 1.469, 1.297, 1.145, 0.862, 0.770, 1.506, 1.768, 1.680,
        1.583, 1.386, 1.333, 0.706, 1.428, 0.943, 1.462, 1.272, 1.752, 0.897,
        1.339, 1.327, 0.859, 1.557, 1.107, 1.341, 1.380, 0.984, 0.972, 0.986,
        1.586, 1.234, 0.795, 0.521, 1.338, 0.643, 1.039, 1.048, 1.476, 1.552,
        0.955, 0.846, 1.353, 1.757, 0.960, 1.403, 1.135, 1.224, 1.231, 1.514,
        0.838, 0.994, 1.365, 0.886, 1.189, 1.357, 1.491, 1.383, 1.057, 1.513,
        1.103, 1.251, 0.904, 0.956, 0.888, 0.518, 1.052, 1.499, 0.608, 0.868,
        0.980, 1.034, 1.048, 0.900, 1.099, 1.059, 1.031, 1.293, 1.728, 0.912,
        1.292, 0.835, 1.399, 1.050, 1.468, 0.879, 0.775, 1.029, 1.008, 1.674,
        1.085, 0.996, 0.860, 1.091, 0.743, 1.330, 0.754, 1.139, 1.205, 1.053,
        1.353, 1.507, 1.167, 1.422, 1.264, 1.148, 1.029, 1.269, 0.516, 0.934,
        0.968, 0.967, 0.623, 1.695, 1.372, 1.500, 1.353, 1.008, 0.667, 0.935],
       device='cuda:0')
b after update for 1 param tensor([73.961, 64.653, 56.298, 85.399, 55.457, 87.601, 81.555, 77.487, 64.665,
        66.652, 55.866, 65.126, 68.346, 82.743, 73.114, 78.772, 88.297, 78.960,
        83.330, 60.646, 65.061, 75.667, 83.366, 80.637, 83.563, 80.939, 80.684,
        83.767, 63.651, 67.278, 65.765, 76.607, 88.864, 82.081, 85.735, 58.440,
        80.209, 79.928, 69.521, 74.834, 86.682, 70.079, 81.261, 78.758, 88.772,
        82.732, 92.656, 69.457, 96.981, 88.299, 65.607, 83.023, 68.664, 67.380,
        80.859, 51.409, 74.968, 77.189, 92.761, 72.067, 73.416, 79.049, 71.753,
        84.359, 60.625, 79.618, 58.578, 70.038, 95.548, 63.239, 81.094, 79.604,
        70.762, 91.552, 79.778, 83.083, 77.848, 80.297, 82.447, 77.957, 71.366,
        83.829, 88.547, 83.202, 78.159, 67.834, 64.094, 89.654, 97.133, 94.676,
        91.901, 86.000, 84.339, 61.364, 87.295, 70.947, 88.332, 82.396, 96.692,
        69.175, 84.520, 84.149, 67.712, 91.152, 76.871, 84.586, 85.803, 72.474,
        72.027, 72.555, 92.006, 81.152, 65.116, 52.741, 84.494, 58.598, 74.476,
        74.804, 88.758, 91.018, 71.402, 67.199, 84.974, 96.821, 71.567, 86.525,
        77.820, 80.815, 81.053, 89.884, 66.868, 72.821, 85.362, 68.748, 79.671,
        85.098, 89.209, 85.920, 75.095, 89.847, 76.727, 81.706, 69.446, 71.416,
        68.828, 52.561, 74.916, 89.456, 56.962, 68.060, 72.329, 74.280, 74.793,
        69.323, 76.589, 75.179, 74.192, 83.082, 96.026, 69.752, 83.035, 66.744,
        86.395, 74.849, 88.519, 68.502, 64.313, 74.097, 73.348, 94.526, 76.086,
        72.906, 67.739, 76.322, 62.980, 84.240, 63.439, 77.954, 80.178, 74.972,
        84.990, 89.675, 78.922, 87.106, 82.134, 78.280, 74.092, 82.283, 52.473,
        70.588, 71.893, 71.851, 57.679, 95.102, 85.562, 89.467, 84.975, 73.352,
        59.645, 70.647], device='cuda:0')
clipping threshold 0.2481878101651305
a after update for 1 param tensor([[[-0.021],
         [-0.062],
         [-0.010],
         [ 0.161],
         [-0.037],
         [-0.087],
         [ 0.067],
         [-0.018],
         [-0.008],
         [-0.091]],

        [[-0.034],
         [-0.039],
         [-0.055],
         [-0.156],
         [ 0.128],
         [ 0.073],
         [-0.023],
         [ 0.054],
         [ 0.029],
         [ 0.114]],

        [[ 0.022],
         [-0.007],
         [-0.025],
         [-0.112],
         [-0.016],
         [ 0.048],
         [ 0.047],
         [-0.047],
         [ 0.045],
         [-0.037]],

        [[ 0.024],
         [-0.015],
         [ 0.032],
         [-0.049],
         [ 0.007],
         [-0.003],
         [ 0.017],
         [ 0.015],
         [-0.052],
         [-0.045]],

        [[-0.028],
         [ 0.140],
         [-0.003],
         [ 0.053],
         [-0.022],
         [ 0.035],
         [ 0.025],
         [ 0.010],
         [ 0.011],
         [-0.001]],

        [[-0.003],
         [ 0.014],
         [ 0.010],
         [-0.012],
         [-0.155],
         [ 0.002],
         [-0.022],
         [-0.053],
         [ 0.072],
         [ 0.023]],

        [[-0.021],
         [-0.017],
         [-0.011],
         [ 0.015],
         [-0.091],
         [ 0.055],
         [ 0.067],
         [-0.087],
         [ 0.065],
         [-0.022]],

        [[ 0.083],
         [-0.001],
         [ 0.054],
         [-0.022],
         [ 0.058],
         [ 0.042],
         [ 0.018],
         [ 0.039],
         [-0.060],
         [-0.053]],

        [[-0.031],
         [ 0.102],
         [-0.039],
         [-0.022],
         [ 0.024],
         [-0.006],
         [ 0.188],
         [-0.085],
         [-0.026],
         [-0.036]],

        [[ 0.006],
         [ 0.013],
         [ 0.067],
         [ 0.005],
         [ 0.007],
         [-0.047],
         [ 0.007],
         [ 0.017],
         [-0.020],
         [ 0.005]],

        [[-0.036],
         [ 0.013],
         [-0.102],
         [-0.112],
         [-0.072],
         [ 0.038],
         [ 0.047],
         [ 0.027],
         [ 0.015],
         [-0.098]],

        [[-0.024],
         [ 0.002],
         [-0.029],
         [ 0.001],
         [ 0.014],
         [ 0.057],
         [-0.180],
         [ 0.059],
         [-0.059],
         [ 0.008]],

        [[-0.059],
         [ 0.060],
         [-0.057],
         [ 0.067],
         [ 0.067],
         [-0.098],
         [-0.021],
         [-0.044],
         [ 0.140],
         [-0.084]],

        [[-0.072],
         [ 0.008],
         [-0.017],
         [-0.171],
         [ 0.023],
         [ 0.108],
         [-0.087],
         [-0.047],
         [ 0.042],
         [-0.064]],

        [[-0.006],
         [-0.023],
         [ 0.026],
         [-0.005],
         [ 0.120],
         [ 0.002],
         [-0.142],
         [-0.013],
         [ 0.016],
         [ 0.092]],

        [[ 0.001],
         [ 0.044],
         [ 0.044],
         [ 0.010],
         [-0.079],
         [-0.111],
         [ 0.104],
         [ 0.054],
         [-0.019],
         [ 0.084]],

        [[-0.004],
         [ 0.010],
         [-0.062],
         [ 0.009],
         [-0.004],
         [-0.028],
         [-0.005],
         [ 0.036],
         [-0.008],
         [-0.006]],

        [[-0.053],
         [ 0.082],
         [-0.058],
         [-0.017],
         [ 0.107],
         [ 0.033],
         [ 0.049],
         [ 0.086],
         [-0.040],
         [ 0.126]],

        [[ 0.068],
         [ 0.006],
         [-0.019],
         [-0.041],
         [-0.022],
         [ 0.163],
         [ 0.035],
         [ 0.003],
         [-0.031],
         [-0.027]],

        [[-0.013],
         [ 0.017],
         [-0.013],
         [-0.004],
         [ 0.183],
         [-0.006],
         [-0.017],
         [-0.034],
         [ 0.004],
         [ 0.043]]], device='cuda:0')
s after update for 1 param tensor([[[0.919],
         [1.266],
         [1.359],
         [1.021],
         [0.991],
         [1.480],
         [1.719],
         [1.372],
         [0.964],
         [0.919]],

        [[0.906],
         [1.522],
         [1.343],
         [1.638],
         [1.184],
         [1.114],
         [1.236],
         [1.253],
         [1.217],
         [1.896]],

        [[1.303],
         [0.838],
         [1.399],
         [1.407],
         [0.911],
         [1.165],
         [0.667],
         [1.320],
         [1.537],
         [1.247]],

        [[1.022],
         [0.689],
         [1.274],
         [1.561],
         [0.688],
         [1.606],
         [1.045],
         [0.970],
         [1.176],
         [1.007]],

        [[1.518],
         [1.493],
         [0.933],
         [1.473],
         [1.102],
         [1.435],
         [1.026],
         [1.330],
         [1.748],
         [1.392]],

        [[1.265],
         [0.504],
         [1.342],
         [0.981],
         [1.552],
         [1.173],
         [1.041],
         [1.405],
         [1.250],
         [1.105]],

        [[1.003],
         [1.108],
         [0.473],
         [0.715],
         [1.011],
         [1.548],
         [1.076],
         [0.830],
         [1.367],
         [1.016]],

        [[1.452],
         [1.087],
         [1.087],
         [1.164],
         [1.206],
         [1.364],
         [1.270],
         [1.303],
         [0.925],
         [1.099]],

        [[0.902],
         [1.497],
         [1.184],
         [1.136],
         [1.781],
         [1.166],
         [1.472],
         [1.688],
         [0.933],
         [1.368]],

        [[0.778],
         [0.966],
         [1.224],
         [1.374],
         [1.037],
         [0.996],
         [1.475],
         [0.600],
         [1.097],
         [0.856]],

        [[1.644],
         [0.861],
         [1.903],
         [1.511],
         [1.096],
         [1.286],
         [1.145],
         [0.992],
         [1.345],
         [1.176]],

        [[1.017],
         [1.100],
         [1.470],
         [1.004],
         [1.512],
         [1.049],
         [1.057],
         [1.078],
         [1.400],
         [0.875]],

        [[1.012],
         [1.205],
         [1.330],
         [1.022],
         [1.550],
         [0.855],
         [0.664],
         [1.601],
         [1.442],
         [1.480]],

        [[1.176],
         [1.172],
         [1.301],
         [1.725],
         [1.261],
         [0.831],
         [1.053],
         [0.899],
         [1.356],
         [1.175]],

        [[1.088],
         [0.984],
         [1.119],
         [1.224],
         [1.324],
         [0.979],
         [1.048],
         [1.319],
         [1.775],
         [1.319]],

        [[1.310],
         [1.399],
         [1.170],
         [1.076],
         [1.127],
         [1.092],
         [1.654],
         [1.441],
         [0.921],
         [1.086]],

        [[0.641],
         [1.414],
         [1.611],
         [0.937],
         [1.312],
         [0.788],
         [0.745],
         [1.011],
         [1.298],
         [0.941]],

        [[1.263],
         [1.092],
         [1.131],
         [1.361],
         [1.542],
         [1.569],
         [0.998],
         [1.365],
         [1.227],
         [1.225]],

        [[1.312],
         [1.624],
         [1.664],
         [1.306],
         [1.086],
         [1.320],
         [0.928],
         [1.269],
         [0.879],
         [1.573]],

        [[1.454],
         [1.086],
         [1.674],
         [1.740],
         [1.591],
         [1.052],
         [1.500],
         [1.008],
         [0.734],
         [0.644]]], device='cuda:0')
b after update for 1 param tensor([[[ 70.015],
         [ 82.196],
         [ 85.160],
         [ 73.817],
         [ 72.737],
         [ 88.877],
         [ 95.776],
         [ 85.557],
         [ 71.723],
         [ 70.042]],

        [[ 69.541],
         [ 90.113],
         [ 84.666],
         [ 93.487],
         [ 79.492],
         [ 77.093],
         [ 81.215],
         [ 81.760],
         [ 80.580],
         [100.598]],

        [[ 83.390],
         [ 66.880],
         [ 86.410],
         [ 86.656],
         [ 69.743],
         [ 78.854],
         [ 59.657],
         [ 83.937],
         [ 90.578],
         [ 81.563]],

        [[ 73.861],
         [ 60.628],
         [ 82.442],
         [ 91.259],
         [ 60.616],
         [ 92.575],
         [ 74.685],
         [ 71.935],
         [ 79.214],
         [ 73.296]],

        [[ 90.010],
         [ 89.263],
         [ 70.562],
         [ 88.661],
         [ 76.684],
         [ 87.504],
         [ 74.006],
         [ 84.238],
         [ 96.576],
         [ 86.194]],

        [[ 82.150],
         [ 51.866],
         [ 84.623],
         [ 72.367],
         [ 91.004],
         [ 79.135],
         [ 74.542],
         [ 86.589],
         [ 81.673],
         [ 76.778]],

        [[ 73.178],
         [ 76.910],
         [ 50.224],
         [ 61.770],
         [ 73.462],
         [ 90.878],
         [ 75.784],
         [ 66.567],
         [ 85.407],
         [ 73.638]],

        [[ 88.022],
         [ 76.180],
         [ 76.154],
         [ 78.831],
         [ 80.237],
         [ 85.320],
         [ 82.325],
         [ 83.395],
         [ 70.277],
         [ 76.585]],

        [[ 69.368],
         [ 89.396],
         [ 79.493],
         [ 77.848],
         [ 97.491],
         [ 78.900],
         [ 88.636],
         [ 94.908],
         [ 70.561],
         [ 85.453]],

        [[ 64.426],
         [ 71.808],
         [ 80.837],
         [ 85.638],
         [ 74.381],
         [ 72.916],
         [ 88.730],
         [ 56.598],
         [ 76.531],
         [ 67.591]],

        [[ 93.679],
         [ 67.774],
         [100.768],
         [ 89.801],
         [ 76.495],
         [ 82.853],
         [ 78.176],
         [ 72.770],
         [ 84.727],
         [ 79.229]],

        [[ 73.668],
         [ 76.630],
         [ 88.560],
         [ 73.195],
         [ 89.837],
         [ 74.821],
         [ 75.099],
         [ 75.853],
         [ 86.447],
         [ 68.339]],

        [[ 73.501],
         [ 80.198],
         [ 84.252],
         [ 73.864],
         [ 90.952],
         [ 67.548],
         [ 59.545],
         [ 92.428],
         [ 87.729],
         [ 88.866]],

        [[ 79.206],
         [ 79.083],
         [ 83.310],
         [ 95.961],
         [ 82.035],
         [ 66.583],
         [ 74.956],
         [ 69.284],
         [ 85.056],
         [ 79.195]],

        [[ 76.183],
         [ 72.467],
         [ 77.290],
         [ 80.812],
         [ 84.055],
         [ 72.288],
         [ 74.779],
         [ 83.904],
         [ 97.329],
         [ 83.888]],

        [[ 83.603],
         [ 86.414],
         [ 79.024],
         [ 75.777],
         [ 77.548],
         [ 76.346],
         [ 93.963],
         [ 87.684],
         [ 70.112],
         [ 76.134]],

        [[ 58.497],
         [ 86.872],
         [ 92.729],
         [ 70.697],
         [ 83.686],
         [ 64.837],
         [ 63.068],
         [ 73.450],
         [ 83.216],
         [ 70.861]],

        [[ 82.099],
         [ 76.348],
         [ 77.678],
         [ 85.210],
         [ 90.712],
         [ 91.506],
         [ 72.973],
         [ 85.360],
         [ 80.934],
         [ 80.860]],

        [[ 83.671],
         [ 93.093],
         [ 94.233],
         [ 83.492],
         [ 76.146],
         [ 83.943],
         [ 70.374],
         [ 82.301],
         [ 68.492],
         [ 91.628]],

        [[ 88.091],
         [ 76.134],
         [ 94.517],
         [ 96.370],
         [ 92.153],
         [ 74.931],
         [ 89.460],
         [ 73.329],
         [ 62.575],
         [ 58.606]]], device='cuda:0')
clipping threshold 0.2481878101651305
a after update for 1 param tensor([[ 0.039],
        [-0.054],
        [ 0.044],
        [ 0.010],
        [ 0.013],
        [-0.068],
        [ 0.009],
        [-0.003],
        [-0.057],
        [-0.088],
        [-0.045],
        [ 0.135],
        [ 0.052],
        [ 0.006],
        [-0.062],
        [-0.116],
        [-0.030],
        [-0.022],
        [-0.150],
        [ 0.025]], device='cuda:0')
s after update for 1 param tensor([[1.465],
        [1.733],
        [0.934],
        [1.441],
        [1.444],
        [1.626],
        [1.489],
        [1.112],
        [1.115],
        [1.270],
        [1.421],
        [1.769],
        [1.302],
        [1.187],
        [1.897],
        [1.864],
        [1.516],
        [1.195],
        [1.329],
        [1.359]], device='cuda:0')
b after update for 1 param tensor([[ 88.425],
        [ 96.163],
        [ 70.603],
        [ 87.690],
        [ 87.795],
        [ 93.159],
        [ 89.147],
        [ 77.037],
        [ 77.143],
        [ 82.326],
        [ 87.074],
        [ 97.150],
        [ 83.345],
        [ 79.575],
        [100.605],
        [ 99.740],
        [ 89.941],
        [ 79.846],
        [ 84.215],
        [ 85.151]], device='cuda:0')
clipping threshold 0.2481878101651305
||w||^2 0.1727132619611528
exp ma of ||w||^2 0.10768057797567611
||w|| 0.4155878510750198
exp ma of ||w|| 0.3144172679327903
||w||^2 0.08573986778531355
exp ma of ||w||^2 0.13332412758420845
||w|| 0.29281370832888537
exp ma of ||w|| 0.3525148364340609
v before min max tensor([[-0.938,  1.816,  4.567,  ...,  9.227,  3.111, -1.851],
        [-1.674,  3.086, -2.745,  ..., -1.953, -1.564, -2.265],
        [-1.689, -2.183, 12.881,  ..., -3.132, -1.104, -0.728],
        ...,
        [-2.837, -1.044, -1.443,  ..., -3.546, -1.186, -3.603],
        [ 1.048, -0.498,  0.130,  ..., -1.304, -1.230, -3.166],
        [ 5.508, -3.082, -0.454,  ..., -1.401, -2.820,  0.144]],
       device='cuda:0')
v tensor([[1.000e-12, 1.816e+00, 4.567e+00,  ..., 9.227e+00, 3.111e+00,
         1.000e-12],
        [1.000e-12, 3.086e+00, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [1.000e-12, 1.000e-12, 1.000e+01,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        ...,
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [1.048e+00, 1.000e-12, 1.304e-01,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [5.508e+00, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.440e-01]], device='cuda:0')
v before min max tensor([ 1.524e+00, -2.566e+00, -2.321e+00, -1.442e+00, -2.995e+00,  1.202e+00,
        -2.250e+00, -2.626e+00,  2.743e+00, -3.107e+00, -1.765e+00, -2.439e+00,
         9.764e-01, -1.189e+00, -2.366e+00, -3.401e+00, -2.927e+00, -1.743e+00,
        -2.869e+00,  2.226e+00,  7.423e+00, -1.686e+00, -2.079e+00, -2.986e-01,
        -1.322e+00, -1.278e+00,  1.131e+00, -2.609e+00,  5.168e+01, -2.232e+00,
        -2.120e+00, -4.690e-01,  9.715e+00, -3.126e+00, -1.205e+00, -1.882e+00,
        -1.611e+00, -2.074e+00, -1.986e+00, -2.110e+00, -4.883e+00, -1.465e+00,
        -2.638e+00, -1.673e+00, -8.259e-01, -3.931e+00, -2.747e+00, -2.813e+00,
         3.794e+00,  1.417e+00, -3.981e-01, -3.798e+00,  1.042e+01, -7.113e-01,
        -2.609e+00, -2.048e+00,  1.206e+00, -3.136e+00, -2.254e+00, -6.969e-01,
        -7.705e-01, -6.395e-01, -2.043e+00,  7.322e+00, -2.185e+00, -3.185e+00,
        -1.654e+00,  3.348e+00, -6.300e-01, -1.192e+00, -2.548e+00, -5.664e-01,
        -2.451e+00,  2.656e+00, -2.054e+00, -2.194e+00,  4.029e+00, -1.405e+00,
         1.088e+00,  1.004e+00,  7.109e-01, -3.417e+00, -5.053e-01, -9.480e-01,
        -2.257e+00, -2.164e+00,  2.853e+00, -2.287e+00, -3.017e+00, -3.573e+00,
        -2.317e+00, -1.730e-01, -2.830e+00,  1.054e+00,  9.904e+00, -1.538e+00,
         1.151e+00,  5.782e+00, -2.145e+00, -1.952e+00, -3.247e+00, -2.166e+00,
        -2.680e+00,  7.203e+00, -1.716e+00, -1.788e-01, -2.940e+00,  4.052e-02,
        -2.724e+00, -2.111e+00, -4.863e-02, -1.049e+00, -1.222e+00,  5.256e+00,
        -1.971e+00,  2.483e+00, -1.996e-01,  1.862e+00, -3.046e+00, -2.559e+00,
        -2.207e+00,  1.397e+00,  4.572e+00, -2.725e+00,  8.466e+00,  4.403e+00,
        -2.373e+00, -1.346e+00, -2.555e+00,  1.062e+00, -6.422e-01,  8.700e-01,
         4.093e+00, -1.805e+00, -1.488e+00, -2.697e+00, -3.524e+00,  1.208e+00,
         3.781e+00, -2.232e+00, -1.348e+00, -2.476e+00,  2.618e+00, -2.652e+00,
        -3.492e+00,  1.305e+00, -3.662e+00, -7.352e-01, -2.025e+00, -2.748e+00,
        -1.385e+00, -1.707e+00,  2.138e-01,  1.632e+01, -1.930e+00,  2.551e+00,
        -1.345e+00, -1.682e+00, -2.221e+00, -9.069e-01, -2.135e+00, -2.129e+00,
         9.368e-01, -2.070e+00,  2.962e-01, -1.878e+00, -1.497e+00,  1.733e+00,
        -1.175e+00, -2.193e+00, -2.366e+00, -1.304e+00, -2.418e-01, -1.067e+00,
         2.701e-03,  4.309e-01, -2.397e+00, -2.024e+00, -9.165e-01,  1.351e+00,
         4.352e+00, -1.277e+00, -3.238e+00,  2.110e+00, -3.332e+00,  3.455e+00,
        -1.180e+00,  1.592e+01, -2.514e+00, -2.439e+00, -1.818e+00, -1.398e+00,
         5.706e-01, -3.161e+00, -2.684e+00, -3.221e+00, -2.979e+00, -3.838e+00,
        -3.643e+00, -3.595e-01], device='cuda:0')
v tensor([1.524e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.202e+00,
        1.000e-12, 1.000e-12, 2.743e+00, 1.000e-12, 1.000e-12, 1.000e-12,
        9.764e-01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 2.226e+00, 7.423e+00, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.131e+00, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 9.715e+00, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        3.794e+00, 1.417e+00, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.206e+00, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 7.322e+00, 1.000e-12, 1.000e-12,
        1.000e-12, 3.348e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 2.656e+00, 1.000e-12, 1.000e-12, 4.029e+00, 1.000e-12,
        1.088e+00, 1.004e+00, 7.109e-01, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 2.853e+00, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.054e+00, 9.904e+00, 1.000e-12,
        1.151e+00, 5.782e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 7.203e+00, 1.000e-12, 1.000e-12, 1.000e-12, 4.052e-02,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 5.256e+00,
        1.000e-12, 2.483e+00, 1.000e-12, 1.862e+00, 1.000e-12, 1.000e-12,
        1.000e-12, 1.397e+00, 4.572e+00, 1.000e-12, 8.466e+00, 4.403e+00,
        1.000e-12, 1.000e-12, 1.000e-12, 1.062e+00, 1.000e-12, 8.700e-01,
        4.093e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.208e+00,
        3.781e+00, 1.000e-12, 1.000e-12, 1.000e-12, 2.618e+00, 1.000e-12,
        1.000e-12, 1.305e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 2.138e-01, 1.000e+01, 1.000e-12, 2.551e+00,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        9.368e-01, 1.000e-12, 2.962e-01, 1.000e-12, 1.000e-12, 1.733e+00,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        2.701e-03, 4.309e-01, 1.000e-12, 1.000e-12, 1.000e-12, 1.351e+00,
        4.352e+00, 1.000e-12, 1.000e-12, 2.110e+00, 1.000e-12, 3.455e+00,
        1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        5.706e-01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12], device='cuda:0')
v before min max tensor([[[-1.953e+00],
         [-2.238e+00],
         [ 1.937e+00],
         [-2.272e+00],
         [-7.327e-01],
         [-1.904e+00],
         [-3.726e+00],
         [-2.113e+00],
         [ 1.805e-02],
         [ 2.332e+00]],

        [[ 1.743e+00],
         [ 3.395e+00],
         [-1.164e+00],
         [-2.981e-01],
         [ 6.530e+00],
         [ 1.196e+01],
         [-4.225e+00],
         [-1.958e+00],
         [-2.941e+00],
         [ 4.733e+00]],

        [[ 8.932e-01],
         [-2.230e+00],
         [-4.411e+00],
         [ 1.531e+00],
         [ 9.768e-01],
         [-3.783e+00],
         [ 1.222e+00],
         [ 7.014e+00],
         [-1.779e+00],
         [ 8.221e-01]],

        [[-1.876e+00],
         [-8.341e-02],
         [ 2.687e+00],
         [ 1.656e+00],
         [-2.912e+00],
         [-1.162e+00],
         [-2.887e+00],
         [-2.346e+00],
         [ 1.314e+01],
         [-2.137e+00]],

        [[-4.536e+00],
         [-2.975e+00],
         [-3.358e+00],
         [ 1.971e+00],
         [-1.661e+00],
         [ 2.418e+00],
         [-2.607e+00],
         [-4.853e-01],
         [-7.995e-02],
         [-1.963e+00]],

        [[-1.238e+00],
         [ 1.316e+00],
         [-1.953e+00],
         [ 1.523e+00],
         [-3.875e+00],
         [-1.041e+00],
         [-1.369e+00],
         [ 1.016e+01],
         [ 5.870e+00],
         [-1.934e+00]],

        [[ 2.619e+00],
         [-3.104e+00],
         [ 3.107e-01],
         [ 5.470e+00],
         [-2.598e+00],
         [-2.704e+00],
         [-3.573e+00],
         [ 6.085e+00],
         [-1.023e+00],
         [-1.046e+00]],

        [[ 4.254e+00],
         [ 4.908e+00],
         [ 7.488e+00],
         [-4.258e+00],
         [-2.417e+00],
         [ 5.552e+00],
         [ 4.322e+00],
         [ 3.631e+00],
         [ 5.542e+00],
         [-3.515e+00]],

        [[-3.652e+00],
         [-1.958e+00],
         [ 5.362e+00],
         [-2.080e+00],
         [ 7.781e+00],
         [-1.672e+00],
         [-3.142e+00],
         [-2.793e+00],
         [-6.538e-01],
         [-1.933e+00]],

        [[-2.017e+00],
         [-3.047e+00],
         [-2.053e+00],
         [-2.042e+00],
         [ 7.358e-01],
         [-2.160e+00],
         [ 7.980e-01],
         [-2.154e+00],
         [-1.208e+00],
         [-7.598e-01]],

        [[-3.099e+00],
         [-1.681e-01],
         [ 1.287e+00],
         [-9.034e-01],
         [-1.665e+00],
         [-7.741e-01],
         [-6.685e-01],
         [-2.385e+00],
         [-7.957e-01],
         [-2.272e+00]],

        [[-3.262e+00],
         [-2.747e+00],
         [-1.145e+00],
         [ 5.371e+00],
         [-1.604e+00],
         [ 2.772e+00],
         [-4.582e+00],
         [-2.212e+00],
         [ 5.121e-01],
         [-4.261e-01]],

        [[ 3.794e+00],
         [-1.659e+00],
         [ 2.915e+00],
         [-3.466e+00],
         [ 5.115e+00],
         [-1.273e+00],
         [-6.539e-01],
         [-2.370e-01],
         [-2.306e+00],
         [-2.244e+00]],

        [[-4.721e-01],
         [ 5.635e+00],
         [-3.299e+00],
         [-1.687e+00],
         [ 9.907e+00],
         [-3.736e+00],
         [-3.430e+00],
         [ 2.980e+00],
         [-2.099e+00],
         [ 1.219e+01]],

        [[-2.044e+00],
         [-1.315e+00],
         [-1.562e+00],
         [-1.627e+00],
         [-4.351e+00],
         [-9.204e-01],
         [ 4.282e-03],
         [ 5.542e-01],
         [ 3.159e+00],
         [-3.673e+00]],

        [[-1.134e+00],
         [ 3.953e-02],
         [ 9.217e-01],
         [-2.627e+00],
         [-1.267e+00],
         [-1.963e+00],
         [-2.340e+00],
         [-1.959e+00],
         [-2.852e+00],
         [ 5.709e+00]],

        [[-2.466e+00],
         [-3.334e+00],
         [-3.225e+00],
         [-3.931e+00],
         [ 2.850e-01],
         [-1.926e+00],
         [-3.844e+00],
         [-1.830e+00],
         [ 6.980e+00],
         [ 1.450e-01]],

        [[-1.522e+00],
         [-2.102e+00],
         [-2.369e+00],
         [-3.599e+00],
         [-4.959e-01],
         [ 1.213e+01],
         [-2.054e+00],
         [-2.004e+00],
         [-2.425e+00],
         [-1.120e+00]],

        [[-3.267e+00],
         [ 5.947e+00],
         [ 1.251e+00],
         [-2.956e-01],
         [-2.142e+00],
         [-1.696e+00],
         [ 4.459e+00],
         [-2.438e+00],
         [ 4.948e+00],
         [-1.353e+00]],

        [[-3.904e-01],
         [-2.380e+00],
         [-2.538e+00],
         [-2.964e+00],
         [ 1.220e+01],
         [ 2.825e+00],
         [-1.267e+00],
         [-1.012e+00],
         [-2.696e+00],
         [-2.213e+00]]], device='cuda:0')
v tensor([[[1.000e-12],
         [1.000e-12],
         [1.937e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.805e-02],
         [2.332e+00]],

        [[1.743e+00],
         [3.395e+00],
         [1.000e-12],
         [1.000e-12],
         [6.530e+00],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [4.733e+00]],

        [[8.932e-01],
         [1.000e-12],
         [1.000e-12],
         [1.531e+00],
         [9.768e-01],
         [1.000e-12],
         [1.222e+00],
         [7.014e+00],
         [1.000e-12],
         [8.221e-01]],

        [[1.000e-12],
         [1.000e-12],
         [2.687e+00],
         [1.656e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.971e+00],
         [1.000e-12],
         [2.418e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.316e+00],
         [1.000e-12],
         [1.523e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [5.870e+00],
         [1.000e-12]],

        [[2.619e+00],
         [1.000e-12],
         [3.107e-01],
         [5.470e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [6.085e+00],
         [1.000e-12],
         [1.000e-12]],

        [[4.254e+00],
         [4.908e+00],
         [7.488e+00],
         [1.000e-12],
         [1.000e-12],
         [5.552e+00],
         [4.322e+00],
         [3.631e+00],
         [5.542e+00],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [5.362e+00],
         [1.000e-12],
         [7.781e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [7.358e-01],
         [1.000e-12],
         [7.980e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.287e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [5.371e+00],
         [1.000e-12],
         [2.772e+00],
         [1.000e-12],
         [1.000e-12],
         [5.121e-01],
         [1.000e-12]],

        [[3.794e+00],
         [1.000e-12],
         [2.915e+00],
         [1.000e-12],
         [5.115e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [5.635e+00],
         [1.000e-12],
         [1.000e-12],
         [9.907e+00],
         [1.000e-12],
         [1.000e-12],
         [2.980e+00],
         [1.000e-12],
         [1.000e+01]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [4.282e-03],
         [5.542e-01],
         [3.159e+00],
         [1.000e-12]],

        [[1.000e-12],
         [3.953e-02],
         [9.217e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [5.709e+00]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.850e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [6.980e+00],
         [1.450e-01]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [5.947e+00],
         [1.251e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [4.459e+00],
         [1.000e-12],
         [4.948e+00],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [2.825e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]]], device='cuda:0')
v before min max tensor([[-1.885],
        [ 2.113],
        [14.596],
        [-3.284],
        [-4.519],
        [-1.966],
        [ 1.603],
        [-0.767],
        [-2.344],
        [ 5.627],
        [-1.038],
        [-0.212],
        [ 2.674],
        [-2.466],
        [-0.676],
        [-2.321],
        [-3.015],
        [-4.104],
        [ 6.266],
        [-3.357]], device='cuda:0')
v tensor([[1.000e-12],
        [2.113e+00],
        [1.000e+01],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.603e+00],
        [1.000e-12],
        [1.000e-12],
        [5.627e+00],
        [1.000e-12],
        [1.000e-12],
        [2.674e+00],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [6.266e+00],
        [1.000e-12]], device='cuda:0')
a after update for 1 param tensor([[ 0.008, -0.015, -0.075,  ..., -0.006,  0.017, -0.016],
        [-0.035, -0.052, -0.005,  ...,  0.023,  0.015,  0.035],
        [-0.001, -0.027, -0.011,  ..., -0.015,  0.043, -0.040],
        ...,
        [-0.015, -0.035,  0.003,  ...,  0.009,  0.013,  0.008],
        [ 0.001,  0.028,  0.044,  ..., -0.012, -0.004, -0.009],
        [ 0.013,  0.002, -0.019,  ...,  0.004, -0.030,  0.017]],
       device='cuda:0')
s after update for 1 param tensor([[1.037, 0.843, 1.100,  ..., 1.263, 0.820, 0.772],
        [0.869, 0.670, 1.298,  ..., 1.775, 0.849, 1.253],
        [1.187, 1.011, 1.553,  ..., 1.087, 0.491, 0.744],
        ...,
        [0.960, 0.752, 0.749,  ..., 1.200, 0.539, 1.256],
        [0.840, 0.562, 1.252,  ..., 1.064, 0.637, 1.158],
        [1.486, 1.313, 0.962,  ..., 0.504, 0.957, 0.955]], device='cuda:0')
b after update for 1 param tensor([[68.494, 61.751, 70.544,  ..., 75.617, 60.933, 59.110],
        [62.719, 55.053, 76.633,  ..., 89.622, 61.996, 75.299],
        [73.307, 67.656, 83.847,  ..., 70.139, 47.151, 58.030],
        ...,
        [65.920, 58.331, 58.234,  ..., 73.703, 49.401, 75.401],
        [61.663, 50.440, 75.285,  ..., 69.407, 53.689, 72.385],
        [81.998, 77.080, 65.995,  ..., 47.738, 65.823, 65.730]],
       device='cuda:0')
clipping threshold 0.29089570186814256
a after update for 1 param tensor([-0.030,  0.032,  0.013, -0.025,  0.009, -0.051,  0.077,  0.041,  0.016,
         0.014, -0.012,  0.037,  0.072, -0.044,  0.064,  0.013,  0.072,  0.010,
        -0.041, -0.007,  0.044,  0.055, -0.007,  0.010, -0.024,  0.076, -0.031,
         0.051,  0.017,  0.013, -0.013, -0.040,  0.006, -0.022,  0.039, -0.041,
        -0.012,  0.024, -0.008, -0.003,  0.091, -0.004, -0.075, -0.023,  0.030,
        -0.032,  0.040,  0.018, -0.073,  0.016,  0.004,  0.093, -0.025, -0.064,
        -0.006,  0.074,  0.065, -0.003, -0.004, -0.028, -0.030,  0.046, -0.057,
        -0.088,  0.060, -0.010,  0.055,  0.010, -0.065,  0.050,  0.019, -0.107,
        -0.041, -0.027,  0.040,  0.024,  0.011,  0.051,  0.048,  0.025,  0.040,
        -0.042, -0.018,  0.114, -0.016, -0.016,  0.007, -0.051,  0.037, -0.073,
        -0.023, -0.002, -0.060,  0.038,  0.046,  0.023, -0.100, -0.072, -0.019,
        -0.041, -0.010,  0.053, -0.030,  0.046, -0.007, -0.010, -0.056, -0.022,
        -0.032,  0.082, -0.051,  0.008, -0.060, -0.014,  0.016,  0.010,  0.073,
        -0.007,  0.003, -0.048,  0.015,  0.032, -0.033, -0.020, -0.019, -0.082,
         0.117,  0.000,  0.022, -0.022, -0.001, -0.001, -0.015,  0.020, -0.051,
        -0.058, -0.002,  0.013,  0.150,  0.058,  0.060,  0.023,  0.053, -0.010,
        -0.043, -0.000, -0.024,  0.037,  0.002,  0.012,  0.003,  0.024, -0.074,
         0.023, -0.022,  0.041,  0.037, -0.055,  0.069,  0.003,  0.048,  0.029,
         0.089,  0.003,  0.001,  0.040,  0.010,  0.058,  0.020, -0.014, -0.068,
         0.004,  0.057, -0.040,  0.031,  0.056,  0.007,  0.077, -0.022,  0.019,
         0.081,  0.019,  0.035,  0.083,  0.042,  0.014, -0.012,  0.007, -0.022,
        -0.051, -0.022,  0.094,  0.040, -0.121, -0.073,  0.001, -0.020,  0.007,
         0.000,  0.023], device='cuda:0')
s after update for 1 param tensor([1.099, 0.958, 0.792, 0.626, 1.014, 0.796, 0.820, 1.287, 1.155, 1.053,
        0.701, 0.826, 1.326, 1.088, 0.801, 1.278, 1.470, 1.049, 1.143, 0.846,
        1.256, 0.869, 0.757, 0.927, 0.835, 0.776, 0.808, 0.886, 1.438, 0.964,
        0.749, 0.733, 1.447, 1.276, 1.358, 0.644, 0.573, 0.714, 1.349, 0.753,
        1.677, 0.652, 0.903, 0.604, 0.847, 1.364, 1.015, 0.978, 1.210, 1.014,
        0.843, 1.531, 1.305, 0.744, 0.883, 0.951, 1.361, 1.061, 0.764, 0.411,
        0.853, 0.902, 0.739, 1.343, 1.245, 1.178, 0.666, 1.120, 0.725, 0.833,
        0.946, 1.141, 0.875, 1.009, 1.180, 0.799, 0.779, 0.920, 1.634, 1.209,
        0.868, 1.291, 1.129, 1.108, 1.143, 0.878, 1.300, 0.786, 1.150, 1.226,
        0.788, 0.586, 1.097, 1.069, 1.713, 0.775, 1.395, 1.183, 1.098, 1.055,
        1.288, 0.896, 1.195, 1.239, 1.009, 0.579, 1.044, 0.770, 0.931, 1.001,
        0.590, 0.835, 0.787, 1.120, 0.759, 0.788, 0.982, 1.767, 1.073, 0.897,
        0.858, 0.888, 1.059, 0.940, 1.248, 1.494, 0.857, 0.960, 0.867, 0.903,
        0.392, 0.948, 1.097, 1.173, 1.314, 1.216, 1.197, 1.484, 1.451, 1.186,
        1.015, 0.838, 0.748, 1.328, 1.562, 1.025, 1.287, 1.144, 0.803, 1.077,
        0.985, 0.705, 0.862, 1.640, 1.164, 0.835, 0.499, 0.674, 1.327, 0.955,
        0.846, 0.785, 0.923, 0.801, 0.551, 0.730, 0.560, 1.122, 1.268, 0.908,
        0.874, 0.566, 0.777, 0.630, 0.524, 0.989, 0.942, 0.930, 0.930, 0.908,
        1.262, 1.509, 1.097, 1.557, 1.138, 1.181, 0.595, 1.543, 0.862, 0.842,
        0.663, 1.237, 0.360, 1.073, 0.993, 1.099, 1.017, 1.300, 1.247, 0.393],
       device='cuda:0')
b after update for 1 param tensor([70.515, 65.842, 59.856, 53.238, 67.730, 60.037, 60.935, 76.329, 72.295,
        69.034, 56.342, 61.155, 77.479, 70.175, 60.226, 76.058, 81.555, 68.890,
        71.917, 61.888, 75.409, 62.724, 58.541, 64.782, 61.476, 59.265, 60.468,
        63.315, 80.661, 66.042, 58.234, 57.608, 80.927, 75.980, 78.383, 54.001,
        50.935, 56.849, 78.128, 58.369, 87.127, 54.300, 63.912, 52.268, 61.918,
        78.567, 67.778, 66.519, 74.009, 67.735, 61.771, 83.240, 76.845, 58.019,
        63.218, 65.590, 78.480, 69.304, 58.808, 43.127, 62.129, 63.882, 57.830,
        77.973, 75.060, 73.018, 54.885, 71.197, 57.269, 61.393, 65.421, 71.852,
        62.932, 67.590, 73.064, 60.117, 59.386, 64.525, 86.001, 73.967, 62.694,
        76.425, 71.473, 70.812, 71.916, 63.050, 76.697, 59.642, 72.130, 74.489,
        59.726, 51.481, 70.461, 69.540, 88.054, 59.230, 79.464, 73.170, 70.491,
        69.097, 76.351, 63.676, 73.533, 74.875, 67.563, 51.204, 68.729, 59.050,
        64.924, 67.305, 51.670, 61.468, 59.668, 71.188, 58.606, 59.736, 66.666,
        89.432, 69.697, 63.716, 62.305, 63.394, 69.218, 65.213, 75.152, 82.221,
        62.262, 65.905, 62.646, 63.922, 42.147, 65.497, 70.447, 72.856, 77.115,
        74.183, 73.594, 81.956, 81.043, 73.258, 67.764, 61.593, 58.202, 77.524,
        84.067, 68.097, 76.328, 71.952, 60.271, 69.816, 66.784, 56.500, 62.462,
        86.153, 72.572, 61.479, 47.514, 55.230, 77.507, 65.726, 61.865, 59.590,
        64.644, 60.196, 49.957, 57.474, 50.331, 71.261, 75.752, 64.121, 62.878,
        50.605, 59.315, 53.415, 48.720, 66.903, 65.290, 64.884, 64.867, 64.107,
        75.573, 82.652, 70.451, 83.935, 71.760, 73.103, 51.902, 83.572, 62.452,
        61.729, 54.766, 74.834, 40.389, 69.695, 67.052, 70.532, 67.837, 76.697,
        75.110, 42.167], device='cuda:0')
clipping threshold 0.29089570186814256
a after update for 1 param tensor([[[-2.477e-02],
         [-4.452e-02],
         [ 2.779e-04],
         [ 1.425e-01],
         [-3.514e-02],
         [-7.219e-02],
         [ 5.687e-02],
         [-1.640e-02],
         [ 8.455e-03],
         [-6.058e-02]],

        [[-3.048e-02],
         [-2.976e-02],
         [-4.772e-02],
         [-1.376e-01],
         [ 1.021e-01],
         [ 4.459e-02],
         [-8.878e-03],
         [ 4.316e-02],
         [ 1.824e-02],
         [ 9.453e-02]],

        [[ 2.046e-02],
         [-6.550e-03],
         [-1.156e-02],
         [-1.065e-01],
         [-2.635e-02],
         [ 6.013e-02],
         [ 3.928e-02],
         [-2.647e-02],
         [ 4.645e-02],
         [-2.894e-02]],

        [[ 3.150e-02],
         [ 1.019e-02],
         [ 3.013e-02],
         [-4.679e-02],
         [ 2.994e-03],
         [ 3.819e-03],
         [-1.452e-02],
         [ 1.342e-03],
         [-4.342e-02],
         [-3.692e-02]],

        [[-1.793e-02],
         [ 1.132e-01],
         [-1.964e-02],
         [ 1.132e-02],
         [-1.741e-02],
         [ 4.570e-02],
         [ 9.078e-03],
         [-6.169e-03],
         [-5.904e-03],
         [-1.375e-03]],

        [[ 6.459e-03],
         [ 2.325e-02],
         [ 1.997e-02],
         [ 4.807e-03],
         [-1.283e-01],
         [ 3.141e-02],
         [-1.681e-02],
         [-1.779e-02],
         [ 6.910e-02],
         [ 1.243e-02]],

        [[-2.082e-02],
         [-5.539e-04],
         [-9.843e-04],
         [ 2.025e-02],
         [-7.489e-02],
         [ 5.324e-02],
         [ 6.818e-02],
         [-6.563e-02],
         [ 4.464e-02],
         [-1.028e-02]],

        [[ 7.140e-02],
         [-1.277e-02],
         [ 4.574e-02],
         [-9.515e-03],
         [ 3.894e-02],
         [ 2.918e-02],
         [ 3.067e-02],
         [ 3.095e-02],
         [-3.890e-02],
         [-4.770e-02]],

        [[-3.662e-03],
         [ 9.193e-02],
         [-3.150e-02],
         [-1.429e-02],
         [ 2.049e-02],
         [ 1.420e-02],
         [ 1.702e-01],
         [-6.380e-02],
         [-1.789e-02],
         [-3.832e-02]],

        [[ 7.247e-03],
         [ 1.456e-02],
         [ 5.286e-02],
         [ 1.273e-03],
         [ 1.225e-02],
         [-3.378e-02],
         [-9.726e-04],
         [ 2.757e-02],
         [-2.462e-02],
         [-4.600e-03]],

        [[-2.422e-02],
         [ 1.772e-02],
         [-9.148e-02],
         [-1.059e-01],
         [-6.016e-02],
         [ 1.867e-02],
         [ 4.838e-02],
         [ 8.508e-03],
         [-6.906e-03],
         [-7.872e-02]],

        [[-4.462e-02],
         [ 7.789e-03],
         [-3.986e-02],
         [-1.265e-02],
         [ 1.037e-02],
         [ 5.821e-02],
         [-1.478e-01],
         [ 5.612e-02],
         [-4.867e-02],
         [ 4.174e-03]],

        [[-3.663e-02],
         [ 4.062e-02],
         [-3.390e-02],
         [ 5.792e-02],
         [ 5.502e-02],
         [-8.721e-02],
         [-3.015e-02],
         [-2.147e-02],
         [ 1.312e-01],
         [-7.202e-02]],

        [[-6.277e-02],
         [ 8.068e-03],
         [-4.968e-03],
         [-1.302e-01],
         [ 1.877e-02],
         [ 7.350e-02],
         [-6.136e-02],
         [-4.375e-02],
         [ 3.352e-02],
         [-4.235e-02]],

        [[-3.238e-03],
         [-2.113e-02],
         [ 1.766e-02],
         [-1.484e-04],
         [ 1.061e-01],
         [ 2.229e-03],
         [-1.153e-01],
         [-1.643e-02],
         [ 2.333e-03],
         [ 7.060e-02]],

        [[-5.300e-03],
         [ 4.210e-02],
         [ 3.417e-02],
         [ 1.497e-03],
         [-7.267e-02],
         [-9.003e-02],
         [ 7.994e-02],
         [ 4.122e-02],
         [-1.337e-02],
         [ 6.715e-02]],

        [[ 4.626e-03],
         [ 1.494e-02],
         [-4.528e-02],
         [ 8.412e-04],
         [ 1.148e-02],
         [-4.197e-03],
         [-1.168e-02],
         [ 4.295e-02],
         [-2.073e-02],
         [-7.725e-03]],

        [[-3.840e-02],
         [ 8.230e-02],
         [-4.958e-02],
         [ 2.281e-02],
         [ 8.340e-02],
         [ 3.223e-03],
         [ 4.601e-02],
         [ 7.510e-02],
         [-2.823e-02],
         [ 1.101e-01]],

        [[ 6.518e-02],
         [ 2.797e-02],
         [-5.381e-03],
         [-3.033e-02],
         [-1.134e-02],
         [ 1.335e-01],
         [ 3.424e-02],
         [-2.504e-03],
         [-3.286e-03],
         [-5.256e-03]],

        [[-1.005e-02],
         [-5.650e-03],
         [-1.421e-02],
         [-3.427e-03],
         [ 1.297e-01],
         [-1.600e-02],
         [-1.619e-02],
         [-2.995e-02],
         [-2.075e-02],
         [ 3.488e-02]]], device='cuda:0')
s after update for 1 param tensor([[[0.661],
         [0.757],
         [1.095],
         [0.792],
         [0.445],
         [0.731],
         [1.264],
         [1.017],
         [0.646],
         [1.289]],

        [[0.723],
         [0.987],
         [0.417],
         [1.239],
         [1.171],
         [1.993],
         [1.479],
         [0.757],
         [1.152],
         [1.039]],

        [[0.727],
         [0.783],
         [1.546],
         [0.936],
         [0.763],
         [1.280],
         [1.062],
         [1.491],
         [0.863],
         [0.766]],

        [[0.808],
         [1.395],
         [1.137],
         [1.180],
         [1.012],
         [0.947],
         [1.493],
         [0.803],
         [1.935],
         [0.909]],

        [[1.575],
         [1.288],
         [1.143],
         [1.443],
         [0.568],
         [1.321],
         [1.179],
         [1.208],
         [1.154],
         [0.675]],

        [[0.913],
         [0.652],
         [1.290],
         [1.047],
         [1.358],
         [1.177],
         [0.720],
         [1.529],
         [1.314],
         [1.030]],

        [[1.273],
         [1.071],
         [0.939],
         [1.114],
         [0.901],
         [1.289],
         [1.437],
         [0.927],
         [0.909],
         [1.080]],

        [[1.241],
         [1.344],
         [1.501],
         [1.470],
         [0.825],
         [1.251],
         [1.092],
         [1.611],
         [1.030],
         [1.195]],

        [[1.336],
         [1.256],
         [1.339],
         [1.285],
         [1.150],
         [1.216],
         [1.170],
         [1.134],
         [0.699],
         [0.675]],

        [[0.930],
         [1.035],
         [0.699],
         [1.163],
         [1.044],
         [0.745],
         [0.712],
         [0.857],
         [0.660],
         [1.019]],

        [[1.647],
         [0.634],
         [1.080],
         [0.630],
         [1.064],
         [1.174],
         [1.079],
         [1.147],
         [0.773],
         [1.003]],

        [[1.173],
         [1.011],
         [0.755],
         [1.258],
         [0.651],
         [0.954],
         [1.787],
         [0.854],
         [0.757],
         [0.769]],

        [[0.990],
         [1.335],
         [0.935],
         [1.321],
         [1.554],
         [0.639],
         [0.670],
         [1.289],
         [0.807],
         [1.218]],

        [[0.529],
         [1.281],
         [1.495],
         [1.070],
         [1.349],
         [1.359],
         [1.174],
         [0.794],
         [1.318],
         [1.581]],

        [[0.707],
         [0.649],
         [0.661],
         [0.774],
         [1.483],
         [0.635],
         [1.247],
         [0.873],
         [1.578],
         [1.389]],

        [[0.878],
         [0.762],
         [0.760],
         [0.895],
         [0.950],
         [0.937],
         [1.365],
         [1.024],
         [1.032],
         [1.453]],

        [[0.918],
         [1.137],
         [1.465],
         [1.586],
         [1.150],
         [1.194],
         [1.367],
         [0.879],
         [1.302],
         [1.215]],

        [[0.812],
         [1.361],
         [0.808],
         [1.606],
         [1.346],
         [2.047],
         [1.103],
         [0.916],
         [0.822],
         [0.823]],

        [[1.105],
         [1.463],
         [1.286],
         [1.288],
         [0.858],
         [0.931],
         [1.200],
         [0.877],
         [1.142],
         [1.008]],

        [[1.169],
         [1.412],
         [1.184],
         [1.045],
         [1.763],
         [1.453],
         [0.960],
         [1.365],
         [0.920],
         [0.826]]], device='cuda:0')
b after update for 1 param tensor([[[54.710],
         [58.546],
         [70.384],
         [59.887],
         [44.880],
         [57.506],
         [75.627],
         [67.833],
         [54.073],
         [76.364]],

        [[57.219],
         [66.827],
         [43.454],
         [74.868],
         [72.795],
         [94.961],
         [81.808],
         [58.538],
         [72.210],
         [68.581]],

        [[57.379],
         [59.527],
         [83.647],
         [65.071],
         [58.753],
         [76.116],
         [69.332],
         [82.132],
         [62.494],
         [58.860]],

        [[60.471],
         [79.462],
         [71.728],
         [73.063],
         [67.673],
         [65.451],
         [82.203],
         [60.292],
         [93.576],
         [64.122]],

        [[84.425],
         [76.338],
         [71.928],
         [80.815],
         [50.702],
         [77.317],
         [73.062],
         [73.930],
         [72.271],
         [55.279]],

        [[64.280],
         [54.311],
         [76.411],
         [68.840],
         [78.400],
         [72.992],
         [57.083],
         [83.194],
         [77.110],
         [68.282]],

        [[75.905],
         [69.632],
         [65.184],
         [70.998],
         [63.874],
         [76.381],
         [80.638],
         [64.762],
         [64.151],
         [69.919]],

        [[74.952],
         [78.006],
         [82.418],
         [81.564],
         [61.109],
         [75.230],
         [70.290],
         [85.377],
         [68.259],
         [73.537]],

        [[77.750],
         [75.395],
         [77.848],
         [76.268],
         [72.151],
         [74.173],
         [72.763],
         [71.626],
         [56.233],
         [55.257]],

        [[64.877],
         [68.425],
         [56.262],
         [72.547],
         [68.748],
         [58.054],
         [56.771],
         [62.262],
         [54.661],
         [67.894]],

        [[86.337],
         [53.569],
         [69.918],
         [53.400],
         [69.383],
         [72.887],
         [69.884],
         [72.037],
         [59.131],
         [67.385]],

        [[72.873],
         [67.649],
         [58.463],
         [75.456],
         [54.278],
         [65.711],
         [89.919],
         [62.165],
         [58.541],
         [58.987]],

        [[66.925],
         [77.723],
         [65.064],
         [77.306],
         [83.875],
         [53.768],
         [55.046],
         [76.381],
         [60.439],
         [74.257]],

        [[48.941],
         [76.143],
         [82.242],
         [69.602],
         [78.140],
         [78.438],
         [72.878],
         [59.953],
         [77.231],
         [84.600]],

        [[56.568],
         [54.180],
         [54.680],
         [59.188],
         [81.915],
         [53.599],
         [75.131],
         [62.861],
         [84.505],
         [79.290]],

        [[63.040],
         [58.736],
         [58.647],
         [63.628],
         [65.564],
         [65.136],
         [78.598],
         [68.062],
         [68.334],
         [81.084]],

        [[64.447],
         [71.741],
         [81.438],
         [84.733],
         [72.154],
         [73.511],
         [78.646],
         [63.070],
         [76.772],
         [74.144]],

        [[60.615],
         [78.483],
         [60.474],
         [85.256],
         [78.057],
         [96.250],
         [70.669],
         [64.404],
         [60.984],
         [61.036]],

        [[70.733],
         [81.365],
         [76.301],
         [76.357],
         [62.308],
         [64.910],
         [73.703],
         [63.003],
         [71.890],
         [67.539]],

        [[72.731],
         [79.933],
         [73.208],
         [68.765],
         [89.326],
         [81.085],
         [65.913],
         [78.596],
         [64.510],
         [61.139]]], device='cuda:0')
clipping threshold 0.29089570186814256
a after update for 1 param tensor([[ 0.058],
        [-0.057],
        [ 0.042],
        [ 0.007],
        [-0.018],
        [-0.034],
        [ 0.018],
        [-0.008],
        [-0.035],
        [-0.057],
        [-0.041],
        [ 0.085],
        [ 0.045],
        [ 0.021],
        [-0.044],
        [-0.098],
        [-0.041],
        [-0.016],
        [-0.127],
        [-0.011]], device='cuda:0')
s after update for 1 param tensor([[1.263],
        [1.464],
        [1.584],
        [1.149],
        [1.533],
        [1.205],
        [1.703],
        [0.569],
        [1.460],
        [1.511],
        [0.983],
        [1.402],
        [1.440],
        [0.940],
        [1.007],
        [1.485],
        [1.160],
        [1.521],
        [1.881],
        [1.497]], device='cuda:0')
b after update for 1 param tensor([[75.590],
        [81.406],
        [84.681],
        [72.096],
        [83.291],
        [73.837],
        [87.794],
        [50.754],
        [81.292],
        [82.699],
        [66.713],
        [79.644],
        [80.732],
        [65.229],
        [67.498],
        [81.982],
        [72.453],
        [82.975],
        [92.272],
        [82.300]], device='cuda:0')
clipping threshold 0.29089570186814256
||w||^2 0.045346979379462825
exp ma of ||w||^2 0.1406335690760999
||w|| 0.21294830212862187
exp ma of ||w|| 0.36078155343696283
||w||^2 0.09517383701761728
exp ma of ||w||^2 0.13642904686344273
||w|| 0.30850257214100707
exp ma of ||w|| 0.35632117305737354
||w||^2 0.15149751138798218
exp ma of ||w||^2 0.12941542469731496
||w|| 0.38922681226758027
exp ma of ||w|| 0.34845518776846185
||w||^2 0.16251244382576835
exp ma of ||w||^2 0.1283578852606327
||w|| 0.4031283217857167
exp ma of ||w|| 0.346808820872941
||w||^2 0.19968828287171075
exp ma of ||w||^2 0.13996088925800623
||w|| 0.4468649492539225
exp ma of ||w|| 0.36100789156886937
||w||^2 0.13166274491661462
exp ma of ||w||^2 0.13372482293556515
||w|| 0.3628536136193418
exp ma of ||w|| 0.35410007469717264
||w||^2 0.11207963075521984
exp ma of ||w||^2 0.1413833036016072
||w|| 0.334782960670372
exp ma of ||w|| 0.36360002581857437
cuda
Objective function 18.34 = squared loss an data 16.13 + 0.5*rho*h**2 0.757499 + alpha*h 0.604198 + L2reg 0.66 + L1reg 0.18 ; SHD = 59 ; DAG True
Proportion of microbatches that were clipped  0.7591803937324226
iteration 2 in inner loop, alpha 1.5522898821292088 rho 10.0 h 0.38922981309253757
4420
cuda
Objective function 25.16 = squared loss an data 16.13 + 0.5*rho*h**2 7.574992 + alpha*h 0.604198 + L2reg 0.66 + L1reg 0.18 ; SHD = 59 ; DAG True
||w||^2 7472125.067153928
exp ma of ||w||^2 260536560.19152898
||w|| 2733.5188068045054
exp ma of ||w|| 8607.201094069835
||w||^2 0.0648954178489921
exp ma of ||w||^2 1.6274101791468034
||w|| 0.25474579064037955
exp ma of ||w|| 0.29308805217298
||w||^2 0.1911143196667121
exp ma of ||w||^2 0.14761996654803447
||w|| 0.43716623802246224
exp ma of ||w|| 0.3694602117322356
||w||^2 0.09064692869728669
exp ma of ||w||^2 0.12639211008235948
||w|| 0.30107628385059937
exp ma of ||w|| 0.3431273470786076
||w||^2 0.048612742586633464
exp ma of ||w||^2 0.14506289312207285
||w|| 0.22048297572972264
exp ma of ||w|| 0.36508812769290677
||w||^2 0.21358729005345767
exp ma of ||w||^2 0.15302739861438544
||w|| 0.46215504979763844
exp ma of ||w|| 0.3777816167112181
||w||^2 0.0896988624537988
exp ma of ||w||^2 0.14838843418713527
||w|| 0.2994976835533103
exp ma of ||w|| 0.37143436698458593
||w||^2 0.23602090629061717
exp ma of ||w||^2 0.16437474743957187
||w|| 0.4858198290422255
exp ma of ||w|| 0.3904800036984535
cuda
Objective function 19.35 = squared loss an data 17.40 + 0.5*rho*h**2 0.837889 + alpha*h 0.200947 + L2reg 0.75 + L1reg 0.16 ; SHD = 49 ; DAG True
Proportion of microbatches that were clipped  0.7604285018665801
iteration 3 in inner loop, alpha 1.5522898821292088 rho 100.0 h 0.1294518521510888
iteration 2 in outer loop, alpha = 14.497475097238087, rho = 100.0, h = 0.1294518521510888
cuda
4420
cuda
Objective function 21.03 = squared loss an data 17.40 + 0.5*rho*h**2 0.837889 + alpha*h 1.876725 + L2reg 0.75 + L1reg 0.16 ; SHD = 49 ; DAG True
||w||^2 107223748.12756895
exp ma of ||w||^2 2349223027.051666
||w|| 10354.890058690577
exp ma of ||w|| 39199.87760215653
||w||^2 62381.05821439742
exp ma of ||w||^2 27701173.754722413
||w|| 249.7620031437877
exp ma of ||w|| 1375.694743963474
||w||^2 0.11168260938292057
exp ma of ||w||^2 42839.98245464705
||w|| 0.33418948125714637
exp ma of ||w|| 3.2288984364565665
||w||^2 0.14647769127428617
exp ma of ||w||^2 2442.870361761841
||w|| 0.38272404062756
exp ma of ||w|| 0.5103389686859715
||w||^2 0.055982384954307345
exp ma of ||w||^2 0.12480545036423747
||w|| 0.23660596981967158
exp ma of ||w|| 0.3371107750350075
||w||^2 0.2254165112479
exp ma of ||w||^2 0.1445509072571175
||w|| 0.4747804874338245
exp ma of ||w|| 0.36927262553183804
||w||^2 0.09369026387318759
exp ma of ||w||^2 0.14579930576761865
||w|| 0.30608865361719567
exp ma of ||w|| 0.36762818544256626
||w||^2 0.12202855012403106
exp ma of ||w||^2 0.1367067121790636
||w|| 0.34932585092436413
exp ma of ||w|| 0.35870041202604375
||w||^2 0.1167893112217103
exp ma of ||w||^2 0.1408878075428218
||w|| 0.34174451161900216
exp ma of ||w|| 0.3640738067366459
||w||^2 0.04206759877720846
exp ma of ||w||^2 0.14685448325584646
||w|| 0.20510387314043696
exp ma of ||w|| 0.37080571596387
||w||^2 0.07863844237915335
exp ma of ||w||^2 0.15025058529267776
||w|| 0.28042546670934393
exp ma of ||w|| 0.3721026779893362
||w||^2 0.1990999127994839
exp ma of ||w||^2 0.1626839649722047
||w|| 0.4462061326332079
exp ma of ||w|| 0.3909789286437581
||w||^2 0.30337881670572425
exp ma of ||w||^2 0.1722633966619156
||w|| 0.5507983448647283
exp ma of ||w|| 0.39833511877494454
||w||^2 0.1296861449016966
exp ma of ||w||^2 0.15798169321192906
||w|| 0.3601196258213326
exp ma of ||w|| 0.38343323851390376
||w||^2 0.0777804276918865
exp ma of ||w||^2 0.13589481875905873
||w|| 0.27889142635062575
exp ma of ||w|| 0.3556817051902001
cuda
Objective function 20.22 = squared loss an data 17.79 + 0.5*rho*h**2 0.313258 + alpha*h 1.147515 + L2reg 0.81 + L1reg 0.16 ; SHD = 62 ; DAG True
Proportion of microbatches that were clipped  0.7588606570642499
iteration 1 in inner loop, alpha 14.497475097238087 rho 100.0 h 0.07915275347409079
4420
cuda
Objective function 23.04 = squared loss an data 17.79 + 0.5*rho*h**2 3.132579 + alpha*h 1.147515 + L2reg 0.81 + L1reg 0.16 ; SHD = 62 ; DAG True
||w||^2 0.1766411859420192
exp ma of ||w||^2 42584.637175914424
||w|| 0.4202870280439538
exp ma of ||w|| 2.913065017474055
||w||^2 0.1296522393308739
exp ma of ||w||^2 389.97060243354196
||w|| 0.3600725473163344
exp ma of ||w|| 0.3768523915786985
||w||^2 0.2066375392345118
exp ma of ||w||^2 0.1533671621492279
||w|| 0.45457401953313586
exp ma of ||w|| 0.3800240032824687
||w||^2 0.16187258017592446
exp ma of ||w||^2 0.15689293527740533
||w|| 0.4023339162634993
exp ma of ||w|| 0.38252453997368246
||w||^2 0.1442396074414185
exp ma of ||w||^2 0.1592939067774357
||w|| 0.37978889852313813
exp ma of ||w|| 0.3864210061118421
||w||^2 0.19992200677212815
exp ma of ||w||^2 0.1681567719577259
||w|| 0.4471263879174748
exp ma of ||w|| 0.3944451193130165
cuda
Objective function 20.44 = squared loss an data 18.40 + 0.5*rho*h**2 0.548153 + alpha*h 0.480019 + L2reg 0.86 + L1reg 0.16 ; SHD = 57 ; DAG True
Proportion of microbatches that were clipped  0.7637795275590551
iteration 2 in inner loop, alpha 14.497475097238087 rho 1000.0 h 0.033110502124976904
4420
cuda
Objective function 25.38 = squared loss an data 18.40 + 0.5*rho*h**2 5.481527 + alpha*h 0.480019 + L2reg 0.86 + L1reg 0.16 ; SHD = 57 ; DAG True
||w||^2 100959567932.52551
exp ma of ||w||^2 41658402071.66297
||w|| 317741.35382811836
exp ma of ||w|| 130059.2473266068
||w||^2 239461362.57429436
exp ma of ||w||^2 6414657465.444831
||w|| 15474.539171629453
exp ma of ||w|| 45261.32847035341
||w||^2 161.8597622052286
exp ma of ||w||^2 23317788.61257687
||w|| 12.722411807720603
exp ma of ||w|| 430.730216748075
||w||^2 0.13999857247758174
exp ma of ||w||^2 6593.623422380855
||w|| 0.37416383106545953
exp ma of ||w|| 0.6302865047667794
||w||^2 0.1322282864939889
exp ma of ||w||^2 0.12552644018711787
||w|| 0.3636320757221355
exp ma of ||w|| 0.33775666836419294
||w||^2 0.13135593914896077
exp ma of ||w||^2 0.14319580412660515
||w|| 0.36243059907927305
exp ma of ||w|| 0.36442781916942896
||w||^2 0.1495790286037886
exp ma of ||w||^2 0.13803907716272204
||w|| 0.3867544810390548
exp ma of ||w|| 0.3595295215388568
||w||^2 0.1639668875016011
exp ma of ||w||^2 0.14102964765223305
||w|| 0.40492824981915143
exp ma of ||w|| 0.36477471755872315
||w||^2 0.13520414489338742
exp ma of ||w||^2 0.14610247075614383
||w|| 0.36770116248577106
exp ma of ||w|| 0.37099697595732756
||w||^2 0.23360924692730325
exp ma of ||w||^2 0.15767233182523593
||w|| 0.483331404863478
exp ma of ||w|| 0.3813750669058841
||w||^2 0.2050818740870724
exp ma of ||w||^2 0.1594226721400792
||w|| 0.45285966268489003
exp ma of ||w|| 0.385327126855888
||w||^2 0.13969112277593923
exp ma of ||w||^2 0.13656968757605426
||w|| 0.37375275621182946
exp ma of ||w|| 0.35808522907158713
cuda
Objective function 20.56 = squared loss an data 18.81 + 0.5*rho*h**2 0.570036 + alpha*h 0.154796 + L2reg 0.87 + L1reg 0.15 ; SHD = 61 ; DAG True
Proportion of microbatches that were clipped  0.7634580110056624
iteration 3 in inner loop, alpha 14.497475097238087 rho 10000.0 h 0.010677419210626482
iteration 3 in outer loop, alpha = 121.27166720350291, rho = 10000.0, h = 0.010677419210626482
cuda
4420
cuda
Objective function 21.70 = squared loss an data 18.81 + 0.5*rho*h**2 0.570036 + alpha*h 1.294868 + L2reg 0.87 + L1reg 0.15 ; SHD = 61 ; DAG True
||w||^2 0.1765896632970837
exp ma of ||w||^2 6647.592688507065
||w|| 0.42022572898037036
exp ma of ||w|| 0.5171223469692025
||w||^2 0.0881294084165123
exp ma of ||w||^2 41.663403591665144
||w|| 0.2968659771959601
exp ma of ||w|| 0.34969207341552916
||w||^2 0.19651118508239135
exp ma of ||w||^2 0.22805718409719686
||w|| 0.4432958211876031
exp ma of ||w|| 0.32502687565082417
||w||^2 0.14375368914507508
exp ma of ||w||^2 0.10610026977537743
||w|| 0.37914863727181597
exp ma of ||w|| 0.3162518680136232
||w||^2 0.055678484422790255
exp ma of ||w||^2 0.14869627882519812
||w|| 0.23596288780821076
exp ma of ||w|| 0.37283801195596455
||w||^2 0.05984011191166643
exp ma of ||w||^2 0.15139398765676318
||w|| 0.24462238636655156
exp ma of ||w|| 0.3768551303207335
||w||^2 0.1564925735211891
exp ma of ||w||^2 0.14733429479615448
||w|| 0.3955914224565405
exp ma of ||w|| 0.37083319201673076
||w||^2 0.10632571331767912
exp ma of ||w||^2 0.13891294180310818
||w|| 0.32607623850516787
exp ma of ||w|| 0.3621885479059308
||w||^2 0.1498328041062276
exp ma of ||w||^2 0.13944700100735827
||w|| 0.38708242546804883
exp ma of ||w|| 0.3611087940223174
||w||^2 0.08927947898247864
exp ma of ||w||^2 0.13369546170214525
||w|| 0.2987967184934912
exp ma of ||w|| 0.35344060573068775
||w||^2 0.20958528609550126
exp ma of ||w||^2 0.15015613167278752
||w|| 0.45780485591079223
exp ma of ||w|| 0.37750050042268135
||w||^2 0.21701189152141764
exp ma of ||w||^2 0.14014996562044663
||w|| 0.4658453515077913
exp ma of ||w|| 0.3637017752942487
cuda
Objective function 21.06 = squared loss an data 18.87 + 0.5*rho*h**2 0.273201 + alpha*h 0.896428 + L2reg 0.87 + L1reg 0.15 ; SHD = 54 ; DAG True
Proportion of microbatches that were clipped  0.7614649681528662
iteration 1 in inner loop, alpha 121.27166720350291 rho 10000.0 h 0.0073918992569730335
4420
cuda
Objective function 23.51 = squared loss an data 18.87 + 0.5*rho*h**2 2.732009 + alpha*h 0.896428 + L2reg 0.87 + L1reg 0.15 ; SHD = 54 ; DAG True
||w||^2 4.04931561366298
exp ma of ||w||^2 162878591.02969098
||w|| 2.012291135413308
exp ma of ||w|| 94.17340368205348
||w||^2 0.15321575544805566
exp ma of ||w||^2 397.1280984776736
||w|| 0.3914278419428741
exp ma of ||w|| 0.42909146482074767
||w||^2 0.04525897212844341
exp ma of ||w||^2 4.6487968883824164
||w|| 0.2127415618266525
exp ma of ||w|| 0.3336012076014927
||w||^2 0.16535652806571421
exp ma of ||w||^2 0.13906748618482817
||w|| 0.4066405391321852
exp ma of ||w|| 0.36100956354300134
||w||^2 0.2535885048101074
exp ma of ||w||^2 0.16016043015420528
||w|| 0.5035757190434299
exp ma of ||w|| 0.3872591145157898
||w||^2 0.4738887881806094
exp ma of ||w||^2 0.15722153230537952
||w|| 0.6883958077883751
exp ma of ||w|| 0.38210725178173055
||w||^2 0.0902065974414569
exp ma of ||w||^2 0.14412956559463713
||w|| 0.3003441316913931
exp ma of ||w|| 0.3704889554912846
||w||^2 0.18101324959674697
exp ma of ||w||^2 0.14806796977102482
||w|| 0.42545651904365855
exp ma of ||w|| 0.3742887709524425
||w||^2 0.07896942519036337
exp ma of ||w||^2 0.1489688824362086
||w|| 0.28101499104204986
exp ma of ||w|| 0.37456986486332133
||w||^2 0.11141073256
exp ma of ||w||^2 0.1317890054642725
||w|| 0.333782462930574
exp ma of ||w|| 0.35468152955329335
||w||^2 0.1188627889054434
exp ma of ||w||^2 0.14490776369795103
||w|| 0.3447648313059837
exp ma of ||w|| 0.3720254431982024
cuda
Objective function 20.75 = squared loss an data 18.92 + 0.5*rho*h**2 0.411124 + alpha*h 0.347745 + L2reg 0.92 + L1reg 0.15 ; SHD = 51 ; DAG True
Proportion of microbatches that were clipped  0.7638877723289653
iteration 2 in inner loop, alpha 121.27166720350291 rho 100000.0 h 0.0028674869919100843
iteration 4 in outer loop, alpha = 2988.7586591135873, rho = 1000000.0, h = 0.0028674869919100843
Threshold 0.3
[[0.003 0.16  0.365 0.23  0.264 0.323 0.413 0.018 0.116 0.318 0.306 0.27
  0.601 0.041 0.543 0.251 0.183 0.336 0.4   0.271]
 [0.021 0.003 0.334 0.164 0.155 0.668 0.304 0.005 0.111 0.307 0.079 0.21
  0.158 0.014 0.083 0.149 0.11  0.411 0.104 0.587]
 [0.01  0.013 0.004 0.021 0.177 0.065 0.049 0.003 0.005 0.504 0.018 0.012
  0.051 0.001 0.025 0.023 0.027 0.035 0.014 0.057]
 [0.014 0.021 0.131 0.003 0.083 0.112 0.123 0.006 0.005 0.487 0.067 0.005
  0.109 0.009 0.044 0.033 0.009 0.117 0.026 0.06 ]
 [0.005 0.02  0.03  0.049 0.002 0.02  0.03  0.003 0.007 0.047 0.029 0.005
  0.056 0.006 0.017 0.009 0.018 0.047 0.011 0.125]
 [0.008 0.004 0.045 0.02  0.113 0.003 0.021 0.008 0.01  0.348 0.021 0.011
  0.099 0.006 0.006 0.019 0.01  0.016 0.005 0.149]
 [0.007 0.016 0.07  0.037 0.138 0.288 0.003 0.005 0.015 0.15  0.175 0.009
  0.142 0.009 0.015 0.055 0.006 0.026 0.032 0.112]
 [0.167 0.675 0.356 0.497 0.625 0.33  0.417 0.003 0.201 0.407 0.529 0.637
  0.714 0.118 0.741 0.222 0.212 1.263 0.219 0.387]
 [0.029 0.023 0.453 0.607 0.64  0.287 0.282 0.014 0.004 0.352 0.489 0.012
  0.188 0.005 0.198 0.136 0.069 0.124 0.371 0.272]
 [0.006 0.005 0.009 0.006 0.058 0.011 0.019 0.006 0.008 0.003 0.015 0.006
  0.012 0.004 0.011 0.011 0.014 0.018 0.018 0.015]
 [0.012 0.042 0.193 0.055 0.08  0.182 0.031 0.008 0.005 0.367 0.002 0.007
  0.046 0.008 0.022 0.014 0.021 0.021 0.008 0.392]
 [0.012 0.011 0.259 0.65  0.473 0.292 0.49  0.004 0.344 0.372 0.365 0.003
  0.472 0.032 0.116 0.355 0.303 0.399 0.145 0.252]
 [0.003 0.018 0.066 0.028 0.071 0.044 0.063 0.005 0.019 0.352 0.119 0.005
  0.002 0.007 0.008 0.065 0.021 0.01  0.021 0.125]
 [0.138 0.205 2.221 0.221 0.482 0.356 0.256 0.027 0.6   0.44  0.341 0.084
  0.295 0.002 0.302 0.383 0.296 0.119 0.609 0.485]
 [0.009 0.035 0.147 0.099 0.271 0.547 0.183 0.005 0.03  0.148 0.113 0.025
  0.564 0.009 0.003 0.108 0.014 0.08  0.037 0.146]
 [0.011 0.022 0.177 0.127 0.3   0.176 0.046 0.007 0.022 0.331 0.311 0.01
  0.05  0.007 0.044 0.005 0.049 0.026 0.007 0.109]
 [0.016 0.034 0.136 0.395 0.294 0.191 0.72  0.016 0.059 0.26  0.207 0.016
  0.211 0.016 0.232 0.094 0.004 0.145 0.063 0.248]
 [0.008 0.008 0.12  0.029 0.084 0.221 0.106 0.002 0.032 0.285 0.125 0.006
  0.228 0.026 0.027 0.176 0.025 0.003 0.043 0.444]
 [0.009 0.037 0.116 0.112 0.291 0.715 0.133 0.012 0.006 0.274 0.315 0.033
  0.149 0.007 0.091 0.605 0.047 0.083 0.003 0.154]
 [0.01  0.005 0.058 0.032 0.029 0.03  0.044 0.005 0.014 0.252 0.009 0.016
  0.03  0.009 0.021 0.018 0.008 0.011 0.017 0.002]]
[[0.    0.    0.365 0.    0.    0.323 0.413 0.    0.    0.318 0.306 0.
  0.601 0.    0.543 0.    0.    0.336 0.4   0.   ]
 [0.    0.    0.334 0.    0.    0.668 0.304 0.    0.    0.307 0.    0.
  0.    0.    0.    0.    0.    0.411 0.    0.587]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.504 0.    0.
  0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.487 0.    0.
  0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.348 0.    0.
  0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.675 0.356 0.497 0.625 0.33  0.417 0.    0.    0.407 0.529 0.637
  0.714 0.    0.741 0.    0.    1.263 0.    0.387]
 [0.    0.    0.453 0.607 0.64  0.    0.    0.    0.    0.352 0.489 0.
  0.    0.    0.    0.    0.    0.    0.371 0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.367 0.    0.
  0.    0.    0.    0.    0.    0.    0.    0.392]
 [0.    0.    0.    0.65  0.473 0.    0.49  0.    0.344 0.372 0.365 0.
  0.472 0.    0.    0.355 0.303 0.399 0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.352 0.    0.
  0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    2.221 0.    0.482 0.356 0.    0.    0.6   0.44  0.341 0.
  0.    0.    0.302 0.383 0.    0.    0.609 0.485]
 [0.    0.    0.    0.    0.    0.547 0.    0.    0.    0.    0.    0.
  0.564 0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.331 0.311 0.
  0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.395 0.    0.    0.72  0.    0.    0.    0.    0.
  0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.    0.    0.    0.    0.    0.    0.    0.444]
 [0.    0.    0.    0.    0.    0.715 0.    0.    0.    0.    0.315 0.
  0.    0.    0.    0.605 0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.    0.    0.    0.    0.    0.    0.    0.   ]]
{'fdr': 0.4857142857142857, 'tpr': 0.6, 'fpr': 0.26153846153846155, 'f1': 0.5538461538461538, 'shd': 51, 'npred': 70, 'ntrue': 60}
[1.596e-01 3.648e-01 2.295e-01 2.636e-01 3.233e-01 4.130e-01 1.763e-02
 1.156e-01 3.179e-01 3.065e-01 2.701e-01 6.008e-01 4.089e-02 5.427e-01
 2.510e-01 1.829e-01 3.362e-01 4.000e-01 2.708e-01 2.121e-02 3.339e-01
 1.643e-01 1.548e-01 6.683e-01 3.036e-01 5.205e-03 1.111e-01 3.066e-01
 7.919e-02 2.101e-01 1.575e-01 1.410e-02 8.330e-02 1.487e-01 1.101e-01
 4.108e-01 1.045e-01 5.866e-01 1.045e-02 1.287e-02 2.126e-02 1.772e-01
 6.500e-02 4.889e-02 2.971e-03 5.384e-03 5.041e-01 1.762e-02 1.237e-02
 5.124e-02 1.283e-03 2.508e-02 2.277e-02 2.652e-02 3.496e-02 1.391e-02
 5.668e-02 1.449e-02 2.074e-02 1.309e-01 8.279e-02 1.124e-01 1.231e-01
 5.780e-03 4.732e-03 4.866e-01 6.717e-02 4.611e-03 1.090e-01 8.522e-03
 4.365e-02 3.272e-02 8.919e-03 1.172e-01 2.641e-02 5.987e-02 5.462e-03
 1.982e-02 3.023e-02 4.891e-02 2.024e-02 3.019e-02 2.966e-03 6.806e-03
 4.741e-02 2.903e-02 4.779e-03 5.644e-02 5.860e-03 1.698e-02 9.069e-03
 1.795e-02 4.717e-02 1.069e-02 1.248e-01 8.425e-03 3.643e-03 4.500e-02
 2.005e-02 1.129e-01 2.050e-02 8.066e-03 9.930e-03 3.476e-01 2.145e-02
 1.145e-02 9.920e-02 5.944e-03 5.947e-03 1.944e-02 1.035e-02 1.616e-02
 4.906e-03 1.488e-01 6.691e-03 1.590e-02 6.998e-02 3.736e-02 1.380e-01
 2.881e-01 4.771e-03 1.521e-02 1.500e-01 1.755e-01 9.109e-03 1.417e-01
 9.358e-03 1.452e-02 5.528e-02 5.824e-03 2.616e-02 3.215e-02 1.116e-01
 1.670e-01 6.748e-01 3.557e-01 4.970e-01 6.247e-01 3.298e-01 4.174e-01
 2.012e-01 4.069e-01 5.291e-01 6.371e-01 7.144e-01 1.178e-01 7.406e-01
 2.221e-01 2.121e-01 1.263e+00 2.191e-01 3.872e-01 2.947e-02 2.257e-02
 4.528e-01 6.075e-01 6.398e-01 2.868e-01 2.821e-01 1.430e-02 3.522e-01
 4.891e-01 1.158e-02 1.885e-01 5.477e-03 1.978e-01 1.364e-01 6.912e-02
 1.243e-01 3.712e-01 2.716e-01 6.140e-03 5.431e-03 8.984e-03 6.100e-03
 5.814e-02 1.082e-02 1.904e-02 6.326e-03 7.976e-03 1.518e-02 6.456e-03
 1.164e-02 3.760e-03 1.072e-02 1.116e-02 1.418e-02 1.808e-02 1.813e-02
 1.475e-02 1.162e-02 4.165e-02 1.933e-01 5.465e-02 7.964e-02 1.821e-01
 3.096e-02 7.877e-03 4.663e-03 3.669e-01 7.372e-03 4.568e-02 8.005e-03
 2.226e-02 1.390e-02 2.114e-02 2.146e-02 8.037e-03 3.923e-01 1.194e-02
 1.125e-02 2.592e-01 6.499e-01 4.729e-01 2.921e-01 4.896e-01 4.088e-03
 3.435e-01 3.721e-01 3.646e-01 4.715e-01 3.152e-02 1.161e-01 3.550e-01
 3.025e-01 3.986e-01 1.453e-01 2.515e-01 3.111e-03 1.827e-02 6.607e-02
 2.779e-02 7.078e-02 4.368e-02 6.291e-02 4.899e-03 1.866e-02 3.519e-01
 1.192e-01 5.325e-03 6.996e-03 7.890e-03 6.545e-02 2.089e-02 1.026e-02
 2.150e-02 1.246e-01 1.381e-01 2.048e-01 2.221e+00 2.206e-01 4.817e-01
 3.558e-01 2.560e-01 2.696e-02 6.004e-01 4.401e-01 3.414e-01 8.438e-02
 2.953e-01 3.021e-01 3.826e-01 2.963e-01 1.187e-01 6.088e-01 4.850e-01
 8.778e-03 3.536e-02 1.469e-01 9.935e-02 2.714e-01 5.471e-01 1.826e-01
 4.565e-03 2.991e-02 1.476e-01 1.129e-01 2.480e-02 5.640e-01 8.602e-03
 1.076e-01 1.421e-02 7.992e-02 3.694e-02 1.456e-01 1.129e-02 2.187e-02
 1.774e-01 1.266e-01 2.996e-01 1.757e-01 4.648e-02 7.367e-03 2.234e-02
 3.309e-01 3.110e-01 9.509e-03 5.025e-02 6.742e-03 4.448e-02 4.922e-02
 2.646e-02 7.353e-03 1.095e-01 1.574e-02 3.350e-02 1.362e-01 3.948e-01
 2.943e-01 1.913e-01 7.203e-01 1.587e-02 5.898e-02 2.601e-01 2.073e-01
 1.593e-02 2.109e-01 1.551e-02 2.318e-01 9.361e-02 1.447e-01 6.277e-02
 2.484e-01 7.680e-03 7.760e-03 1.201e-01 2.876e-02 8.376e-02 2.212e-01
 1.056e-01 1.763e-03 3.216e-02 2.853e-01 1.250e-01 5.668e-03 2.283e-01
 2.612e-02 2.713e-02 1.760e-01 2.543e-02 4.312e-02 4.439e-01 8.530e-03
 3.707e-02 1.160e-01 1.124e-01 2.911e-01 7.150e-01 1.326e-01 1.156e-02
 6.390e-03 2.739e-01 3.148e-01 3.321e-02 1.488e-01 7.234e-03 9.089e-02
 6.053e-01 4.710e-02 8.301e-02 1.536e-01 9.822e-03 4.809e-03 5.822e-02
 3.177e-02 2.891e-02 3.006e-02 4.361e-02 4.749e-03 1.422e-02 2.518e-01
 8.987e-03 1.588e-02 2.997e-02 9.174e-03 2.141e-02 1.841e-02 7.701e-03
 1.112e-02 1.653e-02]
[[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 1. 1. 0. 0. 0. 0. 1. 1. 0.]
 [0. 0. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 1. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [0. 0. 0. 1. 0. 0. 1. 0. 1. 0. 0. 1. 1. 0. 0. 0. 0. 1. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0. 0. 1. 1. 0. 0. 0. 1. 0. 0. 0. 1. 0.]
 [0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 1.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 1. 0. 1. 1. 0. 1. 0. 1. 0. 1. 0. 1. 0. 0. 1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 1. 1. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 1. 0. 0. 1. 1.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 1. 1. 0. 0. 0. 1. 0. 0. 0. 0. 1. 1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
[0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 1. 1. 0. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0. 1.
 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 1. 0. 0. 0. 1. 1. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 1. 0. 0. 1. 1. 0. 0. 1.
 1. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 1. 1. 0. 0. 0. 1. 1. 0. 0. 0. 1. 0. 0.
 0. 1. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 1. 0. 0.
 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 1. 1. 0. 1.
 0. 1. 0. 1. 1. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 1. 0. 0.
 0. 1. 0. 0. 0. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 1. 0. 0.
 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 1. 1. 0. 0. 0. 1. 0. 0. 0. 0. 1. 1. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
aucroc, aucpr (0.7774479166666667, 0.5155130812890749)
Iterations 2250
Achieves (13.034436291409676, 1e-05)-DP
