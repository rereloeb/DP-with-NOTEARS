samples  5000  graph  13 26 ER mlp  minibatch size  50  noise  0.5  minibatches per NN training  250 adaclip_and_quantile
cuda
cuda
iteration 1 in inner loop,alpha 0.0 rho 1.0 h 1.322518967968728
iteration 1 in outer loop, alpha = 1.322518967968728, rho = 1.0, h = 1.322518967968728
cuda
iteration 1 in inner loop,alpha 1.322518967968728 rho 1.0 h 0.8800708651427165
iteration 2 in inner loop,alpha 1.322518967968728 rho 10.0 h 0.4004716387134195
iteration 3 in inner loop,alpha 1.322518967968728 rho 100.0 h 0.1460902192537592
iteration 2 in outer loop, alpha = 15.931540893344648, rho = 100.0, h = 0.1460902192537592
cuda
iteration 1 in inner loop,alpha 15.931540893344648 rho 100.0 h 0.0917923530310798
iteration 2 in inner loop,alpha 15.931540893344648 rho 1000.0 h 0.03634019258100096
iteration 3 in outer loop, alpha = 52.27173347434561, rho = 1000.0, h = 0.03634019258100096
cuda
iteration 1 in inner loop,alpha 52.27173347434561 rho 1000.0 h 0.022466434180948625
iteration 2 in inner loop,alpha 52.27173347434561 rho 10000.0 h 0.007381044273051529
iteration 4 in outer loop, alpha = 126.0821762048609, rho = 10000.0, h = 0.007381044273051529
cuda
iteration 1 in inner loop,alpha 126.0821762048609 rho 10000.0 h 0.003916551463571949
iteration 2 in inner loop,alpha 126.0821762048609 rho 100000.0 h 0.0014244319668765826
iteration 5 in outer loop, alpha = 268.52537289251916, rho = 100000.0, h = 0.0014244319668765826
cuda
iteration 1 in inner loop,alpha 268.52537289251916 rho 100000.0 h 0.000743005989100709
iteration 6 in outer loop, alpha = 1011.5313619932282, rho = 1000000.0, h = 0.000743005989100709
Threshold 0.3
[[0.001 0.    0.179 2.534 0.611 0.005 0.017 0.002 0.    0.432 0.    1.926
  0.   ]
 [0.649 0.001 0.317 0.053 0.165 0.002 0.039 0.    0.    2.026 0.002 0.21
  0.   ]
 [0.    0.    0.002 0.    0.    0.    0.001 0.    0.    0.    0.    0.
  0.   ]
 [0.    0.    2.681 0.001 0.109 0.005 0.088 0.002 0.    1.544 0.    0.276
  0.   ]
 [0.    0.    0.248 0.    0.001 0.    0.002 0.    0.    0.    0.    0.001
  0.   ]
 [0.078 0.034 0.336 0.064 0.587 0.001 0.012 0.    0.096 2.225 0.03  0.097
  0.014]
 [0.01  0.011 1.083 0.025 0.089 0.055 0.026 0.005 0.003 0.904 0.001 0.312
  0.004]
 [0.01  0.01  0.014 0.016 1.492 3.708 0.082 0.001 0.653 0.451 0.005 0.078
  0.002]
 [0.024 1.524 2.231 0.024 0.087 0.005 0.355 0.001 0.    1.247 0.002 0.198
  0.036]
 [0.    0.    1.118 0.    0.255 0.    0.001 0.    0.    0.004 0.    2.467
  0.   ]
 [1.734 0.005 2.548 0.073 0.439 0.001 0.012 0.002 0.006 0.899 0.    0.116
  0.007]
 [0.    0.    0.951 0.    0.933 0.    0.001 0.    0.    0.    0.    0.001
  0.   ]
 [0.005 0.999 2.323 0.016 0.263 0.005 0.091 0.003 0.003 2.222 0.002 0.35
  0.   ]]
[[0.    0.    0.    2.534 0.611 0.    0.    0.    0.    0.432 0.    1.926
  0.   ]
 [0.649 0.    0.317 0.    0.    0.    0.    0.    0.    2.026 0.    0.
  0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.   ]
 [0.    0.    2.681 0.    0.    0.    0.    0.    0.    1.544 0.    0.
  0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.   ]
 [0.    0.    0.336 0.    0.587 0.    0.    0.    0.    2.225 0.    0.
  0.   ]
 [0.    0.    1.083 0.    0.    0.    0.    0.    0.    0.904 0.    0.312
  0.   ]
 [0.    0.    0.    0.    1.492 3.708 0.    0.    0.653 0.451 0.    0.
  0.   ]
 [0.    1.524 2.231 0.    0.    0.    0.355 0.    0.    1.247 0.    0.
  0.   ]
 [0.    0.    1.118 0.    0.    0.    0.    0.    0.    0.    0.    2.467
  0.   ]
 [1.734 0.    2.548 0.    0.439 0.    0.    0.    0.    0.899 0.    0.
  0.   ]
 [0.    0.    0.951 0.    0.933 0.    0.    0.    0.    0.    0.    0.
  0.   ]
 [0.    0.999 2.323 0.    0.    0.    0.    0.    0.    2.222 0.    0.35
  0.   ]]
{'fdr': 0.42857142857142855, 'tpr': 0.7692307692307693, 'fpr': 0.28846153846153844, 'f1': 0.6557377049180327, 'shd': 16, 'npred': 35, 'ntrue': 26}
[2.591e-04 1.788e-01 2.534e+00 6.112e-01 5.363e-03 1.722e-02 1.634e-03
 1.146e-04 4.323e-01 1.558e-05 1.926e+00 1.358e-04 6.490e-01 3.174e-01
 5.269e-02 1.650e-01 1.930e-03 3.902e-02 3.268e-04 1.587e-04 2.026e+00
 2.249e-03 2.098e-01 1.570e-04 3.704e-05 1.672e-05 9.120e-05 4.945e-04
 1.286e-05 1.055e-03 5.900e-06 2.387e-05 1.909e-04 6.756e-06 1.664e-04
 1.816e-05 1.368e-04 6.424e-05 2.681e+00 1.087e-01 4.920e-03 8.812e-02
 2.156e-03 3.355e-04 1.544e+00 1.069e-05 2.764e-01 2.361e-04 7.625e-05
 1.262e-04 2.480e-01 1.120e-04 1.048e-04 1.716e-03 7.722e-06 1.004e-04
 2.480e-04 5.547e-05 9.775e-04 6.075e-05 7.819e-02 3.361e-02 3.364e-01
 6.355e-02 5.873e-01 1.249e-02 1.224e-04 9.622e-02 2.225e+00 3.035e-02
 9.716e-02 1.446e-02 9.609e-03 1.138e-02 1.083e+00 2.493e-02 8.946e-02
 5.457e-02 4.998e-03 2.525e-03 9.035e-01 1.314e-03 3.122e-01 3.730e-03
 9.631e-03 1.025e-02 1.417e-02 1.588e-02 1.492e+00 3.708e+00 8.178e-02
 6.531e-01 4.506e-01 4.525e-03 7.799e-02 2.276e-03 2.371e-02 1.524e+00
 2.231e+00 2.436e-02 8.682e-02 5.114e-03 3.553e-01 7.089e-04 1.247e+00
 1.743e-03 1.982e-01 3.603e-02 4.241e-05 1.160e-04 1.118e+00 1.141e-04
 2.546e-01 2.391e-04 1.290e-03 5.704e-05 2.469e-05 1.596e-05 2.467e+00
 6.512e-05 1.734e+00 5.287e-03 2.548e+00 7.315e-02 4.386e-01 1.476e-03
 1.189e-02 1.950e-03 5.696e-03 8.986e-01 1.164e-01 6.568e-03 2.293e-06
 1.006e-05 9.509e-01 2.877e-05 9.329e-01 8.572e-06 1.214e-03 5.277e-05
 1.123e-04 4.825e-05 4.487e-06 1.300e-06 4.746e-03 9.992e-01 2.323e+00
 1.581e-02 2.632e-01 4.536e-03 9.145e-02 3.035e-03 2.870e-03 2.222e+00
 1.885e-03 3.498e-01]
[[0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 1. 0. 0. 0.]
 [0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0. 0. 0.]
 [0. 1. 1. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 1. 0.]
 [1. 0. 1. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 0. 0.]
 [0. 1. 1. 0. 0. 0. 1. 0. 0. 1. 0. 0. 0.]]
[0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0.
 0. 0. 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0. 0.
 0. 1. 1. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 1. 0.
 1. 0. 1. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 0.
 0. 1. 1. 0. 0. 0. 1. 0. 0. 1. 0. 0.]
aucroc, aucpr (0.8576923076923076, 0.7593816559659051)
cuda
1963
cuda
Objective function 480.43 = squared loss an data 285.64 + 0.5*rho*h**2 194.315677 + alpha*h 0.000000 + L2reg 0.24 + L1reg 0.24 ; SHD = 91 ; DAG False
||w||^2 31964696773.940037
exp ma of ||w||^2 1072636895161.3567
||w|| 178786.7354529973
exp ma of ||w|| 626743.3936508566
||w||^2 98.06809478767886
exp ma of ||w||^2 6299923391.226337
||w|| 9.902933645525394
exp ma of ||w|| 4484.498398736208
||w||^2 10.39747603935223
exp ma of ||w||^2 2524282695.7128124
||w|| 3.2245117520877837
exp ma of ||w|| 1802.6439324627113
||w||^2 0.31837497281335003
exp ma of ||w||^2 908461.8862899503
||w|| 0.564247262123043
exp ma of ||w|| 1.2594429370184144
v before min max tensor([[-2.687, -2.972, -0.927,  ..., -0.185, -2.563,  9.143],
        [-4.894, -2.930, -4.822,  ..., -3.463, -2.024, 10.268],
        [-5.594,  1.285,  1.376,  ...,  7.989, -3.632, -3.957],
        ...,
        [-4.014, -4.775, -3.732,  ..., -0.964, -4.602, -3.099],
        [-2.827, -3.239, -2.845,  ...,  4.974, 15.168, -2.851],
        [-1.631, -3.061, -0.109,  ...,  2.497, 17.929, -2.511]],
       device='cuda:0')
v tensor([[1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         9.143e+00],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e+01],
        [1.000e-12, 1.285e+00, 1.376e+00,  ..., 7.989e+00, 1.000e-12,
         1.000e-12],
        ...,
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 4.974e+00, 1.000e+01,
         1.000e-12],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 2.497e+00, 1.000e+01,
         1.000e-12]], device='cuda:0')
v before min max tensor([-3.837, -2.980, -3.452, -2.014, -0.860, -3.576, -4.025,  6.042,  6.244,
        -1.411, -5.300, -3.503, -0.928, -4.436, -0.462,  0.968,  0.531, -1.448,
        -0.259, -3.171, -1.084, -1.007,  2.882,  1.123,  0.465, -4.125, -1.374,
        -5.647,  1.309,  1.159, -2.927, -4.717, -5.950, -4.108, -2.358, -0.847,
        -2.279,  9.837, -2.621, -2.605, 17.207, -3.366, -1.391, -0.440,  1.706,
        -0.042,  3.877, -4.511, -1.947,  2.136, -1.833, -2.456, -2.832, -1.766,
        -0.882,  2.987, -0.716,  1.731,  2.222, -1.287, -1.430, -0.359, -2.614,
         1.868, -3.178,  6.128, -1.823, -1.368, -4.432, 20.380,  0.366,  3.060,
        -4.357,  0.192,  5.464, -2.139,  0.864,  0.275, -3.665, -2.370, -3.019,
        -1.840, 25.289, -1.367,  0.062, -2.141, 26.273, -2.494, -2.890, -3.453,
        -6.032, -3.697,  6.342, 24.766, 13.423,  0.512, -1.523, -3.264, -2.459,
        -2.928, -0.967, 10.591, -0.120, -2.451,  6.187,  2.809,  2.051, -3.918,
         1.922,  1.120, -7.169, -0.724, -3.658, -3.075, -3.391, -2.992, -3.322,
        -5.017,  3.292, -0.402, -2.331, -3.385, -2.528, -0.153, -0.551, -2.950,
        16.602, -2.329, -5.635, -2.844], device='cuda:0')
v tensor([1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 6.042e+00, 6.244e+00, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 9.683e-01, 5.311e-01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 2.882e+00, 1.123e+00,
        4.649e-01, 1.000e-12, 1.000e-12, 1.000e-12, 1.309e+00, 1.159e+00,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 9.837e+00, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.706e+00, 1.000e-12, 3.877e+00, 1.000e-12,
        1.000e-12, 2.136e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 2.987e+00, 1.000e-12, 1.731e+00, 2.222e+00, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.868e+00, 1.000e-12, 6.128e+00,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 3.657e-01, 3.060e+00,
        1.000e-12, 1.924e-01, 5.464e+00, 1.000e-12, 8.642e-01, 2.746e-01,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12,
        6.249e-02, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 6.342e+00, 1.000e+01, 1.000e+01, 5.118e-01,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01,
        1.000e-12, 1.000e-12, 6.187e+00, 2.809e+00, 2.051e+00, 1.000e-12,
        1.922e+00, 1.120e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 3.292e+00, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12], device='cuda:0')
v before min max tensor([[[-4.460e+00],
         [-6.387e+00],
         [ 7.171e-01],
         [-3.831e+00],
         [ 2.041e+01],
         [-5.848e+00],
         [-3.207e+00],
         [-6.609e+00],
         [-2.815e+00],
         [-5.929e+00]],

        [[-2.050e+00],
         [ 3.048e+00],
         [ 5.248e+00],
         [-5.828e+00],
         [ 1.991e-03],
         [-5.224e+00],
         [-2.053e+00],
         [-2.315e+00],
         [ 9.074e+00],
         [-3.348e+00]],

        [[-4.776e+00],
         [-5.865e+00],
         [-5.381e+00],
         [-5.465e+00],
         [-7.787e+00],
         [ 2.521e+01],
         [-4.239e+00],
         [ 4.367e-01],
         [-2.434e+00],
         [ 3.394e+00]],

        [[-3.706e+00],
         [-3.351e+00],
         [-4.621e+00],
         [-2.948e+00],
         [-9.004e-01],
         [-2.749e+00],
         [-6.218e+00],
         [-1.966e+00],
         [-3.135e+00],
         [-2.797e+00]],

        [[ 3.085e+03],
         [ 4.639e+03],
         [ 3.473e+03],
         [-5.163e+00],
         [ 1.603e+01],
         [ 2.824e+03],
         [ 3.504e+03],
         [ 3.278e+03],
         [ 3.261e+03],
         [ 3.034e+03]],

        [[-5.427e+00],
         [ 7.189e+01],
         [ 9.776e-02],
         [-2.991e+00],
         [ 1.052e+02],
         [ 5.357e+01],
         [-4.495e+00],
         [-4.566e+00],
         [-6.374e+00],
         [ 6.911e+01]],

        [[-3.868e+00],
         [ 5.686e-01],
         [ 8.860e+00],
         [ 8.380e+00],
         [-4.362e+00],
         [ 6.526e+00],
         [-2.586e+00],
         [-5.762e+00],
         [-2.678e+00],
         [-5.285e+00]],

        [[-2.990e+00],
         [ 1.742e+00],
         [-2.075e+00],
         [-4.239e+00],
         [-4.237e+00],
         [-2.597e-01],
         [-2.860e+00],
         [-3.203e+00],
         [-6.511e+00],
         [-5.671e+00]],

        [[-2.070e+00],
         [-3.862e+00],
         [-2.019e+00],
         [ 2.929e+00],
         [-4.719e+00],
         [ 1.868e+01],
         [-4.597e+00],
         [-4.827e+00],
         [ 1.812e+01],
         [ 1.117e+01]],

        [[ 4.747e+02],
         [ 9.846e+02],
         [ 8.691e+02],
         [ 6.280e+02],
         [-1.944e+00],
         [-4.665e+00],
         [ 6.462e+02],
         [ 7.875e+02],
         [ 2.259e+02],
         [ 8.190e+02]],

        [[-2.190e+00],
         [-3.241e+00],
         [ 6.388e-01],
         [-2.160e+00],
         [-2.709e+00],
         [-1.214e+00],
         [-2.309e+00],
         [-4.085e+00],
         [-4.769e+00],
         [-4.607e+00]],

        [[ 1.037e+03],
         [-1.710e+00],
         [-3.278e+00],
         [ 9.139e+02],
         [ 9.572e+02],
         [-4.204e+00],
         [ 8.047e+02],
         [-1.275e+00],
         [-5.140e+00],
         [ 7.563e+02]],

        [[ 2.480e+00],
         [-5.153e+00],
         [ 1.086e+01],
         [-2.834e+00],
         [-5.315e+00],
         [-4.366e+00],
         [ 1.814e+00],
         [ 9.170e+00],
         [ 2.448e+00],
         [-3.240e+00]]], device='cuda:0')
v tensor([[[1.000e-12],
         [1.000e-12],
         [7.171e-01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [3.048e+00],
         [5.248e+00],
         [1.000e-12],
         [1.991e-03],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [9.074e+00],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [4.367e-01],
         [1.000e-12],
         [3.394e+00]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01]],

        [[1.000e-12],
         [1.000e+01],
         [9.776e-02],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01]],

        [[1.000e-12],
         [5.686e-01],
         [8.860e+00],
         [8.380e+00],
         [1.000e-12],
         [6.526e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.742e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.929e+00],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01]],

        [[1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01]],

        [[1.000e-12],
         [1.000e-12],
         [6.388e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01]],

        [[2.480e+00],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.814e+00],
         [9.170e+00],
         [2.448e+00],
         [1.000e-12]]], device='cuda:0')
v before min max tensor([[-3.395e+00],
        [ 1.959e+01],
        [-1.422e+00],
        [ 8.276e+00],
        [ 3.641e+03],
        [ 1.238e+02],
        [-5.972e+00],
        [-1.280e+00],
        [-5.419e+00],
        [ 7.267e+02],
        [-1.240e+00],
        [ 6.295e+02],
        [-4.310e+00]], device='cuda:0')
v tensor([[1.000e-12],
        [1.000e+01],
        [1.000e-12],
        [8.276e+00],
        [1.000e+01],
        [1.000e+01],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e+01],
        [1.000e-12],
        [1.000e+01],
        [1.000e-12]], device='cuda:0')
a after update for 1 param tensor([[-0.002, -0.009,  0.001,  ...,  0.001,  0.003, -0.030],
        [-0.042, -0.010,  0.010,  ...,  0.029,  0.030, -0.009],
        [ 0.039, -0.013,  0.010,  ...,  0.006,  0.015, -0.025],
        ...,
        [-0.002, -0.016,  0.017,  ...,  0.013, -0.009,  0.003],
        [ 0.017, -0.014,  0.007,  ...,  0.016,  0.014, -0.004],
        [-0.008, -0.003, -0.007,  ..., -0.036, -0.002,  0.015]],
       device='cuda:0')
s after update for 1 param tensor([[0.958, 1.406, 0.965,  ..., 1.011, 0.770, 1.812],
        [1.495, 0.901, 1.470,  ..., 1.632, 1.006, 1.592],
        [1.612, 1.189, 0.656,  ..., 1.789, 1.132, 1.136],
        ...,
        [1.154, 1.456, 1.478,  ..., 0.878, 1.304, 1.128],
        [0.903, 0.907, 0.952,  ..., 1.621, 1.645, 1.102],
        [0.755, 1.369, 2.067,  ..., 1.481, 1.690, 1.130]], device='cuda:0')
b after update for 1 param tensor([[50.529, 61.219, 50.728,  ..., 51.917, 45.311, 69.505],
        [63.146, 49.014, 62.605,  ..., 65.958, 51.798, 65.143],
        [65.553, 56.313, 41.838,  ..., 69.065, 54.929, 55.033],
        ...,
        [55.466, 62.315, 62.776,  ..., 48.391, 58.966, 54.843],
        [49.073, 49.177, 50.391,  ..., 65.745, 66.236, 54.215],
        [44.875, 60.422, 74.244,  ..., 62.836, 67.136, 54.896]],
       device='cuda:0')
clipping threshold 0.4999581691518254
a after update for 1 param tensor([ 5.815e-03, -3.101e-02, -5.082e-03, -6.843e-03, -2.252e-02, -4.874e-03,
         7.526e-03, -5.478e-03, -2.402e-03,  7.922e-03,  1.122e-02,  6.281e-03,
        -6.212e-03, -6.134e-04, -6.511e-03, -2.365e-02,  5.125e-04, -1.693e-02,
         3.505e-03,  2.829e-02, -1.286e-02, -2.691e-03,  1.308e-02,  6.804e-03,
        -1.129e-02,  1.127e-02,  8.402e-03, -3.335e-03,  1.502e-02, -6.457e-03,
         1.378e-02, -1.146e-02, -1.949e-02,  1.595e-03,  3.133e-03, -1.243e-02,
        -3.429e-04, -1.532e-02,  2.374e-02, -1.923e-02,  3.756e-03, -4.574e-02,
        -2.916e-02,  2.773e-04,  3.287e-03, -5.729e-03,  1.323e-03, -5.096e-04,
        -4.401e-02, -8.223e-03, -8.509e-03,  8.012e-03,  1.616e-02, -2.358e-03,
         9.741e-05, -3.167e-02, -1.017e-02, -1.471e-04,  1.734e-02, -5.126e-03,
        -7.266e-03, -2.157e-02,  2.829e-02, -2.106e-02,  1.783e-02, -4.809e-02,
        -8.714e-03, -5.538e-03, -1.060e-02, -9.294e-03, -1.587e-02, -3.433e-03,
         6.870e-04,  1.777e-02, -9.747e-03, -9.316e-04,  4.461e-03, -1.506e-03,
         4.537e-02,  8.626e-03, -5.435e-03, -4.276e-03, -2.476e-02, -3.644e-03,
        -5.261e-03, -4.152e-03,  5.270e-03, -1.332e-03,  1.409e-02, -1.577e-02,
        -1.991e-02, -1.738e-02, -1.177e-02,  2.613e-02,  2.371e-02, -4.568e-03,
         1.520e-02, -1.484e-03, -1.222e-02, -4.575e-02, -6.740e-03,  2.278e-02,
         9.264e-04,  5.369e-03, -3.548e-02, -2.782e-02,  1.306e-02, -3.862e-02,
        -1.843e-02, -5.609e-03, -2.629e-02,  2.922e-03, -7.397e-03, -7.635e-03,
        -6.649e-03, -3.709e-02, -4.448e-03, -2.282e-03, -1.309e-02, -1.199e-02,
         9.110e-03,  2.338e-02, -1.286e-02, -4.403e-04, -5.325e-03, -2.419e-03,
        -4.710e-03, -1.833e-03,  2.870e-02,  4.747e-03], device='cuda:0')
s after update for 1 param tensor([1.107, 1.289, 1.192, 1.175, 0.867, 1.042, 1.226, 1.450, 1.651, 1.317,
        1.489, 0.983, 1.194, 1.708, 0.958, 1.323, 1.016, 0.676, 0.870, 1.283,
        0.314, 1.086, 0.979, 0.817, 1.190, 1.632, 1.113, 1.697, 1.173, 0.785,
        0.909, 1.314, 1.658, 1.297, 0.784, 0.816, 0.759, 2.151, 0.852, 0.979,
        1.473, 2.122, 1.290, 0.154, 1.110, 0.919, 1.322, 1.378, 1.378, 0.824,
        0.617, 1.285, 0.837, 0.987, 0.722, 1.311, 0.957, 0.606, 1.920, 0.441,
        1.164, 1.327, 1.269, 1.243, 1.024, 1.265, 0.583, 1.471, 1.349, 1.719,
        0.759, 1.129, 1.250, 0.897, 1.505, 0.895, 0.321, 0.739, 1.158, 0.662,
        1.085, 1.042, 1.585, 1.441, 1.158, 1.507, 1.311, 1.199, 0.976, 1.319,
        1.716, 1.163, 0.959, 1.686, 1.639, 0.362, 1.056, 0.937, 1.205, 1.475,
        0.700, 1.382, 0.090, 0.868, 1.201, 1.525, 1.076, 1.349, 0.887, 0.912,
        1.999, 0.342, 1.199, 0.889, 0.946, 1.018, 1.080, 1.457, 1.439, 0.129,
        0.789, 1.412, 1.375, 0.099, 0.159, 0.923, 1.461, 0.816, 1.575, 0.935],
       device='cuda:0')
b after update for 1 param tensor([54.322, 58.631, 56.376, 55.978, 48.093, 52.719, 57.177, 62.179, 66.348,
        59.256, 63.008, 51.184, 56.428, 67.480, 50.548, 59.394, 52.050, 42.461,
        48.166, 58.481, 28.937, 53.815, 51.103, 46.683, 56.336, 65.967, 54.468,
        67.264, 55.923, 45.744, 49.241, 59.201, 66.499, 58.796, 45.732, 46.631,
        44.979, 75.736, 47.674, 51.104, 62.668, 75.223, 58.645, 20.292, 54.405,
        49.513, 59.377, 60.613, 60.623, 46.859, 40.554, 58.539, 47.244, 51.294,
        43.880, 59.124, 50.506, 40.184, 71.558, 34.297, 55.700, 59.487, 58.165,
        57.562, 52.249, 58.085, 39.418, 62.630, 59.967, 67.705, 44.998, 54.865,
        57.721, 48.892, 63.353, 48.849, 29.249, 44.382, 55.573, 42.017, 53.784,
        52.709, 65.013, 61.989, 55.569, 63.398, 59.130, 56.532, 51.020, 59.306,
        67.646, 55.691, 50.567, 67.040, 66.109, 31.054, 53.068, 49.985, 56.691,
        62.702, 43.205, 60.713, 15.494, 48.097, 56.578, 63.756, 53.558, 59.976,
        48.619, 49.310, 73.007, 30.184, 56.544, 48.698, 50.226, 52.110, 53.665,
        62.326, 61.944, 18.540, 45.854, 61.356, 60.541, 16.260, 20.607, 49.612,
        62.422, 46.648, 64.802, 49.929], device='cuda:0')
clipping threshold 0.4999581691518254
a after update for 1 param tensor([[[ 4.067e-02],
         [ 9.419e-02],
         [-2.999e-03],
         [ 7.105e-02],
         [ 2.136e-01],
         [ 1.331e-01],
         [ 1.391e-01],
         [ 1.195e-01],
         [ 1.436e-01],
         [ 8.432e-02]],

        [[-1.348e-01],
         [-1.111e-01],
         [-1.389e-02],
         [-1.434e-01],
         [-5.135e-03],
         [-5.814e-02],
         [-3.949e-02],
         [-9.885e-02],
         [-9.228e-02],
         [-9.946e-03]],

        [[-5.444e-02],
         [-2.336e-02],
         [-9.473e-02],
         [-5.984e-02],
         [-1.195e-02],
         [-2.783e-02],
         [-1.645e-02],
         [-7.470e-02],
         [-1.055e-01],
         [-3.014e-02]],

        [[-8.525e-03],
         [-1.737e-02],
         [-2.857e-02],
         [ 3.821e-02],
         [-6.510e-02],
         [-3.174e-02],
         [ 1.213e-02],
         [-3.358e-02],
         [-3.200e-02],
         [-1.017e-03]],

        [[-2.610e+00],
         [-1.302e+00],
         [-2.587e+00],
         [-7.708e-02],
         [-2.574e-02],
         [-2.563e+00],
         [-2.535e+00],
         [-2.582e+00],
         [-2.502e+00],
         [-2.562e+00]],

        [[ 4.582e-02],
         [ 5.661e-01],
         [-6.215e-03],
         [ 7.405e-03],
         [ 5.198e-01],
         [ 4.896e-01],
         [ 7.009e-02],
         [ 1.195e-03],
         [ 1.043e-01],
         [ 3.874e-01]],

        [[ 2.369e-02],
         [ 3.455e-03],
         [-2.070e-02],
         [ 5.822e-02],
         [ 1.347e-03],
         [ 7.938e-02],
         [ 2.075e-02],
         [-2.537e-02],
         [-1.140e-02],
         [ 6.636e-02]],

        [[-1.625e-02],
         [ 1.267e-03],
         [-3.185e-03],
         [-7.622e-03],
         [ 6.976e-04],
         [-9.848e-03],
         [ 1.444e-02],
         [ 2.187e-02],
         [ 1.740e-03],
         [ 7.620e-03]],

        [[-2.305e-03],
         [ 8.634e-03],
         [-3.395e-02],
         [ 7.063e-03],
         [ 6.060e-02],
         [ 1.707e-03],
         [-4.170e-03],
         [-2.546e-02],
         [-1.225e-03],
         [ 6.348e-03]],

        [[-1.165e+00],
         [-1.007e+00],
         [-1.306e+00],
         [-1.241e+00],
         [-1.782e-02],
         [-3.049e-01],
         [-1.313e+00],
         [-1.267e+00],
         [-1.365e-01],
         [-1.065e+00]],

        [[-2.192e-03],
         [ 1.926e-02],
         [-2.960e-02],
         [-6.204e-02],
         [ 3.184e-03],
         [ 3.991e-03],
         [-8.182e-03],
         [-6.909e-03],
         [-8.345e-03],
         [-1.321e-02]],

        [[ 1.420e+00],
         [ 4.244e-02],
         [ 6.575e-03],
         [ 1.410e+00],
         [ 1.418e+00],
         [ 8.661e-03],
         [ 1.487e+00],
         [ 9.159e-02],
         [ 5.465e-02],
         [ 1.407e+00]],

        [[ 2.660e-02],
         [ 1.941e-02],
         [ 2.624e-02],
         [-4.214e-03],
         [-5.420e-03],
         [ 3.212e-03],
         [ 2.902e-03],
         [ 2.091e-02],
         [-2.283e-02],
         [-1.136e-02]]], device='cuda:0')
s after update for 1 param tensor([[[1.332],
         [1.903],
         [0.353],
         [1.987],
         [2.212],
         [1.779],
         [1.749],
         [1.849],
         [1.760],
         [1.938]],

        [[1.801],
         [1.927],
         [1.493],
         [1.634],
         [0.516],
         [1.608],
         [1.434],
         [1.262],
         [2.208],
         [0.965]],

        [[1.975],
         [1.638],
         [1.522],
         [1.854],
         [2.218],
         [1.584],
         [1.264],
         [1.644],
         [1.660],
         [2.056]],

        [[1.381],
         [0.935],
         [1.296],
         [1.831],
         [1.423],
         [1.539],
         [1.738],
         [1.547],
         [1.497],
         [1.468]],

        [[3.032],
         [2.894],
         [3.028],
         [1.441],
         [1.918],
         [3.028],
         [3.022],
         [3.036],
         [3.014],
         [3.030]],

        [[1.900],
         [2.988],
         [1.392],
         [0.856],
         [2.935],
         [2.955],
         [1.506],
         [1.286],
         [1.974],
         [2.837]],

        [[1.204],
         [1.739],
         [2.054],
         [2.203],
         [1.228],
         [1.810],
         [1.682],
         [1.606],
         [1.405],
         [1.758]],

        [[1.282],
         [1.457],
         [1.041],
         [1.447],
         [1.181],
         [1.256],
         [0.879],
         [1.453],
         [2.087],
         [1.706]],

        [[0.580],
         [1.291],
         [1.719],
         [1.634],
         [1.581],
         [1.572],
         [1.869],
         [1.411],
         [1.543],
         [1.576]],

        [[3.007],
         [2.943],
         [3.020],
         [3.022],
         [1.550],
         [2.123],
         [3.021],
         [3.016],
         [2.577],
         [2.960]],

        [[0.859],
         [0.904],
         [1.555],
         [2.295],
         [1.305],
         [0.499],
         [0.910],
         [1.182],
         [1.329],
         [1.286]],

        [[3.021],
         [1.728],
         [1.241],
         [3.024],
         [3.023],
         [1.443],
         [3.025],
         [1.319],
         [1.579],
         [3.012]],

        [[1.538],
         [1.473],
         [1.414],
         [1.661],
         [1.598],
         [1.399],
         [1.205],
         [1.685],
         [1.334],
         [1.166]]], device='cuda:0')
b after update for 1 param tensor([[[59.605],
         [71.234],
         [30.685],
         [72.783],
         [76.794],
         [68.881],
         [68.289],
         [70.208],
         [68.497],
         [71.892]],

        [[69.289],
         [71.681],
         [63.091],
         [66.007],
         [37.101],
         [65.487],
         [61.834],
         [58.012],
         [76.731],
         [50.725]],

        [[72.574],
         [66.091],
         [63.710],
         [70.310],
         [76.896],
         [64.987],
         [58.063],
         [66.199],
         [66.528],
         [74.042]],

        [[60.682],
         [49.926],
         [58.781],
         [69.873],
         [61.594],
         [64.057],
         [68.073],
         [64.218],
         [63.177],
         [62.571]],

        [[89.918],
         [87.841],
         [89.855],
         [61.982],
         [71.507],
         [89.847],
         [89.763],
         [89.979],
         [89.646],
         [89.885]],

        [[71.185],
         [89.258],
         [60.917],
         [47.786],
         [88.457],
         [88.771],
         [63.365],
         [58.561],
         [72.543],
         [86.972]],

        [[56.668],
         [68.102],
         [73.997],
         [76.640],
         [57.231],
         [69.460],
         [66.967],
         [65.435],
         [61.206],
         [68.472]],

        [[58.455],
         [62.337],
         [52.680],
         [62.109],
         [56.108],
         [57.860],
         [48.416],
         [62.238],
         [74.594],
         [67.439]],

        [[39.312],
         [58.662],
         [67.699],
         [66.008],
         [64.917],
         [64.746],
         [70.600],
         [61.347],
         [64.132],
         [64.817]],

        [[89.535],
         [88.579],
         [89.728],
         [89.767],
         [64.296],
         [75.240],
         [89.745],
         [89.678],
         [82.897],
         [88.836]],

        [[47.866],
         [49.108],
         [64.399],
         [78.221],
         [58.990],
         [36.462],
         [49.259],
         [56.138],
         [59.532],
         [58.553]],

        [[89.747],
         [67.884],
         [57.526],
         [89.795],
         [89.780],
         [62.036],
         [89.813],
         [59.309],
         [64.890],
         [89.611]],

        [[64.048],
         [62.661],
         [61.411],
         [66.555],
         [65.272],
         [61.075],
         [56.681],
         [67.027],
         [59.649],
         [55.753]]], device='cuda:0')
clipping threshold 0.4999581691518254
a after update for 1 param tensor([[ 0.087],
        [-0.106],
        [-0.091],
        [-0.029],
        [-2.586],
        [ 0.553],
        [ 0.003],
        [-0.009],
        [ 0.017],
        [-1.256],
        [ 0.029],
        [ 1.441],
        [ 0.038]], device='cuda:0')
s after update for 1 param tensor([[1.450],
        [2.131],
        [2.049],
        [2.021],
        [3.037],
        [2.980],
        [2.196],
        [1.450],
        [1.522],
        [3.021],
        [1.673],
        [3.025],
        [1.419]], device='cuda:0')
b after update for 1 param tensor([[62.168],
        [75.385],
        [73.913],
        [73.413],
        [89.993],
        [89.140],
        [76.515],
        [62.188],
        [63.697],
        [89.750],
        [66.798],
        [89.813],
        [61.506]], device='cuda:0')
clipping threshold 0.4999581691518254
||w||^2 0.1761294144036997
exp ma of ||w||^2 603.844286664937
||w|| 0.41967775066555496
exp ma of ||w|| 0.5175764419981577
||w||^2 0.24626255887927723
exp ma of ||w||^2 0.4972205179595434
||w|| 0.49624848501459146
exp ma of ||w|| 0.6677833226224072
||w||^2 0.47999052473605436
exp ma of ||w||^2 0.6036986461081584
||w|| 0.6928134848110669
exp ma of ||w|| 0.7432501029537999
||w||^2 0.6201489259385943
exp ma of ||w||^2 0.6071712766614539
||w|| 0.7874953497885523
exp ma of ||w|| 0.7405182375905904
cuda
Objective function 13.26 = squared loss an data 10.91 + 0.5*rho*h**2 1.630291 + alpha*h 0.000000 + L2reg 0.60 + L1reg 0.12 ; SHD = 40 ; DAG False
Proportion of microbatches that were clipped  0.7664245359160613
iteration 1 in inner loop, alpha 0.0 rho 1.0 h 1.8057082361498296
iteration 1 in outer loop, alpha = 1.8057082361498296, rho = 1.0, h = 1.8057082361498296
cuda
1963
cuda
Objective function 16.52 = squared loss an data 10.91 + 0.5*rho*h**2 1.630291 + alpha*h 3.260582 + L2reg 0.60 + L1reg 0.12 ; SHD = 40 ; DAG False
||w||^2 23466243832.390247
exp ma of ||w||^2 41778319072.84617
||w|| 153186.95712230285
exp ma of ||w|| 176203.83702217264
||w||^2 3300352062.624335
exp ma of ||w||^2 7923400155.1226425
||w|| 57448.69069547482
exp ma of ||w|| 69536.07227719408
||w||^2 9134.942322891844
exp ma of ||w||^2 39665188.60749233
||w|| 95.57689220147223
exp ma of ||w|| 1292.4609422972248
||w||^2 4370.959682735909
exp ma of ||w||^2 35159973.17062833
||w|| 66.11323379427078
exp ma of ||w|| 1157.2104295208426
||w||^2 0.33804605619183836
exp ma of ||w||^2 108732.69024469669
||w|| 0.5814172823298585
exp ma of ||w|| 5.117936534278488
||w||^2 0.2327578393331896
exp ma of ||w||^2 744.4047522671573
||w|| 0.4824498308976692
exp ma of ||w|| 0.8158655964473016
||w||^2 0.3489247050824483
exp ma of ||w||^2 2.743386857480783
||w|| 0.5906984891486081
exp ma of ||w|| 0.8347104775694614
||w||^2 1.0931890653895366
exp ma of ||w||^2 0.7959108132794886
||w|| 1.0455568207369395
exp ma of ||w|| 0.8522882089103626
||w||^2 0.37776717936732
exp ma of ||w||^2 0.7462868238995779
||w|| 0.6146276753997659
exp ma of ||w|| 0.8233102413771503
||w||^2 1.7066744427300442
exp ma of ||w||^2 0.8962280051651711
||w|| 1.3063975056352657
exp ma of ||w|| 0.8938988642377544
||w||^2 0.9286845065510376
exp ma of ||w||^2 0.7278548823379948
||w|| 0.963682783155867
exp ma of ||w|| 0.813439120235541
||w||^2 1.025788155397401
exp ma of ||w||^2 0.7749131975743861
||w|| 1.012812003975763
exp ma of ||w|| 0.8455740366303159
||w||^2 0.28656592844934536
exp ma of ||w||^2 0.7702137549519296
||w|| 0.5353185298953749
exp ma of ||w|| 0.8428973730352813
||w||^2 0.6486128048128427
exp ma of ||w||^2 0.7799008879169708
||w|| 0.8053650134025209
exp ma of ||w|| 0.8407567851291532
||w||^2 1.0799668047957964
exp ma of ||w||^2 0.9209753203369466
||w|| 1.0392145133685329
exp ma of ||w|| 0.9128554758879336
||w||^2 0.42170877943160157
exp ma of ||w||^2 0.8259500632960481
||w|| 0.6493910835787643
exp ma of ||w|| 0.8681511313007861
cuda
Objective function 11.98 = squared loss an data 8.50 + 0.5*rho*h**2 0.564701 + alpha*h 1.918986 + L2reg 0.88 + L1reg 0.11 ; SHD = 34 ; DAG False
Proportion of microbatches that were clipped  0.7673283436381386
iteration 1 in inner loop, alpha 1.8057082361498296 rho 1.0 h 1.0627331893798058
1963
cuda
Objective function 17.06 = squared loss an data 8.50 + 0.5*rho*h**2 5.647009 + alpha*h 1.918986 + L2reg 0.88 + L1reg 0.11 ; SHD = 34 ; DAG False
||w||^2 92047405682.39111
exp ma of ||w||^2 20496877536.70862
||w|| 303393.15365115134
exp ma of ||w|| 47081.5500014994
||w||^2 268178453752.3269
exp ma of ||w||^2 62027628479.02725
||w|| 517859.4922875576
exp ma of ||w|| 125097.2118760769
||w||^2 0.6956422182252212
exp ma of ||w||^2 10771.907979367495
||w|| 0.8340516879817589
exp ma of ||w|| 1.4129996806725889
||w||^2 0.4689601693815673
exp ma of ||w||^2 1.2599600295673787
||w|| 0.6848066656959227
exp ma of ||w|| 1.0449596460295005
||w||^2 0.6745538430095088
exp ma of ||w||^2 1.2241100713563156
||w|| 0.8213122688779882
exp ma of ||w|| 1.0485829071384623
||w||^2 1.0256931929789903
exp ma of ||w||^2 1.2287848575940528
||w|| 1.0127651223156287
exp ma of ||w|| 1.0536072738598794
||w||^2 0.6518129630373083
exp ma of ||w||^2 1.2249525287729428
||w|| 0.8073493438638
exp ma of ||w|| 1.0611021319449607
||w||^2 0.9553979730308026
exp ma of ||w||^2 1.1263004436716308
||w|| 0.9774446137919032
exp ma of ||w|| 1.022618643499575
||w||^2 0.4640787982112522
exp ma of ||w||^2 1.307953128420467
||w|| 0.6812332920602546
exp ma of ||w|| 1.0945062742603122
v before min max tensor([[-16.084,  -9.015,   4.416,  ..., -14.805, -18.185,  16.425],
        [  1.444,  46.998, -16.952,  ..., -10.467, -22.122,  -8.643],
        [-16.485, -15.766,  -2.451,  ..., -20.760, -10.711,  -9.622],
        ...,
        [  5.830,  13.491,  -6.608,  ..., -13.313,  40.969,   1.893],
        [  0.205, -18.024, -13.559,  ..., -18.121,  21.036,   1.911],
        [ -4.535,  -7.542, -12.882,  ...,   4.608,  -6.227,  20.733]],
       device='cuda:0')
v tensor([[1.000e-12, 1.000e-12, 4.416e+00,  ..., 1.000e-12, 1.000e-12,
         1.000e+01],
        [1.444e+00, 1.000e+01, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        ...,
        [5.830e+00, 1.000e+01, 1.000e-12,  ..., 1.000e-12, 1.000e+01,
         1.893e+00],
        [2.053e-01, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e+01,
         1.911e+00],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 4.608e+00, 1.000e-12,
         1.000e+01]], device='cuda:0')
v before min max tensor([ 2.607e+01, -1.447e+01, -4.756e+00, -1.281e+01,  1.218e+01, -1.312e+01,
        -2.001e+01, -7.098e+00, -1.507e+01,  3.371e+01, -2.292e+00, -2.179e+01,
         2.821e+01, -6.077e+00,  1.132e+02, -6.103e+00,  8.380e+00,  5.596e+01,
        -8.879e+00, -2.011e+01,  1.518e+01,  2.497e+01, -1.519e+01,  4.305e+00,
        -1.789e+01, -1.641e+01, -6.947e+00, -1.710e+01, -1.919e+01, -1.095e+01,
        -1.070e+01,  5.258e+01, -1.144e+01, -2.076e+01, -1.208e+01, -2.197e+00,
         3.851e+01, -1.860e+01, -1.675e+01, -5.911e-02, -1.304e+01, -7.201e+00,
        -1.621e+01, -6.086e+00,  3.365e+01,  7.728e+00, -1.506e+01, -9.573e+00,
         2.145e+01,  1.057e+01, -9.300e+00, -2.228e+01, -1.736e+01, -8.421e+00,
         3.273e+01,  4.026e+01, -7.307e+00, -1.757e+01, -3.303e+00, -1.773e+01,
         2.309e+01, -1.517e+01, -1.214e+01,  8.342e+00, -1.507e+01, -1.361e+01,
        -1.369e+01, -2.298e+01, -1.309e+01, -1.476e+01, -5.836e+00, -1.534e+01,
        -2.069e+01, -1.502e+01, -1.463e+01, -6.024e+00, -3.272e+00, -1.099e+01,
        -9.629e+00, -4.836e+00, -1.275e+01, -8.259e+00, -2.405e+01,  5.515e+01,
         1.393e+01,  1.599e+00,  1.409e+01, -1.121e+01, -5.553e+00, -1.221e+01,
        -5.223e-01, -2.136e+01, -1.220e+01, -6.159e+00, -8.422e+00, -2.365e+01,
         9.803e+01, -7.400e+00, -1.849e+01, -9.394e+00, -2.092e+01, -1.412e+01,
        -1.449e+01,  1.330e+00, -9.037e+00, -1.910e+01,  4.740e-01,  2.129e+01,
        -1.206e+01,  3.548e+01,  4.455e+00, -1.406e+01, -2.171e+01,  1.120e+01,
        -2.372e+01, -1.715e+01, -1.445e+01, -1.274e+01,  6.033e+01, -1.506e+01,
        -1.208e+01, -4.577e+00, -1.456e+01,  7.753e+01, -2.104e+01,  1.236e+01,
        -1.317e+01, -9.957e+00, -1.552e+01, -1.865e+01], device='cuda:0')
v tensor([1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e+01, 1.000e-12, 8.380e+00, 1.000e+01,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e+01, 1.000e-12, 4.305e+00,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e+01, 7.728e+00, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e-12, 8.342e+00, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01,
        1.000e+01, 1.599e+00, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.330e+00, 1.000e-12, 1.000e-12, 4.740e-01, 1.000e+01,
        1.000e-12, 1.000e+01, 4.455e+00, 1.000e-12, 1.000e-12, 1.000e+01,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e+01,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12], device='cuda:0')
v before min max tensor([[[-17.903],
         [-16.170],
         [-16.319],
         [ 50.668],
         [-11.365],
         [ 40.134],
         [-16.319],
         [-14.421],
         [-20.859],
         [-17.847]],

        [[-15.077],
         [ -4.016],
         [-12.318],
         [ -6.602],
         [-15.711],
         [  8.102],
         [ 11.822],
         [-11.571],
         [-10.315],
         [  5.800]],

        [[-19.103],
         [-19.735],
         [ 24.971],
         [-17.055],
         [-11.231],
         [ -1.667],
         [-10.089],
         [ -9.849],
         [ 10.071],
         [ 12.791]],

        [[-14.247],
         [  8.187],
         [ -5.745],
         [-17.656],
         [  8.572],
         [-14.874],
         [-15.745],
         [-12.065],
         [-13.745],
         [ -4.997]],

        [[-20.843],
         [ 14.823],
         [ -0.687],
         [ -9.532],
         [ -5.476],
         [  6.649],
         [-14.882],
         [-16.476],
         [-14.613],
         [ -2.303]],

        [[-18.134],
         [  3.515],
         [-15.472],
         [ -5.738],
         [-18.853],
         [-11.793],
         [ 13.403],
         [ -9.179],
         [ 41.783],
         [ -6.202]],

        [[ 19.689],
         [ -1.655],
         [-18.081],
         [-15.456],
         [-13.656],
         [ 13.890],
         [-10.807],
         [-15.785],
         [ 13.051],
         [-12.920]],

        [[ 87.135],
         [-18.721],
         [-17.091],
         [-19.772],
         [ 18.737],
         [ -8.252],
         [ -0.926],
         [-18.987],
         [ -8.446],
         [-14.639]],

        [[-11.754],
         [172.914],
         [  3.204],
         [ 37.271],
         [ -7.856],
         [-17.174],
         [-10.990],
         [-10.969],
         [ 24.737],
         [-14.437]],

        [[-10.922],
         [ 23.501],
         [ 40.481],
         [-13.103],
         [ -5.354],
         [-22.231],
         [-14.178],
         [ 15.400],
         [ 41.403],
         [-15.553]],

        [[-17.461],
         [ -5.342],
         [-15.864],
         [-17.140],
         [  6.487],
         [ -6.739],
         [  2.502],
         [ 34.381],
         [ -8.473],
         [-16.198]],

        [[-22.476],
         [-14.338],
         [ -4.810],
         [-20.809],
         [-12.859],
         [ 76.418],
         [-13.025],
         [  8.749],
         [-16.971],
         [ -8.147]],

        [[-18.471],
         [ -5.397],
         [ 37.469],
         [-15.024],
         [  3.398],
         [-15.389],
         [ -8.372],
         [ -6.634],
         [-10.518],
         [ -6.164]]], device='cuda:0')
v tensor([[[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [8.102e+00],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [5.800e+00]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01]],

        [[1.000e-12],
         [8.187e+00],
         [1.000e-12],
         [1.000e-12],
         [8.572e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [6.649e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [3.515e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12]],

        [[1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12]],

        [[1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e+01],
         [3.204e+00],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [6.487e+00],
         [1.000e-12],
         [2.502e+00],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [8.749e+00],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [3.398e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]]], device='cuda:0')
v before min max tensor([[-15.629],
        [-12.820],
        [-13.519],
        [  2.568],
        [ -8.128],
        [-15.163],
        [-11.850],
        [ 13.535],
        [ -4.949],
        [-18.812],
        [-16.949],
        [ -4.827],
        [ -9.293]], device='cuda:0')
v tensor([[1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [2.568e+00],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e+01],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12]], device='cuda:0')
a after update for 1 param tensor([[ 0.006, -0.011,  0.034,  ...,  0.024, -0.003, -0.090],
        [-0.006, -0.004, -0.051,  ..., -0.010, -0.093, -0.029],
        [ 0.003, -0.036,  0.013,  ...,  0.014, -0.014,  0.002],
        ...,
        [-0.043,  0.007,  0.027,  ..., -0.023,  0.040, -0.028],
        [-0.000,  0.003,  0.023,  ...,  0.005,  0.029,  0.016],
        [ 0.013, -0.001, -0.012,  ...,  0.037,  0.061, -0.018]],
       device='cuda:0')
s after update for 1 param tensor([[1.435, 1.581, 1.314,  ..., 1.277, 2.117, 2.039],
        [0.908, 1.893, 1.952,  ..., 1.010, 1.880, 1.629],
        [1.468, 1.332, 1.179,  ..., 1.877, 1.994, 1.157],
        ...,
        [1.542, 1.937, 1.289,  ..., 1.301, 1.882, 2.026],
        [1.447, 1.806, 2.131,  ..., 1.538, 1.978, 1.612],
        [0.979, 0.755, 1.543,  ..., 1.734, 0.757, 1.713]], device='cuda:0')
b after update for 1 param tensor([[67.843, 71.221, 64.937,  ..., 64.001, 82.414, 80.887],
        [53.980, 77.923, 79.135,  ..., 56.921, 77.662, 72.295],
        [68.640, 65.378, 61.510,  ..., 77.593, 79.984, 60.939],
        ...,
        [70.337, 78.837, 64.302,  ..., 64.596, 77.705, 80.632],
        [68.141, 76.128, 82.678,  ..., 70.237, 79.662, 71.913],
        [56.040, 49.209, 70.372,  ..., 74.587, 49.290, 74.125]],
       device='cuda:0')
clipping threshold 0.8323420469435983
a after update for 1 param tensor([-0.003, -0.032,  0.012, -0.025,  0.014, -0.062,  0.003,  0.016,  0.071,
         0.025,  0.003,  0.003,  0.088, -0.015,  0.007, -0.011,  0.004, -0.059,
         0.030, -0.020,  0.006, -0.013, -0.021, -0.067,  0.114, -0.019, -0.084,
         0.040,  0.089,  0.017, -0.063, -0.021, -0.016, -0.016, -0.004, -0.059,
        -0.056,  0.053, -0.024, -0.045,  0.025,  0.004, -0.049, -0.002,  0.043,
        -0.072,  0.061,  0.009, -0.003, -0.001,  0.014, -0.019, -0.003, -0.008,
         0.011,  0.027,  0.079, -0.055, -0.004, -0.047, -0.032,  0.016, -0.044,
        -0.062,  0.046, -0.031, -0.022,  0.057, -0.003, -0.092,  0.074, -0.069,
         0.034,  0.037, -0.040, -0.033, -0.026,  0.036, -0.022,  0.044,  0.048,
        -0.036,  0.026, -0.005,  0.029,  0.006,  0.046,  0.063,  0.016,  0.040,
         0.010,  0.057, -0.050, -0.030, -0.016,  0.057,  0.026, -0.032,  0.033,
        -0.039, -0.053,  0.009, -0.065,  0.012, -0.055, -0.021, -0.017,  0.016,
         0.010,  0.082, -0.067,  0.016,  0.028,  0.031,  0.062, -0.029,  0.047,
        -0.080, -0.031, -0.102,  0.048, -0.005, -0.025, -0.003,  0.062, -0.014,
         0.082, -0.006, -0.025, -0.019], device='cuda:0')
s after update for 1 param tensor([1.470, 1.714, 1.449, 1.274, 1.799, 1.368, 1.727, 0.904, 1.297, 2.577,
        0.885, 1.871, 1.815, 2.250, 1.511, 0.892, 2.077, 1.769, 1.288, 2.197,
        1.870, 1.438, 1.367, 1.953, 1.511, 1.706, 1.397, 1.559, 1.819, 1.164,
        1.026, 2.025, 1.354, 1.757, 1.414, 0.711, 1.803, 1.593, 1.422, 1.231,
        1.167, 1.810, 1.720, 0.956, 1.498, 1.840, 1.594, 0.897, 1.938, 1.777,
        1.473, 1.888, 1.649, 0.931, 1.560, 1.671, 1.106, 1.523, 1.010, 1.549,
        1.582, 1.313, 1.458, 2.028, 1.512, 1.208, 1.516, 1.968, 1.109, 1.292,
        1.442, 1.721, 1.885, 1.389, 1.671, 1.455, 1.661, 1.319, 1.372, 1.639,
        1.197, 0.746, 2.035, 2.090, 1.853, 1.468, 1.644, 0.950, 1.026, 1.738,
        1.135, 1.818, 1.434, 1.367, 1.091, 2.001, 1.532, 1.853, 1.692, 1.589,
        1.860, 1.823, 1.703, 1.695, 1.318, 1.733, 1.782, 1.366, 1.405, 1.432,
        1.820, 1.201, 1.844, 2.192, 2.185, 1.453, 1.251, 1.713, 2.128, 1.319,
        1.431, 1.279, 1.375, 2.127, 2.035, 1.528, 1.112, 1.634, 1.539, 1.705],
       device='cuda:0')
b after update for 1 param tensor([68.670, 74.154, 68.179, 63.939, 75.969, 66.262, 74.436, 53.858, 64.517,
        90.929, 53.276, 77.481, 76.315, 84.973, 69.628, 53.498, 81.636, 75.340,
        64.281, 83.965, 77.451, 67.928, 66.223, 79.159, 69.623, 73.986, 66.951,
        70.730, 76.400, 61.117, 57.366, 80.594, 65.906, 75.077, 67.355, 47.758,
        76.048, 71.502, 67.535, 62.857, 61.194, 76.211, 74.287, 55.382, 69.317,
        76.835, 71.511, 53.659, 78.862, 75.502, 68.748, 77.832, 72.741, 54.641,
        70.741, 73.227, 59.570, 69.899, 56.920, 70.496, 71.239, 64.902, 68.402,
        80.662, 69.657, 62.267, 69.732, 79.459, 59.648, 64.375, 68.009, 74.305,
        77.761, 66.746, 73.229, 68.324, 73.005, 65.046, 66.338, 72.516, 61.964,
        48.933, 80.794, 81.887, 77.113, 68.619, 72.635, 55.200, 57.361, 74.667,
        60.343, 76.372, 67.836, 66.220, 59.160, 80.126, 70.110, 77.099, 73.684,
        71.395, 77.249, 76.480, 73.917, 73.748, 65.035, 74.572, 75.621, 66.194,
        67.143, 67.783, 76.414, 62.067, 76.912, 83.861, 83.728, 68.269, 63.358,
        74.143, 82.627, 65.041, 67.758, 64.051, 66.417, 82.615, 80.795, 70.016,
        59.739, 72.409, 70.273, 73.953], device='cuda:0')
clipping threshold 0.8323420469435983
a after update for 1 param tensor([[[-0.048],
         [-0.033],
         [-0.070],
         [ 0.056],
         [ 0.032],
         [ 0.005],
         [ 0.021],
         [ 0.002],
         [-0.020],
         [-0.044]],

        [[-0.079],
         [ 0.023],
         [-0.024],
         [-0.113],
         [ 0.098],
         [-0.013],
         [ 0.070],
         [ 0.005],
         [-0.035],
         [ 0.049]],

        [[-0.019],
         [ 0.022],
         [-0.039],
         [-0.091],
         [ 0.033],
         [ 0.026],
         [ 0.109],
         [-0.024],
         [ 0.020],
         [ 0.009]],

        [[-0.009],
         [-0.042],
         [ 0.019],
         [ 0.092],
         [-0.102],
         [-0.011],
         [-0.023],
         [-0.048],
         [-0.032],
         [-0.037]],

        [[-0.101],
         [ 0.053],
         [-0.035],
         [-0.095],
         [-0.025],
         [ 0.013],
         [ 0.011],
         [ 0.018],
         [-0.081],
         [-0.020]],

        [[-0.014],
         [ 0.062],
         [-0.064],
         [-0.013],
         [ 0.004],
         [ 0.032],
         [ 0.047],
         [ 0.009],
         [-0.059],
         [ 0.026]],

        [[-0.032],
         [ 0.032],
         [ 0.060],
         [ 0.053],
         [-0.058],
         [ 0.025],
         [ 0.037],
         [ 0.063],
         [-0.033],
         [ 0.002]],

        [[ 0.061],
         [-0.053],
         [-0.020],
         [ 0.005],
         [ 0.048],
         [-0.011],
         [-0.020],
         [-0.019],
         [ 0.037],
         [-0.011]],

        [[ 0.063],
         [ 0.019],
         [-0.056],
         [ 0.029],
         [ 0.021],
         [ 0.070],
         [ 0.171],
         [ 0.000],
         [ 0.028],
         [-0.087]],

        [[-0.069],
         [-0.033],
         [-0.070],
         [ 0.011],
         [ 0.083],
         [-0.022],
         [-0.039],
         [-0.017],
         [ 0.005],
         [ 0.005]],

        [[-0.128],
         [ 0.027],
         [ 0.066],
         [ 0.020],
         [-0.027],
         [-0.017],
         [ 0.083],
         [ 0.059],
         [ 0.060],
         [-0.014]],

        [[-0.040],
         [ 0.103],
         [ 0.050],
         [ 0.011],
         [-0.019],
         [ 0.053],
         [-0.061],
         [ 0.053],
         [-0.021],
         [-0.024]],

        [[-0.028],
         [-0.050],
         [-0.005],
         [ 0.039],
         [ 0.052],
         [-0.106],
         [-0.026],
         [-0.026],
         [ 0.078],
         [-0.031]]], device='cuda:0')
s after update for 1 param tensor([[[1.563],
         [1.791],
         [1.379],
         [1.669],
         [1.870],
         [1.993],
         [1.380],
         [1.239],
         [1.892],
         [1.508]],

        [[1.454],
         [1.706],
         [1.416],
         [1.895],
         [1.402],
         [1.992],
         [2.182],
         [1.463],
         [1.305],
         [1.898]],

        [[1.647],
         [1.762],
         [2.086],
         [2.031],
         [1.455],
         [1.474],
         [1.072],
         [1.485],
         [1.530],
         [1.841]],

        [[1.356],
         [1.830],
         [1.501],
         [1.501],
         [1.894],
         [1.536],
         [1.453],
         [1.457],
         [1.243],
         [1.388]],

        [[1.780],
         [2.024],
         [1.759],
         [1.675],
         [1.315],
         [1.936],
         [1.569],
         [1.855],
         [1.586],
         [1.573]],

        [[2.006],
         [1.640],
         [1.727],
         [1.034],
         [1.722],
         [1.291],
         [2.153],
         [1.486],
         [1.736],
         [1.164]],

        [[1.349],
         [1.576],
         [1.956],
         [1.768],
         [1.244],
         [1.650],
         [1.605],
         [1.356],
         [2.035],
         [1.145]],

        [[2.243],
         [1.618],
         [1.499],
         [1.790],
         [1.826],
         [1.290],
         [1.731],
         [1.811],
         [1.618],
         [1.564]],

        [[1.178],
         [1.781],
         [1.764],
         [1.670],
         [1.615],
         [1.585],
         [1.476],
         [1.095],
         [2.123],
         [1.571]],

        [[1.728],
         [1.766],
         [1.951],
         [1.442],
         [1.108],
         [1.960],
         [1.198],
         [1.685],
         [2.017],
         [1.331]],

        [[1.986],
         [1.687],
         [2.037],
         [1.452],
         [1.802],
         [1.966],
         [1.760],
         [1.857],
         [0.884],
         [1.489]],

        [[1.910],
         [1.471],
         [1.690],
         [1.781],
         [1.165],
         [2.301],
         [1.623],
         [1.688],
         [1.483],
         [0.820]],

        [[1.760],
         [1.452],
         [1.889],
         [1.398],
         [1.143],
         [1.484],
         [1.519],
         [0.643],
         [1.253],
         [1.351]]], device='cuda:0')
b after update for 1 param tensor([[[70.814],
         [75.811],
         [66.519],
         [73.171],
         [77.458],
         [79.973],
         [66.545],
         [63.039],
         [77.919],
         [69.552]],

        [[68.306],
         [73.994],
         [67.408],
         [77.983],
         [67.070],
         [79.940],
         [83.679],
         [68.503],
         [64.708],
         [78.045]],

        [[72.688],
         [75.186],
         [81.813],
         [80.718],
         [68.324],
         [68.767],
         [58.660],
         [69.017],
         [70.058],
         [76.847]],

        [[65.961],
         [76.619],
         [69.390],
         [69.390],
         [77.950],
         [70.199],
         [68.273],
         [68.372],
         [63.163],
         [66.736]],

        [[75.580],
         [80.591],
         [75.123],
         [73.313],
         [64.944],
         [78.813],
         [70.945],
         [77.155],
         [71.323],
         [71.032]],

        [[80.226],
         [72.543],
         [74.441],
         [57.593],
         [74.330],
         [64.362],
         [83.104],
         [69.044],
         [74.628],
         [61.122]],

        [[65.778],
         [71.101],
         [79.209],
         [75.322],
         [63.168],
         [72.760],
         [71.770],
         [65.951],
         [80.805],
         [60.611]],

        [[84.841],
         [72.055],
         [69.343],
         [75.789],
         [76.541],
         [64.337],
         [74.534],
         [76.223],
         [72.051],
         [70.846]],

        [[61.484],
         [75.588],
         [75.237],
         [73.201],
         [71.980],
         [71.321],
         [68.820],
         [59.260],
         [82.526],
         [70.990]],

        [[74.454],
         [75.268],
         [79.119],
         [68.025],
         [59.626],
         [79.293],
         [61.987],
         [73.518],
         [80.454],
         [65.353]],

        [[79.823],
         [73.560],
         [80.837],
         [68.265],
         [76.041],
         [79.413],
         [75.136],
         [77.186],
         [53.262],
         [69.120]],

        [[78.274],
         [68.706],
         [73.635],
         [75.599],
         [61.127],
         [85.919],
         [72.171],
         [73.595],
         [68.978],
         [51.281]],

        [[75.139],
         [68.265],
         [77.842],
         [66.978],
         [60.562],
         [69.005],
         [69.806],
         [45.405],
         [63.407],
         [65.843]]], device='cuda:0')
clipping threshold 0.8323420469435983
a after update for 1 param tensor([[-0.029],
        [ 0.019],
        [ 0.095],
        [-0.002],
        [-0.036],
        [-0.118],
        [-0.014],
        [-0.041],
        [-0.005],
        [ 0.055],
        [-0.054],
        [ 0.079],
        [-0.001]], device='cuda:0')
s after update for 1 param tensor([[1.444],
        [1.083],
        [1.950],
        [1.308],
        [1.635],
        [1.515],
        [1.168],
        [1.706],
        [1.955],
        [1.644],
        [1.484],
        [1.583],
        [1.882]], device='cuda:0')
b after update for 1 param tensor([[68.068],
        [58.944],
        [79.094],
        [64.792],
        [72.429],
        [69.714],
        [61.221],
        [73.978],
        [79.204],
        [72.627],
        [68.993],
        [71.277],
        [77.701]], device='cuda:0')
clipping threshold 0.8323420469435983
||w||^2 0.7341706562505024
exp ma of ||w||^2 1.2066167244358592
||w|| 0.8568375903579991
exp ma of ||w|| 1.052264611982405
||w||^2 1.923186203585716
exp ma of ||w||^2 1.288268173589816
||w|| 1.3867898916511168
exp ma of ||w|| 1.0815088725461834
||w||^2 0.6229348848284985
exp ma of ||w||^2 1.2754394485909073
||w|| 0.7892622408480583
exp ma of ||w|| 1.0758289784497292
cuda
Objective function 13.12 = squared loss an data 9.75 + 0.5*rho*h**2 1.283912 + alpha*h 0.915019 + L2reg 1.07 + L1reg 0.11 ; SHD = 40 ; DAG False
Proportion of microbatches that were clipped  0.7724021538214257
iteration 2 in inner loop, alpha 1.8057082361498296 rho 10.0 h 0.5067370758111576
1963
cuda
Objective function 24.68 = squared loss an data 9.75 + 0.5*rho*h**2 12.839123 + alpha*h 0.915019 + L2reg 1.07 + L1reg 0.11 ; SHD = 40 ; DAG False
||w||^2 130.71081346650038
exp ma of ||w||^2 18098562.23069558
||w|| 11.432882990151713
exp ma of ||w|| 340.67932298353264
||w||^2 3.959842673935607
exp ma of ||w||^2 2003342.5171104115
||w|| 1.9899353441596053
exp ma of ||w|| 40.79342639516415
||w||^2 0.737932119118092
exp ma of ||w||^2 634.8197267515174
||w|| 0.8590297545010254
exp ma of ||w|| 1.3957380208693824
||w||^2 3.4855049956967976
exp ma of ||w||^2 1.8700050434295294
||w|| 1.8669507212823797
exp ma of ||w|| 1.2983153233588192
||w||^2 0.3311970031341671
exp ma of ||w||^2 1.851740023324027
||w|| 0.5754971790844566
exp ma of ||w|| 1.2926494810254998
||w||^2 0.7078413184594056
exp ma of ||w||^2 1.789912155588149
||w|| 0.8413330603627825
exp ma of ||w|| 1.2854751506069455
||w||^2 1.8698714193968975
exp ma of ||w||^2 1.867300508480127
||w|| 1.3674324185848812
exp ma of ||w|| 1.3128322117414755
||w||^2 2.5119193902870536
exp ma of ||w||^2 1.983343008900096
||w|| 1.584903590218362
exp ma of ||w|| 1.343693523170624
||w||^2 2.2852082295473792
exp ma of ||w||^2 1.9709416729365907
||w|| 1.511690520426512
exp ma of ||w|| 1.3377982428203576
||w||^2 2.4726294448325925
exp ma of ||w||^2 1.6660192413848853
||w|| 1.5724596798750017
exp ma of ||w|| 1.2396189225850032
||w||^2 1.7390979556305701
exp ma of ||w||^2 1.836206294189681
||w|| 1.3187486324658577
exp ma of ||w|| 1.2826241504075835
cuda
Objective function 15.55 = squared loss an data 12.72 + 0.5*rho*h**2 1.284603 + alpha*h 0.289432 + L2reg 1.15 + L1reg 0.11 ; SHD = 30 ; DAG True
Proportion of microbatches that were clipped  0.7719412194527888
iteration 3 in inner loop, alpha 1.8057082361498296 rho 100.0 h 0.1602874513062833
iteration 2 in outer loop, alpha = 17.83445336677816, rho = 100.0, h = 0.1602874513062833
cuda
1963
cuda
Objective function 18.12 = squared loss an data 12.72 + 0.5*rho*h**2 1.284603 + alpha*h 2.858639 + L2reg 1.15 + L1reg 0.11 ; SHD = 30 ; DAG True
||w||^2 91975852956.97769
exp ma of ||w||^2 233471586100.8842
||w|| 303275.20992817346
exp ma of ||w|| 387944.40868292877
||w||^2 30381051397.301304
exp ma of ||w||^2 186775773230.5367
||w|| 174301.61042658586
exp ma of ||w|| 361581.20530709065
||w||^2 5317387.264952996
exp ma of ||w||^2 829854962.5280136
||w|| 2305.946067225553
exp ma of ||w|| 10149.177530968425
||w||^2 0.6565793992668294
exp ma of ||w||^2 338.23598897811706
||w|| 0.8102958714363719
exp ma of ||w|| 1.3726764835380072
||w||^2 1.707373673235511
exp ma of ||w||^2 1.9278182908045205
||w|| 1.3066650960500594
exp ma of ||w|| 1.311776126624698
||w||^2 1.1275099315639194
exp ma of ||w||^2 1.9715406837854392
||w|| 1.0618427056602684
exp ma of ||w|| 1.3332230656444035
||w||^2 1.478142243024765
exp ma of ||w||^2 1.9563115699971805
||w|| 1.2157887328910253
exp ma of ||w|| 1.3246888051900005
||w||^2 1.988065135546376
exp ma of ||w||^2 2.0218582938656415
||w|| 1.4099876366643702
exp ma of ||w|| 1.3350818172208887
||w||^2 0.2573324073522713
exp ma of ||w||^2 2.040115571583869
||w|| 0.5072794174340916
exp ma of ||w|| 1.3396250397362413
||w||^2 0.974452876279304
exp ma of ||w||^2 1.795007189233072
||w|| 0.9871437971639715
exp ma of ||w|| 1.2793101587328664
||w||^2 2.8334842298383376
exp ma of ||w||^2 1.8963931826748899
||w|| 1.683295645404674
exp ma of ||w|| 1.3095179364805078
||w||^2 1.851589228918181
exp ma of ||w||^2 1.8365852771600406
||w|| 1.3607311376308624
exp ma of ||w|| 1.2964552377633658
||w||^2 2.7883933476864793
exp ma of ||w||^2 1.7667659186910425
||w|| 1.6698483008005485
exp ma of ||w|| 1.2700019493853336
||w||^2 1.313790281573774
exp ma of ||w||^2 1.8861602532289263
||w|| 1.146206910454554
exp ma of ||w|| 1.3074010294073253
||w||^2 1.3392376029636415
exp ma of ||w||^2 1.8068614144544028
||w|| 1.1572543380621398
exp ma of ||w|| 1.2828769662375763
||w||^2 0.7929134295878629
exp ma of ||w||^2 1.9794953888261633
||w|| 0.8904568656526058
exp ma of ||w|| 1.3395471149392848
||w||^2 0.7055766478979676
exp ma of ||w||^2 1.8507259966462988
||w|| 0.8399860998242575
exp ma of ||w|| 1.2938824988247666
cuda
Objective function 16.33 = squared loss an data 12.91 + 0.5*rho*h**2 0.433415 + alpha*h 1.660454 + L2reg 1.21 + L1reg 0.12 ; SHD = 37 ; DAG True
Proportion of microbatches that were clipped  0.7690375891121193
iteration 1 in inner loop, alpha 17.83445336677816 rho 100.0 h 0.09310371078975166
1963
cuda
Objective function 20.23 = squared loss an data 12.91 + 0.5*rho*h**2 4.334150 + alpha*h 1.660454 + L2reg 1.21 + L1reg 0.12 ; SHD = 37 ; DAG True
||w||^2 0.8540650297150805
exp ma of ||w||^2 34868.02752955804
||w|| 0.9241563881265338
exp ma of ||w|| 1.942752404803314
||w||^2 1.098499744098933
exp ma of ||w||^2 1.793486570453764
||w|| 1.0480933851994931
exp ma of ||w|| 1.2776507836234903
||w||^2 1.9522115759424203
exp ma of ||w||^2 1.775158751432737
||w|| 1.3972156511943388
exp ma of ||w|| 1.2723120297519597
||w||^2 0.93155593520764
exp ma of ||w||^2 1.9488371874303856
||w|| 0.9651714537882065
exp ma of ||w|| 1.3253956720100315
||w||^2 4.487237942236105
exp ma of ||w||^2 1.6646632549138676
||w|| 2.1183101619536515
exp ma of ||w|| 1.2237272922497169
||w||^2 1.0502913926776771
exp ma of ||w||^2 1.5610855926642497
||w|| 1.0248372518003417
exp ma of ||w|| 1.1918410015045917
||w||^2 4.0994718012587406
exp ma of ||w||^2 1.4319065056405418
||w|| 2.024715239548204
exp ma of ||w|| 1.1429796879528995
cuda
Objective function 16.90 = squared loss an data 14.02 + 0.5*rho*h**2 0.801053 + alpha*h 0.713848 + L2reg 1.25 + L1reg 0.12 ; SHD = 32 ; DAG True
Proportion of microbatches that were clipped  0.7758168375864536
iteration 2 in inner loop, alpha 17.83445336677816 rho 1000.0 h 0.040026322121804014
iteration 3 in outer loop, alpha = 57.86077548858218, rho = 1000.0, h = 0.040026322121804014
cuda
1963
cuda
Objective function 18.50 = squared loss an data 14.02 + 0.5*rho*h**2 0.801053 + alpha*h 2.315954 + L2reg 1.25 + L1reg 0.12 ; SHD = 32 ; DAG True
||w||^2 19705054328.521248
exp ma of ||w||^2 198220921270.05573
||w|| 140374.69262128856
exp ma of ||w|| 370076.1163262959
||w||^2 1.2496484311319842
exp ma of ||w||^2 30.750180776613217
||w|| 1.117876751315629
exp ma of ||w|| 1.319647399615347
||w||^2 0.7520815915267257
exp ma of ||w||^2 7.536775302622815
||w|| 0.8672263784772265
exp ma of ||w|| 1.3104821610237394
||w||^2 0.9177527871397891
exp ma of ||w||^2 1.8160111749636636
||w|| 0.9579941477586328
exp ma of ||w|| 1.2733608626326924
||w||^2 1.8026970693975648
exp ma of ||w||^2 1.7853829799193905
||w|| 1.3426455486827358
exp ma of ||w|| 1.2782740935268164
||w||^2 0.7026191223629131
exp ma of ||w||^2 1.689798207538001
||w|| 0.8382237901437259
exp ma of ||w|| 1.2356797677118303
||w||^2 1.5339403742449564
exp ma of ||w||^2 1.6700404199403214
||w|| 1.2385234653590365
exp ma of ||w|| 1.2355907396593009
||w||^2 0.8211436857829879
exp ma of ||w||^2 1.730049976008082
||w|| 0.9061697886064112
exp ma of ||w|| 1.2587890675549878
||w||^2 1.276006709059962
exp ma of ||w||^2 1.6012652207144888
||w|| 1.1296046693688735
exp ma of ||w|| 1.2078301823725333
||w||^2 1.655002972894369
exp ma of ||w||^2 1.5606688286308308
||w|| 1.2864691884745507
exp ma of ||w|| 1.1963333153885864
||w||^2 0.9240298945836997
exp ma of ||w||^2 1.5374327202569962
||w|| 0.9612647369916882
exp ma of ||w|| 1.1893008814474302
||w||^2 0.9887114086061408
exp ma of ||w||^2 1.4582124548615147
||w|| 0.9943396847185276
exp ma of ||w|| 1.1551958560521924
cuda
Objective function 16.47 = squared loss an data 13.50 + 0.5*rho*h**2 0.255081 + alpha*h 1.306887 + L2reg 1.29 + L1reg 0.12 ; SHD = 29 ; DAG True
Proportion of microbatches that were clipped  0.77501196744854
iteration 1 in inner loop, alpha 57.86077548858218 rho 1000.0 h 0.02258675237246166
1963
cuda
Objective function 18.76 = squared loss an data 13.50 + 0.5*rho*h**2 2.550807 + alpha*h 1.306887 + L2reg 1.29 + L1reg 0.12 ; SHD = 29 ; DAG True
||w||^2 1.2947110284972123
exp ma of ||w||^2 1683.5521242120396
||w|| 1.137853693801278
exp ma of ||w|| 1.2175897138198168
||w||^2 0.8165628230741865
exp ma of ||w||^2 1.3948204687738568
||w|| 0.9036386573593377
exp ma of ||w|| 1.123850190866503
||w||^2 1.5040886515910739
exp ma of ||w||^2 1.4441152535066608
||w|| 1.226412920508861
exp ma of ||w|| 1.1462171410577107
||w||^2 0.862133217728471
exp ma of ||w||^2 1.4330936763476392
||w|| 0.9285112911152298
exp ma of ||w|| 1.1515088361095736
||w||^2 0.7907819758262339
exp ma of ||w||^2 1.290938599639349
||w|| 0.8892592286989401
exp ma of ||w|| 1.0937232301525812
||w||^2 1.1940817327175663
exp ma of ||w||^2 1.3244405245738324
||w|| 1.0927404690582143
exp ma of ||w|| 1.1088306138919692
||w||^2 1.8091563238347275
exp ma of ||w||^2 1.3056175123859328
||w|| 1.3450488183834546
exp ma of ||w|| 1.1073008837562541
||w||^2 1.498819575071444
exp ma of ||w||^2 1.353928537138266
||w|| 1.2242628700860956
exp ma of ||w|| 1.1058483078419148
||w||^2 2.4836051292649146
exp ma of ||w||^2 1.3159105093423398
||w|| 1.5759457888090296
exp ma of ||w|| 1.1064046896627227
||w||^2 1.5931330915143314
exp ma of ||w||^2 1.2521728241949726
||w|| 1.2621937614781382
exp ma of ||w|| 1.0746626044008112
||w||^2 1.9669054319841828
exp ma of ||w||^2 1.2247403443448286
||w|| 1.402464057287809
exp ma of ||w|| 1.0623788534014924
||w||^2 1.2107859168242823
exp ma of ||w||^2 1.1702867329506397
||w|| 1.1003571769313283
exp ma of ||w|| 1.0446928995964293
||w||^2 0.42677908477404825
exp ma of ||w||^2 1.0795405993770055
||w|| 0.6532833112624631
exp ma of ||w|| 1.006779821126445
cuda
Objective function 15.11 = squared loss an data 12.65 + 0.5*rho*h**2 0.442032 + alpha*h 0.544034 + L2reg 1.35 + L1reg 0.12 ; SHD = 31 ; DAG True
Proportion of microbatches that were clipped  0.7730451366815003
iteration 2 in inner loop, alpha 57.86077548858218 rho 10000.0 h 0.009402470082303438
iteration 4 in outer loop, alpha = 151.88547631161657, rho = 10000.0, h = 0.009402470082303438
cuda
1963
cuda
Objective function 15.99 = squared loss an data 12.65 + 0.5*rho*h**2 0.442032 + alpha*h 1.428099 + L2reg 1.35 + L1reg 0.12 ; SHD = 31 ; DAG True
||w||^2 52534151167.493225
exp ma of ||w||^2 2916667777151.3584
||w|| 229203.29658949765
exp ma of ||w|| 1134793.2600460534
||w||^2 1.5722876223172015
exp ma of ||w||^2 2219.2788536766056
||w|| 1.253908937011457
exp ma of ||w|| 1.1577731797661552
||w||^2 1.3750932216662946
exp ma of ||w||^2 278.3361130510729
||w|| 1.172643689134212
exp ma of ||w|| 1.1331588977851252
||w||^2 4.289278946446502
exp ma of ||w||^2 2.140228017703017
||w|| 2.0710574464380516
exp ma of ||w|| 1.133761077552986
||w||^2 1.922985682536185
exp ma of ||w||^2 1.3968510518417103
||w|| 1.3867175929280573
exp ma of ||w|| 1.1373294011681918
||w||^2 0.8695719994268027
exp ma of ||w||^2 1.3182157120524072
||w|| 0.9325084446946327
exp ma of ||w|| 1.1080130278885636
||w||^2 2.108167473463352
exp ma of ||w||^2 1.2365634482443042
||w|| 1.4519529859686753
exp ma of ||w|| 1.0701231804458964
||w||^2 0.5908615013735589
exp ma of ||w||^2 1.3853799383409393
||w|| 0.7686751598520397
exp ma of ||w|| 1.1170496412933602
||w||^2 1.2624644916721803
exp ma of ||w||^2 1.2893114720009682
||w|| 1.1235944516026146
exp ma of ||w|| 1.0955245722689557
||w||^2 1.6754543382321871
exp ma of ||w||^2 1.1989210103151782
||w|| 1.2943934248257702
exp ma of ||w|| 1.061812921217467
||w||^2 2.3420117863464744
exp ma of ||w||^2 1.296855891449814
||w|| 1.530363285741812
exp ma of ||w|| 1.096369078909836
||w||^2 1.1243164196766002
exp ma of ||w||^2 1.3057190778314278
||w|| 1.0603378799593082
exp ma of ||w|| 1.0928958760740954
cuda
Objective function 15.11 = squared loss an data 12.13 + 0.5*rho*h**2 0.281170 + alpha*h 1.138979 + L2reg 1.43 + L1reg 0.13 ; SHD = 30 ; DAG True
Proportion of microbatches that were clipped  0.7704931220336256
iteration 1 in inner loop, alpha 151.88547631161657 rho 10000.0 h 0.007498935269058649
1963
cuda
Objective function 17.64 = squared loss an data 12.13 + 0.5*rho*h**2 2.811702 + alpha*h 1.138979 + L2reg 1.43 + L1reg 0.13 ; SHD = 30 ; DAG True
||w||^2 12263562545927.562
exp ma of ||w||^2 328474644573285.06
||w|| 3501936.9705817895
exp ma of ||w|| 10870700.648168687
||w||^2 9970.021227127016
exp ma of ||w||^2 445161060713.32733
||w|| 99.84999362607398
exp ma of ||w|| 17606.838144346053
||w||^2 2.0445456658145496
exp ma of ||w||^2 40026037.53491137
||w|| 1.4298761015607435
exp ma of ||w|| 3.3616591434143808
||w||^2 3.0630523947564217
exp ma of ||w||^2 18647362.646302596
||w|| 1.7501578199569379
exp ma of ||w|| 2.369825991608481
||w||^2 2.2971941944065133
exp ma of ||w||^2 5048854.530727389
||w|| 1.5156497598081535
exp ma of ||w|| 1.7306011325426784
||w||^2 0.7308221283859911
exp ma of ||w||^2 78.72592824022239
||w|| 0.8548813533970613
exp ma of ||w|| 1.103607529123256
||w||^2 2.038863903183797
exp ma of ||w||^2 8.213959640524287
||w|| 1.427887916884164
exp ma of ||w|| 1.1202465016118608
||w||^2 1.270805192422265
exp ma of ||w||^2 2.3213726437284428
||w|| 1.1272999567205992
exp ma of ||w|| 1.120157349291843
||w||^2 1.7013656769208299
exp ma of ||w||^2 1.4288772006583361
||w|| 1.304364089095077
exp ma of ||w|| 1.1546198663436957
||w||^2 1.3023787970712077
exp ma of ||w||^2 1.4143571320769135
||w|| 1.1412181198487903
exp ma of ||w|| 1.1446615369585775
||w||^2 1.007197226259519
exp ma of ||w||^2 1.6271665227175391
||w|| 1.0035921613182912
exp ma of ||w|| 1.2138522841727446
||w||^2 0.920039292135292
exp ma of ||w||^2 1.2199529473006512
||w|| 0.9591867868852719
exp ma of ||w|| 1.065932559809031
v before min max tensor([[ 12.178, -16.266, -30.721,  ..., -18.741, -22.937,  -7.014],
        [ 75.973,  22.184,  62.917,  ..., -17.818,  38.574, -10.217],
        [  3.117, -16.885,   7.997,  ..., -19.821, -10.180,  -4.693],
        ...,
        [-14.599,  24.449, -29.719,  ..., -10.761, -15.822, -25.831],
        [-19.260,  -1.625, 384.388,  ..., -17.747,  19.560,  49.740],
        [-15.066,  16.357, 228.384,  ...,   2.140, -23.484, 140.597]],
       device='cuda:0')
v tensor([[1.000e+01, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [1.000e+01, 1.000e+01, 1.000e+01,  ..., 1.000e-12, 1.000e+01,
         1.000e-12],
        [3.117e+00, 1.000e-12, 7.997e+00,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        ...,
        [1.000e-12, 1.000e+01, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [1.000e-12, 1.000e-12, 1.000e+01,  ..., 1.000e-12, 1.000e+01,
         1.000e+01],
        [1.000e-12, 1.000e+01, 1.000e+01,  ..., 2.140e+00, 1.000e-12,
         1.000e+01]], device='cuda:0')
v before min max tensor([ 2.468e+00, -2.217e+01, -2.564e+01, -1.070e+01, -1.224e+01, -1.975e+01,
        -1.848e+01, -2.064e+01, -8.927e+00,  4.748e+01, -2.670e+01, -1.152e+01,
         1.294e+02, -1.306e+01,  1.510e+01,  4.819e-01,  8.603e+00, -1.161e+01,
        -2.721e+00,  3.014e+01, -7.527e+00, -2.150e+01,  5.555e+00, -2.002e+01,
        -2.176e+01,  7.604e+01, -3.758e+00,  2.659e+00, -1.624e+01, -1.932e+01,
         2.668e+00, -1.795e+01,  1.591e+01, -1.001e+01, -1.817e+01, -9.898e+00,
        -2.569e+01,  1.969e+01,  5.686e+01, -1.782e+01, -7.658e+00, -1.108e+01,
        -7.222e+00, -1.161e+01,  1.318e+00, -2.286e+01,  5.464e+01, -2.009e+01,
        -9.011e+00,  4.628e+00, -1.236e+01, -1.906e+01,  1.394e+01, -1.110e+01,
         5.183e+01, -1.747e+01,  1.177e+00,  1.514e+01, -2.030e+01, -2.033e+01,
         2.530e+01, -2.170e+01,  6.889e+01,  2.133e+01, -8.390e+00, -1.208e+01,
         1.351e+01, -1.710e+01, -1.714e+01,  3.882e+01, -1.135e+01, -1.306e+01,
        -1.628e+01, -1.268e+01, -1.583e+01,  1.575e+00, -8.406e+00,  2.599e+00,
         8.296e+01,  1.199e+02, -2.398e+01, -1.844e+01, -9.314e+00, -2.094e+01,
         1.936e+01, -1.121e+01, -9.296e+00, -1.507e+01, -6.025e+00, -1.507e+01,
        -1.268e+01, -6.415e+00,  4.956e+01,  4.994e+01, -1.357e+01, -1.105e+01,
        -2.195e+01, -1.343e+01,  8.138e+00, -2.888e+01, -2.050e+01,  3.324e+01,
         4.175e+01, -1.610e+01, -1.869e+01, -1.233e+01, -3.138e+00, -8.931e+00,
        -2.932e-01,  6.447e+00, -2.060e+01, -7.943e-01,  2.002e+01, -1.513e+01,
        -1.268e+01, -1.919e+01, -6.990e-02, -2.061e+01, -1.282e+01, -2.862e+01,
        -1.186e+01, -6.103e+00, -7.233e+00,  9.748e+00,  2.335e+01, -1.468e+01,
         3.400e+00,  7.282e+00, -1.027e+01, -9.048e+00], device='cuda:0')
v tensor([2.468e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e+01, 4.819e-01, 8.603e+00, 1.000e-12,
        1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 5.555e+00, 1.000e-12,
        1.000e-12, 1.000e+01, 1.000e-12, 2.659e+00, 1.000e-12, 1.000e-12,
        2.668e+00, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e+01, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.318e+00, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e-12, 4.628e+00, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e+01, 1.000e-12, 1.177e+00, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e+01, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.575e+00, 1.000e-12, 2.599e+00,
        1.000e+01, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 8.138e+00, 1.000e-12, 1.000e-12, 1.000e+01,
        1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 6.447e+00, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 9.748e+00, 1.000e+01, 1.000e-12,
        3.400e+00, 7.282e+00, 1.000e-12, 1.000e-12], device='cuda:0')
v before min max tensor([[[-2.182e+01],
         [-1.332e+01],
         [ 7.913e+01],
         [-2.517e+01],
         [ 8.815e+00],
         [-1.880e+01],
         [-1.430e+01],
         [ 3.795e+01],
         [-4.244e+00],
         [-1.736e+01]],

        [[-1.921e+01],
         [ 9.469e+00],
         [ 1.001e+02],
         [-1.174e+01],
         [-1.721e+01],
         [-1.683e+01],
         [-4.288e+00],
         [ 2.865e+01],
         [-2.632e+00],
         [-2.041e+01]],

        [[-1.010e+01],
         [ 8.871e+01],
         [-2.171e+01],
         [ 4.593e+01],
         [-1.409e+01],
         [ 1.978e+01],
         [-2.152e+00],
         [-1.628e+01],
         [ 2.068e+01],
         [ 6.246e-01]],

        [[-7.270e+00],
         [-1.254e+01],
         [-9.555e+00],
         [ 8.383e+01],
         [-1.591e+01],
         [ 8.702e+01],
         [ 3.643e+01],
         [-1.662e+01],
         [-1.931e+01],
         [ 3.373e+00]],

        [[-2.131e+01],
         [-1.472e+01],
         [-6.104e+00],
         [ 1.636e+02],
         [-1.490e+01],
         [-2.849e+00],
         [ 6.090e+00],
         [ 4.749e+00],
         [-1.115e+01],
         [-1.652e+01]],

        [[-1.944e+01],
         [-1.514e+01],
         [ 8.468e+00],
         [-9.970e-01],
         [-2.551e+01],
         [ 1.380e+01],
         [-1.817e+01],
         [ 1.408e+02],
         [-2.229e+01],
         [-9.220e+00]],

        [[-1.102e+01],
         [-1.420e+01],
         [-6.173e+00],
         [-2.471e+01],
         [-2.217e+01],
         [-1.720e+01],
         [-1.732e+01],
         [-9.442e+00],
         [-1.047e+01],
         [-1.345e+01]],

        [[-6.281e+00],
         [ 2.974e+01],
         [-1.535e+01],
         [-1.413e+01],
         [-1.882e+01],
         [-4.604e+00],
         [ 1.198e+02],
         [-5.835e+00],
         [-1.857e+01],
         [-1.989e+01]],

        [[ 8.250e+00],
         [-1.653e+01],
         [-1.498e+01],
         [-1.732e+01],
         [ 4.960e+01],
         [-2.128e+01],
         [-1.769e+01],
         [-2.313e+01],
         [-1.271e+01],
         [ 7.252e+00]],

        [[-1.585e+01],
         [-1.709e+01],
         [-1.478e+01],
         [-2.053e+01],
         [-2.169e+01],
         [ 1.020e+01],
         [-2.225e+01],
         [-2.318e+01],
         [ 1.499e+02],
         [ 4.897e+00]],

        [[-1.192e-01],
         [-1.829e+01],
         [ 4.253e+01],
         [-2.166e+00],
         [ 5.636e+00],
         [-1.387e+01],
         [-9.662e+00],
         [-2.622e+01],
         [ 1.927e+01],
         [-2.003e+01]],

        [[-1.392e+01],
         [ 4.280e+00],
         [-9.411e+00],
         [ 1.524e+01],
         [-1.287e+01],
         [ 8.329e+01],
         [ 2.759e+00],
         [-1.624e+01],
         [-2.891e+00],
         [ 2.126e+01]],

        [[ 2.893e-01],
         [-2.228e+01],
         [ 1.481e+01],
         [ 8.673e+00],
         [-1.384e+01],
         [-2.025e+01],
         [ 1.372e+01],
         [ 1.268e+00],
         [-5.139e+00],
         [ 9.926e+01]]], device='cuda:0')
v tensor([[[1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [8.815e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [9.469e+00],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [6.246e-01]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [3.373e+00]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [6.090e+00],
         [4.749e+00],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [8.468e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[8.250e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [7.252e+00]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [4.897e+00]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [5.636e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12]],

        [[1.000e-12],
         [4.280e+00],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [2.759e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01]],

        [[2.893e-01],
         [1.000e-12],
         [1.000e+01],
         [8.673e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.268e+00],
         [1.000e-12],
         [1.000e+01]]], device='cuda:0')
v before min max tensor([[ 19.640],
        [-24.504],
        [ -9.238],
        [  0.362],
        [ -8.338],
        [-13.840],
        [-18.307],
        [-18.109],
        [-19.111],
        [-25.401],
        [ -4.134],
        [ -9.295],
        [-17.877]], device='cuda:0')
v tensor([[1.000e+01],
        [1.000e-12],
        [1.000e-12],
        [3.624e-01],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12]], device='cuda:0')
a after update for 1 param tensor([[-0.004, -0.012, -0.028,  ..., -0.022, -0.003, -0.027],
        [-0.017, -0.009,  0.019,  ...,  0.002, -0.011,  0.000],
        [-0.006, -0.030,  0.030,  ..., -0.011, -0.002,  0.040],
        ...,
        [ 0.001,  0.010,  0.019,  ...,  0.024,  0.004,  0.012],
        [-0.005,  0.014,  0.012,  ..., -0.023, -0.006,  0.001],
        [ 0.010,  0.007,  0.010,  ...,  0.002,  0.000, -0.002]],
       device='cuda:0')
s after update for 1 param tensor([[1.916, 2.081, 2.680,  ..., 1.400, 1.786, 1.698],
        [2.811, 2.339, 2.926,  ..., 1.863, 2.417, 1.314],
        [1.787, 2.361, 2.614,  ..., 1.526, 1.460, 1.789],
        ...,
        [1.371, 2.127, 2.341,  ..., 1.401, 1.454, 2.004],
        [1.429, 1.749, 2.555,  ..., 1.323, 1.859, 2.198],
        [1.310, 1.925, 2.371,  ..., 1.143, 1.865, 2.162]], device='cuda:0')
b after update for 1 param tensor([[ 83.326,  86.822,  98.549,  ...,  71.216,  80.439,  78.447],
        [100.928,  92.055, 102.969,  ...,  82.167,  93.588,  68.996],
        [ 80.470,  92.481,  97.312,  ...,  74.352,  72.741,  80.515],
        ...,
        [ 70.471,  87.789,  92.091,  ...,  71.242,  72.577,  85.209],
        [ 71.944,  79.603,  96.209,  ...,  69.240,  82.079,  89.236],
        [ 68.884,  83.523,  92.676,  ...,  64.346,  82.204,  88.512]],
       device='cuda:0')
clipping threshold 0.8349546011467328
a after update for 1 param tensor([ 0.103, -0.071, -0.018,  0.008,  0.052,  0.000, -0.002,  0.008, -0.052,
        -0.025, -0.017,  0.061, -0.107,  0.103,  0.031, -0.038, -0.029,  0.016,
        -0.014,  0.019, -0.071, -0.005, -0.086,  0.041,  0.082, -0.008,  0.050,
         0.079, -0.041,  0.009,  0.025, -0.021, -0.094,  0.017,  0.030, -0.018,
         0.041, -0.026,  0.040,  0.095,  0.085, -0.012, -0.064, -0.029, -0.040,
         0.045,  0.071, -0.038,  0.006,  0.043, -0.063,  0.016,  0.049,  0.009,
        -0.145, -0.007,  0.027,  0.017, -0.043,  0.016,  0.014,  0.040, -0.010,
         0.077, -0.048,  0.046,  0.027, -0.073, -0.045, -0.000, -0.004,  0.056,
        -0.037,  0.018,  0.050,  0.051, -0.024, -0.099, -0.004,  0.046,  0.005,
        -0.010, -0.048,  0.004, -0.054,  0.027,  0.004, -0.008,  0.007,  0.012,
        -0.023,  0.116, -0.019,  0.053,  0.043, -0.105,  0.058, -0.026,  0.094,
         0.092, -0.031,  0.012,  0.019, -0.024,  0.027,  0.023,  0.068,  0.078,
         0.050, -0.007,  0.033,  0.001, -0.076, -0.040,  0.026, -0.041,  0.038,
         0.028,  0.002, -0.036,  0.013, -0.007,  0.029,  0.026, -0.027, -0.018,
         0.039,  0.015,  0.023, -0.008], device='cuda:0')
s after update for 1 param tensor([1.998, 1.932, 2.183, 1.282, 1.337, 1.470, 1.378, 1.532, 1.711, 1.643,
        2.049, 0.980, 1.955, 1.525, 1.387, 1.353, 1.623, 1.579, 1.062, 1.666,
        1.243, 1.784, 1.878, 1.668, 1.672, 2.161, 1.029, 1.139, 1.513, 2.021,
        1.596, 1.593, 1.407, 1.077, 1.431, 1.474, 2.115, 1.527, 1.732, 1.365,
        1.635, 1.171, 0.784, 1.613, 1.795, 1.716, 1.251, 1.488, 0.860, 1.423,
        1.845, 1.464, 1.882, 1.345, 1.848, 1.864, 1.875, 2.164, 1.687, 1.615,
        1.882, 1.700, 1.660, 1.596, 1.848, 1.563, 1.458, 1.672, 1.344, 1.640,
        1.509, 1.728, 1.210, 1.646, 1.271, 1.556, 1.040, 1.608, 1.725, 1.714,
        1.806, 1.524, 1.899, 1.953, 1.891, 1.464, 1.680, 1.279, 0.755, 1.199,
        1.173, 0.749, 2.151, 1.715, 1.311, 1.080, 2.044, 1.146, 1.760, 2.168,
        1.699, 1.725, 1.893, 1.500, 1.540, 1.266, 1.500, 1.068, 1.057, 1.298,
        1.589, 1.591, 1.951, 1.521, 1.510, 1.422, 1.038, 1.612, 1.337, 2.127,
        1.031, 0.764, 1.933, 2.038, 1.829, 1.687, 1.507, 1.163, 1.019, 1.528],
       device='cuda:0')
b after update for 1 param tensor([85.082, 83.669, 88.944, 68.145, 69.590, 72.974, 70.653, 74.510, 78.736,
        77.162, 86.155, 59.575, 84.173, 74.339, 70.878, 70.004, 76.675, 75.627,
        62.019, 77.693, 67.104, 80.408, 82.495, 77.751, 77.832, 88.478, 61.048,
        64.248, 74.051, 85.578, 76.032, 75.965, 71.393, 62.478, 72.004, 73.081,
        87.535, 74.372, 79.226, 70.319, 76.972, 65.148, 53.297, 76.449, 80.643,
        78.857, 67.335, 73.435, 55.812, 71.807, 81.766, 72.836, 82.576, 69.797,
        81.831, 82.187, 82.420, 88.542, 78.187, 76.486, 82.584, 78.473, 77.548,
        76.053, 81.835, 75.251, 72.670, 77.840, 69.775, 77.084, 73.931, 79.122,
        66.220, 77.236, 67.861, 75.077, 61.371, 76.341, 79.065, 78.816, 80.887,
        74.308, 82.941, 84.127, 82.776, 72.828, 78.025, 68.066, 52.304, 65.903,
        65.197, 52.089, 88.283, 78.838, 68.931, 62.542, 86.064, 64.428, 79.847,
        88.630, 78.453, 79.058, 82.820, 73.723, 74.689, 67.719, 73.732, 62.200,
        61.890, 68.568, 75.878, 75.934, 84.072, 74.240, 73.975, 71.772, 61.317,
        76.426, 69.613, 87.791, 61.123, 52.598, 83.681, 85.930, 81.408, 78.186,
        73.895, 64.917, 60.751, 74.405], device='cuda:0')
clipping threshold 0.8349546011467328
a after update for 1 param tensor([[[-0.005],
         [-0.040],
         [ 0.045],
         [-0.040],
         [ 0.017],
         [-0.062],
         [ 0.054],
         [ 0.028],
         [ 0.046],
         [-0.045]],

        [[-0.062],
         [-0.003],
         [ 0.011],
         [-0.047],
         [-0.043],
         [ 0.084],
         [ 0.075],
         [ 0.073],
         [-0.041],
         [ 0.095]],

        [[ 0.096],
         [ 0.013],
         [ 0.019],
         [-0.103],
         [-0.078],
         [-0.046],
         [ 0.070],
         [ 0.012],
         [ 0.024],
         [-0.018]],

        [[-0.032],
         [ 0.055],
         [ 0.017],
         [-0.050],
         [ 0.012],
         [ 0.038],
         [-0.043],
         [-0.105],
         [ 0.078],
         [ 0.062]],

        [[ 0.035],
         [-0.006],
         [ 0.133],
         [-0.005],
         [-0.081],
         [ 0.039],
         [-0.008],
         [ 0.059],
         [ 0.026],
         [-0.042]],

        [[-0.124],
         [ 0.037],
         [ 0.038],
         [ 0.054],
         [-0.040],
         [ 0.013],
         [ 0.008],
         [ 0.014],
         [-0.029],
         [ 0.097]],

        [[ 0.007],
         [ 0.021],
         [ 0.028],
         [ 0.116],
         [ 0.047],
         [-0.025],
         [-0.034],
         [-0.104],
         [-0.083],
         [ 0.006]],

        [[ 0.073],
         [ 0.006],
         [-0.008],
         [ 0.050],
         [-0.006],
         [-0.030],
         [-0.052],
         [-0.028],
         [ 0.035],
         [ 0.005]],

        [[ 0.028],
         [-0.098],
         [ 0.092],
         [-0.055],
         [ 0.007],
         [ 0.037],
         [-0.003],
         [-0.005],
         [ 0.132],
         [-0.058]],

        [[ 0.021],
         [ 0.143],
         [ 0.060],
         [ 0.056],
         [ 0.032],
         [-0.004],
         [-0.016],
         [-0.002],
         [ 0.079],
         [ 0.001]],

        [[-0.049],
         [ 0.032],
         [-0.011],
         [-0.016],
         [-0.055],
         [ 0.003],
         [ 0.017],
         [ 0.000],
         [-0.040],
         [-0.092]],

        [[ 0.073],
         [-0.008],
         [ 0.078],
         [ 0.078],
         [ 0.040],
         [-0.004],
         [-0.017],
         [-0.013],
         [-0.006],
         [ 0.082]],

        [[-0.048],
         [ 0.024],
         [ 0.046],
         [-0.065],
         [ 0.052],
         [ 0.088],
         [ 0.038],
         [ 0.014],
         [-0.011],
         [-0.088]]], device='cuda:0')
s after update for 1 param tensor([[[1.621],
         [1.468],
         [1.858],
         [1.891],
         [1.342],
         [1.677],
         [1.161],
         [1.305],
         [1.186],
         [1.344]],

        [[1.926],
         [1.951],
         [2.196],
         [1.787],
         [1.757],
         [1.602],
         [1.672],
         [2.301],
         [1.152],
         [1.523]],

        [[1.064],
         [1.925],
         [1.614],
         [1.720],
         [2.072],
         [2.356],
         [1.729],
         [1.252],
         [1.688],
         [2.114]],

        [[1.592],
         [1.899],
         [1.570],
         [2.140],
         [1.298],
         [1.909],
         [1.395],
         [1.233],
         [1.627],
         [1.792]],

        [[1.617],
         [1.232],
         [1.776],
         [1.782],
         [1.818],
         [1.559],
         [1.607],
         [1.788],
         [0.827],
         [1.487]],

        [[1.601],
         [1.941],
         [2.034],
         [1.370],
         [2.034],
         [2.099],
         [1.362],
         [2.037],
         [2.022],
         [1.756]],

        [[1.663],
         [1.507],
         [1.757],
         [1.878],
         [1.858],
         [1.514],
         [1.292],
         [1.748],
         [0.778],
         [1.793]],

        [[1.587],
         [2.054],
         [1.719],
         [1.659],
         [1.484],
         [0.935],
         [1.439],
         [0.860],
         [1.436],
         [1.531]],

        [[1.788],
         [1.705],
         [1.294],
         [1.341],
         [2.050],
         [2.121],
         [1.331],
         [1.806],
         [1.720],
         [2.123]],

        [[1.284],
         [1.736],
         [1.342],
         [1.694],
         [1.661],
         [1.488],
         [1.738],
         [1.764],
         [2.100],
         [1.683]],

        [[1.113],
         [1.400],
         [1.257],
         [1.517],
         [1.848],
         [1.285],
         [1.602],
         [1.943],
         [1.938],
         [2.109]],

        [[1.344],
         [2.052],
         [1.758],
         [1.896],
         [1.734],
         [1.923],
         [1.427],
         [1.411],
         [1.479],
         [1.747]],

        [[1.022],
         [1.683],
         [2.011],
         [1.906],
         [1.297],
         [1.638],
         [1.647],
         [1.427],
         [1.610],
         [2.088]]], device='cuda:0')
b after update for 1 param tensor([[[76.632],
         [72.938],
         [82.047],
         [82.773],
         [69.743],
         [77.960],
         [64.866],
         [68.761],
         [65.544],
         [69.771]],

        [[83.532],
         [84.080],
         [89.209],
         [80.466],
         [79.792],
         [76.193],
         [77.825],
         [91.300],
         [64.614],
         [74.277]],

        [[62.077],
         [83.516],
         [76.468],
         [78.938],
         [86.637],
         [92.398],
         [79.148],
         [67.343],
         [78.210],
         [87.528]],

        [[75.944],
         [82.948],
         [75.416],
         [88.048],
         [68.568],
         [83.165],
         [71.105],
         [66.836],
         [76.789],
         [80.579]],

        [[76.553],
         [66.818],
         [80.209],
         [80.342],
         [81.168],
         [75.150],
         [76.300],
         [80.498],
         [54.754],
         [73.400]],

        [[76.151],
         [83.871],
         [85.852],
         [70.454],
         [85.853],
         [87.213],
         [70.256],
         [85.903],
         [85.584],
         [79.766]],

        [[77.624],
         [73.881],
         [79.795],
         [82.486],
         [82.057],
         [74.074],
         [68.413],
         [79.592],
         [53.088],
         [80.607]],

        [[75.823],
         [86.258],
         [78.926],
         [77.520],
         [73.324],
         [58.217],
         [72.209],
         [55.811],
         [72.119],
         [74.468]],

        [[80.478],
         [78.586],
         [68.475],
         [69.710],
         [86.179],
         [87.664],
         [69.446],
         [80.886],
         [78.934],
         [87.706]],

        [[68.194],
         [79.309],
         [69.730],
         [78.345],
         [77.584],
         [73.416],
         [79.351],
         [79.937],
         [87.226],
         [78.088]],

        [[63.511],
         [71.218],
         [67.482],
         [74.147],
         [81.827],
         [68.223],
         [76.176],
         [83.907],
         [83.805],
         [87.406]],

        [[69.791],
         [86.233],
         [79.813],
         [82.885],
         [79.274],
         [83.477],
         [71.914],
         [71.501],
         [73.212],
         [79.559]],

        [[60.862],
         [78.098],
         [85.362],
         [83.095],
         [68.545],
         [77.045],
         [77.247],
         [71.910],
         [76.383],
         [86.980]]], device='cuda:0')
clipping threshold 0.8349546011467328
a after update for 1 param tensor([[ 0.037],
        [-0.049],
        [ 0.089],
        [ 0.005],
        [ 0.072],
        [-0.034],
        [-0.023],
        [ 0.087],
        [-0.015],
        [-0.050],
        [ 0.149],
        [-0.038],
        [ 0.019]], device='cuda:0')
s after update for 1 param tensor([[2.255],
        [1.819],
        [1.695],
        [0.973],
        [1.188],
        [1.330],
        [1.787],
        [1.354],
        [1.427],
        [2.176],
        [1.936],
        [1.377],
        [1.383]], device='cuda:0')
b after update for 1 param tensor([[90.381],
        [81.176],
        [78.366],
        [59.369],
        [65.612],
        [69.422],
        [80.458],
        [70.037],
        [71.907],
        [88.793],
        [83.742],
        [70.643],
        [70.777]], device='cuda:0')
clipping threshold 0.8349546011467328
||w||^2 2.140661502093843
exp ma of ||w||^2 1.3612799751937996
||w|| 1.4630999631241344
exp ma of ||w|| 1.126923167631453
cuda
Objective function 14.26 = squared loss an data 11.80 + 0.5*rho*h**2 0.423611 + alpha*h 0.442094 + L2reg 1.46 + L1reg 0.13 ; SHD = 28 ; DAG True
Proportion of microbatches that were clipped  0.7754169339320077
iteration 2 in inner loop, alpha 151.88547631161657 rho 100000.0 h 0.0029107066653750735
iteration 5 in outer loop, alpha = 3062.59214168669, rho = 1000000.0, h = 0.0029107066653750735
Threshold 0.3
[[0.005 0.588 0.646 1.546 0.928 0.39  0.865 0.101 0.28  1.097 0.525 0.298
  0.083]
 [0.007 0.003 0.076 0.027 0.072 0.038 0.478 0.009 0.004 0.721 0.041 0.037
  0.005]
 [0.002 0.085 0.004 0.003 0.137 0.02  1.519 0.003 0.005 0.652 0.003 0.021
  0.003]
 [0.003 0.323 1.424 0.006 0.183 0.169 0.742 0.008 0.046 0.754 0.161 0.032
  0.028]
 [0.003 0.063 0.043 0.019 0.005 0.016 0.513 0.002 0.023 0.087 0.005 0.004
  0.009]
 [0.021 0.143 0.171 0.037 0.565 0.004 0.789 0.001 0.018 1.335 0.019 0.062
  0.041]
 [0.003 0.006 0.003 0.003 0.013 0.004 0.005 0.002 0.002 0.003 0.005 0.003
  0.002]
 [0.069 0.614 0.95  0.619 1.239 3.222 1.219 0.005 0.477 1.554 0.823 0.715
  0.286]
 [0.034 1.215 1.351 0.194 0.397 0.268 1.219 0.015 0.004 0.667 0.058 0.09
  0.041]
 [0.003 0.011 0.01  0.005 0.055 0.002 1.132 0.001 0.005 0.009 0.009 0.018
  0.003]
 [0.006 0.159 0.939 0.042 0.648 0.227 0.428 0.008 0.125 0.411 0.005 0.109
  0.085]
 [0.018 0.115 0.271 0.182 0.985 0.115 1.217 0.005 0.049 0.333 0.048 0.004
  0.042]
 [0.051 1.06  1.192 0.254 0.637 0.045 1.042 0.025 0.152 1.684 0.08  0.208
  0.008]]
[[0.    0.588 0.646 1.546 0.928 0.39  0.865 0.    0.    1.097 0.525 0.
  0.   ]
 [0.    0.    0.    0.    0.    0.    0.478 0.    0.    0.721 0.    0.
  0.   ]
 [0.    0.    0.    0.    0.    0.    1.519 0.    0.    0.652 0.    0.
  0.   ]
 [0.    0.323 1.424 0.    0.    0.    0.742 0.    0.    0.754 0.    0.
  0.   ]
 [0.    0.    0.    0.    0.    0.    0.513 0.    0.    0.    0.    0.
  0.   ]
 [0.    0.    0.    0.    0.565 0.    0.789 0.    0.    1.335 0.    0.
  0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.   ]
 [0.    0.614 0.95  0.619 1.239 3.222 1.219 0.    0.477 1.554 0.823 0.715
  0.   ]
 [0.    1.215 1.351 0.    0.397 0.    1.219 0.    0.    0.667 0.    0.
  0.   ]
 [0.    0.    0.    0.    0.    0.    1.132 0.    0.    0.    0.    0.
  0.   ]
 [0.    0.    0.939 0.    0.648 0.    0.428 0.    0.    0.411 0.    0.
  0.   ]
 [0.    0.    0.    0.    0.985 0.    1.217 0.    0.    0.333 0.    0.
  0.   ]
 [0.    1.06  1.192 0.    0.637 0.    1.042 0.    0.    1.684 0.    0.
  0.   ]]
{'fdr': 0.5625, 'tpr': 0.8076923076923077, 'fpr': 0.5192307692307693, 'f1': 0.5675675675675675, 'shd': 28, 'npred': 48, 'ntrue': 26}
[5.880e-01 6.462e-01 1.546e+00 9.284e-01 3.899e-01 8.650e-01 1.011e-01
 2.804e-01 1.097e+00 5.246e-01 2.983e-01 8.331e-02 7.262e-03 7.640e-02
 2.732e-02 7.230e-02 3.762e-02 4.784e-01 8.760e-03 4.096e-03 7.210e-01
 4.064e-02 3.703e-02 5.213e-03 1.718e-03 8.515e-02 2.764e-03 1.368e-01
 1.951e-02 1.519e+00 3.489e-03 4.750e-03 6.519e-01 2.927e-03 2.057e-02
 3.445e-03 2.992e-03 3.233e-01 1.424e+00 1.834e-01 1.692e-01 7.421e-01
 8.314e-03 4.609e-02 7.535e-01 1.613e-01 3.249e-02 2.844e-02 3.008e-03
 6.308e-02 4.285e-02 1.908e-02 1.553e-02 5.134e-01 1.960e-03 2.269e-02
 8.720e-02 5.452e-03 4.265e-03 8.929e-03 2.106e-02 1.432e-01 1.711e-01
 3.700e-02 5.653e-01 7.890e-01 1.303e-03 1.779e-02 1.335e+00 1.915e-02
 6.173e-02 4.080e-02 3.441e-03 5.800e-03 2.575e-03 3.309e-03 1.347e-02
 4.486e-03 1.660e-03 1.883e-03 2.546e-03 5.440e-03 3.049e-03 1.548e-03
 6.888e-02 6.144e-01 9.496e-01 6.190e-01 1.239e+00 3.222e+00 1.219e+00
 4.774e-01 1.554e+00 8.234e-01 7.155e-01 2.857e-01 3.435e-02 1.215e+00
 1.351e+00 1.940e-01 3.968e-01 2.677e-01 1.219e+00 1.504e-02 6.667e-01
 5.810e-02 8.999e-02 4.096e-02 3.120e-03 1.075e-02 1.015e-02 4.548e-03
 5.500e-02 2.445e-03 1.132e+00 8.270e-04 4.920e-03 9.096e-03 1.752e-02
 2.961e-03 6.131e-03 1.588e-01 9.391e-01 4.217e-02 6.485e-01 2.268e-01
 4.278e-01 7.885e-03 1.248e-01 4.109e-01 1.094e-01 8.515e-02 1.796e-02
 1.148e-01 2.708e-01 1.815e-01 9.851e-01 1.148e-01 1.217e+00 5.406e-03
 4.857e-02 3.335e-01 4.803e-02 4.204e-02 5.117e-02 1.060e+00 1.192e+00
 2.537e-01 6.369e-01 4.451e-02 1.042e+00 2.508e-02 1.525e-01 1.684e+00
 8.011e-02 2.084e-01]
[[0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 1. 0. 0. 0.]
 [0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0. 0. 0.]
 [0. 1. 1. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 1. 0.]
 [1. 0. 1. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 0. 0.]
 [0. 1. 1. 0. 0. 0. 1. 0. 0. 1. 0. 0. 0.]]
[0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0.
 0. 0. 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0. 0.
 0. 1. 1. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 1. 0.
 1. 0. 1. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 0.
 0. 1. 1. 0. 0. 0. 1. 0. 0. 1. 0. 0.]
aucroc, aucpr (0.855621301775148, 0.6988523468045454)
Iterations 2500
Achieves (24.160548736236485, 1e-05)-DP
