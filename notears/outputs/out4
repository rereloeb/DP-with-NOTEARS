samples  5000  SCM  10 2 RE mim  minibatch size  50  noise  0.6  minibatches per NN training  250  DP methodology  group_clipping [[3.1, 1.0, 6.0, 3.0]]  box penalty  0
cpu
max degree  2.0  complexity indicator 1  625.0  complexity indicator 2  1086.9565217391305
model created without box penalty
model created without box penalty
cpu
iteration 1 in inner loop,alpha 0.0 rho 1.0 h 1.1601221069006407
iteration 1 in outer loop, alpha = 1.1601221069006407, rho = 1.0, h = 1.1601221069006407
model created without box penalty
cpu
iteration 1 in inner loop,alpha 1.1601221069006407 rho 1.0 h 0.697926845742554
iteration 2 in inner loop,alpha 1.1601221069006407 rho 10.0 h 0.29175731529299753
iteration 3 in inner loop,alpha 1.1601221069006407 rho 100.0 h 0.08501950555491611
iteration 2 in outer loop, alpha = 9.662072662392251, rho = 100.0, h = 0.08501950555491611
model created without box penalty
cpu
iteration 1 in inner loop,alpha 9.662072662392251 rho 100.0 h 0.040170488512167424
iteration 2 in inner loop,alpha 9.662072662392251 rho 1000.0 h 0.00868366913203289
iteration 3 in outer loop, alpha = 18.34574179442514, rho = 1000.0, h = 0.00868366913203289
model created without box penalty
cpu
iteration 1 in inner loop,alpha 18.34574179442514 rho 1000.0 h 0.0030868790422431402
iteration 2 in inner loop,alpha 18.34574179442514 rho 10000.0 h 0.0008995705368377571
iteration 4 in outer loop, alpha = 27.341447162802712, rho = 10000.0, h = 0.0008995705368377571
model created without box penalty
cpu
iteration 1 in inner loop,alpha 27.341447162802712 rho 10000.0 h 0.0006484053062099093
iteration 2 in inner loop,alpha 27.341447162802712 rho 100000.0 h 0.0002616647124735749
iteration 5 in outer loop, alpha = 289.0061596363776, rho = 1000000.0, h = 0.0002616647124735749
Threshold 0.3
[[0.01  0.    2.439 0.    0.313 0.    0.201 0.    0.    0.052]
 [3.167 0.    0.255 0.    0.057 0.    0.025 0.    0.    0.049]
 [0.001 0.    0.003 0.    0.02  0.    3.039 0.    0.    0.016]
 [2.626 0.    0.121 0.    0.976 0.006 0.072 0.    0.    0.013]
 [0.001 0.    0.015 0.    0.003 0.    0.011 0.    0.    0.001]
 [0.021 0.007 0.019 0.    0.045 0.    0.033 0.    0.005 0.045]
 [0.    0.    0.    0.    0.004 0.    0.009 0.    0.    0.001]
 [0.045 0.    0.003 0.    0.143 0.009 0.081 0.    0.    3.237]
 [0.04  0.    0.064 0.004 0.117 0.    2.722 0.    0.    2.883]
 [0.016 0.    0.012 0.    2.19  0.    0.301 0.    0.    0.008]]
[[0.    0.    2.439 0.    0.313 0.    0.    0.    0.    0.   ]
 [3.167 0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    3.039 0.    0.    0.   ]
 [2.626 0.    0.    0.    0.976 0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    3.237]
 [0.    0.    0.    0.    0.    0.    2.722 0.    0.    2.883]
 [0.    0.    0.    0.    2.19  0.    0.301 0.    0.    0.   ]]
{'fdr': 0.18181818181818182, 'tpr': 1.0, 'fpr': 0.05555555555555555, 'f1': 0.8999999999999999, 'shd': 2, 'npred': 11, 'ntrue': 9}
[3.269e-06 2.439e+00 2.360e-05 3.127e-01 1.057e-04 2.009e-01 1.136e-04
 6.644e-05 5.173e-02 3.167e+00 2.553e-01 1.845e-04 5.678e-02 1.726e-04
 2.526e-02 1.867e-04 1.036e-04 4.862e-02 6.936e-04 1.064e-05 4.596e-06
 2.025e-02 6.305e-05 3.039e+00 1.164e-04 1.147e-04 1.567e-02 2.626e+00
 1.722e-04 1.206e-01 9.764e-01 5.872e-03 7.239e-02 3.245e-04 5.762e-05
 1.254e-02 9.900e-04 2.162e-05 1.487e-02 2.243e-05 6.487e-05 1.146e-02
 5.745e-06 4.002e-06 6.108e-04 2.138e-02 6.722e-03 1.936e-02 2.459e-04
 4.486e-02 3.297e-02 1.213e-04 5.333e-03 4.493e-02 7.180e-05 2.638e-05
 9.349e-05 2.986e-06 4.291e-03 1.041e-04 1.811e-04 4.376e-06 1.285e-03
 4.487e-02 1.554e-04 2.565e-03 8.778e-05 1.427e-01 8.665e-03 8.118e-02
 8.880e-05 3.237e+00 4.033e-02 3.416e-04 6.358e-02 4.082e-03 1.167e-01
 8.093e-05 2.722e+00 2.648e-04 2.883e+00 1.620e-02 1.016e-04 1.176e-02
 1.046e-04 2.190e+00 2.991e-05 3.007e-01 3.538e-06 1.440e-05]
[[0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 1.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]]
[0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
aucroc, aucpr (1.0, 1.0)
model created without box penalty
number of groups for clipping  4  noise multiplier modified for group clipping  1.2
cpu
cpu
[0.559 0.633 0.599 0.618 0.582 0.65  0.581 0.777 0.565 0.59  0.563 0.595
 0.599 0.652 0.572 0.425 0.563 0.623 0.674 0.547 0.67  0.464 0.587 0.633
 0.513 0.67  0.619 0.664 0.569 0.534 0.421 0.561 0.638 0.437 0.543 0.523
 0.602 0.65  0.636 0.545 0.456 0.5   0.452 0.503 0.559 0.545 0.595 0.518
 0.583 0.615 0.586 0.566 0.608 0.69  0.562 0.643 0.552 0.466 0.638 0.594
 0.626 0.59  0.652 0.749 0.536 0.64  0.519 0.682 0.581 0.683 0.469 0.408
 0.488 0.647 0.596 0.555 0.586 0.613 0.659 0.696 0.579 0.623 0.589 0.663
 0.464 0.539 0.399 0.605 0.732 0.502]
[[0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 1.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]]
[0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
aucroc, aucpr (0.49382716049382713, 0.11721121018714775)
Objective function 186.49 = squared loss an data 9.43 + 0.5*rho*h**2 176.710652 + alpha*h 0.000000 + L2reg 0.19 + L1reg 0.16 ; SHD = 55 ; DAG False
Grad norm per param group for one microbatch
13.002772412426165
0.6990063362056258
9.225330746477386
5.366873022553816
Grad norm per param group for one microbatch
4.092012454281077
0.7831776226623982
8.363214709081763
5.051163900855063
Grad norm per param group for one microbatch
4.9767406736303155
0.9842064453987451
7.330261718472514
4.438070413200539
Grad norm per param group for one microbatch
3.4372273524974344
1.0767485755941184
4.8386051147905285
3.01232466542623
Grad norm per param group for one microbatch
8.844560683558468
1.68904306489971
7.43033752782123
4.410547909697119
Grad norm per param group for one microbatch
4.850747998593764
1.2410872999472389
4.946864701189097
3.2450909166353523
Grad norm per param group for one microbatch
4.2563817146313605
1.3450024799709992
4.674376140060556
3.0127704290141133
Grad norm per param group for one microbatch
9.90339537464456
2.007160130244114
5.628296247259233
3.5820795130271894
Grad norm per param group for one microbatch
2.799319581105566
0.8521750988820801
3.8536141465236007
2.377802496180907
Grad norm per param group for one microbatch
4.245282681298746
1.3464732643011013
5.251264375778523
3.2264326342183227
cpu
[0.184 0.374 0.17  0.142 0.267 0.207 0.103 0.189 0.148 0.615 0.1   0.203
 0.157 0.198 0.279 0.127 0.206 0.221 0.347 0.34  0.256 0.211 0.304 0.408
 0.144 0.242 0.226 0.757 0.274 0.174 0.335 0.219 0.298 0.28  0.21  0.178
 0.287 0.289 0.151 0.253 0.112 0.193 0.213 0.186 0.314 0.194 0.199 0.202
 0.176 0.352 0.198 0.164 0.123 0.106 0.186 0.158 0.281 0.17  0.206 0.197
 0.147 0.102 0.152 0.263 0.316 0.181 0.155 0.292 0.18  0.262 0.2   0.777
 0.202 0.263 0.279 0.154 0.187 0.313 0.716 0.252 0.483 0.194 0.194 0.219
 0.227 0.407 0.248 0.127 0.172 0.132]
[[0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 1.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]]
[0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
aucroc, aucpr (0.9958847736625515, 0.9722222222222223)
Objective function 5.84 = squared loss an data 5.12 + 0.5*rho*h**2 0.413883 + alpha*h 0.000000 + L2reg 0.25 + L1reg 0.06 ; SHD = 11 ; DAG False
Proportion of microbatches that were clipped  [0.6859088697908221, 0.4854061942597697, 0.3919247608237393, 0.7059348143343603]
iteration 1 in inner loop, alpha 0.0 rho 1.0 h 0.9098166971820696
iteration 1 in outer loop, alpha = 0.9098166971820696, rho = 1.0, h = 0.9098166971820696
cpu
cpu
[0.184 0.374 0.17  0.142 0.267 0.207 0.103 0.189 0.148 0.615 0.1   0.203
 0.157 0.198 0.279 0.127 0.206 0.221 0.347 0.34  0.256 0.211 0.304 0.408
 0.144 0.242 0.226 0.757 0.274 0.174 0.335 0.219 0.298 0.28  0.21  0.178
 0.287 0.289 0.151 0.253 0.112 0.193 0.213 0.186 0.314 0.194 0.199 0.202
 0.176 0.352 0.198 0.164 0.123 0.106 0.186 0.158 0.281 0.17  0.206 0.197
 0.147 0.102 0.152 0.263 0.316 0.181 0.155 0.292 0.18  0.262 0.2   0.777
 0.202 0.263 0.279 0.154 0.187 0.313 0.716 0.252 0.483 0.194 0.194 0.219
 0.227 0.407 0.248 0.127 0.172 0.132]
[[0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 1.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]]
[0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
aucroc, aucpr (0.9958847736625515, 0.9722222222222223)
Objective function 6.67 = squared loss an data 5.12 + 0.5*rho*h**2 0.413883 + alpha*h 0.827766 + L2reg 0.25 + L1reg 0.06 ; SHD = 11 ; DAG False
Grad norm per param group for one microbatch
10.383577653957131
2.186452459640412
6.497374594269861
3.9945369471164462
Grad norm per param group for one microbatch
12.693920367058327
2.3446431675093766
6.0816172680338765
3.758988729094504
Grad norm per param group for one microbatch
4.762140161184389
1.5072957682764554
4.55170151509823
2.878245886109074
Grad norm per param group for one microbatch
5.054167484973921
1.5393728359121948
4.670319866732102
2.8971482758877123
Grad norm per param group for one microbatch
4.190385914090892
1.3776311521719322
3.5074710968085174
2.1720776877483545
Grad norm per param group for one microbatch
8.105484047398402
2.298944972127529
5.8987404890581505
3.580689078874788
Grad norm per param group for one microbatch
9.652927853956017
2.225093395054526
4.8984778067366905
3.0213862324760177
Grad norm per param group for one microbatch
6.090062920722776
1.9713730890485799
4.720079543853313
2.986107721116494
Grad norm per param group for one microbatch
11.337460334653018
2.5088946085415653
5.976555851178576
3.686880127439078
Grad norm per param group for one microbatch
11.509764817603074
2.475141422892236
5.455936212202295
3.438394328259715
cpu
[0.267 0.334 0.217 0.125 0.137 0.215 0.157 0.227 0.12  0.271 0.243 0.224
 0.151 0.223 0.141 0.116 0.131 0.253 0.241 0.197 0.224 0.287 0.145 0.249
 0.129 0.202 0.353 0.393 0.276 0.228 0.16  0.242 0.295 0.217 0.155 0.241
 0.25  0.18  0.218 0.3   0.292 0.172 0.293 0.229 0.275 0.326 0.214 0.19
 0.222 0.153 0.227 0.107 0.188 0.227 0.188 0.214 0.294 0.157 0.267 0.285
 0.165 0.176 0.238 0.294 0.392 0.229 0.161 0.141 0.206 0.154 0.348 0.433
 0.155 0.268 0.328 0.246 0.204 0.254 0.373 0.085 0.411 0.279 0.191 0.076
 0.134 0.297 0.175 0.121 0.274 0.204]
[[0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 1.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]]
[0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
aucroc, aucpr (0.8491083676268861, 0.622796218378266)
Objective function 5.95 = squared loss an data 4.62 + 0.5*rho*h**2 0.211668 + alpha*h 0.591966 + L2reg 0.47 + L1reg 0.06 ; SHD = 11 ; DAG False
Proportion of microbatches that were clipped  [0.9555394174130557, 0.9629629629629629, 0.20406681190994916, 0.5247317033809409]
iteration 1 in inner loop, alpha 0.9098166971820696 rho 1.0 h 0.6506433351614955
cpu
[0.267 0.334 0.217 0.125 0.137 0.215 0.157 0.227 0.12  0.271 0.243 0.224
 0.151 0.223 0.141 0.116 0.131 0.253 0.241 0.197 0.224 0.287 0.145 0.249
 0.129 0.202 0.353 0.393 0.276 0.228 0.16  0.242 0.295 0.217 0.155 0.241
 0.25  0.18  0.218 0.3   0.292 0.172 0.293 0.229 0.275 0.326 0.214 0.19
 0.222 0.153 0.227 0.107 0.188 0.227 0.188 0.214 0.294 0.157 0.267 0.285
 0.165 0.176 0.238 0.294 0.392 0.229 0.161 0.141 0.206 0.154 0.348 0.433
 0.155 0.268 0.328 0.246 0.204 0.254 0.373 0.085 0.411 0.279 0.191 0.076
 0.134 0.297 0.175 0.121 0.274 0.204]
[[0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 1.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]]
[0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
aucroc, aucpr (0.8491083676268861, 0.622796218378266)
Objective function 7.85 = squared loss an data 4.62 + 0.5*rho*h**2 2.116684 + alpha*h 0.591966 + L2reg 0.47 + L1reg 0.06 ; SHD = 11 ; DAG False
Grad norm per param group for one microbatch
7.781532097245204
2.0064874172157863
4.786142549817744
3.0066428961650637
Grad norm per param group for one microbatch
8.396723970158174
2.5905406433326017
4.877689067094134
3.021653099726433
Grad norm per param group for one microbatch
4.325885154139851
1.262875486538445
3.7001119888965666
2.3047866982718115
Grad norm per param group for one microbatch
6.811733136125476
2.20704323379634
5.257179631116994
3.174637285415656
Grad norm per param group for one microbatch
6.365451636509422
2.126411311935928
4.520918475866452
2.829676938778024
Grad norm per param group for one microbatch
4.819564283576978
1.2513719771996448
3.957658050907149
2.4950188909875375
Grad norm per param group for one microbatch
14.97412026305609
3.080955757954326
6.530311952864046
3.9631099688892584
Grad norm per param group for one microbatch
6.733691176978861
1.7748288269315333
4.740105213958125
2.730774620526114
Grad norm per param group for one microbatch
8.653414352768053
2.497809499811782
4.8845431223548665
3.0002724508708396
Grad norm per param group for one microbatch
6.156882043868286
2.0299334080888807
3.556913325673794
2.216370053554476
Grad norm per param group for one microbatch
15.224714084147264
3.1493043446385376
6.731734512763034
4.148430852375826
cpu
[0.3   0.329 0.17  0.149 0.188 0.199 0.159 0.134 0.221 0.272 0.165 0.256
 0.175 0.298 0.232 0.139 0.254 0.316 0.223 0.247 0.152 0.178 0.187 0.233
 0.082 0.185 0.234 0.415 0.14  0.186 0.24  0.098 0.276 0.12  0.162 0.21
 0.197 0.142 0.12  0.198 0.375 0.23  0.235 0.162 0.249 0.226 0.129 0.17
 0.299 0.131 0.16  0.214 0.12  0.173 0.124 0.148 0.22  0.134 0.128 0.243
 0.086 0.115 0.161 0.206 0.233 0.349 0.282 0.154 0.157 0.267 0.128 0.425
 0.156 0.148 0.262 0.212 0.171 0.282 0.557 0.323 0.362 0.13  0.094 0.129
 0.17  0.243 0.141 0.22  0.202 0.164]
[[0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 1.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]]
[0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
aucroc, aucpr (0.9080932784636488, 0.6456996898376208)
Objective function 6.50 = squared loss an data 5.23 + 0.5*rho*h**2 0.371566 + alpha*h 0.248020 + L2reg 0.61 + L1reg 0.05 ; SHD = 8 ; DAG True
Proportion of microbatches that were clipped  [0.9966131763567454, 0.9945972099024272, 0.2544149665349569, 0.5910007257479235]
iteration 2 in inner loop, alpha 0.9098166971820696 rho 10.0 h 0.272604633492179
cpu
[0.3   0.329 0.17  0.149 0.188 0.199 0.159 0.134 0.221 0.272 0.165 0.256
 0.175 0.298 0.232 0.139 0.254 0.316 0.223 0.247 0.152 0.178 0.187 0.233
 0.082 0.185 0.234 0.415 0.14  0.186 0.24  0.098 0.276 0.12  0.162 0.21
 0.197 0.142 0.12  0.198 0.375 0.23  0.235 0.162 0.249 0.226 0.129 0.17
 0.299 0.131 0.16  0.214 0.12  0.173 0.124 0.148 0.22  0.134 0.128 0.243
 0.086 0.115 0.161 0.206 0.233 0.349 0.282 0.154 0.157 0.267 0.128 0.425
 0.156 0.148 0.262 0.212 0.171 0.282 0.557 0.323 0.362 0.13  0.094 0.129
 0.17  0.243 0.141 0.22  0.202 0.164]
[[0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 1.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]]
[0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
aucroc, aucpr (0.9080932784636488, 0.6456996898376208)
Objective function 9.85 = squared loss an data 5.23 + 0.5*rho*h**2 3.715664 + alpha*h 0.248020 + L2reg 0.61 + L1reg 0.05 ; SHD = 8 ; DAG True
Grad norm per param group for one microbatch
19.50726379842377
4.238406737349723
7.365697775195347
4.345336404555853
Grad norm per param group for one microbatch
17.725322249151983
4.082864565967749
6.329955355571461
3.8630369558102626
Grad norm per param group for one microbatch
11.093448782699774
2.9942210994947156
5.746967859603648
3.6308266339406856
Grad norm per param group for one microbatch
8.876145961013048
2.6741374345817523
4.572674900709624
2.8037209957044897
Grad norm per param group for one microbatch
40.000583693917875
5.915729159003959
10.070216664827829
5.978298845718517
Grad norm per param group for one microbatch
16.003839941996365
3.8130186870565934
7.067554843484242
4.433162831446573
Grad norm per param group for one microbatch
30.89850658209064
4.353448647838286
7.515419612209717
4.634246938026283
Grad norm per param group for one microbatch
46.09994390316326
6.299733448088731
9.257509106616089
5.5371054689617765
Grad norm per param group for one microbatch
4.606259027836919
1.1853113810311593
3.324019173453844
2.153653123415696
Grad norm per param group for one microbatch
14.501671576225014
3.230905489095884
6.942530242861681
4.316647575749221
Grad norm per param group for one microbatch
8.670399411134857
2.601588139018387
5.193117686609781
3.1353183726135576
Grad norm per param group for one microbatch
12.958179429162433
2.967436540981451
6.380628787484856
3.926457600978813
Grad norm per param group for one microbatch
15.038172947727949
3.7955392890083064
6.356401200038735
3.9271115976891333
cpu
[0.119 0.279 0.077 0.111 0.373 0.194 0.31  0.103 0.342 0.297 0.202 0.279
 0.189 0.397 0.186 0.202 0.206 0.168 0.162 0.112 0.174 0.192 0.21  0.183
 0.172 0.074 0.23  0.425 0.087 0.224 0.25  0.357 0.374 0.155 0.108 0.193
 0.168 0.145 0.098 0.098 0.237 0.092 0.172 0.099 0.265 0.043 0.094 0.112
 0.068 0.126 0.121 0.104 0.128 0.102 0.127 0.151 0.208 0.054 0.173 0.251
 0.12  0.072 0.134 0.109 0.152 0.082 0.233 0.148 0.158 0.18  0.055 0.519
 0.25  0.101 0.264 0.233 0.258 0.223 0.475 0.353 0.334 0.056 0.138 0.082
 0.138 0.234 0.311 0.177 0.038 0.089]
[[0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 1.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]]
[0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
aucroc, aucpr (0.8902606310013718, 0.5713091256569518)
Objective function 7.34 = squared loss an data 6.22 + 0.5*rho*h**2 0.356754 + alpha*h 0.076852 + L2reg 0.64 + L1reg 0.05 ; SHD = 13 ; DAG True
Proportion of microbatches that were clipped  [1.0, 0.9979812661498708, 0.36046511627906974, 0.7051841085271318]
iteration 3 in inner loop, alpha 0.9098166971820696 rho 100.0 h 0.0844693875232938
iteration 2 in outer loop, alpha = 9.35675544951145, rho = 100.0, h = 0.0844693875232938
cpu
cpu
[0.119 0.279 0.077 0.111 0.373 0.194 0.31  0.103 0.342 0.297 0.202 0.279
 0.189 0.397 0.186 0.202 0.206 0.168 0.162 0.112 0.174 0.192 0.21  0.183
 0.172 0.074 0.23  0.425 0.087 0.224 0.25  0.357 0.374 0.155 0.108 0.193
 0.168 0.145 0.098 0.098 0.237 0.092 0.172 0.099 0.265 0.043 0.094 0.112
 0.068 0.126 0.121 0.104 0.128 0.102 0.127 0.151 0.208 0.054 0.173 0.251
 0.12  0.072 0.134 0.109 0.152 0.082 0.233 0.148 0.158 0.18  0.055 0.519
 0.25  0.101 0.264 0.233 0.258 0.223 0.475 0.353 0.334 0.056 0.138 0.082
 0.138 0.234 0.311 0.177 0.038 0.089]
[[0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 1.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]]
[0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
aucroc, aucpr (0.8902606310013718, 0.5713091256569518)
Objective function 8.05 = squared loss an data 6.22 + 0.5*rho*h**2 0.356754 + alpha*h 0.790359 + L2reg 0.64 + L1reg 0.05 ; SHD = 13 ; DAG True
Grad norm per param group for one microbatch
13.116989870055953
3.796408766181458
5.7038024415945685
3.638312533325005
Grad norm per param group for one microbatch
11.077538467346695
3.4242393718623565
6.169868145428748
3.859389847099684
Grad norm per param group for one microbatch
26.336646364409535
4.629456008333245
8.24369592041465
4.950980165106972
Grad norm per param group for one microbatch
8.548396420147931
2.7199213354612404
4.21984367704383
2.5618530736263616
Grad norm per param group for one microbatch
16.036471790209823
3.800316799887558
6.591734649391559
4.15134116582807
Grad norm per param group for one microbatch
20.407532672759622
3.77018486645998
6.743187379683591
4.119263973602294
Grad norm per param group for one microbatch
11.256818157715324
2.9807175636412113
5.072758091149082
3.1124958109017165
Grad norm per param group for one microbatch
21.999010429611676
4.1875755417417535
7.7782860162566765
4.816384126646888
Grad norm per param group for one microbatch
13.01448188571002
3.4703689293368583
5.596153494787449
3.592351963299207
Grad norm per param group for one microbatch
8.724950194879435
2.8558265813376664
5.045315359025367
3.11057174582616
Grad norm per param group for one microbatch
4.743555935046739
1.677454475732625
2.995495569777216
1.8988627905780155
Grad norm per param group for one microbatch
7.897016850369478
1.867309799600728
4.5772968219381625
2.8884494902284743
Grad norm per param group for one microbatch
13.092513238879775
3.649540765130283
5.549008473869556
3.4172030062351095
Grad norm per param group for one microbatch
16.65220459312768
3.406091163617748
6.2056583244679775
3.8967897564598255
Grad norm per param group for one microbatch
14.133575760241024
2.837252413508171
4.4702436868426405
2.794333852429659
Grad norm per param group for one microbatch
9.185742514601795
3.1136426876446097
4.591563819739849
2.9774926597731146
Grad norm per param group for one microbatch
12.043957684702713
3.593673333661122
4.807140063811762
3.0300209464193406
cpu
[0.066 0.312 0.052 0.258 0.207 0.139 0.158 0.116 0.185 0.489 0.176 0.172
 0.241 0.403 0.226 0.184 0.153 0.134 0.162 0.115 0.184 0.224 0.084 0.176
 0.138 0.065 0.246 0.471 0.071 0.129 0.155 0.123 0.2   0.237 0.146 0.216
 0.076 0.105 0.082 0.124 0.125 0.114 0.234 0.095 0.202 0.095 0.048 0.193
 0.174 0.124 0.197 0.089 0.113 0.09  0.114 0.087 0.172 0.132 0.173 0.112
 0.11  0.028 0.199 0.092 0.098 0.149 0.112 0.054 0.216 0.156 0.048 0.526
 0.174 0.177 0.356 0.13  0.233 0.165 0.619 0.426 0.374 0.096 0.132 0.098
 0.085 0.206 0.187 0.077 0.074 0.071]
[[0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 1.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]]
[0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
aucroc, aucpr (0.8943758573388203, 0.685954226651901)
Objective function 7.81 = squared loss an data 6.61 + 0.5*rho*h**2 0.098473 + alpha*h 0.415239 + L2reg 0.64 + L1reg 0.04 ; SHD = 6 ; DAG True
Proportion of microbatches that were clipped  [1.0, 0.9989501736251313, 0.3864168618266979, 0.7208269401598967]
iteration 1 in inner loop, alpha 9.35675544951145 rho 100.0 h 0.04437856942227114
cpu
[0.066 0.312 0.052 0.258 0.207 0.139 0.158 0.116 0.185 0.489 0.176 0.172
 0.241 0.403 0.226 0.184 0.153 0.134 0.162 0.115 0.184 0.224 0.084 0.176
 0.138 0.065 0.246 0.471 0.071 0.129 0.155 0.123 0.2   0.237 0.146 0.216
 0.076 0.105 0.082 0.124 0.125 0.114 0.234 0.095 0.202 0.095 0.048 0.193
 0.174 0.124 0.197 0.089 0.113 0.09  0.114 0.087 0.172 0.132 0.173 0.112
 0.11  0.028 0.199 0.092 0.098 0.149 0.112 0.054 0.216 0.156 0.048 0.526
 0.174 0.177 0.356 0.13  0.233 0.165 0.619 0.426 0.374 0.096 0.132 0.098
 0.085 0.206 0.187 0.077 0.074 0.071]
[[0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 1.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]]
[0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
aucroc, aucpr (0.8943758573388203, 0.685954226651901)
Objective function 8.70 = squared loss an data 6.61 + 0.5*rho*h**2 0.984729 + alpha*h 0.415239 + L2reg 0.64 + L1reg 0.04 ; SHD = 6 ; DAG True
Grad norm per param group for one microbatch
8.884680300917495
2.702557669893767
4.544292409432645
2.8579197784262265
Grad norm per param group for one microbatch
12.955521420520107
3.294864249647202
5.785299898696489
3.6487348291554733
Grad norm per param group for one microbatch
9.065356570046973
2.127456688650183
4.8203212928173365
3.061937422427292
Grad norm per param group for one microbatch
21.734294193379277
4.491408670127161
8.26020902670683
4.921630240679189
Grad norm per param group for one microbatch
10.68029659366237
3.0377309506599546
6.09331381687696
3.685921194091357
Grad norm per param group for one microbatch
18.82449765430612
3.9616540676330185
6.543620646941721
4.010566366682812
Grad norm per param group for one microbatch
28.361355404359024
5.779637299480018
7.199794510983538
4.496900556207957
cpu
[0.037 0.272 0.034 0.191 0.303 0.129 0.042 0.101 0.282 0.525 0.144 0.145
 0.168 0.21  0.213 0.147 0.126 0.148 0.095 0.113 0.115 0.074 0.156 0.262
 0.169 0.076 0.161 0.493 0.092 0.156 0.36  0.305 0.09  0.112 0.128 0.194
 0.103 0.068 0.176 0.044 0.161 0.142 0.114 0.058 0.202 0.047 0.04  0.099
 0.064 0.081 0.089 0.182 0.141 0.111 0.084 0.053 0.111 0.107 0.107 0.104
 0.105 0.032 0.142 0.187 0.103 0.114 0.163 0.108 0.1   0.144 0.103 0.644
 0.2   0.096 0.243 0.122 0.118 0.108 0.743 0.171 0.505 0.046 0.13  0.106
 0.073 0.161 0.127 0.099 0.03  0.018]
[[0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 1.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]]
[0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
aucroc, aucpr (0.9670781893004115, 0.8622895622895623)
Objective function 8.08 = squared loss an data 7.07 + 0.5*rho*h**2 0.189330 + alpha*h 0.182075 + L2reg 0.60 + L1reg 0.04 ; SHD = 5 ; DAG True
Proportion of microbatches that were clipped  [1.0, 0.9981706832100533, 0.44261512765449773, 0.7627455658951722]
iteration 2 in inner loop, alpha 9.35675544951145 rho 1000.0 h 0.019459206328580336
iteration 3 in outer loop, alpha = 28.815961778091786, rho = 1000.0, h = 0.019459206328580336
cpu
cpu
[0.037 0.272 0.034 0.191 0.303 0.129 0.042 0.101 0.282 0.525 0.144 0.145
 0.168 0.21  0.213 0.147 0.126 0.148 0.095 0.113 0.115 0.074 0.156 0.262
 0.169 0.076 0.161 0.493 0.092 0.156 0.36  0.305 0.09  0.112 0.128 0.194
 0.103 0.068 0.176 0.044 0.161 0.142 0.114 0.058 0.202 0.047 0.04  0.099
 0.064 0.081 0.089 0.182 0.141 0.111 0.084 0.053 0.111 0.107 0.107 0.104
 0.105 0.032 0.142 0.187 0.103 0.114 0.163 0.108 0.1   0.144 0.103 0.644
 0.2   0.096 0.243 0.122 0.118 0.108 0.743 0.171 0.505 0.046 0.13  0.106
 0.073 0.161 0.127 0.099 0.03  0.018]
[[0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 1.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]]
[0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
aucroc, aucpr (0.9670781893004115, 0.8622895622895623)
Objective function 8.46 = squared loss an data 7.07 + 0.5*rho*h**2 0.189330 + alpha*h 0.560736 + L2reg 0.60 + L1reg 0.04 ; SHD = 5 ; DAG True
Grad norm per param group for one microbatch
20.552084507518874
4.284012155248784
8.717345288910149
5.34282218485975
Grad norm per param group for one microbatch
11.158726944542607
2.801154312271389
5.650960803326931
3.5503901054727347
Grad norm per param group for one microbatch
19.577730982015098
4.033157179726205
6.048113701747594
3.7215515933387096
Grad norm per param group for one microbatch
8.650852073369132
2.555543499243944
4.390538761612903
2.774033691113368
Grad norm per param group for one microbatch
10.10458105941285
2.99918153262938
6.120459892888964
3.6268391463298357
Grad norm per param group for one microbatch
6.211971573429473
1.621844003927668
3.826246382381841
2.334568223383956
Grad norm per param group for one microbatch
13.167992547827042
2.9628928205908287
6.292625678566602
3.8529126326750194
Grad norm per param group for one microbatch
9.231472368283688
2.3652565029760355
5.730931416691916
3.4140091804959654
Grad norm per param group for one microbatch
15.092331039125527
3.476275627838299
6.248624646025673
3.867263482874876
Grad norm per param group for one microbatch
19.345998212735118
3.9696226148701745
6.601229277375734
3.9778762314551046
Grad norm per param group for one microbatch
14.644774788813253
3.41383144846968
5.380972791497312
3.198161226661827
Grad norm per param group for one microbatch
11.319015389550522
2.587714916717121
6.151286352042551
3.679355930560056
Grad norm per param group for one microbatch
18.082903494370818
3.8718932231811323
7.214178068708057
4.466851890305647
Grad norm per param group for one microbatch
8.340722004465375
2.717751486419801
5.160109059190764
3.120905907548229
Grad norm per param group for one microbatch
10.549111470349159
2.608061202876563
5.230154912129157
3.3079729022145155
Grad norm per param group for one microbatch
44.20872640749435
6.9206016260658325
10.57001011771382
6.664956073384818
Grad norm per param group for one microbatch
9.964165776863897
2.7982697401906003
5.369512237308928
3.2094357394722155
Grad norm per param group for one microbatch
23.92671686241668
4.424407010421549
7.958507942406122
4.790450375708529
Grad norm per param group for one microbatch
6.589497626570494
2.194429097549979
4.307082134128015
2.6270551752874907
Grad norm per param group for one microbatch
11.853322917530202
3.4241191388058256
6.499941317526769
3.936510293555484
Grad norm per param group for one microbatch
16.03107910215001
3.492862859313856
5.811473187231766
3.5800375175403527
Grad norm per param group for one microbatch
23.581847115762432
4.48094244000794
9.97166021545864
5.864519677463252
cpu
[0.02  0.378 0.015 0.156 0.048 0.109 0.067 0.068 0.149 0.836 0.381 0.085
 0.261 0.143 0.321 0.062 0.208 0.29  0.061 0.032 0.063 0.054 0.095 0.334
 0.078 0.098 0.187 0.769 0.145 0.233 0.333 0.193 0.161 0.26  0.125 0.269
 0.05  0.065 0.171 0.037 0.171 0.171 0.023 0.085 0.238 0.125 0.055 0.146
 0.083 0.052 0.165 0.063 0.146 0.205 0.081 0.035 0.059 0.089 0.078 0.057
 0.083 0.019 0.141 0.193 0.185 0.194 0.056 0.358 0.215 0.221 0.078 0.672
 0.133 0.063 0.127 0.084 0.146 0.092 0.679 0.196 0.547 0.069 0.054 0.071
 0.063 0.131 0.063 0.099 0.024 0.026]
[[0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 1.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]]
[0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
aucroc, aucpr (0.9478737997256516, 0.8499118165784834)
Objective function 8.22 = squared loss an data 7.18 + 0.5*rho*h**2 0.073629 + alpha*h 0.349682 + L2reg 0.57 + L1reg 0.04 ; SHD = 4 ; DAG True
Proportion of microbatches that were clipped  [1.0, 0.997763042262523, 0.48342254533833984, 0.7782216185987058]
iteration 1 in inner loop, alpha 28.815961778091786 rho 1000.0 h 0.012135013134003003
cpu
[0.02  0.378 0.015 0.156 0.048 0.109 0.067 0.068 0.149 0.836 0.381 0.085
 0.261 0.143 0.321 0.062 0.208 0.29  0.061 0.032 0.063 0.054 0.095 0.334
 0.078 0.098 0.187 0.769 0.145 0.233 0.333 0.193 0.161 0.26  0.125 0.269
 0.05  0.065 0.171 0.037 0.171 0.171 0.023 0.085 0.238 0.125 0.055 0.146
 0.083 0.052 0.165 0.063 0.146 0.205 0.081 0.035 0.059 0.089 0.078 0.057
 0.083 0.019 0.141 0.193 0.185 0.194 0.056 0.358 0.215 0.221 0.078 0.672
 0.133 0.063 0.127 0.084 0.146 0.092 0.679 0.196 0.547 0.069 0.054 0.071
 0.063 0.131 0.063 0.099 0.024 0.026]
[[0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 1.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]]
[0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
aucroc, aucpr (0.9478737997256516, 0.8499118165784834)
Objective function 8.88 = squared loss an data 7.18 + 0.5*rho*h**2 0.736293 + alpha*h 0.349682 + L2reg 0.57 + L1reg 0.04 ; SHD = 4 ; DAG True
Grad norm per param group for one microbatch
20.46994476505096
3.6599859055909674
6.995045480168972
4.192274350212752
Grad norm per param group for one microbatch
16.65221795191768
2.971370515032122
5.483717343572942
3.30563350900657
Grad norm per param group for one microbatch
9.750462967350726
2.3177664073148563
4.895771250532096
2.9557673067133137
Grad norm per param group for one microbatch
11.103785264136215
3.14032650034552
5.966457729633173
3.731775495865149
Grad norm per param group for one microbatch
9.574443580509723
2.9202366170174736
5.4642973339103404
3.2733178392201974
Grad norm per param group for one microbatch
8.535808352588283
2.7466121358057256
4.87379720363589
3.026528332200811
Grad norm per param group for one microbatch
34.827372081743505
5.092094748477938
9.54448303421763
5.643512426154621
Grad norm per param group for one microbatch
20.419541936196147
4.043421587164862
6.534814305507438
3.9296762302415327
Grad norm per param group for one microbatch
14.3372038939798
3.5172644207149752
5.114890217368892
3.218383441188638
Grad norm per param group for one microbatch
8.815697298068871
2.4120750635601813
4.49108481966452
2.6923720846038743
Grad norm per param group for one microbatch
9.810322306850983
2.467899339658585
4.23555518206341
2.662661288902467
Grad norm per param group for one microbatch
11.593679240225281
3.1432103264022624
5.845512729469833
3.7826831387010786
cpu
[0.008 0.434 0.011 0.081 0.041 0.113 0.048 0.066 0.114 0.983 0.526 0.035
 0.35  0.208 0.255 0.187 0.242 0.424 0.027 0.018 0.033 0.069 0.051 0.435
 0.047 0.038 0.181 0.832 0.275 0.282 0.136 0.167 0.24  0.092 0.106 0.167
 0.133 0.022 0.137 0.064 0.108 0.179 0.02  0.117 0.297 0.156 0.044 0.11
 0.053 0.09  0.118 0.062 0.036 0.119 0.065 0.021 0.033 0.029 0.055 0.094
 0.061 0.013 0.096 0.145 0.055 0.158 0.089 0.387 0.147 0.157 0.051 1.051
 0.143 0.037 0.25  0.089 0.08  0.254 0.669 0.183 0.567 0.085 0.024 0.047
 0.055 0.043 0.086 0.071 0.006 0.015]
[[0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 1.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]]
[0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
aucroc, aucpr (0.8765432098765432, 0.7882441709077999)
Objective function 8.15 = squared loss an data 7.32 + 0.5*rho*h**2 0.130695 + alpha*h 0.147325 + L2reg 0.51 + L1reg 0.04 ; SHD = 6 ; DAG True
Proportion of microbatches that were clipped  [1.0, 0.9976973161823091, 0.49658567571859613, 0.7830713037954582]
iteration 2 in inner loop, alpha 28.815961778091786 rho 10000.0 h 0.005112621694330244
cpu
[0.008 0.434 0.011 0.081 0.041 0.113 0.048 0.066 0.114 0.983 0.526 0.035
 0.35  0.208 0.255 0.187 0.242 0.424 0.027 0.018 0.033 0.069 0.051 0.435
 0.047 0.038 0.181 0.832 0.275 0.282 0.136 0.167 0.24  0.092 0.106 0.167
 0.133 0.022 0.137 0.064 0.108 0.179 0.02  0.117 0.297 0.156 0.044 0.11
 0.053 0.09  0.118 0.062 0.036 0.119 0.065 0.021 0.033 0.029 0.055 0.094
 0.061 0.013 0.096 0.145 0.055 0.158 0.089 0.387 0.147 0.157 0.051 1.051
 0.143 0.037 0.25  0.089 0.08  0.254 0.669 0.183 0.567 0.085 0.024 0.047
 0.055 0.043 0.086 0.071 0.006 0.015]
[[0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 1.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]]
[0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
aucroc, aucpr (0.8765432098765432, 0.7882441709077999)
Objective function 9.32 = squared loss an data 7.32 + 0.5*rho*h**2 1.306945 + alpha*h 0.147325 + L2reg 0.51 + L1reg 0.04 ; SHD = 6 ; DAG True
Grad norm per param group for one microbatch
33.527708315522275
3.4980272884616905
7.414368400433615
4.6707520760102375
Grad norm per param group for one microbatch
17.631086923173395
3.393141724524278
7.378634766049526
4.477010647596367
Grad norm per param group for one microbatch
14.424020363084649
2.861067280565974
5.270368486233503
3.178748773150248
Grad norm per param group for one microbatch
13.702395052308717
2.578099824558235
4.61542875000522
2.8621800531311488
Grad norm per param group for one microbatch
17.19353473629097
3.2387541251747285
6.990388056265617
4.107260032684021
Grad norm per param group for one microbatch
13.157010710716593
3.238044475310299
6.140231706439763
3.6469751399292702
Grad norm per param group for one microbatch
14.451965864462048
2.360947620786035
5.312676772157261
3.224998608314555
Grad norm per param group for one microbatch
10.143676502050962
1.7803661563128808
4.646725423273928
2.964189535702425
cpu
[0.005 0.542 0.006 0.118 0.109 0.245 0.023 0.037 0.209 1.025 0.443 0.033
 0.32  0.328 0.223 0.095 0.213 0.669 0.01  0.01  0.012 0.111 0.034 0.449
 0.045 0.038 0.166 0.909 0.189 0.469 0.229 0.135 0.506 0.122 0.163 0.329
 0.046 0.019 0.04  0.025 0.1   0.238 0.01  0.116 0.455 0.029 0.019 0.097
 0.038 0.055 0.249 0.023 0.079 0.111 0.017 0.017 0.015 0.007 0.023 0.027
 0.012 0.012 0.072 0.262 0.07  0.086 0.072 0.428 0.274 0.234 0.145 1.113
 0.128 0.019 0.151 0.042 0.069 0.065 0.729 0.03  0.727 0.033 0.009 0.032
 0.019 0.014 0.05  0.092 0.002 0.005]
[[0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 1.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]]
[0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
aucroc, aucpr (0.8779149519890261, 0.7729685773164034)
Objective function 8.17 = squared loss an data 7.49 + 0.5*rho*h**2 0.138104 + alpha*h 0.047891 + L2reg 0.45 + L1reg 0.04 ; SHD = 10 ; DAG True
Proportion of microbatches that were clipped  [1.0, 0.9943452621374909, 0.5023830680992003, 0.7940867598352048]
iteration 3 in inner loop, alpha 28.815961778091786 rho 100000.0 h 0.0016619483418214287
iteration 4 in outer loop, alpha = 195.01079596023465, rho = 100000.0, h = 0.0016619483418214287
cpu
cpu
[0.005 0.542 0.006 0.118 0.109 0.245 0.023 0.037 0.209 1.025 0.443 0.033
 0.32  0.328 0.223 0.095 0.213 0.669 0.01  0.01  0.012 0.111 0.034 0.449
 0.045 0.038 0.166 0.909 0.189 0.469 0.229 0.135 0.506 0.122 0.163 0.329
 0.046 0.019 0.04  0.025 0.1   0.238 0.01  0.116 0.455 0.029 0.019 0.097
 0.038 0.055 0.249 0.023 0.079 0.111 0.017 0.017 0.015 0.007 0.023 0.027
 0.012 0.012 0.072 0.262 0.07  0.086 0.072 0.428 0.274 0.234 0.145 1.113
 0.128 0.019 0.151 0.042 0.069 0.065 0.729 0.03  0.727 0.033 0.009 0.032
 0.019 0.014 0.05  0.092 0.002 0.005]
[[0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 1.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]]
[0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
aucroc, aucpr (0.8779149519890261, 0.7729685773164034)
Objective function 8.44 = squared loss an data 7.49 + 0.5*rho*h**2 0.138104 + alpha*h 0.324098 + L2reg 0.45 + L1reg 0.04 ; SHD = 10 ; DAG True
Grad norm per param group for one microbatch
31.602205200431964
2.089064302657881
4.263504659608142
2.5293701534619335
Grad norm per param group for one microbatch
22.92071756578102
1.7827175597334908
5.383675430093649
3.3397866728807903
Grad norm per param group for one microbatch
25.084664573815033
2.054819121721249
6.692863575203643
3.9895281250404713
Grad norm per param group for one microbatch
10.805066149081917
1.6204905670320777
3.8851105257491794
2.4846963126336328
Grad norm per param group for one microbatch
20.532667714058537
3.5594609520531946
7.2220670233107125
4.40835820787691
Grad norm per param group for one microbatch
16.898148395005883
2.3815394532466647
5.819855859814191
3.517239809318951
Grad norm per param group for one microbatch
13.360507925137458
1.9237135139902488
4.779678423630049
2.972960281488164
Grad norm per param group for one microbatch
12.537538533735683
1.9469182233167386
4.6566187048214145
2.9424566488991615
Grad norm per param group for one microbatch
14.590243666037761
2.2531530974085037
5.91728195786278
3.8233975215061964
Grad norm per param group for one microbatch
15.859388991120603
2.3698362057660085
7.03281563143802
4.234233882926494
Grad norm per param group for one microbatch
13.797121230371483
2.2305871499094136
4.955019187235416
3.0712659352122595
Grad norm per param group for one microbatch
19.63444577711319
3.289383234769348
7.409197418205703
4.567376965279194
Grad norm per param group for one microbatch
14.524735971311479
2.0670263464272645
5.715150715838426
3.4108158522618908
Grad norm per param group for one microbatch
16.20194606860619
3.0066313664472197
8.488653847820975
5.017729082409314
cpu
[0.002 0.526 0.005 0.08  0.124 0.204 0.02  0.03  0.161 1.286 0.501 0.043
 0.249 0.455 0.499 0.056 0.16  0.618 0.014 0.003 0.01  0.098 0.109 0.468
 0.022 0.016 0.075 1.192 0.124 0.596 0.386 0.337 0.387 0.07  0.199 0.374
 0.057 0.023 0.074 0.01  0.257 0.086 0.01  0.073 0.499 0.039 0.014 0.045
 0.022 0.023 0.085 0.02  0.062 0.161 0.028 0.009 0.01  0.014 0.054 0.058
 0.018 0.006 0.119 0.272 0.081 0.105 0.072 0.45  0.278 0.29  0.1   1.333
 0.168 0.042 0.292 0.038 0.061 0.099 0.716 0.053 0.686 0.034 0.007 0.047
 0.016 0.012 0.027 0.044 0.004 0.006]
[[0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 1.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]]
[0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
aucroc, aucpr (0.8847736625514403, 0.7720797720797721)
Objective function 8.23 = squared loss an data 7.39 + 0.5*rho*h**2 0.098698 + alpha*h 0.273985 + L2reg 0.43 + L1reg 0.04 ; SHD = 10 ; DAG True
Proportion of microbatches that were clipped  [1.0, 0.9905980880145374, 0.48866240025282454, 0.785731215927945]
iteration 1 in inner loop, alpha 195.01079596023465 rho 100000.0 h 0.0014049751131857136
iteration 5 in outer loop, alpha = 1599.9859091459482, rho = 1000000.0, h = 0.0014049751131857136
Threshold 0.3
[[0.003 0.002 0.526 0.005 0.08  0.124 0.204 0.02  0.03  0.161]
 [1.286 0.002 0.501 0.043 0.249 0.455 0.499 0.056 0.16  0.618]
 [0.014 0.003 0.005 0.01  0.098 0.109 0.468 0.022 0.016 0.075]
 [1.192 0.124 0.596 0.005 0.386 0.337 0.387 0.07  0.199 0.374]
 [0.057 0.023 0.074 0.01  0.003 0.257 0.086 0.01  0.073 0.499]
 [0.039 0.014 0.045 0.022 0.023 0.003 0.085 0.02  0.062 0.161]
 [0.028 0.009 0.01  0.014 0.054 0.058 0.007 0.018 0.006 0.119]
 [0.272 0.081 0.105 0.072 0.45  0.278 0.29  0.003 0.1   1.333]
 [0.168 0.042 0.292 0.038 0.061 0.099 0.716 0.053 0.004 0.686]
 [0.034 0.007 0.047 0.016 0.012 0.027 0.044 0.004 0.006 0.003]]
[[0.    0.    0.526 0.    0.    0.    0.    0.    0.    0.   ]
 [1.286 0.    0.501 0.    0.    0.455 0.499 0.    0.    0.618]
 [0.    0.    0.    0.    0.    0.    0.468 0.    0.    0.   ]
 [1.192 0.    0.596 0.    0.386 0.337 0.387 0.    0.    0.374]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.499]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.45  0.    0.    0.    0.    1.333]
 [0.    0.    0.    0.    0.    0.    0.716 0.    0.    0.686]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]]
{'fdr': 0.5555555555555556, 'tpr': 0.8888888888888888, 'fpr': 0.2777777777777778, 'f1': 0.5925925925925926, 'shd': 10, 'npred': 18, 'ntrue': 9}
[0.002 0.526 0.005 0.08  0.124 0.204 0.02  0.03  0.161 1.286 0.501 0.043
 0.249 0.455 0.499 0.056 0.16  0.618 0.014 0.003 0.01  0.098 0.109 0.468
 0.022 0.016 0.075 1.192 0.124 0.596 0.386 0.337 0.387 0.07  0.199 0.374
 0.057 0.023 0.074 0.01  0.257 0.086 0.01  0.073 0.499 0.039 0.014 0.045
 0.022 0.023 0.085 0.02  0.062 0.161 0.028 0.009 0.01  0.014 0.054 0.058
 0.018 0.006 0.119 0.272 0.081 0.105 0.072 0.45  0.278 0.29  0.1   1.333
 0.168 0.042 0.292 0.038 0.061 0.099 0.716 0.053 0.686 0.034 0.007 0.047
 0.016 0.012 0.027 0.044 0.004 0.006]
[[0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 1.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]]
[0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
aucroc, aucpr (0.8847736625514403, 0.7720797720797721)
Iterations 2500
Achieves (13.610683049707138, 1e-05)-DP
