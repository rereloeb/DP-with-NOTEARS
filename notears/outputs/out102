samples  5000  graph  10 20 ER mim  minibatch size  100  noise  0.8  minibatches per NN training  63 quantile adaptive clipping
cuda
cuda
iteration 1 in inner loop,alpha 0.0 rho 1.0 h 1.2478837018637314
iteration 1 in outer loop, alpha = 1.2478837018637314, rho = 1.0, h = 1.2478837018637314
cuda
iteration 1 in inner loop,alpha 1.2478837018637314 rho 1.0 h 0.8090069430803162
iteration 2 in inner loop,alpha 1.2478837018637314 rho 10.0 h 0.33059154117724177
iteration 3 in inner loop,alpha 1.2478837018637314 rho 100.0 h 0.08919457479346349
iteration 2 in outer loop, alpha = 10.16734118121008, rho = 100.0, h = 0.08919457479346349
cuda
iteration 1 in inner loop,alpha 10.16734118121008 rho 100.0 h 0.04481073042669337
iteration 2 in inner loop,alpha 10.16734118121008 rho 1000.0 h 0.01468190595974228
iteration 3 in outer loop, alpha = 24.84924714095236, rho = 1000.0, h = 0.01468190595974228
cuda
iteration 1 in inner loop,alpha 24.84924714095236 rho 1000.0 h 0.006955907874850453
iteration 2 in inner loop,alpha 24.84924714095236 rho 10000.0 h 0.0010457936685934754
iteration 4 in outer loop, alpha = 35.30718382688711, rho = 10000.0, h = 0.0010457936685934754
cuda
iteration 1 in inner loop,alpha 35.30718382688711 rho 10000.0 h 0.0006004847146634518
iteration 2 in inner loop,alpha 35.30718382688711 rho 100000.0 h 0.0002591217210365926
iteration 5 in outer loop, alpha = 61.21935593054637, rho = 100000.0, h = 0.0002591217210365926
cuda
iteration 1 in inner loop,alpha 61.21935593054637 rho 100000.0 h 0.0001588684727789058
iteration 6 in outer loop, alpha = 220.0878287094522, rho = 1000000.0, h = 0.0001588684727789058
Threshold 0.3
[[0.005 0.    0.    0.    0.503 0.    0.086 0.001 0.    1.777]
 [2.982 0.004 0.589 0.    0.106 0.003 1.117 0.004 0.    1.032]
 [0.358 0.004 0.005 0.    0.074 0.003 1.22  0.011 0.    0.238]
 [1.874 3.02  1.117 0.    0.001 2.631 0.2   2.693 0.    0.143]
 [0.    0.    0.001 0.    0.004 0.    0.001 0.    0.    0.001]
 [0.428 0.285 0.735 0.    0.025 0.004 0.968 1.042 0.    0.145]
 [0.005 0.001 0.001 0.    0.99  0.001 0.004 0.001 0.    0.015]
 [0.248 0.22  0.019 0.    0.004 0.001 0.217 0.002 0.    0.03 ]
 [0.269 2.084 0.012 0.    1.494 0.074 0.527 0.042 0.    0.047]
 [0.001 0.    0.001 0.    0.898 0.    0.059 0.    0.    0.004]]
[[0.    0.    0.    0.    0.503 0.    0.    0.    0.    1.777]
 [2.982 0.    0.589 0.    0.    0.    1.117 0.    0.    1.032]
 [0.358 0.    0.    0.    0.    0.    1.22  0.    0.    0.   ]
 [1.874 3.02  1.117 0.    0.    2.631 0.    2.693 0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.428 0.    0.735 0.    0.    0.    0.968 1.042 0.    0.   ]
 [0.    0.    0.    0.    0.99  0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    2.084 0.    0.    1.494 0.    0.527 0.    0.    0.   ]
 [0.    0.    0.    0.    0.898 0.    0.    0.    0.    0.   ]]
{'fdr': 0.13636363636363635, 'tpr': 0.95, 'fpr': 0.12, 'f1': 0.9047619047619048, 'shd': 3, 'npred': 22, 'ntrue': 20}
[1.466e-04 1.170e-04 7.057e-06 5.027e-01 2.600e-05 8.630e-02 5.824e-04
 1.558e-06 1.777e+00 2.982e+00 5.886e-01 1.630e-06 1.063e-01 2.673e-03
 1.117e+00 3.685e-03 1.103e-05 1.032e+00 3.584e-01 3.752e-03 7.119e-06
 7.370e-02 2.718e-03 1.220e+00 1.076e-02 4.977e-05 2.377e-01 1.874e+00
 3.020e+00 1.117e+00 1.139e-03 2.631e+00 2.004e-01 2.693e+00 1.972e-04
 1.433e-01 1.438e-04 8.162e-05 6.822e-04 1.436e-06 3.354e-04 1.341e-03
 2.852e-04 1.228e-05 1.416e-03 4.278e-01 2.850e-01 7.353e-01 9.627e-06
 2.479e-02 9.676e-01 1.042e+00 9.714e-05 1.453e-01 5.408e-03 7.890e-04
 1.360e-03 1.863e-06 9.899e-01 5.773e-04 9.357e-04 2.727e-05 1.485e-02
 2.480e-01 2.197e-01 1.892e-02 4.072e-06 4.253e-03 1.003e-03 2.167e-01
 2.914e-04 3.003e-02 2.694e-01 2.084e+00 1.208e-02 2.853e-04 1.494e+00
 7.410e-02 5.269e-01 4.202e-02 4.692e-02 7.940e-04 1.142e-04 1.097e-03
 9.230e-07 8.976e-01 2.113e-04 5.853e-02 4.187e-04 3.534e-06]
[[0. 0. 0. 0. 1. 0. 0. 0. 0. 1.]
 [1. 0. 1. 0. 0. 0. 1. 0. 0. 1.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [1. 1. 1. 0. 0. 1. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0. 0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 1. 0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]]
[0. 0. 0. 1. 0. 0. 0. 0. 1. 1. 1. 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 1. 1. 1. 0. 1. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0.
 0. 1. 0. 0. 1. 0. 1. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
aucroc, aucpr (0.9685714285714285, 0.9431306939104926)
cuda
noise_multiplier  0.8  noise_multiplier_b  5.0  noise_multiplier_delta  0.802572353905128
cuda
Objective function 188.58 = squared loss an data 11.52 + 0.5*rho*h**2 176.710652 + alpha*h 0.000000 + L2reg 0.19 + L1reg 0.16 ; SHD = 55 ; DAG False
total norm for a microbatch 10.984584637825355 clip 7.148747111052806
total norm for a microbatch 11.099819704361787 clip 6.569689864951721
total norm for a microbatch 9.83981568479412 clip 6.603181080906344
cuda
Objective function 8.11 = squared loss an data 7.47 + 0.5*rho*h**2 0.452338 + alpha*h 0.000000 + L2reg 0.12 + L1reg 0.07 ; SHD = 18 ; DAG False
Proportion of microbatches that were clipped  0.8515811218814556
iteration 1 in inner loop, alpha 0.0 rho 1.0 h 0.9511447913046851
iteration 1 in outer loop, alpha = 0.9511447913046851, rho = 1.0, h = 0.9511447913046851
cuda
noise_multiplier  0.8  noise_multiplier_b  5.0  noise_multiplier_delta  0.802572353905128
cuda
Objective function 9.01 = squared loss an data 7.47 + 0.5*rho*h**2 0.452338 + alpha*h 0.904676 + L2reg 0.12 + L1reg 0.07 ; SHD = 18 ; DAG False
total norm for a microbatch 6.4101950992847785 clip 7.074603634763872
total norm for a microbatch 9.251483352091215 clip 7.050535369660006
total norm for a microbatch 6.501208295474496 clip 7.4369413752153
total norm for a microbatch 11.45620123407467 clip 7.437645882100276
total norm for a microbatch 8.132024401267266 clip 7.437645882100276
cuda
Objective function 7.51 = squared loss an data 6.48 + 0.5*rho*h**2 0.169247 + alpha*h 0.553378 + L2reg 0.24 + L1reg 0.06 ; SHD = 8 ; DAG True
Proportion of microbatches that were clipped  0.8508672394229211
iteration 1 in inner loop, alpha 0.9511447913046851 rho 1.0 h 0.5818021156696496
noise_multiplier  0.8  noise_multiplier_b  5.0  noise_multiplier_delta  0.802572353905128
cuda
Objective function 9.03 = squared loss an data 6.48 + 0.5*rho*h**2 1.692469 + alpha*h 0.553378 + L2reg 0.24 + L1reg 0.06 ; SHD = 8 ; DAG True
total norm for a microbatch 10.08147018129674 clip 2.5540993192966748
total norm for a microbatch 11.731659243300752 clip 3.2992799286752
total norm for a microbatch 4.86229640165741 clip 7.458979916293347
total norm for a microbatch 10.829560722682213 clip 8.067317081818656
total norm for a microbatch 9.378958254563496 clip 8.283294817446428
total norm for a microbatch 9.41436262189706 clip 8.084238568371383
total norm for a microbatch 15.912670595624036 clip 8.755088428559715
total norm for a microbatch 18.870102210044813 clip 8.564184922348844
total norm for a microbatch 14.453182775105937 clip 8.288340087201204
total norm for a microbatch 5.911474575624481 clip 8.38479844548099
cuda
Objective function 7.73 = squared loss an data 6.85 + 0.5*rho*h**2 0.275445 + alpha*h 0.223244 + L2reg 0.33 + L1reg 0.05 ; SHD = 11 ; DAG True
Proportion of microbatches that were clipped  0.8599621092516577
iteration 2 in inner loop, alpha 0.9511447913046851 rho 10.0 h 0.2347105066535935
iteration 2 in outer loop, alpha = 3.29824985784062, rho = 10.0, h = 0.2347105066535935
cuda
noise_multiplier  0.8  noise_multiplier_b  5.0  noise_multiplier_delta  0.802572353905128
cuda
Objective function 8.28 = squared loss an data 6.85 + 0.5*rho*h**2 0.275445 + alpha*h 0.774134 + L2reg 0.33 + L1reg 0.05 ; SHD = 11 ; DAG True
total norm for a microbatch 6.902068129224203 clip 1.420592037411281
total norm for a microbatch 9.29371020638936 clip 2.4308121983620232
total norm for a microbatch 10.887679878317636 clip 4.906045091146857
total norm for a microbatch 13.334982676965323 clip 8.270535524584476
total norm for a microbatch 7.933815186908198 clip 9.150188837708082
total norm for a microbatch 8.966858396519841 clip 8.732340684855558
total norm for a microbatch 15.1703145745413 clip 8.847476859355073
cuda
Objective function 8.06 = squared loss an data 6.97 + 0.5*rho*h**2 0.124636 + alpha*h 0.520738 + L2reg 0.39 + L1reg 0.05 ; SHD = 10 ; DAG True
Proportion of microbatches that were clipped  0.8681181959564541
iteration 1 in inner loop, alpha 3.29824985784062 rho 10.0 h 0.15788323536461135
noise_multiplier  0.8  noise_multiplier_b  5.0  noise_multiplier_delta  0.802572353905128
cuda
Objective function 9.18 = squared loss an data 6.97 + 0.5*rho*h**2 1.246356 + alpha*h 0.520738 + L2reg 0.39 + L1reg 0.05 ; SHD = 10 ; DAG True
total norm for a microbatch 27.14257208216529 clip 1.9264795716616325
total norm for a microbatch 12.021391448984348 clip 2.533516530780312
total norm for a microbatch 6.490405850199279 clip 2.533516530780312
total norm for a microbatch 14.721949345985395 clip 3.312223029831494
total norm for a microbatch 13.197461721161922 clip 9.793956796796191
total norm for a microbatch 9.686977370401857 clip 9.659498951753628
total norm for a microbatch 12.847451394345192 clip 9.694677818891615
cuda
Objective function 8.40 = squared loss an data 7.53 + 0.5*rho*h**2 0.181352 + alpha*h 0.198637 + L2reg 0.44 + L1reg 0.05 ; SHD = 12 ; DAG True
Proportion of microbatches that were clipped  0.8607945294692283
iteration 2 in inner loop, alpha 3.29824985784062 rho 100.0 h 0.060224905311383026
noise_multiplier  0.8  noise_multiplier_b  5.0  noise_multiplier_delta  0.802572353905128
cuda
Objective function 10.03 = squared loss an data 7.53 + 0.5*rho*h**2 1.813520 + alpha*h 0.198637 + L2reg 0.44 + L1reg 0.05 ; SHD = 12 ; DAG True
total norm for a microbatch 23.266488748554153 clip 1.5682079317343711
total norm for a microbatch 11.128478473213853 clip 5.229961667599415
total norm for a microbatch 12.866654559000988 clip 7.4007011351887675
total norm for a microbatch 14.508393323329441 clip 10.602925163706724
cuda
Objective function 8.75 = squared loss an data 8.02 + 0.5*rho*h**2 0.176154 + alpha*h 0.061908 + L2reg 0.45 + L1reg 0.04 ; SHD = 10 ; DAG True
Proportion of microbatches that were clipped  0.8654336734693877
iteration 3 in inner loop, alpha 3.29824985784062 rho 1000.0 h 0.018769867170181698
iteration 3 in outer loop, alpha = 22.068117028022318, rho = 1000.0, h = 0.018769867170181698
cuda
noise_multiplier  0.8  noise_multiplier_b  5.0  noise_multiplier_delta  0.802572353905128
cuda
Objective function 9.10 = squared loss an data 8.02 + 0.5*rho*h**2 0.176154 + alpha*h 0.414216 + L2reg 0.45 + L1reg 0.04 ; SHD = 10 ; DAG True
total norm for a microbatch 14.41039792663869 clip 1.7519340349905836
total norm for a microbatch 13.519187195275768 clip 2.310318181147265
total norm for a microbatch 19.48795123676696 clip 10.370940611348232
total norm for a microbatch 11.882862656364935 clip 10.519849435033148
total norm for a microbatch 18.727842841618443 clip 11.260302519545302
cuda
Objective function 8.96 = squared loss an data 8.16 + 0.5*rho*h**2 0.062493 + alpha*h 0.246715 + L2reg 0.44 + L1reg 0.04 ; SHD = 14 ; DAG True
Proportion of microbatches that were clipped  0.8640839386602098
iteration 1 in inner loop, alpha 22.068117028022318 rho 1000.0 h 0.011179703446103417
noise_multiplier  0.8  noise_multiplier_b  5.0  noise_multiplier_delta  0.802572353905128
cuda
Objective function 9.52 = squared loss an data 8.16 + 0.5*rho*h**2 0.624929 + alpha*h 0.246715 + L2reg 0.44 + L1reg 0.04 ; SHD = 14 ; DAG True
total norm for a microbatch 30.175391311216973 clip 1.0866776598045196
total norm for a microbatch 20.905216885923426 clip 3.2404830344505133
total norm for a microbatch 16.719543328466084 clip 3.893353301069285
total norm for a microbatch 9.244817958440642 clip 4.630010404307833
total norm for a microbatch 25.672254615915488 clip 5.510329600428125
total norm for a microbatch 13.301298904764872 clip 6.019363839100308
total norm for a microbatch 27.439458463519973 clip 10.99110413940936
total norm for a microbatch 14.537444005137344 clip 11.19919308787148
total norm for a microbatch 23.833916443998074 clip 10.557430576740703
cuda
Objective function 9.02 = squared loss an data 8.37 + 0.5*rho*h**2 0.079639 + alpha*h 0.088073 + L2reg 0.44 + L1reg 0.04 ; SHD = 9 ; DAG True
Proportion of microbatches that were clipped  0.8685968819599109
iteration 2 in inner loop, alpha 22.068117028022318 rho 10000.0 h 0.003990970165133945
iteration 4 in outer loop, alpha = 61.97781867936176, rho = 10000.0, h = 0.003990970165133945
cuda
noise_multiplier  0.8  noise_multiplier_b  5.0  noise_multiplier_delta  0.802572353905128
cuda
Objective function 9.18 = squared loss an data 8.37 + 0.5*rho*h**2 0.079639 + alpha*h 0.247352 + L2reg 0.44 + L1reg 0.04 ; SHD = 9 ; DAG True
total norm for a microbatch 10.591622742847237 clip 3.8382812381314024
total norm for a microbatch 9.900170977568864 clip 3.8382812381314024
total norm for a microbatch 27.375973995269202 clip 7.757927169622726
total norm for a microbatch 10.475762372949411 clip 9.731846818226835
total norm for a microbatch 14.22270733235986 clip 11.586679999944629
total norm for a microbatch 16.614588920727417 clip 11.737682332997457
total norm for a microbatch 20.998026705431677 clip 11.070772851383108
cuda
Objective function 9.06 = squared loss an data 8.39 + 0.5*rho*h**2 0.032752 + alpha*h 0.158624 + L2reg 0.43 + L1reg 0.04 ; SHD = 9 ; DAG True
Proportion of microbatches that were clipped  0.8677188415229418
iteration 1 in inner loop, alpha 61.97781867936176 rho 10000.0 h 0.0025593748259975513
noise_multiplier  0.8  noise_multiplier_b  5.0  noise_multiplier_delta  0.802572353905128
cuda
Objective function 9.35 = squared loss an data 8.39 + 0.5*rho*h**2 0.327520 + alpha*h 0.158624 + L2reg 0.43 + L1reg 0.04 ; SHD = 9 ; DAG True
total norm for a microbatch 81.09780176559003 clip 1.4239194868742164
total norm for a microbatch 21.382503630678286 clip 4.528193354502542
total norm for a microbatch 24.059046648660498 clip 12.855388033416055
cuda
Objective function 9.07 = squared loss an data 8.45 + 0.5*rho*h**2 0.062052 + alpha*h 0.069044 + L2reg 0.44 + L1reg 0.05 ; SHD = 9 ; DAG True
Proportion of microbatches that were clipped  0.8720948870011219
iteration 2 in inner loop, alpha 61.97781867936176 rho 100000.0 h 0.0011140169256567134
iteration 5 in outer loop, alpha = 1175.994744336075, rho = 1000000.0, h = 0.0011140169256567134
Threshold 0.3
[[0.004 0.016 0.101 0.004 0.328 0.096 0.104 0.043 0.011 0.756]
 [0.31  0.005 0.5   0.008 0.166 0.118 0.418 0.037 0.002 0.287]
 [0.034 0.01  0.005 0.006 0.162 0.551 0.413 0.015 0.009 0.073]
 [0.762 0.803 0.532 0.004 0.261 1.771 0.462 0.877 0.052 0.376]
 [0.008 0.029 0.018 0.011 0.008 0.03  0.014 0.037 0.007 0.019]
 [0.05  0.013 0.009 0.002 0.084 0.005 0.379 0.009 0.01  0.055]
 [0.037 0.011 0.006 0.004 0.458 0.011 0.007 0.016 0.007 0.035]
 [0.086 0.175 0.316 0.005 0.111 0.706 0.304 0.003 0.035 0.072]
 [0.341 1.193 0.314 0.051 0.745 0.231 0.39  0.126 0.003 0.366]
 [0.006 0.017 0.036 0.008 0.311 0.092 0.145 0.053 0.009 0.004]]
[[0.    0.    0.    0.    0.328 0.    0.    0.    0.    0.756]
 [0.31  0.    0.5   0.    0.    0.    0.418 0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.551 0.413 0.    0.    0.   ]
 [0.762 0.803 0.532 0.    0.    1.771 0.462 0.877 0.    0.376]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.379 0.    0.    0.   ]
 [0.    0.    0.    0.    0.458 0.    0.    0.    0.    0.   ]
 [0.    0.    0.316 0.    0.    0.706 0.304 0.    0.    0.   ]
 [0.341 1.193 0.314 0.    0.745 0.    0.39  0.    0.    0.366]
 [0.    0.    0.    0.    0.311 0.    0.    0.    0.    0.   ]]
{'fdr': 0.3076923076923077, 'tpr': 0.9, 'fpr': 0.32, 'f1': 0.7826086956521738, 'shd': 9, 'npred': 26, 'ntrue': 20}
[1.574e-02 1.014e-01 4.147e-03 3.283e-01 9.623e-02 1.037e-01 4.292e-02
 1.126e-02 7.560e-01 3.099e-01 4.996e-01 8.067e-03 1.660e-01 1.178e-01
 4.175e-01 3.685e-02 2.039e-03 2.867e-01 3.353e-02 9.832e-03 5.953e-03
 1.622e-01 5.509e-01 4.132e-01 1.495e-02 9.350e-03 7.325e-02 7.624e-01
 8.030e-01 5.317e-01 2.613e-01 1.771e+00 4.623e-01 8.766e-01 5.182e-02
 3.757e-01 7.845e-03 2.878e-02 1.763e-02 1.055e-02 2.970e-02 1.404e-02
 3.691e-02 6.994e-03 1.947e-02 4.996e-02 1.342e-02 8.712e-03 1.665e-03
 8.448e-02 3.792e-01 8.517e-03 1.049e-02 5.490e-02 3.739e-02 1.051e-02
 6.102e-03 4.448e-03 4.580e-01 1.134e-02 1.592e-02 6.716e-03 3.468e-02
 8.638e-02 1.746e-01 3.157e-01 4.504e-03 1.113e-01 7.063e-01 3.037e-01
 3.545e-02 7.171e-02 3.412e-01 1.193e+00 3.140e-01 5.060e-02 7.446e-01
 2.310e-01 3.895e-01 1.256e-01 3.664e-01 6.246e-03 1.693e-02 3.635e-02
 8.446e-03 3.106e-01 9.249e-02 1.445e-01 5.270e-02 9.022e-03]
[[0. 0. 0. 0. 1. 0. 0. 0. 0. 1.]
 [1. 0. 1. 0. 0. 0. 1. 0. 0. 1.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [1. 1. 1. 0. 0. 1. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0. 0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 1. 0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]]
[0. 0. 0. 1. 0. 0. 0. 0. 1. 1. 1. 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 1. 1. 1. 0. 1. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0.
 0. 1. 0. 0. 1. 0. 1. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
aucroc, aucpr (0.932142857142857, 0.8646753456954697)
Iterations 630
Achieves (6.682218196030888, 1e-05)-DP
