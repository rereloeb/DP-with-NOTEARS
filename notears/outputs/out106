samples  5000  graph  10 20 ER mim  minibatch size  100  noise  1.0  minibatches per NN training  63 quantile adaptive clipping
cuda
cuda
iteration 1 in inner loop,alpha 0.0 rho 1.0 h 1.2478778610411254
iteration 1 in outer loop, alpha = 1.2478778610411254, rho = 1.0, h = 1.2478778610411254
cuda
iteration 1 in inner loop,alpha 1.2478778610411254 rho 1.0 h 0.8084888745241194
iteration 2 in inner loop,alpha 1.2478778610411254 rho 10.0 h 0.33057833071344156
iteration 3 in inner loop,alpha 1.2478778610411254 rho 100.0 h 0.08917599829296385
iteration 2 in outer loop, alpha = 10.16547769033751, rho = 100.0, h = 0.08917599829296385
cuda
iteration 1 in inner loop,alpha 10.16547769033751 rho 100.0 h 0.04477612329798397
iteration 2 in inner loop,alpha 10.16547769033751 rho 1000.0 h 0.01475614729775998
iteration 3 in outer loop, alpha = 24.92162498809749, rho = 1000.0, h = 0.01475614729775998
cuda
iteration 1 in inner loop,alpha 24.92162498809749 rho 1000.0 h 0.006747604373583016
iteration 2 in inner loop,alpha 24.92162498809749 rho 10000.0 h 0.0009845269108446075
iteration 4 in outer loop, alpha = 34.76689409654357, rho = 10000.0, h = 0.0009845269108446075
cuda
iteration 1 in inner loop,alpha 34.76689409654357 rho 10000.0 h 0.0006367139972880409
iteration 2 in inner loop,alpha 34.76689409654357 rho 100000.0 h 0.0002659665090032348
iteration 5 in outer loop, alpha = 300.7334030997784, rho = 1000000.0, h = 0.0002659665090032348
Threshold 0.3
[[0.006 0.    0.    0.    0.497 0.    0.08  0.    0.    1.78 ]
 [2.764 0.006 0.577 0.    0.104 0.003 1.103 0.004 0.    0.993]
 [0.294 0.005 0.007 0.    0.075 0.004 1.208 0.011 0.    0.21 ]
 [1.782 2.985 1.099 0.    0.008 2.619 0.198 2.692 0.003 0.151]
 [0.    0.    0.001 0.    0.005 0.    0.002 0.    0.    0.002]
 [0.388 0.281 0.722 0.    0.043 0.005 0.959 1.04  0.004 0.132]
 [0.009 0.001 0.002 0.    0.983 0.001 0.005 0.001 0.    0.019]
 [0.247 0.252 0.02  0.    0.007 0.001 0.236 0.002 0.008 0.036]
 [0.247 2.116 0.013 0.008 1.483 0.074 0.527 0.043 0.    0.041]
 [0.001 0.    0.002 0.    0.89  0.    0.055 0.001 0.    0.005]]
[[0.    0.    0.    0.    0.497 0.    0.    0.    0.    1.78 ]
 [2.764 0.    0.577 0.    0.    0.    1.103 0.    0.    0.993]
 [0.    0.    0.    0.    0.    0.    1.208 0.    0.    0.   ]
 [1.782 2.985 1.099 0.    0.    2.619 0.    2.692 0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.388 0.    0.722 0.    0.    0.    0.959 1.04  0.    0.   ]
 [0.    0.    0.    0.    0.983 0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    2.116 0.    0.    1.483 0.    0.527 0.    0.    0.   ]
 [0.    0.    0.    0.    0.89  0.    0.    0.    0.    0.   ]]
{'fdr': 0.09523809523809523, 'tpr': 0.95, 'fpr': 0.08, 'f1': 0.9268292682926829, 'shd': 2, 'npred': 21, 'ntrue': 20}
[2.171e-04 2.542e-04 2.300e-05 4.968e-01 3.873e-04 7.987e-02 4.451e-04
 4.830e-06 1.780e+00 2.764e+00 5.767e-01 7.075e-06 1.041e-01 3.219e-03
 1.103e+00 3.582e-03 3.383e-05 9.934e-01 2.938e-01 5.236e-03 3.577e-05
 7.537e-02 3.724e-03 1.208e+00 1.112e-02 1.032e-04 2.100e-01 1.782e+00
 2.985e+00 1.099e+00 7.782e-03 2.619e+00 1.983e-01 2.692e+00 3.356e-03
 1.509e-01 1.818e-04 1.041e-04 9.311e-04 5.426e-06 4.511e-04 1.769e-03
 4.062e-04 1.140e-05 1.845e-03 3.883e-01 2.813e-01 7.218e-01 1.448e-05
 4.333e-02 9.593e-01 1.040e+00 4.466e-03 1.322e-01 8.833e-03 1.071e-03
 1.816e-03 1.383e-05 9.827e-01 7.567e-04 9.749e-04 7.131e-05 1.913e-02
 2.470e-01 2.522e-01 2.039e-02 5.639e-06 6.898e-03 1.284e-03 2.361e-01
 7.577e-03 3.593e-02 2.469e-01 2.116e+00 1.302e-02 7.793e-03 1.483e+00
 7.386e-02 5.273e-01 4.265e-02 4.053e-02 9.944e-04 1.665e-04 2.056e-03
 6.416e-06 8.901e-01 3.087e-04 5.540e-02 6.418e-04 8.262e-06]
[[0. 0. 0. 0. 1. 0. 0. 0. 0. 1.]
 [1. 0. 1. 0. 0. 0. 1. 0. 0. 1.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [1. 1. 1. 0. 0. 1. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0. 0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 1. 0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]]
[0. 0. 0. 1. 0. 0. 0. 0. 1. 1. 1. 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 1. 1. 1. 0. 1. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0.
 0. 1. 0. 0. 1. 0. 1. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
aucroc, aucpr (0.9657142857142857, 0.9419402177200167)
cuda
noise_multiplier  1.0  noise_multiplier_b  5.0  noise_multiplier_delta  1.005037815259212
cuda
Objective function 188.58 = squared loss an data 11.52 + 0.5*rho*h**2 176.710652 + alpha*h 0.000000 + L2reg 0.19 + L1reg 0.16 ; SHD = 55 ; DAG False
total norm for a microbatch 10.977065762332632 clip 7.177399365803522
total norm for a microbatch 11.307905016871231 clip 6.622458175683572
total norm for a microbatch 9.890372568389997 clip 6.6296467011830424
cuda
Objective function 8.33 = squared loss an data 7.71 + 0.5*rho*h**2 0.448230 + alpha*h 0.000000 + L2reg 0.11 + L1reg 0.07 ; SHD = 22 ; DAG False
Proportion of microbatches that were clipped  0.8518989353249642
iteration 1 in inner loop, alpha 0.0 rho 1.0 h 0.9468162028084102
iteration 1 in outer loop, alpha = 0.9468162028084102, rho = 1.0, h = 0.9468162028084102
cuda
noise_multiplier  1.0  noise_multiplier_b  5.0  noise_multiplier_delta  1.005037815259212
cuda
Objective function 9.23 = squared loss an data 7.71 + 0.5*rho*h**2 0.448230 + alpha*h 0.896461 + L2reg 0.11 + L1reg 0.07 ; SHD = 22 ; DAG False
total norm for a microbatch 6.49223652564292 clip 7.018232590508033
total norm for a microbatch 9.329309041810289 clip 7.0787939907025805
total norm for a microbatch 6.456944762031069 clip 7.348231403062744
total norm for a microbatch 11.414941507897863 clip 7.407954720483318
total norm for a microbatch 7.83045611902795 clip 7.407954720483318
cuda
Objective function 7.71 = squared loss an data 6.69 + 0.5*rho*h**2 0.175379 + alpha*h 0.560751 + L2reg 0.22 + L1reg 0.06 ; SHD = 12 ; DAG False
Proportion of microbatches that were clipped  0.8505430377694926
iteration 1 in inner loop, alpha 0.9468162028084102 rho 1.0 h 0.5922487400010841
noise_multiplier  1.0  noise_multiplier_b  5.0  noise_multiplier_delta  1.005037815259212
cuda
Objective function 9.29 = squared loss an data 6.69 + 0.5*rho*h**2 1.753793 + alpha*h 0.560751 + L2reg 0.22 + L1reg 0.06 ; SHD = 12 ; DAG False
total norm for a microbatch 9.829726082511321 clip 2.5540993192966748
total norm for a microbatch 11.534537765426785 clip 3.2992799286752
total norm for a microbatch 4.871412000149802 clip 7.399546129091667
total norm for a microbatch 10.575794730648482 clip 7.9710878072328715
total norm for a microbatch 9.408924019069605 clip 8.184489298414649
total norm for a microbatch 9.255215052805328 clip 7.924159919412937
total norm for a microbatch 15.449306852611286 clip 8.513346138247682
total norm for a microbatch 18.547659657906724 clip 8.327713789626662
total norm for a microbatch 13.861022365206352 clip 8.091787984748166
total norm for a microbatch 5.781291922228282 clip 8.1532804663589
cuda
Objective function 7.88 = squared loss an data 7.03 + 0.5*rho*h**2 0.274998 + alpha*h 0.222047 + L2reg 0.30 + L1reg 0.06 ; SHD = 12 ; DAG True
Proportion of microbatches that were clipped  0.8586990843069151
iteration 2 in inner loop, alpha 0.9468162028084102 rho 10.0 h 0.23451992472864447
iteration 2 in outer loop, alpha = 3.292015450094855, rho = 10.0, h = 0.23451992472864447
cuda
noise_multiplier  1.0  noise_multiplier_b  5.0  noise_multiplier_delta  1.005037815259212
cuda
Objective function 8.43 = squared loss an data 7.03 + 0.5*rho*h**2 0.274998 + alpha*h 0.772043 + L2reg 0.30 + L1reg 0.06 ; SHD = 12 ; DAG True
total norm for a microbatch 6.730744483062308 clip 1.420592037411281
total norm for a microbatch 9.029191888696221 clip 2.4308121983620232
total norm for a microbatch 10.4582841010864 clip 4.906045091146857
total norm for a microbatch 12.853447055756066 clip 8.139259961231359
total norm for a microbatch 7.6811003156913 clip 8.969002959227751
total norm for a microbatch 8.867308735802398 clip 8.559428754158027
total norm for a microbatch 14.654644295284447 clip 8.707043690848268
cuda
Objective function 8.20 = squared loss an data 7.14 + 0.5*rho*h**2 0.124348 + alpha*h 0.519153 + L2reg 0.36 + L1reg 0.05 ; SHD = 9 ; DAG True
Proportion of microbatches that were clipped  0.8674961119751167
iteration 1 in inner loop, alpha 3.292015450094855 rho 10.0 h 0.15770072339073593
noise_multiplier  1.0  noise_multiplier_b  5.0  noise_multiplier_delta  1.005037815259212
cuda
Objective function 9.32 = squared loss an data 7.14 + 0.5*rho*h**2 1.243476 + alpha*h 0.519153 + L2reg 0.36 + L1reg 0.05 ; SHD = 9 ; DAG True
total norm for a microbatch 26.280179082936616 clip 1.9264795716616325
total norm for a microbatch 11.714844729201443 clip 2.533516530780312
total norm for a microbatch 6.4088706779865285 clip 2.533516530780312
total norm for a microbatch 14.279510071291334 clip 3.312223029831494
total norm for a microbatch 12.997042147474529 clip 9.600023458643307
total norm for a microbatch 9.536261500003393 clip 9.39278440981407
total norm for a microbatch 12.482212632469073 clip 9.426991930976294
cuda
Objective function 8.52 = squared loss an data 7.69 + 0.5*rho*h**2 0.180050 + alpha*h 0.197548 + L2reg 0.40 + L1reg 0.05 ; SHD = 12 ; DAG True
Proportion of microbatches that were clipped  0.8594920221426245
iteration 2 in inner loop, alpha 3.292015450094855 rho 100.0 h 0.06000829304649358
noise_multiplier  1.0  noise_multiplier_b  5.0  noise_multiplier_delta  1.005037815259212
cuda
Objective function 10.14 = squared loss an data 7.69 + 0.5*rho*h**2 1.800498 + alpha*h 0.197548 + L2reg 0.40 + L1reg 0.05 ; SHD = 12 ; DAG True
total norm for a microbatch 22.633559650540658 clip 1.5682079317343711
total norm for a microbatch 10.794508603671737 clip 5.229961667599415
total norm for a microbatch 12.513443272007178 clip 7.3417317182781225
total norm for a microbatch 13.896091175682646 clip 10.269002810343121
cuda
Objective function 8.81 = squared loss an data 8.11 + 0.5*rho*h**2 0.181073 + alpha*h 0.062648 + L2reg 0.41 + L1reg 0.04 ; SHD = 9 ; DAG True
Proportion of microbatches that were clipped  0.8646364795918368
iteration 3 in inner loop, alpha 3.292015450094855 rho 1000.0 h 0.019030137925586388
iteration 3 in outer loop, alpha = 22.322153375681243, rho = 1000.0, h = 0.019030137925586388
cuda
noise_multiplier  1.0  noise_multiplier_b  5.0  noise_multiplier_delta  1.005037815259212
cuda
Objective function 9.17 = squared loss an data 8.11 + 0.5*rho*h**2 0.181073 + alpha*h 0.424794 + L2reg 0.41 + L1reg 0.04 ; SHD = 9 ; DAG True
total norm for a microbatch 13.820128659830782 clip 1.7519340349905836
total norm for a microbatch 13.147635215493963 clip 2.310318181147265
total norm for a microbatch 18.734798879870645 clip 10.247233053844205
total norm for a microbatch 11.584698378891526 clip 10.352871231884277
total norm for a microbatch 18.182898252098703 clip 11.08157134157189
cuda
Objective function 9.01 = squared loss an data 8.23 + 0.5*rho*h**2 0.067064 + alpha*h 0.258520 + L2reg 0.41 + L1reg 0.05 ; SHD = 15 ; DAG True
Proportion of microbatches that were clipped  0.8632768361581921
iteration 1 in inner loop, alpha 22.322153375681243 rho 1000.0 h 0.011581328215337194
noise_multiplier  1.0  noise_multiplier_b  5.0  noise_multiplier_delta  1.005037815259212
cuda
Objective function 9.61 = squared loss an data 8.23 + 0.5*rho*h**2 0.670636 + alpha*h 0.258520 + L2reg 0.41 + L1reg 0.05 ; SHD = 15 ; DAG True
total norm for a microbatch 29.795268331519342 clip 1.0866776598045196
total norm for a microbatch 20.173455014913316 clip 3.2404830344505133
total norm for a microbatch 16.51248257755218 clip 3.893353301069285
total norm for a microbatch 9.198924747802268 clip 4.630010404307833
total norm for a microbatch 24.976808386692504 clip 5.510329600428125
total norm for a microbatch 13.032433506948951 clip 6.019363839100308
total norm for a microbatch 27.079934752712663 clip 10.90352608559181
total norm for a microbatch 14.221322445963722 clip 11.109956963591118
total norm for a microbatch 22.388805448154883 clip 10.515285201378287
cuda
Objective function 9.05 = squared loss an data 8.42 + 0.5*rho*h**2 0.080193 + alpha*h 0.089396 + L2reg 0.41 + L1reg 0.05 ; SHD = 10 ; DAG True
Proportion of microbatches that were clipped  0.868119630925867
iteration 2 in inner loop, alpha 22.322153375681243 rho 10000.0 h 0.004004811189098234
iteration 4 in outer loop, alpha = 62.37026526666358, rho = 10000.0, h = 0.004004811189098234
cuda
noise_multiplier  1.0  noise_multiplier_b  5.0  noise_multiplier_delta  1.005037815259212
cuda
Objective function 9.21 = squared loss an data 8.42 + 0.5*rho*h**2 0.080193 + alpha*h 0.249781 + L2reg 0.41 + L1reg 0.05 ; SHD = 10 ; DAG True
total norm for a microbatch 10.60326352114802 clip 3.8382812381314024
total norm for a microbatch 9.690719755827129 clip 3.8382812381314024
total norm for a microbatch 26.920115106770766 clip 7.757927169622726
total norm for a microbatch 10.677825799721283 clip 9.770852164184543
total norm for a microbatch 14.350498265254474 clip 11.540425849917085
total norm for a microbatch 16.549039383309903 clip 11.831960401118087
total norm for a microbatch 20.383039032517836 clip 11.249329863905396
cuda
Objective function 9.09 = squared loss an data 8.42 + 0.5*rho*h**2 0.038844 + alpha*h 0.173841 + L2reg 0.41 + L1reg 0.05 ; SHD = 9 ; DAG True
Proportion of microbatches that were clipped  0.868369671330947
iteration 1 in inner loop, alpha 62.37026526666358 rho 10000.0 h 0.002787245896243462
noise_multiplier  1.0  noise_multiplier_b  5.0  noise_multiplier_delta  1.005037815259212
cuda
Objective function 9.44 = squared loss an data 8.42 + 0.5*rho*h**2 0.388437 + alpha*h 0.173841 + L2reg 0.41 + L1reg 0.05 ; SHD = 9 ; DAG True
total norm for a microbatch 83.90978010529652 clip 1.4239194868742164
total norm for a microbatch 21.520957470659763 clip 4.528193354502542
total norm for a microbatch 23.761448832184143 clip 13.541553914997072
cuda
Objective function 9.12 = squared loss an data 8.49 + 0.5*rho*h**2 0.077572 + alpha*h 0.077687 + L2reg 0.42 + L1reg 0.05 ; SHD = 9 ; DAG True
Proportion of microbatches that were clipped  0.8735374258695304
iteration 2 in inner loop, alpha 62.37026526666358 rho 100000.0 h 0.0012455699774598372
iteration 5 in outer loop, alpha = 1307.9402427265009, rho = 1000000.0, h = 0.0012455699774598372
Threshold 0.3
[[0.006 0.018 0.104 0.005 0.365 0.105 0.129 0.041 0.01  0.801]
 [0.287 0.005 0.485 0.008 0.196 0.137 0.411 0.045 0.003 0.314]
 [0.037 0.009 0.005 0.006 0.22  0.604 0.436 0.018 0.009 0.081]
 [0.764 0.87  0.538 0.003 0.296 1.714 0.507 0.835 0.055 0.419]
 [0.01  0.027 0.014 0.008 0.007 0.026 0.015 0.036 0.007 0.018]
 [0.051 0.013 0.009 0.002 0.097 0.004 0.403 0.009 0.012 0.062]
 [0.031 0.014 0.007 0.005 0.476 0.008 0.006 0.017 0.008 0.036]
 [0.099 0.169 0.327 0.006 0.128 0.658 0.325 0.004 0.034 0.08 ]
 [0.357 1.217 0.321 0.05  0.767 0.247 0.395 0.148 0.003 0.421]
 [0.004 0.015 0.035 0.009 0.325 0.092 0.151 0.05  0.009 0.005]]
[[0.    0.    0.    0.    0.365 0.    0.    0.    0.    0.801]
 [0.    0.    0.485 0.    0.    0.    0.411 0.    0.    0.314]
 [0.    0.    0.    0.    0.    0.604 0.436 0.    0.    0.   ]
 [0.764 0.87  0.538 0.    0.    1.714 0.507 0.835 0.    0.419]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.403 0.    0.    0.   ]
 [0.    0.    0.    0.    0.476 0.    0.    0.    0.    0.   ]
 [0.    0.    0.327 0.    0.    0.658 0.325 0.    0.    0.   ]
 [0.357 1.217 0.321 0.    0.767 0.    0.395 0.    0.    0.421]
 [0.    0.    0.    0.    0.325 0.    0.    0.    0.    0.   ]]
{'fdr': 0.3076923076923077, 'tpr': 0.9, 'fpr': 0.32, 'f1': 0.7826086956521738, 'shd': 9, 'npred': 26, 'ntrue': 20}
[0.018 0.104 0.005 0.365 0.105 0.129 0.041 0.01  0.801 0.287 0.485 0.008
 0.196 0.137 0.411 0.045 0.003 0.314 0.037 0.009 0.006 0.22  0.604 0.436
 0.018 0.009 0.081 0.764 0.87  0.538 0.296 1.714 0.507 0.835 0.055 0.419
 0.01  0.027 0.014 0.008 0.026 0.015 0.036 0.007 0.018 0.051 0.013 0.009
 0.002 0.097 0.403 0.009 0.012 0.062 0.031 0.014 0.007 0.005 0.476 0.008
 0.017 0.008 0.036 0.099 0.169 0.327 0.006 0.128 0.658 0.325 0.034 0.08
 0.357 1.217 0.321 0.05  0.767 0.247 0.395 0.148 0.421 0.004 0.015 0.035
 0.009 0.325 0.092 0.151 0.05  0.009]
[[0. 0. 0. 0. 1. 0. 0. 0. 0. 1.]
 [1. 0. 1. 0. 0. 0. 1. 0. 0. 1.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [1. 1. 1. 0. 0. 1. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0. 0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 1. 0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]]
[0. 0. 0. 1. 0. 0. 0. 0. 1. 1. 1. 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 1. 1. 1. 0. 1. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0.
 0. 1. 0. 0. 1. 0. 1. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
aucroc, aucpr (0.927142857142857, 0.8457233250925202)
Iterations 630
Achieves (4.040438258977602, 1e-05)-DP
