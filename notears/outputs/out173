samples  5000  graph  20 60 ER mim  minibatch size  50  noise  0.8  minibatches per NN training  250 adaclip_and_quantile
cuda
cuda
iteration 1 in inner loop,alpha 0.0 rho 1.0 h 1.8940950442230857
iteration 1 in outer loop, alpha = 1.8940950442230857, rho = 1.0, h = 1.8940950442230857
cuda
iteration 1 in inner loop,alpha 1.8940950442230857 rho 1.0 h 1.182773599915663
iteration 2 in inner loop,alpha 1.8940950442230857 rho 10.0 h 0.459195570993554
iteration 2 in outer loop, alpha = 6.486050754158626, rho = 10.0, h = 0.459195570993554
cuda
iteration 1 in inner loop,alpha 6.486050754158626 rho 10.0 h 0.25981398971351055
iteration 2 in inner loop,alpha 6.486050754158626 rho 100.0 h 0.09213537717594988
iteration 3 in outer loop, alpha = 15.699588471753614, rho = 100.0, h = 0.09213537717594988
cuda
iteration 1 in inner loop,alpha 15.699588471753614 rho 100.0 h 0.05367211647120129
iteration 2 in inner loop,alpha 15.699588471753614 rho 1000.0 h 0.01978300963797608
iteration 4 in outer loop, alpha = 35.48259810972969, rho = 1000.0, h = 0.01978300963797608
cuda
iteration 1 in inner loop,alpha 35.48259810972969 rho 1000.0 h 0.01090959889101839
iteration 2 in inner loop,alpha 35.48259810972969 rho 10000.0 h 0.0033893587627424893
iteration 5 in outer loop, alpha = 69.37618573715459, rho = 10000.0, h = 0.0033893587627424893
cuda
iteration 1 in inner loop,alpha 69.37618573715459 rho 10000.0 h 0.0013969378290781265
iteration 2 in inner loop,alpha 69.37618573715459 rho 100000.0 h 0.0005800234825201755
iteration 6 in outer loop, alpha = 127.37853398917214, rho = 100000.0, h = 0.0005800234825201755
cuda
iteration 1 in inner loop,alpha 127.37853398917214 rho 100000.0 h 0.00035829237069506803
iteration 7 in outer loop, alpha = 485.67090468424016, rho = 1000000.0, h = 0.00035829237069506803
Threshold 0.3
[[0.    0.025 0.009 0.053 0.157 0.182 0.047 0.001 0.039 0.05  0.474 0.626
  1.072 0.    0.095 0.    0.072 2.57  0.513 0.018]
 [0.    0.001 0.    0.037 0.079 0.459 0.164 0.    0.007 0.048 0.043 0.
  0.    0.    0.072 0.141 0.02  0.    0.086 0.8  ]
 [0.002 0.288 0.002 0.124 0.539 0.098 0.068 0.    1.467 0.8   0.136 0.005
  0.005 0.    0.034 0.216 0.052 0.041 0.135 0.114]
 [0.    0.006 0.    0.002 0.001 0.004 0.    0.    0.    0.001 0.002 0.
  0.    0.    0.049 0.002 0.    0.    0.002 0.024]
 [0.    0.003 0.    0.165 0.002 0.009 0.004 0.    0.    0.014 0.01  0.
  0.    0.    0.036 0.108 0.004 0.    0.001 0.003]
 [0.    0.002 0.005 0.104 0.029 0.005 0.009 0.    0.02  0.028 0.003 0.
  0.003 0.    1.189 0.079 0.007 0.    0.295 0.042]
 [0.    0.003 0.001 0.216 0.292 0.237 0.003 0.    0.002 0.006 0.003 0.001
  0.003 0.    0.092 0.018 0.001 0.    0.004 0.014]
 [0.    0.099 0.002 1.15  0.045 0.057 0.182 0.    0.361 0.064 0.078 2.151
  1.358 0.035 0.108 0.014 0.034 2.222 0.046 0.039]
 [0.    0.026 0.    1.433 1.381 0.017 0.084 0.    0.003 0.394 1.227 0.
  0.001 0.    0.421 0.143 0.005 0.    0.006 0.016]
 [0.    0.003 0.001 0.05  0.013 0.178 0.114 0.    0.004 0.004 1.06  0.001
  0.002 0.    0.096 0.007 0.038 0.    0.006 0.667]
 [0.    0.007 0.    0.038 0.01  0.02  0.319 0.    0.    0.001 0.002 0.
  0.    0.    0.016 0.005 0.315 0.    0.003 0.738]
 [0.    2.09  0.002 1.579 1.299 0.058 0.556 0.    1.036 0.032 1.087 0.001
  0.001 0.001 0.001 0.909 0.367 0.    0.067 0.123]
 [0.    0.033 0.004 0.179 0.079 0.116 0.43  0.    0.001 0.562 0.056 0.576
  0.003 0.    1.593 0.152 0.227 0.    0.005 0.06 ]
 [0.    1.037 4.614 0.095 0.041 0.167 0.082 0.001 0.84  0.186 0.048 0.02
  0.052 0.    0.057 0.67  0.    0.09  0.705 1.196]
 [0.    0.001 0.    0.014 0.021 0.001 0.001 0.    0.002 0.005 0.002 0.
  0.    0.    0.002 0.011 0.001 0.    0.001 0.002]
 [0.    0.001 0.002 0.076 0.006 0.014 0.005 0.    0.004 0.294 0.036 0.
  0.    0.    0.038 0.003 0.001 0.    0.001 0.089]
 [0.    0.01  0.001 0.99  0.102 0.002 0.906 0.    0.001 0.003 0.003 0.001
  0.003 0.    0.551 0.002 0.002 0.    0.003 0.021]
 [0.    0.051 0.003 0.289 0.051 0.048 0.06  0.    0.105 0.058 0.107 0.876
  2.038 0.    0.001 0.072 0.048 0.002 0.025 1.251]
 [0.    0.001 0.01  0.096 0.769 0.016 0.01  0.    0.411 0.22  0.112 0.
  0.006 0.    0.691 1.039 0.001 0.007 0.004 0.063]
 [0.    0.    0.    0.011 0.008 0.022 0.066 0.    0.001 0.001 0.001 0.
  0.    0.    0.056 0.001 0.002 0.    0.002 0.002]]
[[0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.474 0.626
  1.072 0.    0.    0.    0.    2.57  0.513 0.   ]
 [0.    0.    0.    0.    0.    0.459 0.    0.    0.    0.    0.    0.
  0.    0.    0.    0.    0.    0.    0.    0.8  ]
 [0.    0.    0.    0.    0.539 0.    0.    0.    1.467 0.8   0.    0.
  0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.    0.    1.189 0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    1.15  0.    0.    0.    0.    0.361 0.    0.    2.151
  1.358 0.    0.    0.    0.    2.222 0.    0.   ]
 [0.    0.    0.    1.433 1.381 0.    0.    0.    0.    0.394 1.227 0.
  0.    0.    0.421 0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    1.06  0.
  0.    0.    0.    0.    0.    0.    0.    0.667]
 [0.    0.    0.    0.    0.    0.    0.319 0.    0.    0.    0.    0.
  0.    0.    0.    0.    0.315 0.    0.    0.738]
 [0.    2.09  0.    1.579 1.299 0.    0.556 0.    1.036 0.    1.087 0.
  0.    0.    0.    0.909 0.367 0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.43  0.    0.    0.562 0.    0.576
  0.    0.    1.593 0.    0.    0.    0.    0.   ]
 [0.    1.037 4.614 0.    0.    0.    0.    0.    0.84  0.    0.    0.
  0.    0.    0.    0.67  0.    0.    0.705 1.196]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.99  0.    0.    0.906 0.    0.    0.    0.    0.
  0.    0.    0.551 0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.876
  2.038 0.    0.    0.    0.    0.    0.    1.251]
 [0.    0.    0.    0.    0.769 0.    0.    0.    0.411 0.    0.    0.
  0.    0.    0.691 1.039 0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.    0.    0.    0.    0.    0.    0.    0.   ]]
{'fdr': 0.1111111111111111, 'tpr': 0.8, 'fpr': 0.046153846153846156, 'f1': 0.8421052631578948, 'shd': 15, 'npred': 54, 'ntrue': 60}
[2.497e-02 9.021e-03 5.338e-02 1.567e-01 1.817e-01 4.734e-02 7.364e-04
 3.877e-02 4.982e-02 4.740e-01 6.256e-01 1.072e+00 1.422e-04 9.547e-02
 4.325e-04 7.237e-02 2.570e+00 5.134e-01 1.783e-02 2.882e-06 1.981e-04
 3.699e-02 7.945e-02 4.588e-01 1.638e-01 2.128e-06 7.078e-03 4.829e-02
 4.346e-02 9.206e-05 1.304e-04 2.943e-05 7.178e-02 1.411e-01 1.998e-02
 6.776e-05 8.627e-02 8.003e-01 1.712e-03 2.881e-01 1.240e-01 5.385e-01
 9.769e-02 6.754e-02 2.006e-04 1.467e+00 8.002e-01 1.359e-01 4.600e-03
 4.919e-03 8.612e-06 3.372e-02 2.157e-01 5.212e-02 4.050e-02 1.350e-01
 1.142e-01 6.086e-06 6.167e-03 4.441e-05 1.356e-03 4.402e-03 7.475e-05
 4.239e-06 4.047e-04 5.794e-04 2.281e-03 1.110e-04 2.442e-04 2.825e-06
 4.924e-02 1.684e-03 3.846e-04 2.882e-05 2.092e-03 2.413e-02 6.018e-05
 3.446e-03 1.748e-04 1.645e-01 8.898e-03 4.171e-03 2.763e-06 4.986e-04
 1.398e-02 1.039e-02 1.772e-04 2.442e-04 3.138e-06 3.584e-02 1.080e-01
 3.731e-03 9.497e-05 6.835e-04 2.774e-03 2.922e-05 1.814e-03 5.492e-03
 1.041e-01 2.891e-02 8.924e-03 1.130e-05 2.011e-02 2.820e-02 2.529e-03
 3.796e-04 3.045e-03 8.026e-05 1.189e+00 7.941e-02 6.882e-03 4.147e-04
 2.951e-01 4.207e-02 2.156e-05 2.984e-03 1.370e-03 2.163e-01 2.921e-01
 2.365e-01 2.793e-05 1.769e-03 5.753e-03 3.159e-03 8.077e-04 2.656e-03
 4.077e-05 9.212e-02 1.829e-02 1.211e-03 5.390e-05 3.822e-03 1.391e-02
 4.080e-04 9.948e-02 1.795e-03 1.150e+00 4.513e-02 5.726e-02 1.824e-01
 3.606e-01 6.383e-02 7.794e-02 2.151e+00 1.358e+00 3.472e-02 1.085e-01
 1.408e-02 3.445e-02 2.222e+00 4.638e-02 3.935e-02 2.425e-05 2.569e-02
 2.385e-04 1.433e+00 1.381e+00 1.746e-02 8.384e-02 3.862e-05 3.943e-01
 1.227e+00 2.530e-04 5.985e-04 4.846e-06 4.211e-01 1.425e-01 4.781e-03
 1.376e-04 6.156e-03 1.632e-02 3.297e-05 2.995e-03 6.588e-04 4.980e-02
 1.313e-02 1.777e-01 1.135e-01 2.052e-05 4.320e-03 1.060e+00 9.238e-04
 1.954e-03 7.178e-06 9.594e-02 7.377e-03 3.821e-02 1.562e-04 6.264e-03
 6.671e-01 4.124e-05 7.375e-03 1.835e-04 3.849e-02 1.007e-02 1.962e-02
 3.192e-01 3.013e-06 4.563e-04 9.272e-04 1.337e-04 1.013e-04 4.048e-06
 1.630e-02 4.782e-03 3.154e-01 1.185e-04 2.877e-03 7.384e-01 2.266e-05
 2.090e+00 1.998e-03 1.579e+00 1.299e+00 5.769e-02 5.561e-01 8.099e-06
 1.036e+00 3.247e-02 1.087e+00 1.153e-03 6.890e-04 1.167e-03 9.089e-01
 3.673e-01 1.645e-04 6.684e-02 1.229e-01 2.926e-06 3.337e-02 3.852e-03
 1.789e-01 7.869e-02 1.158e-01 4.298e-01 4.863e-06 1.150e-03 5.624e-01
 5.590e-02 5.762e-01 8.255e-05 1.593e+00 1.522e-01 2.272e-01 7.761e-05
 5.001e-03 6.018e-02 4.370e-04 1.037e+00 4.614e+00 9.498e-02 4.059e-02
 1.670e-01 8.194e-02 1.339e-03 8.396e-01 1.857e-01 4.831e-02 2.014e-02
 5.244e-02 5.670e-02 6.697e-01 4.785e-04 9.026e-02 7.047e-01 1.196e+00
 1.792e-06 8.628e-04 2.248e-04 1.383e-02 2.130e-02 8.327e-04 1.201e-03
 2.580e-06 1.615e-03 5.028e-03 1.744e-03 2.557e-04 4.458e-04 2.969e-05
 1.132e-02 8.195e-04 3.403e-05 1.290e-03 2.266e-03 1.619e-05 7.137e-04
 1.959e-03 7.553e-02 5.658e-03 1.422e-02 5.214e-03 6.652e-05 4.167e-03
 2.936e-01 3.570e-02 4.333e-04 4.181e-04 3.714e-05 3.761e-02 7.032e-04
 8.432e-05 1.474e-03 8.911e-02 1.882e-05 1.011e-02 1.339e-03 9.905e-01
 1.017e-01 2.281e-03 9.064e-01 1.424e-05 7.681e-04 2.734e-03 2.507e-03
 9.546e-04 2.742e-03 1.316e-05 5.514e-01 2.033e-03 2.811e-05 2.999e-03
 2.114e-02 3.706e-06 5.144e-02 3.232e-03 2.889e-01 5.107e-02 4.844e-02
 6.037e-02 1.634e-05 1.048e-01 5.807e-02 1.067e-01 8.764e-01 2.038e+00
 7.526e-05 1.377e-03 7.222e-02 4.768e-02 2.500e-02 1.251e+00 9.764e-05
 9.919e-04 1.000e-02 9.554e-02 7.686e-01 1.602e-02 1.009e-02 5.950e-05
 4.110e-01 2.197e-01 1.118e-01 4.617e-04 5.856e-03 1.377e-04 6.915e-01
 1.039e+00 1.159e-03 6.973e-03 6.338e-02 6.180e-06 3.448e-04 8.699e-05
 1.087e-02 7.738e-03 2.174e-02 6.625e-02 4.371e-06 6.576e-04 6.128e-04
 7.224e-04 1.611e-05 4.823e-04 2.298e-05 5.597e-02 7.691e-04 2.432e-03
 3.424e-04 1.955e-03]
[[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 1. 1. 0. 0. 0. 0. 1. 1. 0.]
 [0. 0. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 1. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [0. 0. 0. 1. 0. 0. 1. 0. 1. 0. 0. 1. 1. 0. 0. 0. 0. 1. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0. 0. 1. 1. 0. 0. 0. 1. 0. 0. 0. 1. 0.]
 [0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 1.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 1. 0. 1. 1. 0. 1. 0. 1. 0. 1. 0. 1. 0. 0. 1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 1. 1. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 1. 0. 0. 1. 1.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 1. 1. 0. 0. 0. 1. 0. 0. 0. 0. 1. 1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
[0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 1. 1. 0. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0. 1.
 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 1. 0. 0. 0. 1. 1. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 1. 0. 0. 1. 1. 0. 0. 1.
 1. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 1. 1. 0. 0. 0. 1. 1. 0. 0. 0. 1. 0. 0.
 0. 1. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 1. 0. 0.
 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 1. 1. 0. 1.
 0. 1. 0. 1. 1. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 1. 0. 0.
 0. 1. 0. 0. 0. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 1. 0. 0.
 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 1. 1. 0. 0. 0. 1. 0. 0. 0. 0. 1. 1. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
aucroc, aucpr (0.9337500000000001, 0.8650591185729459)
cuda
4420
cuda
Objective function 242.67 = squared loss an data 26.66 + 0.5*rho*h**2 215.201283 + alpha*h 0.000000 + L2reg 0.37 + L1reg 0.45 ; SHD = 207 ; DAG False
v before min max tensor([[-9.042e-03,  5.743e-04, -1.853e-03,  ..., -2.997e-04,  5.260e-03,
         -2.414e-04],
        [-1.370e-02, -1.174e-03, -1.335e-02,  ..., -1.372e-03, -5.157e-04,
         -1.083e-03],
        [-5.364e-03,  7.102e-04, -6.495e-03,  ..., -8.295e-04,  5.769e-04,
         -3.456e-04],
        ...,
        [ 6.826e-02, -1.833e-02, -1.298e-03,  ...,  3.412e-05,  2.417e-04,
         -5.431e-03],
        [-1.729e-03, -4.189e-03, -3.300e-04,  ..., -7.070e-04, -1.025e-04,
          3.593e-03],
        [ 1.062e-02, -5.052e-05, -2.260e-03,  ..., -3.202e-04,  2.349e-03,
         -1.334e-02]], device='cuda:0')
v tensor([[1.000e-12, 5.743e-04, 1.000e-12,  ..., 1.000e-12, 5.260e-03,
         1.000e-12],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [1.000e-12, 7.102e-04, 1.000e-12,  ..., 1.000e-12, 5.769e-04,
         1.000e-12],
        ...,
        [6.826e-02, 1.000e-12, 1.000e-12,  ..., 3.412e-05, 2.417e-04,
         1.000e-12],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         3.593e-03],
        [1.062e-02, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 2.349e-03,
         1.000e-12]], device='cuda:0')
v before min max tensor([-1.358e-04,  5.447e-03, -2.161e-05, -1.179e-04, -4.838e-05, -3.560e-02,
        -5.850e-04, -2.978e-04, -1.710e-03, -1.157e-03, -2.683e-04, -3.362e-04,
         1.006e-05, -5.405e-03, -2.297e-05, -6.783e-03, -3.776e-04, -4.479e-04,
         3.002e-04, -1.758e-05, -1.652e-04, -4.303e-03, -2.399e-04, -2.936e-06,
         6.488e-02, -1.745e-04, -4.039e-03, -2.974e-05,  5.831e-04, -1.576e-04,
        -3.891e-03, -8.144e-03, -1.095e-02, -3.090e-06,  1.612e-04, -2.853e-03,
        -1.235e-04, -1.302e-02, -1.296e-03, -2.869e-04, -1.037e-04, -5.880e-03,
        -1.918e-04, -4.778e-03, -1.729e-04,  6.534e-05,  9.475e-05, -4.067e-05,
        -3.005e-06,  6.449e-03, -1.241e-02,  4.183e-04, -3.506e-05, -3.145e-05,
        -5.145e-03,  1.113e-03, -8.046e-04, -3.065e-04, -1.122e-03, -5.019e-03,
        -7.720e-06, -9.466e-04,  8.371e-04, -4.044e-04, -2.683e-03, -8.520e-06,
         2.226e-04, -2.191e-02, -1.205e-02,  4.056e-06, -1.276e-03, -2.993e-03,
        -3.052e-06, -7.306e-05,  7.336e-04, -1.276e-04,  3.316e-04, -1.073e-04,
        -1.228e-03, -1.467e-05,  1.726e-04,  3.762e-03, -3.047e-06, -1.034e-03,
        -4.340e-02, -6.047e-04, -1.314e-04, -2.119e-04, -1.028e-06, -9.967e-04,
         3.235e-03,  3.535e-03, -1.496e-04,  1.407e-02, -1.521e-04, -1.699e-04,
        -1.591e-04, -9.553e-05, -1.134e-02,  2.496e-04,  6.448e-05,  3.516e-05,
        -2.271e-03, -8.647e-04, -4.587e-03, -6.080e-04,  4.719e-02, -4.533e-05,
        -8.382e-05, -2.396e-03, -4.403e-06,  3.812e-05,  3.136e-04, -6.581e-03,
        -1.658e-03, -3.900e-04, -6.788e-04,  1.809e-05, -5.907e-03,  5.070e-04,
        -1.698e-05,  6.509e-05, -5.307e-04,  1.048e-03, -2.944e-04, -2.593e-04,
         3.860e-04,  3.087e-03, -1.802e-03, -1.067e-02,  1.420e-02,  2.460e-02,
         2.724e-04, -5.130e-04,  1.463e-04, -1.979e-03, -2.473e-05,  6.355e-06,
         1.579e-04, -1.897e-04, -1.222e-05,  4.535e-06, -2.011e-06, -1.916e-04,
        -3.270e-07,  5.515e-05,  1.520e-06,  5.644e-02, -1.751e-02, -3.578e-04,
        -1.719e-04, -1.687e-03,  3.062e-04, -4.657e-02, -1.108e-02,  6.618e-04,
        -7.198e-03,  1.394e-04, -5.646e-04, -3.059e-06, -6.203e-03, -5.387e-05,
        -3.627e-03,  4.019e-06, -6.472e-03,  8.004e-04,  1.031e-02, -6.432e-05,
         8.414e-03,  2.469e-06, -6.349e-04, -4.019e-02, -6.025e-05, -3.753e-04,
        -2.369e-05,  9.931e-04, -7.478e-04, -4.847e-04, -2.608e-05, -1.291e-06,
        -3.446e-04, -3.470e-05, -5.840e-04, -1.987e-05, -4.373e-03,  3.091e-02,
        -7.020e-04,  1.406e-02,  2.426e-04, -1.705e-04, -3.577e-03, -6.659e-06,
        -2.858e-03, -4.974e-04, -4.613e-04,  1.375e-05,  2.224e-03, -1.226e-05,
         1.421e-03, -1.804e-03], device='cuda:0')
v tensor([1.000e-12, 5.447e-03, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.006e-05, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        3.002e-04, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        6.488e-02, 1.000e-12, 1.000e-12, 1.000e-12, 5.831e-04, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.612e-04, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 6.534e-05, 9.475e-05, 1.000e-12,
        1.000e-12, 6.449e-03, 1.000e-12, 4.183e-04, 1.000e-12, 1.000e-12,
        1.000e-12, 1.113e-03, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 8.371e-04, 1.000e-12, 1.000e-12, 1.000e-12,
        2.226e-04, 1.000e-12, 1.000e-12, 4.056e-06, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 7.336e-04, 1.000e-12, 3.316e-04, 1.000e-12,
        1.000e-12, 1.000e-12, 1.726e-04, 3.762e-03, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        3.235e-03, 3.535e-03, 1.000e-12, 1.407e-02, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 2.496e-04, 6.448e-05, 3.516e-05,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 4.719e-02, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 3.812e-05, 3.136e-04, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.809e-05, 1.000e-12, 5.070e-04,
        1.000e-12, 6.509e-05, 1.000e-12, 1.048e-03, 1.000e-12, 1.000e-12,
        3.860e-04, 3.087e-03, 1.000e-12, 1.000e-12, 1.420e-02, 2.460e-02,
        2.724e-04, 1.000e-12, 1.463e-04, 1.000e-12, 1.000e-12, 6.355e-06,
        1.579e-04, 1.000e-12, 1.000e-12, 4.535e-06, 1.000e-12, 1.000e-12,
        1.000e-12, 5.515e-05, 1.520e-06, 5.644e-02, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 3.062e-04, 1.000e-12, 1.000e-12, 6.618e-04,
        1.000e-12, 1.394e-04, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 4.019e-06, 1.000e-12, 8.004e-04, 1.031e-02, 1.000e-12,
        8.414e-03, 2.469e-06, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 9.931e-04, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 3.091e-02,
        1.000e-12, 1.406e-02, 2.426e-04, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.375e-05, 2.224e-03, 1.000e-12,
        1.421e-03, 1.000e-12], device='cuda:0')
v before min max tensor([[[ 6.414e-03],
         [-2.093e-02],
         [-3.987e-03],
         [-7.659e-03],
         [-4.304e-02],
         [-3.032e-03],
         [-2.240e-03],
         [ 1.116e-03],
         [ 2.860e-03],
         [-1.274e-03]],

        [[-2.206e-03],
         [-9.548e-04],
         [-2.899e-03],
         [ 1.577e-04],
         [-2.311e-03],
         [ 1.655e-02],
         [-4.106e-03],
         [ 1.241e-02],
         [ 3.901e-03],
         [ 2.051e-02]],

        [[-1.948e-02],
         [ 2.265e-02],
         [-4.668e-04],
         [-1.030e-02],
         [-3.960e-03],
         [-3.710e-03],
         [-9.747e-03],
         [-3.203e-04],
         [ 6.846e-03],
         [ 6.967e-03]],

        [[-6.795e-03],
         [-5.564e-04],
         [-5.079e-05],
         [-1.916e-04],
         [-1.693e-03],
         [-2.251e-03],
         [ 1.456e-04],
         [ 2.000e-03],
         [ 6.770e-03],
         [-5.956e-03]],

        [[-4.388e-03],
         [ 7.377e-04],
         [-2.551e-04],
         [-2.552e-03],
         [ 3.034e-02],
         [-4.319e-03],
         [ 4.573e-02],
         [ 7.289e-03],
         [-5.176e-04],
         [-9.636e-03]],

        [[ 3.374e-02],
         [-2.681e-04],
         [-4.129e-03],
         [-4.747e-03],
         [-1.592e-03],
         [-1.503e-02],
         [-2.762e-04],
         [-2.783e-04],
         [-1.665e-04],
         [-1.888e-03]],

        [[ 6.162e-03],
         [-4.161e-03],
         [-2.426e-03],
         [-5.814e-04],
         [-1.037e-02],
         [-4.697e-03],
         [-4.577e-02],
         [-3.134e-03],
         [ 3.881e-05],
         [-1.890e-02]],

        [[-1.552e-04],
         [ 1.344e-02],
         [-9.254e-03],
         [-1.114e-02],
         [-6.568e-03],
         [-1.068e-03],
         [ 1.009e-02],
         [ 5.410e-03],
         [-2.128e-03],
         [ 6.663e-04]],

        [[ 3.462e-03],
         [ 6.224e-06],
         [-4.197e-03],
         [ 4.072e-04],
         [-2.094e-03],
         [-5.205e-03],
         [ 1.373e-02],
         [ 1.558e-03],
         [-1.543e-03],
         [ 8.506e-04]],

        [[-1.701e-03],
         [-1.304e-03],
         [-9.658e-03],
         [-3.486e-03],
         [-2.277e-03],
         [ 4.259e-03],
         [-1.220e-03],
         [-2.482e-03],
         [ 4.037e-03],
         [-2.824e-02]],

        [[-1.122e-04],
         [ 1.148e-04],
         [-6.730e-03],
         [-2.057e-03],
         [-1.250e-04],
         [-8.197e-05],
         [-2.597e-03],
         [-4.365e-04],
         [ 1.851e-03],
         [ 3.491e-03]],

        [[ 2.934e-03],
         [ 1.933e-04],
         [-4.984e-03],
         [-1.841e-04],
         [-1.107e-03],
         [-8.275e-04],
         [-8.042e-04],
         [-3.862e-04],
         [-3.441e-04],
         [-2.029e-04]],

        [[-2.382e-02],
         [-2.537e-03],
         [ 1.765e-01],
         [-2.014e-02],
         [-4.153e-03],
         [ 1.910e-02],
         [ 3.603e-03],
         [-7.634e-03],
         [-1.546e-02],
         [ 6.197e-03]],

        [[-1.938e-03],
         [-2.218e-04],
         [-1.848e-02],
         [-1.579e-03],
         [ 4.188e-05],
         [-1.109e-03],
         [ 2.558e-04],
         [ 3.428e-03],
         [ 2.714e-04],
         [-1.265e-03]],

        [[-5.213e-03],
         [-5.263e-03],
         [-1.376e-03],
         [-1.148e-03],
         [ 1.823e-03],
         [ 2.834e-03],
         [-2.804e-03],
         [ 1.035e-03],
         [ 1.474e-04],
         [-1.132e-03]],

        [[-6.836e-04],
         [-1.670e-02],
         [-1.222e-03],
         [ 1.516e-03],
         [-4.282e-03],
         [ 5.302e-02],
         [-2.212e-03],
         [-3.701e-04],
         [ 1.997e-04],
         [-2.177e-03]],

        [[-1.561e-04],
         [-1.627e-03],
         [-5.144e-03],
         [ 1.042e-03],
         [-2.405e-03],
         [-6.941e-05],
         [-1.008e-03],
         [-7.997e-03],
         [-5.748e-04],
         [-2.186e-02]],

        [[-6.722e-03],
         [-9.632e-03],
         [-1.740e-02],
         [-1.338e-03],
         [-2.923e-02],
         [-1.531e-02],
         [-3.858e-03],
         [-1.071e-03],
         [ 2.246e-02],
         [-9.257e-04]],

        [[-4.292e-03],
         [ 5.365e-03],
         [-1.864e-03],
         [ 5.943e-03],
         [ 6.610e-04],
         [-1.143e-03],
         [-8.611e-04],
         [-6.510e-03],
         [-1.254e-03],
         [ 7.282e-03]],

        [[ 2.885e-03],
         [-1.801e-03],
         [-4.483e-03],
         [-1.117e-04],
         [-5.850e-04],
         [ 1.680e-04],
         [-1.176e-04],
         [-1.955e-04],
         [-1.326e-04],
         [ 5.669e-04]]], device='cuda:0')
v tensor([[[6.414e-03],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.116e-03],
         [2.860e-03],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.577e-04],
         [1.000e-12],
         [1.655e-02],
         [1.000e-12],
         [1.241e-02],
         [3.901e-03],
         [2.051e-02]],

        [[1.000e-12],
         [2.265e-02],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [6.846e-03],
         [6.967e-03]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.456e-04],
         [2.000e-03],
         [6.770e-03],
         [1.000e-12]],

        [[1.000e-12],
         [7.377e-04],
         [1.000e-12],
         [1.000e-12],
         [3.034e-02],
         [1.000e-12],
         [4.573e-02],
         [7.289e-03],
         [1.000e-12],
         [1.000e-12]],

        [[3.374e-02],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[6.162e-03],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [3.881e-05],
         [1.000e-12]],

        [[1.000e-12],
         [1.344e-02],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.009e-02],
         [5.410e-03],
         [1.000e-12],
         [6.663e-04]],

        [[3.462e-03],
         [6.224e-06],
         [1.000e-12],
         [4.072e-04],
         [1.000e-12],
         [1.000e-12],
         [1.373e-02],
         [1.558e-03],
         [1.000e-12],
         [8.506e-04]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [4.259e-03],
         [1.000e-12],
         [1.000e-12],
         [4.037e-03],
         [1.000e-12]],

        [[1.000e-12],
         [1.148e-04],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.851e-03],
         [3.491e-03]],

        [[2.934e-03],
         [1.933e-04],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.765e-01],
         [1.000e-12],
         [1.000e-12],
         [1.910e-02],
         [3.603e-03],
         [1.000e-12],
         [1.000e-12],
         [6.197e-03]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [4.188e-05],
         [1.000e-12],
         [2.558e-04],
         [3.428e-03],
         [2.714e-04],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.823e-03],
         [2.834e-03],
         [1.000e-12],
         [1.035e-03],
         [1.474e-04],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.516e-03],
         [1.000e-12],
         [5.302e-02],
         [1.000e-12],
         [1.000e-12],
         [1.997e-04],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.042e-03],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.246e-02],
         [1.000e-12]],

        [[1.000e-12],
         [5.365e-03],
         [1.000e-12],
         [5.943e-03],
         [6.610e-04],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [7.282e-03]],

        [[2.885e-03],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.680e-04],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [5.669e-04]]], device='cuda:0')
v before min max tensor([[ 0.009],
        [ 0.002],
        [-0.002],
        [ 0.008],
        [-0.000],
        [ 0.007],
        [ 0.021],
        [-0.006],
        [ 0.001],
        [-0.004],
        [ 0.000],
        [-0.004],
        [ 0.002],
        [-0.004],
        [-0.003],
        [-0.001],
        [-0.004],
        [-0.001],
        [-0.016],
        [ 0.012]], device='cuda:0')
v tensor([[8.983e-03],
        [2.485e-03],
        [1.000e-12],
        [8.397e-03],
        [1.000e-12],
        [7.057e-03],
        [2.149e-02],
        [1.000e-12],
        [6.999e-04],
        [1.000e-12],
        [4.603e-04],
        [1.000e-12],
        [2.027e-03],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.164e-02]], device='cuda:0')
a after update for 1 param tensor([[-3.005e-05, -4.811e-05, -2.762e-05,  ...,  7.026e-05,  4.892e-05,
         -6.953e-05],
        [-8.044e-05, -5.180e-05,  5.526e-05,  ..., -3.815e-05, -3.600e-06,
         -3.170e-05],
        [ 1.190e-04, -1.674e-05, -4.548e-05,  ...,  1.148e-05, -1.333e-04,
          9.605e-06],
        ...,
        [ 6.919e-04,  2.114e-06, -1.010e-04,  ..., -1.102e-05,  3.111e-05,
          2.233e-04],
        [-3.100e-05,  6.149e-06, -2.236e-05,  ..., -1.234e-04,  5.548e-05,
         -1.725e-04],
        [ 9.833e-05,  1.811e-05,  8.065e-06,  ..., -2.831e-05,  1.321e-04,
         -2.881e-04]], device='cuda:0')
s after update for 1 param tensor([[0.006, 0.008, 0.001,  ..., 0.000, 0.023, 0.001],
        [0.008, 0.001, 0.014,  ..., 0.001, 0.001, 0.001],
        [0.004, 0.008, 0.005,  ..., 0.001, 0.009, 0.000],
        ...,
        [0.092, 0.013, 0.002,  ..., 0.002, 0.005, 0.006],
        [0.002, 0.003, 0.000,  ..., 0.003, 0.001, 0.020],
        [0.033, 0.000, 0.002,  ..., 0.000, 0.016, 0.021]], device='cuda:0')
b after update for 1 param tensor([[0.465, 0.510, 0.202,  ..., 0.109, 0.885, 0.190],
        [0.531, 0.177, 0.696,  ..., 0.204, 0.162, 0.149],
        [0.350, 0.537, 0.404,  ..., 0.131, 0.543, 0.087],
        ...,
        [1.770, 0.665, 0.251,  ..., 0.251, 0.410, 0.434],
        [0.264, 0.294, 0.104,  ..., 0.297, 0.140, 0.835],
        [1.060, 0.060, 0.245,  ..., 0.090, 0.730, 0.841]], device='cuda:0')
clipping threshold 2.782537623814828
a after update for 1 param tensor([ 1.654e-05,  2.347e-04, -7.306e-06,  3.184e-06,  1.071e-05, -4.578e-05,
         4.182e-05,  3.548e-05, -1.490e-05,  1.794e-05, -7.918e-06, -4.154e-06,
         1.064e-05, -4.424e-05, -2.224e-05, -3.133e-05,  1.490e-05, -2.917e-05,
         3.243e-05, -1.969e-06, -1.639e-05, -2.252e-05, -2.422e-05, -4.459e-07,
        -5.868e-04, -1.715e-05,  1.907e-05, -1.619e-05, -7.172e-05, -1.874e-05,
         4.866e-05, -1.016e-04,  1.891e-04,  7.812e-07,  4.053e-05,  5.972e-07,
         9.884e-06,  4.399e-05, -9.086e-07,  2.218e-05, -3.089e-05,  1.740e-05,
        -1.118e-05, -7.681e-05, -2.002e-05,  1.813e-05, -9.993e-06, -1.978e-08,
         4.889e-07,  1.546e-04, -3.015e-04,  1.061e-04,  2.533e-06, -6.727e-06,
         1.325e-05,  6.070e-05, -3.603e-05,  2.901e-05, -2.145e-05, -9.468e-05,
        -1.127e-05,  7.929e-06, -3.375e-04, -1.805e-05, -8.393e-05,  1.027e-06,
         3.369e-05,  4.232e-05, -1.744e-04,  1.897e-05, -2.817e-06,  8.706e-05,
        -1.554e-06, -4.696e-06,  4.090e-05,  6.963e-06,  5.522e-05, -7.315e-06,
        -4.294e-06,  2.815e-06,  1.933e-05,  1.986e-04,  1.104e-06,  5.428e-07,
        -2.584e-04,  4.393e-05,  7.348e-06,  1.829e-05, -1.460e-06,  2.849e-05,
        -9.057e-05, -1.091e-04, -1.767e-05, -1.962e-04,  1.716e-05, -1.341e-05,
         3.396e-06,  1.487e-05, -1.087e-04, -1.883e-05, -2.765e-05, -1.773e-05,
        -2.756e-05,  1.041e-05,  6.487e-05,  2.932e-05,  4.532e-04,  9.823e-06,
         3.228e-06,  1.449e-04, -8.721e-07, -8.992e-06, -5.241e-05,  3.901e-05,
        -1.549e-05,  2.159e-05,  3.072e-05, -3.287e-05, -5.216e-05, -3.762e-05,
         1.226e-06,  1.295e-05, -1.810e-05,  5.905e-05,  7.612e-06, -2.005e-05,
         5.630e-05, -5.245e-05,  1.017e-04, -2.276e-05, -2.107e-04,  2.665e-04,
        -3.551e-05, -3.372e-05,  2.709e-05, -1.284e-05,  8.228e-06,  6.521e-06,
        -4.978e-05, -7.592e-05,  1.292e-06,  6.092e-06,  4.133e-07, -1.915e-05,
         3.275e-06, -2.088e-05, -6.591e-06, -5.303e-04,  6.586e-07, -2.735e-05,
        -1.368e-05, -1.059e-05,  7.614e-05,  2.849e-04, -1.819e-04, -4.774e-05,
        -2.783e-04,  4.016e-06, -7.267e-06,  1.856e-05,  2.417e-05, -9.092e-06,
         1.059e-04,  1.095e-05, -8.198e-06,  4.336e-05,  1.834e-04,  1.021e-05,
        -1.606e-04,  1.637e-06,  2.085e-05, -1.534e-04, -1.875e-06,  8.514e-06,
        -7.329e-07,  5.427e-05, -2.900e-05,  6.480e-06,  4.757e-06, -9.930e-07,
         1.391e-05,  4.325e-05,  3.114e-05,  2.874e-06, -2.237e-05,  2.667e-04,
         8.832e-06,  1.336e-04, -2.082e-05, -5.657e-06, -6.301e-05, -1.101e-06,
         1.677e-05,  2.892e-05,  1.349e-04,  8.422e-06, -7.176e-05, -2.085e-05,
        -5.316e-05,  5.992e-06], device='cuda:0')
s after update for 1 param tensor([8.542e-05, 2.396e-02, 4.305e-05, 8.769e-05, 3.400e-05, 2.599e-02,
        4.025e-04, 6.468e-04, 1.256e-03, 6.959e-04, 1.648e-04, 3.352e-04,
        1.003e-03, 3.522e-03, 4.363e-05, 4.202e-03, 2.644e-04, 3.359e-04,
        5.531e-03, 2.728e-05, 3.289e-04, 4.293e-03, 4.654e-04, 3.351e-06,
        8.236e-02, 2.910e-04, 3.106e-03, 2.698e-04, 7.638e-03, 1.265e-04,
        2.447e-03, 5.945e-03, 1.146e-02, 1.882e-06, 4.032e-03, 1.907e-03,
        7.455e-05, 8.170e-03, 8.894e-04, 2.497e-04, 1.316e-04, 4.039e-03,
        1.150e-04, 5.149e-03, 1.153e-04, 2.556e-03, 3.078e-03, 2.478e-05,
        1.882e-06, 2.545e-02, 1.782e-02, 6.600e-03, 2.117e-05, 3.804e-05,
        3.590e-03, 1.055e-02, 9.686e-04, 3.587e-04, 6.969e-04, 3.670e-03,
        6.293e-05, 5.735e-04, 1.477e-02, 3.580e-04, 3.932e-03, 5.279e-06,
        4.719e-03, 1.360e-02, 9.852e-03, 6.886e-04, 9.876e-04, 1.936e-03,
        1.882e-06, 4.573e-05, 8.567e-03, 7.680e-05, 5.763e-03, 6.744e-05,
        9.081e-04, 1.223e-05, 4.157e-03, 2.014e-02, 1.882e-06, 6.708e-04,
        2.619e-02, 4.847e-04, 8.028e-05, 1.472e-04, 1.882e-06, 1.077e-03,
        1.799e-02, 1.884e-02, 1.045e-04, 3.782e-02, 1.497e-04, 1.027e-04,
        1.820e-04, 7.162e-05, 8.034e-03, 5.018e-03, 2.551e-03, 1.875e-03,
        2.180e-03, 5.325e-04, 3.181e-03, 6.260e-04, 6.963e-02, 4.765e-05,
        5.229e-05, 1.978e-03, 3.562e-06, 1.952e-03, 5.682e-03, 4.609e-03,
        1.017e-03, 1.226e-03, 4.112e-04, 1.350e-03, 5.169e-03, 7.122e-03,
        1.021e-05, 2.551e-03, 3.613e-04, 1.026e-02, 1.769e-04, 1.747e-04,
        6.239e-03, 1.773e-02, 2.071e-03, 7.020e-03, 3.837e-02, 4.971e-02,
        5.222e-03, 4.761e-04, 3.825e-03, 1.204e-03, 1.895e-05, 7.972e-04,
        3.976e-03, 8.086e-04, 1.452e-04, 6.738e-04, 1.882e-06, 2.352e-04,
        1.882e-06, 2.382e-03, 3.900e-04, 7.772e-02, 1.174e-02, 2.751e-04,
        1.385e-04, 1.339e-03, 5.585e-03, 3.351e-02, 1.098e-02, 8.141e-03,
        1.214e-02, 3.735e-03, 6.193e-04, 1.698e-05, 3.726e-03, 3.231e-05,
        4.540e-03, 6.355e-04, 5.987e-03, 8.950e-03, 3.254e-02, 4.121e-05,
        2.903e-02, 4.969e-04, 2.946e-03, 2.415e-02, 3.841e-05, 2.361e-04,
        1.749e-05, 9.972e-03, 4.635e-04, 3.454e-04, 1.937e-05, 1.882e-06,
        2.076e-04, 2.355e-04, 3.524e-04, 1.192e-05, 2.684e-03, 5.904e-02,
        4.600e-04, 4.276e-02, 4.926e-03, 1.307e-04, 6.023e-03, 5.582e-06,
        1.770e-03, 3.095e-04, 7.435e-03, 1.172e-03, 1.492e-02, 1.430e-04,
        1.193e-02, 1.173e-03], device='cuda:0')
b after update for 1 param tensor([0.054, 0.904, 0.038, 0.055, 0.034, 0.942, 0.117, 0.149, 0.207, 0.154,
        0.075, 0.107, 0.185, 0.347, 0.039, 0.379, 0.095, 0.107, 0.435, 0.031,
        0.106, 0.383, 0.126, 0.011, 1.677, 0.100, 0.326, 0.096, 0.511, 0.066,
        0.289, 0.451, 0.625, 0.008, 0.371, 0.255, 0.050, 0.528, 0.174, 0.092,
        0.067, 0.371, 0.063, 0.419, 0.063, 0.295, 0.324, 0.029, 0.008, 0.932,
        0.780, 0.475, 0.027, 0.036, 0.350, 0.600, 0.182, 0.111, 0.154, 0.354,
        0.046, 0.140, 0.710, 0.111, 0.366, 0.013, 0.401, 0.681, 0.580, 0.153,
        0.184, 0.257, 0.008, 0.040, 0.541, 0.051, 0.444, 0.048, 0.176, 0.020,
        0.377, 0.829, 0.008, 0.151, 0.946, 0.129, 0.052, 0.071, 0.008, 0.192,
        0.784, 0.802, 0.060, 1.136, 0.071, 0.059, 0.079, 0.049, 0.524, 0.414,
        0.295, 0.253, 0.273, 0.135, 0.330, 0.146, 1.542, 0.040, 0.042, 0.260,
        0.011, 0.258, 0.440, 0.397, 0.186, 0.205, 0.118, 0.215, 0.420, 0.493,
        0.019, 0.295, 0.111, 0.592, 0.078, 0.077, 0.462, 0.778, 0.266, 0.490,
        1.145, 1.303, 0.422, 0.127, 0.361, 0.203, 0.025, 0.165, 0.368, 0.166,
        0.070, 0.152, 0.008, 0.090, 0.008, 0.285, 0.115, 1.629, 0.633, 0.097,
        0.069, 0.214, 0.437, 1.070, 0.612, 0.527, 0.644, 0.357, 0.145, 0.024,
        0.357, 0.033, 0.394, 0.147, 0.452, 0.553, 1.054, 0.038, 0.996, 0.130,
        0.317, 0.908, 0.036, 0.090, 0.024, 0.583, 0.126, 0.109, 0.026, 0.008,
        0.084, 0.090, 0.110, 0.020, 0.303, 1.420, 0.125, 1.208, 0.410, 0.067,
        0.453, 0.014, 0.246, 0.103, 0.504, 0.200, 0.714, 0.070, 0.638, 0.200],
       device='cuda:0')
clipping threshold 2.782537623814828
a after update for 1 param tensor([[[ 1.595e-04],
         [ 4.238e-05],
         [ 9.755e-05],
         [-6.995e-05],
         [-2.232e-04],
         [ 1.785e-04],
         [ 1.783e-04],
         [ 1.689e-04],
         [ 1.471e-04],
         [-3.695e-06]],

        [[ 1.687e-05],
         [-1.535e-04],
         [ 8.943e-05],
         [-5.824e-05],
         [-1.404e-04],
         [ 2.025e-04],
         [ 3.183e-05],
         [-3.782e-04],
         [-2.321e-04],
         [ 1.694e-04]],

        [[-1.348e-04],
         [-1.921e-04],
         [-6.305e-05],
         [-1.548e-04],
         [ 8.589e-05],
         [-9.446e-05],
         [-1.238e-04],
         [-9.779e-05],
         [-2.120e-04],
         [-2.230e-04]],

        [[ 1.655e-05],
         [-3.587e-06],
         [ 9.055e-07],
         [-1.769e-05],
         [-1.141e-05],
         [-3.774e-05],
         [-2.534e-05],
         [ 7.749e-05],
         [ 1.418e-04],
         [ 2.990e-04]],

        [[ 1.963e-05],
         [-4.227e-05],
         [ 8.924e-06],
         [ 8.079e-05],
         [-3.801e-04],
         [ 3.119e-05],
         [ 3.068e-04],
         [-1.520e-04],
         [-2.414e-05],
         [ 2.746e-04]],

        [[ 3.320e-04],
         [-2.668e-05],
         [ 8.953e-05],
         [-3.535e-05],
         [ 1.415e-04],
         [ 1.207e-04],
         [ 8.101e-07],
         [ 2.101e-04],
         [ 6.510e-05],
         [ 6.413e-05]],

        [[-1.422e-04],
         [ 3.239e-05],
         [ 2.541e-06],
         [-6.982e-06],
         [ 8.826e-05],
         [ 8.181e-05],
         [-2.319e-04],
         [-2.147e-06],
         [-1.795e-05],
         [ 1.426e-04]],

        [[ 2.255e-05],
         [ 2.756e-04],
         [ 1.097e-04],
         [ 3.556e-05],
         [ 5.850e-05],
         [ 3.961e-05],
         [-2.112e-04],
         [ 1.591e-04],
         [ 3.997e-05],
         [ 8.125e-05]],

        [[-1.229e-04],
         [-2.824e-05],
         [ 2.926e-06],
         [ 5.901e-05],
         [-3.537e-05],
         [-7.434e-05],
         [-1.914e-04],
         [-1.228e-04],
         [ 1.352e-04],
         [-1.199e-04]],

        [[ 4.483e-06],
         [-1.403e-05],
         [-1.492e-05],
         [-9.301e-05],
         [-1.015e-04],
         [ 7.485e-05],
         [-2.051e-05],
         [-6.252e-05],
         [-9.402e-05],
         [-1.076e-04]],

        [[-5.017e-05],
         [ 2.977e-05],
         [-4.350e-05],
         [ 3.982e-05],
         [ 5.329e-06],
         [-6.855e-06],
         [-2.345e-05],
         [ 4.599e-05],
         [ 7.277e-05],
         [ 1.387e-04]],

        [[-1.238e-04],
         [ 7.229e-05],
         [-1.141e-04],
         [-1.396e-05],
         [-2.359e-05],
         [ 2.153e-05],
         [-8.144e-07],
         [-3.143e-05],
         [-5.153e-06],
         [-2.350e-05]],

        [[ 1.107e-04],
         [-5.955e-05],
         [ 7.631e-04],
         [ 4.053e-05],
         [-9.143e-05],
         [ 1.866e-04],
         [ 1.235e-04],
         [ 5.932e-05],
         [ 1.995e-04],
         [ 1.501e-04]],

        [[ 1.937e-05],
         [ 3.209e-05],
         [ 3.138e-05],
         [ 2.893e-05],
         [-2.053e-05],
         [ 4.594e-05],
         [ 6.979e-05],
         [ 8.125e-05],
         [ 5.107e-05],
         [ 6.343e-06]],

        [[ 1.519e-04],
         [-5.061e-05],
         [-1.760e-05],
         [ 4.556e-05],
         [ 1.087e-04],
         [ 1.278e-04],
         [-5.718e-05],
         [ 3.989e-05],
         [ 5.835e-05],
         [ 2.134e-05]],

        [[ 1.228e-04],
         [ 1.992e-04],
         [-1.031e-04],
         [ 1.105e-04],
         [-5.248e-05],
         [ 5.388e-04],
         [-1.717e-05],
         [ 1.178e-05],
         [-3.849e-05],
         [-3.627e-05]],

        [[-4.965e-08],
         [ 3.857e-05],
         [-1.417e-04],
         [ 3.537e-05],
         [ 1.186e-05],
         [ 2.634e-05],
         [-1.890e-05],
         [ 1.885e-04],
         [-1.208e-05],
         [-1.780e-04]],

        [[-1.124e-04],
         [-1.292e-04],
         [-2.234e-04],
         [-7.997e-06],
         [-1.077e-04],
         [-8.557e-05],
         [-2.693e-05],
         [-9.894e-05],
         [ 2.008e-04],
         [ 2.763e-04]],

        [[ 4.323e-04],
         [-1.158e-04],
         [ 1.595e-05],
         [ 1.225e-04],
         [ 5.483e-05],
         [-1.702e-05],
         [ 7.495e-05],
         [ 3.314e-05],
         [ 2.781e-06],
         [ 8.964e-05]],

        [[ 9.751e-05],
         [ 9.558e-05],
         [-1.191e-05],
         [ 1.584e-05],
         [-3.626e-05],
         [ 8.047e-06],
         [ 3.210e-05],
         [ 1.127e-05],
         [ 9.452e-05],
         [-7.284e-05]]], device='cuda:0')
s after update for 1 param tensor([[[2.540e-02],
         [1.347e-02],
         [3.722e-03],
         [6.228e-03],
         [3.042e-02],
         [5.187e-03],
         [4.467e-03],
         [1.080e-02],
         [1.693e-02],
         [2.383e-03]],

        [[2.037e-03],
         [3.213e-03],
         [2.728e-03],
         [3.980e-03],
         [2.490e-03],
         [4.126e-02],
         [2.563e-03],
         [3.721e-02],
         [2.010e-02],
         [5.165e-02]],

        [[1.168e-02],
         [4.770e-02],
         [6.947e-04],
         [9.380e-03],
         [1.850e-02],
         [6.557e-03],
         [5.889e-03],
         [1.045e-03],
         [2.627e-02],
         [2.661e-02]],

        [[4.576e-03],
         [3.336e-04],
         [3.688e-05],
         [1.516e-04],
         [1.015e-03],
         [1.417e-03],
         [3.815e-03],
         [1.456e-02],
         [2.605e-02],
         [1.195e-02]],

        [[2.788e-03],
         [8.590e-03],
         [2.169e-04],
         [4.111e-03],
         [5.665e-02],
         [2.734e-03],
         [7.094e-02],
         [2.705e-02],
         [3.619e-04],
         [1.463e-02]],

        [[5.858e-02],
         [1.614e-04],
         [2.575e-03],
         [3.901e-03],
         [4.727e-03],
         [9.176e-03],
         [1.844e-04],
         [7.890e-03],
         [9.349e-04],
         [1.138e-03]],

        [[2.485e-02],
         [2.549e-03],
         [2.345e-03],
         [3.899e-04],
         [6.712e-03],
         [8.268e-03],
         [2.975e-02],
         [1.892e-03],
         [2.022e-03],
         [1.249e-02]],

        [[1.483e-04],
         [3.689e-02],
         [5.672e-03],
         [6.684e-03],
         [4.694e-03],
         [8.481e-04],
         [3.185e-02],
         [2.328e-02],
         [1.304e-03],
         [8.319e-03]],

        [[1.862e-02],
         [8.060e-04],
         [2.598e-03],
         [6.403e-03],
         [2.668e-03],
         [3.154e-03],
         [3.710e-02],
         [1.276e-02],
         [1.479e-03],
         [9.382e-03]],

        [[1.036e-03],
         [7.858e-04],
         [5.893e-03],
         [3.410e-03],
         [1.955e-03],
         [2.394e-02],
         [8.705e-04],
         [4.634e-03],
         [2.024e-02],
         [1.716e-02]],

        [[4.084e-04],
         [3.390e-03],
         [4.036e-03],
         [1.266e-03],
         [9.589e-05],
         [1.905e-04],
         [1.608e-03],
         [6.767e-04],
         [1.383e-02],
         [1.879e-02]],

        [[1.724e-02],
         [4.458e-03],
         [3.389e-03],
         [1.105e-04],
         [7.458e-04],
         [5.422e-04],
         [4.846e-04],
         [2.685e-03],
         [2.080e-04],
         [8.145e-04]],

        [[3.167e-02],
         [1.556e-03],
         [1.335e-01],
         [2.691e-02],
         [2.532e-03],
         [4.377e-02],
         [1.904e-02],
         [4.624e-03],
         [1.114e-02],
         [2.494e-02]],

        [[1.226e-03],
         [3.502e-04],
         [1.367e-02],
         [1.133e-03],
         [2.096e-03],
         [1.286e-03],
         [5.078e-03],
         [1.859e-02],
         [5.216e-03],
         [1.270e-03]],

        [[6.064e-03],
         [4.151e-03],
         [9.529e-04],
         [1.575e-03],
         [1.354e-02],
         [1.692e-02],
         [2.258e-03],
         [1.017e-02],
         [3.868e-03],
         [1.259e-03]],

        [[3.149e-03],
         [1.640e-02],
         [3.182e-03],
         [1.232e-02],
         [3.052e-03],
         [7.582e-02],
         [1.646e-03],
         [2.250e-04],
         [5.892e-03],
         [2.044e-03]],

        [[9.472e-05],
         [1.815e-03],
         [3.925e-03],
         [1.023e-02],
         [1.502e-03],
         [2.001e-04],
         [7.925e-04],
         [8.784e-03],
         [3.494e-04],
         [1.420e-02]],

        [[4.524e-03],
         [5.925e-03],
         [1.162e-02],
         [1.769e-03],
         [1.763e-02],
         [9.205e-03],
         [2.466e-03],
         [1.065e-03],
         [4.813e-02],
         [1.551e-02]],

        [[2.498e-02],
         [2.317e-02],
         [1.172e-03],
         [2.441e-02],
         [8.131e-03],
         [7.247e-04],
         [1.897e-03],
         [4.216e-03],
         [7.823e-04],
         [2.822e-02]],

        [[1.700e-02],
         [2.731e-03],
         [2.933e-03],
         [1.203e-04],
         [3.745e-04],
         [4.098e-03],
         [8.750e-04],
         [1.317e-04],
         [2.424e-03],
         [7.685e-03]]], device='cuda:0')
b after update for 1 param tensor([[[0.931],
         [0.678],
         [0.356],
         [0.461],
         [1.019],
         [0.421],
         [0.391],
         [0.607],
         [0.760],
         [0.285]],

        [[0.264],
         [0.331],
         [0.305],
         [0.369],
         [0.292],
         [1.187],
         [0.296],
         [1.127],
         [0.828],
         [1.328]],

        [[0.632],
         [1.276],
         [0.154],
         [0.566],
         [0.795],
         [0.473],
         [0.448],
         [0.189],
         [0.947],
         [0.953]],

        [[0.395],
         [0.107],
         [0.035],
         [0.072],
         [0.186],
         [0.220],
         [0.361],
         [0.705],
         [0.943],
         [0.639]],

        [[0.309],
         [0.542],
         [0.086],
         [0.375],
         [1.391],
         [0.306],
         [1.556],
         [0.961],
         [0.111],
         [0.707]],

        [[1.414],
         [0.074],
         [0.296],
         [0.365],
         [0.402],
         [0.560],
         [0.079],
         [0.519],
         [0.179],
         [0.197]],

        [[0.921],
         [0.295],
         [0.283],
         [0.115],
         [0.479],
         [0.531],
         [1.008],
         [0.254],
         [0.263],
         [0.653]],

        [[0.071],
         [1.122],
         [0.440],
         [0.478],
         [0.400],
         [0.170],
         [1.043],
         [0.892],
         [0.211],
         [0.533]],

        [[0.797],
         [0.166],
         [0.298],
         [0.468],
         [0.302],
         [0.328],
         [1.125],
         [0.660],
         [0.225],
         [0.566]],

        [[0.188],
         [0.164],
         [0.449],
         [0.341],
         [0.258],
         [0.904],
         [0.172],
         [0.398],
         [0.831],
         [0.765]],

        [[0.118],
         [0.340],
         [0.371],
         [0.208],
         [0.057],
         [0.081],
         [0.234],
         [0.152],
         [0.687],
         [0.801]],

        [[0.767],
         [0.390],
         [0.340],
         [0.061],
         [0.160],
         [0.136],
         [0.129],
         [0.303],
         [0.084],
         [0.167]],

        [[1.040],
         [0.231],
         [2.135],
         [0.959],
         [0.294],
         [1.222],
         [0.806],
         [0.397],
         [0.617],
         [0.923]],

        [[0.205],
         [0.109],
         [0.683],
         [0.197],
         [0.268],
         [0.210],
         [0.416],
         [0.797],
         [0.422],
         [0.208]],

        [[0.455],
         [0.376],
         [0.180],
         [0.232],
         [0.680],
         [0.760],
         [0.278],
         [0.589],
         [0.363],
         [0.207]],

        [[0.328],
         [0.748],
         [0.330],
         [0.649],
         [0.323],
         [1.609],
         [0.237],
         [0.088],
         [0.448],
         [0.264]],

        [[0.057],
         [0.249],
         [0.366],
         [0.591],
         [0.226],
         [0.083],
         [0.164],
         [0.548],
         [0.109],
         [0.696]],

        [[0.393],
         [0.450],
         [0.630],
         [0.246],
         [0.776],
         [0.561],
         [0.290],
         [0.191],
         [1.282],
         [0.728]],

        [[0.923],
         [0.889],
         [0.200],
         [0.913],
         [0.527],
         [0.157],
         [0.254],
         [0.379],
         [0.163],
         [0.982]],

        [[0.762],
         [0.305],
         [0.316],
         [0.064],
         [0.113],
         [0.374],
         [0.173],
         [0.067],
         [0.288],
         [0.512]]], device='cuda:0')
clipping threshold 2.782537623814828
a after update for 1 param tensor([[ 1.724e-04],
        [-5.798e-04],
        [-8.260e-05],
        [-3.342e-04],
        [-2.596e-04],
        [ 2.821e-04],
        [ 2.423e-04],
        [ 8.609e-05],
        [ 1.824e-05],
        [-5.992e-06],
        [ 2.923e-05],
        [-4.673e-05],
        [ 1.761e-04],
        [-1.439e-05],
        [-1.114e-04],
        [ 4.101e-05],
        [-1.472e-04],
        [-1.095e-04],
        [ 1.163e-04],
        [ 1.176e-04]], device='cuda:0')
s after update for 1 param tensor([[0.030],
        [0.033],
        [0.002],
        [0.032],
        [0.011],
        [0.030],
        [0.047],
        [0.005],
        [0.008],
        [0.003],
        [0.007],
        [0.002],
        [0.015],
        [0.003],
        [0.003],
        [0.000],
        [0.003],
        [0.005],
        [0.010],
        [0.034]], device='cuda:0')
b after update for 1 param tensor([[1.013],
        [1.062],
        [0.282],
        [1.039],
        [0.603],
        [1.004],
        [1.263],
        [0.424],
        [0.538],
        [0.317],
        [0.481],
        [0.286],
        [0.706],
        [0.309],
        [0.294],
        [0.117],
        [0.313],
        [0.424],
        [0.576],
        [1.080]], device='cuda:0')
clipping threshold 2.782537623814828
||w||^2 0.07060301829085094
exp ma of ||w||^2 0.062164394877156234
||w|| 0.26571228479475867
exp ma of ||w|| 0.24445604903217982
||w||^2 0.06980228835380732
exp ma of ||w||^2 0.06056456786983877
||w|| 0.2642012270104121
exp ma of ||w|| 0.24190325064636595
||w||^2 0.03682869323535868
exp ma of ||w||^2 0.06292579684280111
||w|| 0.1919080332746878
exp ma of ||w|| 0.24540319859253207
||w||^2 0.06993189324603591
exp ma of ||w||^2 0.06509428768170389
||w|| 0.26444639011723325
exp ma of ||w|| 0.24945275705420564
||w||^2 0.06994967958191083
exp ma of ||w||^2 0.06721008777441129
||w|| 0.2644800173584213
exp ma of ||w|| 0.25291515083715477
||w||^2 0.059980290960346426
exp ma of ||w||^2 0.0654060386182992
||w|| 0.2449087400652464
exp ma of ||w|| 0.2507910371109559
||w||^2 0.09408728467646812
exp ma of ||w||^2 0.06372899650762248
||w|| 0.30673650691834536
exp ma of ||w|| 0.24610539948856683
v before min max tensor([[-2.110,  0.220, -0.982,  ..., -1.109, -0.638,  0.494],
        [-3.246,  1.586, -0.219,  ..., -0.645, -1.493, -1.298],
        [-1.289,  1.977, -2.119,  ..., -1.558, -2.647, -0.559],
        ...,
        [-1.096, -1.793, -1.463,  ..., -0.978, -0.726, -1.271],
        [-2.935, -1.648, -1.447,  ..., -0.230, -1.160,  0.183],
        [-0.835, -2.193,  1.489,  ...,  5.884, -1.441, -0.283]],
       device='cuda:0')
v tensor([[1.000e-12, 2.197e-01, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         4.941e-01],
        [1.000e-12, 1.586e+00, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [1.000e-12, 1.977e+00, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        ...,
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.829e-01],
        [1.000e-12, 1.000e-12, 1.489e+00,  ..., 5.884e+00, 1.000e-12,
         1.000e-12]], device='cuda:0')
v before min max tensor([-1.872e+00, -1.186e+00, -2.127e+00, -1.277e+00,  2.081e+00, -1.234e+00,
        -1.204e+00, -1.079e+00, -1.714e+00, -7.726e-01, -5.111e-01,  1.671e-01,
         5.209e-02, -1.525e+00, -9.120e-01, -2.108e+00, -1.865e+00,  1.279e+00,
        -4.455e-01,  1.890e+00, -1.681e+00,  2.194e+00,  6.039e+00,  7.004e+00,
        -1.613e+00, -3.445e-01, -1.096e+00, -3.420e-02, -3.219e+00, -2.929e+00,
        -6.888e-01, -2.123e+00, -2.119e+00, -2.499e+00, -2.419e+00, -1.791e+00,
        -2.305e+00, -2.501e+00, -1.895e+00, -1.351e+00,  2.337e+00, -1.058e+00,
         4.394e-01, -3.117e+00,  2.639e+00, -5.601e-01,  2.082e-01, -1.391e-01,
        -2.125e+00,  1.365e-02, -1.103e+00, -8.678e-01, -1.916e+00, -1.828e+00,
        -3.510e+00,  5.166e+00, -2.702e-01, -1.100e+00, -2.761e-01, -2.767e+00,
        -1.859e+00,  1.141e+01,  3.898e+00, -1.789e+00, -2.233e+00, -2.271e+00,
        -1.764e+00,  3.838e+00, -1.787e+00,  5.753e+00,  3.781e+00, -1.894e+00,
         9.712e-01, -1.116e+00, -1.584e+00,  4.834e+00, -6.100e-01, -4.376e-01,
         1.625e+00, -3.760e-01,  1.299e-01, -4.569e-01, -4.873e-01, -1.502e+00,
        -1.680e+00, -6.588e-01,  1.179e+00, -2.291e+00, -2.892e+00, -3.822e-01,
         5.494e+00,  1.770e+00, -1.613e+00, -2.303e+00, -6.481e-01, -7.666e-01,
         1.200e-01, -2.049e+00, -1.225e-01, -1.042e+00,  1.862e+00, -2.134e+00,
        -1.494e-01, -5.294e-01,  4.686e+00,  2.517e+00, -5.682e-01, -2.296e+00,
        -1.353e+00, -2.329e+00, -3.573e-01, -1.546e+00, -2.851e+00, -1.160e+00,
        -1.173e+00, -1.052e+00, -6.491e-01, -3.389e-01,  3.208e+00, -2.532e+00,
         2.929e+00, -2.350e-01, -1.452e+00, -1.763e+00, -3.240e+00, -2.051e+00,
        -1.867e+00, -2.064e+00, -2.112e+00, -1.777e+00, -1.030e+00, -3.176e+00,
         5.019e+00,  3.195e+00, -6.452e-01, -1.856e+00, -2.259e+00, -7.340e-01,
        -4.756e-01,  7.262e-01, -4.172e-01, -3.543e-01, -1.947e+00,  3.942e-01,
        -1.092e+00, -1.457e+00, -1.050e+00, -1.954e+00, -1.428e+00, -2.546e+00,
        -3.072e+00, -2.004e-01, -5.321e-01,  1.588e-01, -6.818e-01,  2.836e+00,
        -8.886e-01, -2.531e+00,  8.876e+00, -3.696e-01, -2.149e+00,  2.402e+00,
        -3.598e-02, -1.094e-01,  3.766e+00, -2.469e-01, -1.006e+00, -3.634e-01,
         2.619e+00, -1.387e+00, -1.675e+00, -1.007e+00, -2.110e+00,  2.061e+00,
        -5.202e-01, -1.273e+00, -2.240e+00, -1.206e+00, -5.707e-01, -1.996e+00,
        -8.894e-01, -1.467e+00, -7.667e-01,  1.264e+00, -1.782e+00, -1.444e+00,
        -8.691e-01, -9.280e-01, -6.146e-01,  1.372e+01, -2.371e+00, -1.820e+00,
         1.458e-01, -1.779e+00, -9.084e-01, -5.335e-01, -1.612e+00,  3.866e-01,
        -1.657e+00, -1.779e+00], device='cuda:0')
v tensor([1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 2.081e+00, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.671e-01,
        5.209e-02, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.279e+00,
        1.000e-12, 1.890e+00, 1.000e-12, 2.194e+00, 6.039e+00, 7.004e+00,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 2.337e+00, 1.000e-12,
        4.394e-01, 1.000e-12, 2.639e+00, 1.000e-12, 2.082e-01, 1.000e-12,
        1.000e-12, 1.365e-02, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 5.166e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e+01, 3.898e+00, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 3.838e+00, 1.000e-12, 5.753e+00, 3.781e+00, 1.000e-12,
        9.712e-01, 1.000e-12, 1.000e-12, 4.834e+00, 1.000e-12, 1.000e-12,
        1.625e+00, 1.000e-12, 1.299e-01, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.179e+00, 1.000e-12, 1.000e-12, 1.000e-12,
        5.494e+00, 1.770e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.200e-01, 1.000e-12, 1.000e-12, 1.000e-12, 1.862e+00, 1.000e-12,
        1.000e-12, 1.000e-12, 4.686e+00, 2.517e+00, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 3.208e+00, 1.000e-12,
        2.929e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        5.019e+00, 3.195e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 7.262e-01, 1.000e-12, 1.000e-12, 1.000e-12, 3.942e-01,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.588e-01, 1.000e-12, 2.836e+00,
        1.000e-12, 1.000e-12, 8.876e+00, 1.000e-12, 1.000e-12, 2.402e+00,
        1.000e-12, 1.000e-12, 3.766e+00, 1.000e-12, 1.000e-12, 1.000e-12,
        2.619e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 2.061e+00,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.264e+00, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12,
        1.458e-01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 3.866e-01,
        1.000e-12, 1.000e-12], device='cuda:0')
v before min max tensor([[[-1.774],
         [-2.177],
         [-2.512],
         [-0.104],
         [-1.847],
         [ 6.608],
         [-2.484],
         [-2.036],
         [-1.594],
         [ 4.850]],

        [[-1.490],
         [-0.315],
         [-1.280],
         [-2.190],
         [-3.150],
         [-1.390],
         [ 6.678],
         [-2.399],
         [ 2.742],
         [-0.497]],

        [[-1.417],
         [26.127],
         [ 7.816],
         [-2.664],
         [-1.072],
         [-2.204],
         [-1.041],
         [-1.731],
         [ 3.245],
         [ 0.447]],

        [[-1.939],
         [ 1.713],
         [ 0.699],
         [-3.965],
         [-0.886],
         [-3.015],
         [-1.636],
         [-3.353],
         [-0.394],
         [-2.338]],

        [[-3.379],
         [-0.913],
         [ 3.168],
         [-2.861],
         [-1.932],
         [ 4.924],
         [-2.090],
         [ 0.817],
         [-1.051],
         [ 4.724]],

        [[-3.687],
         [ 4.109],
         [ 2.213],
         [-2.445],
         [-1.388],
         [-2.457],
         [ 2.531],
         [ 0.507],
         [ 2.773],
         [ 2.444]],

        [[ 2.104],
         [-1.628],
         [-0.926],
         [-1.241],
         [-2.293],
         [-2.978],
         [-1.119],
         [ 1.455],
         [ 0.188],
         [ 2.499]],

        [[ 6.581],
         [ 1.639],
         [-2.966],
         [ 0.390],
         [-1.914],
         [ 0.322],
         [ 5.565],
         [ 1.010],
         [-1.732],
         [ 0.059]],

        [[ 9.015],
         [ 6.065],
         [ 8.809],
         [-2.064],
         [-2.279],
         [-0.492],
         [-4.248],
         [14.097],
         [-0.657],
         [ 1.357]],

        [[-2.917],
         [ 4.234],
         [-2.306],
         [-1.582],
         [-1.405],
         [-1.932],
         [-1.382],
         [ 2.569],
         [ 1.167],
         [-2.154]],

        [[-1.384],
         [ 2.829],
         [-0.714],
         [-1.769],
         [-0.764],
         [-1.948],
         [ 0.346],
         [-1.208],
         [-2.312],
         [-2.113]],

        [[ 0.389],
         [-2.078],
         [ 1.037],
         [-1.348],
         [-0.883],
         [-1.162],
         [-3.801],
         [11.017],
         [-0.464],
         [-1.704]],

        [[-1.285],
         [-2.257],
         [ 3.706],
         [-2.763],
         [-2.187],
         [-0.811],
         [ 0.074],
         [-1.735],
         [-2.502],
         [-2.542]],

        [[-1.800],
         [ 4.573],
         [-1.030],
         [-1.468],
         [ 0.615],
         [-0.788],
         [-0.959],
         [ 3.217],
         [ 0.153],
         [-1.527]],

        [[ 1.828],
         [ 3.948],
         [-2.634],
         [-1.465],
         [-1.684],
         [-2.986],
         [-1.067],
         [ 0.674],
         [-2.747],
         [-1.056]],

        [[-2.800],
         [-2.158],
         [-1.537],
         [-2.798],
         [-2.986],
         [-2.353],
         [ 4.558],
         [-1.877],
         [-2.174],
         [-1.755]],

        [[-1.259],
         [-1.857],
         [-0.951],
         [-1.589],
         [ 4.193],
         [-1.042],
         [ 6.965],
         [ 0.378],
         [-0.453],
         [ 9.608]],

        [[ 0.364],
         [-0.603],
         [10.297],
         [-1.108],
         [ 1.441],
         [-1.995],
         [-2.682],
         [-1.426],
         [-0.256],
         [-2.099]],

        [[ 1.542],
         [ 2.044],
         [-2.430],
         [-2.612],
         [-2.557],
         [-1.813],
         [-1.813],
         [-1.339],
         [-2.234],
         [ 1.935]],

        [[-0.990],
         [ 1.973],
         [-2.762],
         [-2.951],
         [ 0.394],
         [-1.256],
         [-2.279],
         [ 0.701],
         [ 2.883],
         [-1.421]]], device='cuda:0')
v tensor([[[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [6.608e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [4.850e+00]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [6.678e+00],
         [1.000e-12],
         [2.742e+00],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e+01],
         [7.816e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [3.245e+00],
         [4.468e-01]],

        [[1.000e-12],
         [1.713e+00],
         [6.992e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [3.168e+00],
         [1.000e-12],
         [1.000e-12],
         [4.924e+00],
         [1.000e-12],
         [8.173e-01],
         [1.000e-12],
         [4.724e+00]],

        [[1.000e-12],
         [4.109e+00],
         [2.213e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.531e+00],
         [5.068e-01],
         [2.773e+00],
         [2.444e+00]],

        [[2.104e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.455e+00],
         [1.881e-01],
         [2.499e+00]],

        [[6.581e+00],
         [1.639e+00],
         [1.000e-12],
         [3.897e-01],
         [1.000e-12],
         [3.224e-01],
         [5.565e+00],
         [1.010e+00],
         [1.000e-12],
         [5.948e-02]],

        [[9.015e+00],
         [6.065e+00],
         [8.809e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.357e+00]],

        [[1.000e-12],
         [4.234e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.569e+00],
         [1.167e+00],
         [1.000e-12]],

        [[1.000e-12],
         [2.829e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [3.462e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[3.892e-01],
         [1.000e-12],
         [1.037e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [3.706e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [7.413e-02],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [4.573e+00],
         [1.000e-12],
         [1.000e-12],
         [6.155e-01],
         [1.000e-12],
         [1.000e-12],
         [3.217e+00],
         [1.532e-01],
         [1.000e-12]],

        [[1.828e+00],
         [3.948e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [6.737e-01],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [4.558e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [4.193e+00],
         [1.000e-12],
         [6.965e+00],
         [3.777e-01],
         [1.000e-12],
         [9.608e+00]],

        [[3.639e-01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.441e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.542e+00],
         [2.044e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.935e+00]],

        [[1.000e-12],
         [1.973e+00],
         [1.000e-12],
         [1.000e-12],
         [3.942e-01],
         [1.000e-12],
         [1.000e-12],
         [7.014e-01],
         [2.883e+00],
         [1.000e-12]]], device='cuda:0')
v before min max tensor([[11.619],
        [-3.520],
        [-2.551],
        [-2.257],
        [-1.545],
        [ 8.755],
        [-1.386],
        [-0.311],
        [-3.663],
        [-3.341],
        [ 6.255],
        [ 5.763],
        [-0.977],
        [-2.307],
        [-0.159],
        [-3.416],
        [-3.122],
        [-3.582],
        [ 7.198],
        [-1.673]], device='cuda:0')
v tensor([[1.000e+01],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [8.755e+00],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [6.255e+00],
        [5.763e+00],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [7.198e+00],
        [1.000e-12]], device='cuda:0')
a after update for 1 param tensor([[-0.003, -0.012, -0.009,  ...,  0.013,  0.009, -0.002],
        [-0.027, -0.009,  0.033,  ...,  0.018, -0.015, -0.007],
        [ 0.015, -0.015, -0.014,  ..., -0.011, -0.061,  0.038],
        ...,
        [-0.021,  0.017, -0.007,  ..., -0.007, -0.014,  0.031],
        [-0.015, -0.046, -0.007,  ...,  0.040, -0.010,  0.004],
        [ 0.017, -0.009,  0.013,  ...,  0.033, -0.016,  0.023]],
       device='cuda:0')
s after update for 1 param tensor([[0.888, 0.631, 0.741,  ..., 0.469, 0.556, 0.502],
        [1.403, 1.001, 0.344,  ..., 0.388, 0.823, 0.592],
        [0.669, 1.208, 0.865,  ..., 0.805, 1.042, 0.969],
        ...,
        [0.474, 0.722, 0.913,  ..., 0.836, 0.393, 0.888],
        [1.227, 0.856, 1.098,  ..., 1.237, 0.650, 0.909],
        [0.726, 0.864, 0.689,  ..., 0.919, 0.591, 0.526]], device='cuda:0')
b after update for 1 param tensor([[57.836, 48.771, 52.827,  ..., 42.027, 45.763, 43.499],
        [72.715, 61.402, 36.016,  ..., 38.233, 55.696, 47.240],
        [50.197, 67.464, 57.071,  ..., 55.058, 62.642, 60.405],
        ...,
        [42.280, 52.144, 58.653,  ..., 56.109, 38.469, 57.830],
        [68.002, 56.772, 64.311,  ..., 68.256, 49.480, 58.522],
        [52.292, 57.039, 50.952,  ..., 58.851, 47.182, 44.496]],
       device='cuda:0')
clipping threshold 0.2199342538120872
a after update for 1 param tensor([ 2.150e-02, -2.771e-02,  4.601e-03,  4.983e-03, -1.867e-02, -6.686e-04,
         8.581e-03, -8.653e-03,  8.852e-03,  2.245e-03,  5.233e-06,  1.466e-02,
        -2.561e-03, -1.137e-02, -7.888e-04, -1.182e-03, -2.747e-03, -1.284e-02,
         1.896e-02,  4.155e-02, -2.038e-02,  1.506e-02, -8.857e-03,  3.479e-02,
        -3.329e-03,  3.223e-02, -1.699e-02,  1.527e-03,  2.958e-02,  1.211e-03,
         1.710e-02, -2.409e-02, -3.239e-02, -2.709e-02, -1.717e-02, -1.230e-02,
         1.606e-02, -3.665e-02,  4.043e-03, -2.136e-02,  1.287e-02, -5.277e-02,
         1.119e-02, -3.221e-02, -7.091e-03, -1.689e-02,  2.411e-02, -6.914e-03,
        -3.730e-02, -4.516e-03, -6.853e-03, -5.135e-03,  5.819e-03, -6.421e-03,
         4.245e-02, -2.398e-03,  1.340e-02, -2.574e-02,  4.043e-02, -8.477e-03,
        -3.335e-03, -1.322e-02,  3.551e-02, -8.908e-03,  3.480e-03, -3.390e-02,
        -8.633e-03,  1.229e-02, -1.331e-02, -2.915e-02, -3.633e-02,  6.105e-03,
        -4.423e-03,  2.570e-02, -1.157e-02,  1.532e-02, -1.742e-02,  5.202e-03,
         3.523e-02, -6.082e-03, -1.466e-02, -1.647e-02, -5.584e-03,  3.252e-02,
         5.384e-03, -9.113e-03, -1.226e-03, -3.796e-03,  1.510e-02, -1.228e-02,
         2.012e-02,  8.076e-03, -1.766e-02,  3.283e-02,  2.037e-02, -1.638e-02,
        -1.573e-02,  4.765e-03, -5.299e-03, -2.259e-03, -1.484e-03,  2.531e-03,
         9.196e-03,  1.234e-02, -2.720e-02, -5.207e-03, -8.498e-03, -2.362e-02,
        -1.323e-02,  8.176e-03, -1.347e-02,  1.559e-03, -1.004e-02, -1.170e-02,
         1.841e-02, -2.519e-02, -8.846e-03, -1.788e-03, -6.105e-03, -1.838e-03,
        -1.942e-02,  1.212e-02, -2.397e-02, -1.818e-03, -2.719e-02, -6.799e-03,
        -2.590e-02,  2.994e-02,  1.702e-02, -3.059e-03,  5.423e-03,  5.072e-03,
         5.546e-02,  1.766e-02, -1.718e-02, -4.142e-02,  1.784e-02,  5.388e-03,
        -6.163e-03,  1.602e-02,  1.489e-02,  1.182e-02,  3.129e-03, -6.492e-03,
        -1.811e-02, -5.530e-03, -3.891e-02,  2.192e-03, -3.249e-03,  1.330e-02,
        -4.566e-03,  8.304e-03,  3.619e-03, -1.315e-02, -5.791e-03, -1.279e-02,
        -1.235e-02,  1.764e-02,  1.010e-02,  2.086e-02, -2.274e-02,  1.370e-02,
        -3.022e-02, -6.114e-03,  1.179e-02,  2.717e-02, -1.195e-03, -1.902e-04,
         4.074e-02, -1.986e-03, -9.029e-03, -1.927e-02, -8.965e-03, -1.311e-02,
         2.570e-03,  2.453e-03, -1.157e-02,  1.810e-02, -2.966e-04, -3.469e-03,
        -3.160e-03,  2.313e-02, -3.698e-02,  6.214e-03, -4.785e-03, -1.147e-02,
         7.370e-03,  5.267e-03,  7.123e-03, -3.576e-02,  2.003e-02, -3.517e-02,
         3.235e-02, -1.252e-02,  5.231e-03,  4.128e-02,  8.927e-03,  1.912e-02,
        -2.828e-02,  1.443e-02], device='cuda:0')
s after update for 1 param tensor([0.823, 0.797, 0.971, 0.671, 0.744, 0.502, 0.614, 0.538, 0.717, 0.304,
        1.148, 0.337, 0.688, 0.721, 0.496, 0.835, 0.736, 0.706, 0.488, 0.973,
        1.365, 0.822, 1.337, 1.508, 0.635, 0.680, 0.862, 0.379, 1.270, 1.267,
        1.575, 0.919, 0.846, 1.246, 1.226, 0.706, 0.980, 1.008, 1.313, 0.690,
        0.729, 0.842, 0.784, 1.354, 1.110, 0.647, 1.001, 0.602, 0.858, 0.695,
        0.613, 0.411, 1.021, 0.866, 1.381, 1.261, 0.199, 0.434, 0.578, 1.276,
        0.754, 1.195, 1.020, 0.912, 1.041, 0.927, 0.958, 0.721, 0.704, 1.221,
        1.226, 0.773, 0.857, 0.774, 0.626, 0.933, 0.441, 0.212, 1.028, 0.196,
        0.789, 0.877, 0.662, 0.663, 0.861, 0.622, 1.204, 0.914, 1.160, 0.412,
        1.619, 1.305, 0.637, 1.066, 1.422, 0.306, 0.587, 0.825, 0.583, 0.833,
        1.109, 1.033, 0.505, 0.492, 0.842, 1.324, 0.418, 1.091, 0.589, 1.060,
        0.336, 0.660, 1.137, 0.507, 0.679, 0.434, 0.968, 0.555, 1.230, 1.001,
        0.988, 0.355, 0.838, 0.886, 1.381, 0.943, 0.859, 0.831, 1.140, 0.700,
        1.198, 1.329, 1.178, 1.258, 0.590, 0.730, 0.898, 0.421, 0.681, 0.760,
        0.519, 0.514, 0.767, 0.611, 1.050, 0.573, 1.028, 0.856, 0.660, 1.007,
        1.221, 0.603, 0.278, 0.350, 0.888, 1.054, 0.499, 1.098, 1.600, 1.257,
        0.850, 1.026, 1.266, 0.486, 1.319, 0.552, 1.098, 1.030, 1.124, 0.580,
        0.841, 0.445, 0.835, 1.068, 0.730, 0.506, 0.958, 1.011, 1.132, 0.853,
        0.403, 0.586, 0.778, 1.229, 0.952, 0.936, 0.410, 0.536, 0.295, 1.524,
        1.025, 1.069, 1.361, 0.746, 0.779, 0.581, 0.693, 0.835, 0.690, 0.708],
       device='cuda:0')
b after update for 1 param tensor([55.699, 54.805, 60.474, 50.261, 52.931, 43.495, 48.106, 45.010, 51.980,
        33.870, 65.759, 35.638, 50.915, 52.136, 43.233, 56.084, 52.641, 51.558,
        42.896, 60.542, 71.703, 55.649, 70.985, 75.369, 48.903, 50.618, 56.995,
        37.806, 69.163, 69.095, 77.037, 58.847, 56.472, 68.518, 67.965, 51.571,
        60.776, 61.636, 70.333, 50.984, 52.393, 56.309, 54.342, 71.421, 64.678,
        49.360, 61.398, 47.614, 56.860, 51.152, 48.058, 39.360, 62.006, 57.117,
        72.138, 68.923, 27.361, 40.455, 46.685, 69.346, 53.281, 67.095, 61.990,
        58.629, 62.637, 59.081, 60.063, 52.110, 51.515, 67.820, 67.969, 53.967,
        56.811, 53.985, 48.563, 59.287, 40.782, 28.239, 62.241, 27.154, 54.521,
        57.481, 49.956, 49.995, 56.942, 48.405, 67.336, 58.682, 66.110, 39.380,
        78.110, 70.120, 49.000, 63.385, 73.196, 33.954, 47.040, 55.765, 46.871,
        56.006, 64.633, 62.388, 43.624, 43.047, 56.307, 70.627, 39.663, 64.116,
        47.092, 63.202, 35.593, 49.870, 65.439, 43.687, 50.590, 40.420, 60.399,
        45.742, 68.076, 61.415, 61.015, 36.547, 56.192, 57.765, 72.141, 59.607,
        56.894, 55.968, 65.540, 51.340, 67.175, 70.772, 66.633, 68.838, 47.147,
        52.452, 58.164, 39.834, 50.649, 53.506, 44.229, 43.988, 53.763, 47.960,
        62.902, 46.480, 62.234, 56.773, 49.861, 61.593, 67.820, 47.649, 32.364,
        36.303, 57.828, 63.015, 43.346, 64.305, 77.632, 68.808, 56.578, 62.177,
        69.060, 42.784, 70.502, 45.602, 64.304, 62.292, 65.072, 46.752, 56.287,
        40.965, 56.094, 63.426, 52.437, 43.651, 60.085, 61.714, 65.314, 56.695,
        38.986, 46.999, 54.127, 68.057, 59.885, 59.374, 39.292, 44.927, 33.338,
        75.769, 62.132, 63.475, 71.606, 53.017, 54.168, 46.801, 51.107, 56.076,
        50.982, 51.642], device='cuda:0')
clipping threshold 0.2199342538120872
a after update for 1 param tensor([[[ 0.022],
         [ 0.006],
         [-0.025],
         [ 0.025],
         [ 0.080],
         [ 0.008],
         [ 0.023],
         [-0.029],
         [ 0.056],
         [ 0.029]],

        [[-0.038],
         [-0.057],
         [-0.009],
         [-0.053],
         [ 0.012],
         [ 0.021],
         [-0.013],
         [-0.031],
         [-0.007],
         [-0.031]],

        [[ 0.007],
         [-0.006],
         [ 0.086],
         [-0.058],
         [-0.062],
         [ 0.107],
         [-0.051],
         [ 0.017],
         [-0.031],
         [-0.084]],

        [[ 0.008],
         [ 0.035],
         [ 0.017],
         [ 0.033],
         [-0.054],
         [-0.054],
         [ 0.053],
         [-0.048],
         [-0.003],
         [ 0.026]],

        [[ 0.001],
         [-0.031],
         [ 0.024],
         [-0.074],
         [ 0.026],
         [ 0.009],
         [-0.044],
         [ 0.041],
         [-0.091],
         [ 0.055]],

        [[ 0.071],
         [ 0.067],
         [ 0.001],
         [ 0.031],
         [-0.067],
         [ 0.009],
         [-0.096],
         [-0.029],
         [-0.037],
         [-0.041]],

        [[-0.019],
         [ 0.032],
         [-0.103],
         [ 0.001],
         [-0.010],
         [-0.025],
         [ 0.054],
         [-0.049],
         [ 0.048],
         [ 0.033]],

        [[ 0.018],
         [ 0.014],
         [ 0.029],
         [ 0.025],
         [ 0.022],
         [-0.011],
         [-0.001],
         [ 0.015],
         [ 0.001],
         [ 0.032]],

        [[-0.013],
         [ 0.012],
         [-0.042],
         [ 0.024],
         [ 0.075],
         [ 0.029],
         [-0.003],
         [-0.056],
         [-0.028],
         [ 0.005]],

        [[ 0.001],
         [ 0.065],
         [-0.017],
         [-0.067],
         [ 0.049],
         [-0.075],
         [-0.014],
         [ 0.053],
         [-0.066],
         [-0.082]],

        [[ 0.047],
         [ 0.083],
         [-0.067],
         [ 0.026],
         [ 0.035],
         [-0.012],
         [-0.014],
         [-0.044],
         [-0.037],
         [-0.054]],

        [[-0.003],
         [-0.043],
         [-0.066],
         [-0.055],
         [ 0.058],
         [ 0.038],
         [ 0.082],
         [ 0.020],
         [ 0.048],
         [ 0.022]],

        [[ 0.070],
         [ 0.027],
         [ 0.061],
         [-0.079],
         [ 0.017],
         [ 0.032],
         [-0.018],
         [ 0.084],
         [-0.056],
         [ 0.038]],

        [[-0.026],
         [ 0.009],
         [ 0.017],
         [ 0.013],
         [ 0.012],
         [ 0.051],
         [-0.030],
         [-0.048],
         [-0.000],
         [ 0.038]],

        [[-0.068],
         [-0.034],
         [-0.003],
         [ 0.032],
         [ 0.008],
         [ 0.039],
         [ 0.013],
         [ 0.074],
         [-0.015],
         [-0.012]],

        [[ 0.017],
         [ 0.075],
         [-0.023],
         [ 0.015],
         [-0.007],
         [-0.052],
         [-0.015],
         [ 0.028],
         [ 0.027],
         [-0.056]],

        [[ 0.031],
         [ 0.056],
         [ 0.007],
         [-0.052],
         [ 0.041],
         [-0.007],
         [-0.064],
         [ 0.007],
         [-0.014],
         [ 0.007]],

        [[-0.105],
         [-0.057],
         [-0.052],
         [ 0.013],
         [-0.080],
         [-0.024],
         [ 0.030],
         [ 0.051],
         [-0.043],
         [ 0.056]],

        [[ 0.125],
         [ 0.061],
         [-0.081],
         [ 0.071],
         [-0.029],
         [ 0.003],
         [-0.051],
         [-0.046],
         [-0.015],
         [ 0.036]],

        [[-0.008],
         [ 0.033],
         [ 0.001],
         [-0.012],
         [-0.010],
         [-0.043],
         [ 0.011],
         [ 0.027],
         [ 0.063],
         [ 0.028]]], device='cuda:0')
s after update for 1 param tensor([[[0.715],
         [0.886],
         [1.220],
         [0.949],
         [0.786],
         [1.296],
         [1.454],
         [0.801],
         [0.669],
         [0.961]],

        [[0.926],
         [0.778],
         [0.655],
         [1.408],
         [1.241],
         [0.641],
         [1.406],
         [1.272],
         [1.027],
         [0.930]],

        [[0.994],
         [1.848],
         [1.894],
         [1.575],
         [1.186],
         [0.978],
         [1.096],
         [0.895],
         [1.273],
         [0.708]],

        [[1.124],
         [1.133],
         [1.109],
         [1.562],
         [1.140],
         [1.198],
         [0.990],
         [1.432],
         [1.065],
         [0.955]],

        [[1.344],
         [0.826],
         [1.184],
         [1.416],
         [0.914],
         [1.445],
         [1.125],
         [1.171],
         [0.961],
         [1.340]],

        [[1.451],
         [1.035],
         [1.014],
         [0.994],
         [0.566],
         [1.181],
         [1.027],
         [1.462],
         [1.357],
         [0.723]],

        [[1.167],
         [0.646],
         [0.783],
         [0.799],
         [0.968],
         [1.549],
         [0.456],
         [1.294],
         [0.486],
         [1.410]],

        [[1.182],
         [0.996],
         [1.276],
         [1.267],
         [0.753],
         [0.642],
         [1.111],
         [0.809],
         [0.683],
         [0.439]],

        [[1.823],
         [1.321],
         [1.669],
         [0.844],
         [1.163],
         [1.144],
         [1.870],
         [1.315],
         [1.019],
         [1.138]],

        [[1.223],
         [1.231],
         [0.908],
         [0.671],
         [0.582],
         [0.940],
         [0.652],
         [1.500],
         [1.482],
         [0.913]],

        [[0.550],
         [1.392],
         [1.016],
         [0.698],
         [0.767],
         [0.927],
         [0.703],
         [1.002],
         [0.917],
         [1.083]],

        [[0.943],
         [1.170],
         [1.154],
         [0.724],
         [1.132],
         [0.478],
         [1.983],
         [1.319],
         [0.696],
         [1.133]],

        [[0.660],
         [0.925],
         [1.164],
         [1.637],
         [1.226],
         [0.498],
         [0.925],
         [0.843],
         [0.988],
         [1.287]],

        [[0.803],
         [1.161],
         [0.914],
         [0.611],
         [1.126],
         [0.875],
         [0.403],
         [1.013],
         [0.507],
         [0.830]],

        [[1.586],
         [1.460],
         [1.039],
         [1.270],
         [1.027],
         [1.302],
         [1.351],
         [1.237],
         [1.089],
         [0.858]],

        [[1.149],
         [1.231],
         [1.342],
         [1.281],
         [1.229],
         [0.934],
         [1.376],
         [0.743],
         [1.161],
         [0.769]],

        [[0.507],
         [0.845],
         [0.560],
         [0.705],
         [1.090],
         [1.589],
         [1.051],
         [0.777],
         [1.166],
         [1.492]],

        [[1.252],
         [1.408],
         [1.414],
         [1.325],
         [1.547],
         [1.062],
         [1.071],
         [0.567],
         [0.763],
         [1.015]],

        [[1.480],
         [0.992],
         [0.958],
         [1.037],
         [1.007],
         [1.022],
         [0.863],
         [0.757],
         [0.933],
         [1.062]],

        [[0.982],
         [0.917],
         [1.097],
         [1.173],
         [1.313],
         [0.561],
         [0.900],
         [1.247],
         [1.165],
         [0.886]]], device='cuda:0')
b after update for 1 param tensor([[[51.903],
         [57.782],
         [67.804],
         [59.804],
         [54.433],
         [69.880],
         [74.005],
         [54.938],
         [50.217],
         [60.177]],

        [[59.074],
         [54.130],
         [49.662],
         [72.835],
         [68.374],
         [49.139],
         [72.775],
         [69.234],
         [62.196],
         [59.204]],

        [[61.199],
         [83.435],
         [84.465],
         [77.026],
         [66.836],
         [60.702],
         [64.252],
         [58.057],
         [69.243],
         [51.630]],

        [[65.062],
         [65.328],
         [64.644],
         [76.720],
         [65.534],
         [67.189],
         [61.079],
         [73.442],
         [63.357],
         [59.972]],

        [[71.145],
         [55.798],
         [66.782],
         [73.047],
         [58.688],
         [73.786],
         [65.096],
         [66.416],
         [60.169],
         [71.057]],

        [[73.937],
         [62.430],
         [61.815],
         [61.207],
         [46.164],
         [66.704],
         [62.203],
         [74.227],
         [71.505],
         [52.192]],

        [[66.310],
         [49.332],
         [54.328],
         [54.857],
         [60.393],
         [76.401],
         [41.464],
         [69.813],
         [42.788],
         [72.892]],

        [[66.721],
         [61.265],
         [69.336],
         [69.100],
         [53.277],
         [49.181],
         [64.693],
         [55.204],
         [50.728],
         [40.665]],

        [[82.867],
         [70.546],
         [79.287],
         [56.393],
         [66.191],
         [65.649],
         [83.935],
         [70.373],
         [61.974],
         [65.469]],

        [[67.873],
         [68.092],
         [58.477],
         [50.270],
         [46.822],
         [59.519],
         [49.573],
         [75.181],
         [74.710],
         [58.644]],

        [[45.526],
         [72.424],
         [61.864],
         [51.282],
         [53.755],
         [59.102],
         [51.473],
         [61.448],
         [58.766],
         [63.866]],

        [[59.607],
         [66.388],
         [65.950],
         [52.211],
         [65.313],
         [42.446],
         [86.441],
         [70.488],
         [51.189],
         [65.338]],

        [[49.859],
         [59.039],
         [66.221],
         [78.537],
         [67.960],
         [43.326],
         [59.019],
         [56.340],
         [60.998],
         [69.644]],

        [[55.017],
         [66.135],
         [58.684],
         [47.978],
         [65.143],
         [57.419],
         [38.982],
         [61.788],
         [43.712],
         [55.913]],

        [[77.304],
         [74.160],
         [62.574],
         [69.179],
         [62.208],
         [70.033],
         [71.352],
         [68.257],
         [64.039],
         [56.871]],

        [[65.802],
         [68.089],
         [71.111],
         [69.481],
         [68.043],
         [59.315],
         [71.997],
         [52.909],
         [66.124],
         [53.808]],

        [[43.714],
         [56.411],
         [45.935],
         [51.548],
         [64.078],
         [77.384],
         [62.924],
         [54.114],
         [66.272],
         [74.978]],

        [[68.690],
         [72.842],
         [72.977],
         [70.659],
         [76.336],
         [63.266],
         [63.510],
         [46.220],
         [53.623],
         [61.824]],

        [[74.676],
         [61.121],
         [60.091],
         [62.492],
         [61.582],
         [62.038],
         [57.010],
         [53.395],
         [59.297],
         [63.247]],

        [[60.819],
         [58.783],
         [64.276],
         [66.481],
         [70.340],
         [45.989],
         [58.239],
         [68.535],
         [66.255],
         [57.782]]], device='cuda:0')
clipping threshold 0.2199342538120872
a after update for 1 param tensor([[ 1.076e-02],
        [-2.761e-02],
        [-2.130e-02],
        [-3.241e-05],
        [ 1.349e-02],
        [-5.540e-03],
        [ 2.027e-03],
        [-3.792e-02],
        [-5.225e-03],
        [ 2.164e-02],
        [ 9.185e-03],
        [-1.317e-02],
        [ 8.911e-03],
        [ 2.194e-02],
        [ 8.128e-04],
        [-1.141e-02],
        [-1.099e-02],
        [ 4.040e-02],
        [ 8.645e-02],
        [-4.981e-02]], device='cuda:0')
s after update for 1 param tensor([[1.315],
        [1.431],
        [1.004],
        [1.327],
        [1.536],
        [1.578],
        [1.211],
        [0.749],
        [1.566],
        [1.395],
        [1.300],
        [1.335],
        [0.928],
        [1.055],
        [1.221],
        [1.349],
        [1.382],
        [1.468],
        [2.048],
        [0.887]], device='cuda:0')
b after update for 1 param tensor([[70.377],
        [73.417],
        [61.510],
        [70.702],
        [76.059],
        [77.112],
        [67.547],
        [53.129],
        [76.820],
        [72.506],
        [69.986],
        [70.926],
        [59.113],
        [63.040],
        [67.823],
        [71.291],
        [72.165],
        [74.379],
        [87.836],
        [57.818]], device='cuda:0')
clipping threshold 0.2199342538120872
||w||^2 0.09007146073976822
exp ma of ||w||^2 0.0784645783368092
||w|| 0.30011907760048884
exp ma of ||w|| 0.27392924381476347
||w||^2 0.07073497554504499
exp ma of ||w||^2 0.07290917451794583
||w|| 0.26596047741167295
exp ma of ||w|| 0.2632367117952686
||w||^2 0.1250014557470089
exp ma of ||w||^2 0.06986765382442862
||w|| 0.35355544932444316
exp ma of ||w|| 0.25671851178675525
||w||^2 0.02948456744290065
exp ma of ||w||^2 0.06719885360667574
||w|| 0.1717107085854014
exp ma of ||w|| 0.25206646233324814
||w||^2 0.08583348086921282
exp ma of ||w||^2 0.07433916414860542
||w|| 0.2929735156446958
exp ma of ||w|| 0.2637008365198405
cuda
Objective function 19.01 = squared loss an data 17.37 + 0.5*rho*h**2 1.108036 + alpha*h 0.000000 + L2reg 0.29 + L1reg 0.23 ; SHD = 55 ; DAG False
Proportion of microbatches that were clipped  0.7581166209013084
iteration 1 in inner loop, alpha 0.0 rho 1.0 h 1.4886474067704256
iteration 1 in outer loop, alpha = 1.4886474067704256, rho = 1.0, h = 1.4886474067704256
cuda
4420
cuda
Objective function 21.22 = squared loss an data 17.37 + 0.5*rho*h**2 1.108036 + alpha*h 2.216071 + L2reg 0.29 + L1reg 0.23 ; SHD = 55 ; DAG False
||w||^2 654154761.806115
exp ma of ||w||^2 2931285958.960369
||w|| 25576.449358855796
exp ma of ||w|| 42426.69670830093
||w||^2 170.81947293680804
exp ma of ||w||^2 2412828.1621092306
||w|| 13.069792383079696
exp ma of ||w|| 200.4324715851819
||w||^2 0.09575420150630219
exp ma of ||w||^2 51903.37610029773
||w|| 0.30944175785808575
exp ma of ||w|| 5.28107455466388
||w||^2 0.07512818797155202
exp ma of ||w||^2 0.07097674941685583
||w|| 0.2740952169804355
exp ma of ||w|| 0.26029999655962266
||w||^2 0.049322710146534575
exp ma of ||w||^2 0.06302402068720574
||w|| 0.22208716790155747
exp ma of ||w|| 0.24411885856055784
||w||^2 0.04809070052281468
exp ma of ||w||^2 0.0772842101451779
||w|| 0.21929591998670353
exp ma of ||w|| 0.270426582055818
||w||^2 0.06601525526881481
exp ma of ||w||^2 0.0746372213698235
||w|| 0.2569343403844936
exp ma of ||w|| 0.26571917339423556
||w||^2 0.03144814046643633
exp ma of ||w||^2 0.07474019800173129
||w|| 0.1773362356272297
exp ma of ||w|| 0.26510787282883325
||w||^2 0.027769157295511847
exp ma of ||w||^2 0.0729779615122268
||w|| 0.1666408032131142
exp ma of ||w|| 0.2630755004688469
||w||^2 0.14416098484377957
exp ma of ||w||^2 0.06662354439840339
||w|| 0.37968537612578596
exp ma of ||w|| 0.2513678893805972
||w||^2 0.05070867864273157
exp ma of ||w||^2 0.0815881528253801
||w|| 0.22518587576207255
exp ma of ||w|| 0.2753987761449679
||w||^2 0.06060721650106805
exp ma of ||w||^2 0.08175583249326371
||w|| 0.24618532958132994
exp ma of ||w|| 0.2788344439168832
cuda
Objective function 18.69 = squared loss an data 16.21 + 0.5*rho*h**2 0.446294 + alpha*h 1.406427 + L2reg 0.42 + L1reg 0.21 ; SHD = 45 ; DAG False
Proportion of microbatches that were clipped  0.753887486770333
iteration 1 in inner loop, alpha 1.4886474067704256 rho 1.0 h 0.9447686455837498
4420
cuda
Objective function 22.71 = squared loss an data 16.21 + 0.5*rho*h**2 4.462939 + alpha*h 1.406427 + L2reg 0.42 + L1reg 0.21 ; SHD = 45 ; DAG False
||w||^2 12.244795228328929
exp ma of ||w||^2 706765.1978768911
||w|| 3.499256382194498
exp ma of ||w|| 54.427126106989505
||w||^2 0.05742504902280048
exp ma of ||w||^2 0.11193061500307366
||w|| 0.23963524161274877
exp ma of ||w|| 0.24273563595515787
v before min max tensor([[-3.872, -4.231, -0.297,  ..., -2.144, -4.007, 17.404],
        [ 1.056, -1.126, 50.334,  ...,  6.349, 13.722, -5.992],
        [ 7.334,  1.334,  5.159,  ...,  2.844, -0.596,  5.147],
        ...,
        [-2.355, -4.052, -1.982,  ..., -0.517, -4.935, -4.205],
        [-0.349, -4.897, -2.444,  ..., -5.039, -1.063,  4.172],
        [-1.453, -1.810, -3.224,  ...,  1.211, -2.579, -4.547]],
       device='cuda:0')
v tensor([[1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e+01],
        [1.056e+00, 1.000e-12, 1.000e+01,  ..., 6.349e+00, 1.000e+01,
         1.000e-12],
        [7.334e+00, 1.334e+00, 5.159e+00,  ..., 2.844e+00, 1.000e-12,
         5.147e+00],
        ...,
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         4.172e+00],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.211e+00, 1.000e-12,
         1.000e-12]], device='cuda:0')
v before min max tensor([-2.708e+00,  2.989e+00, -5.222e-01, -5.324e+00, -2.606e+00, -3.078e+00,
         7.229e+00, -1.954e+00,  4.483e-01,  5.949e-01,  3.085e+00, -3.101e+00,
        -2.189e+00, -1.818e+00, -2.656e+00, -7.052e-01,  2.435e+01, -4.740e+00,
         1.771e+01, -6.419e-01, -1.093e+00,  2.567e+00,  8.067e-01, -3.336e+00,
         6.023e+00,  3.219e-01, -4.852e+00, -2.696e+00,  6.803e+00,  1.205e+00,
        -2.571e+00, -3.948e+00,  2.273e+00, -6.326e-01, -2.101e+00, -2.619e+00,
        -5.179e+00,  4.099e+00, -2.641e+00, -3.666e+00,  1.790e+01, -3.334e+00,
        -4.809e+00, -2.646e+00, -4.976e+00, -5.016e+00, -4.650e-01, -1.415e+00,
         1.387e+01, -2.882e+00, -1.864e+00,  3.968e+00,  1.119e+00, -2.733e+00,
        -3.664e+00,  2.350e-01, -2.171e+00, -4.340e+00,  4.388e+00,  2.301e+00,
         8.552e-01, -4.055e+00, -3.945e+00, -5.786e+00, -1.140e-01, -4.223e+00,
        -2.225e+00,  4.122e+00,  4.740e+00,  2.096e+00, -4.895e+00, -1.447e+00,
        -2.500e+00,  4.884e+00, -4.228e+00, -3.075e+00,  2.004e+00, -4.968e+00,
         7.328e+00,  2.279e+00, -3.299e+00, -5.310e+00,  1.255e+01,  1.359e+00,
        -3.480e+00, -1.424e+00, -2.794e+00,  8.024e+00,  1.315e+01,  1.825e+01,
         5.400e+01,  6.212e+00,  1.496e+01, -2.259e+00,  5.670e+00,  4.488e+00,
        -5.678e+00, -8.405e-01,  6.620e+00, -2.453e+00, -5.459e+00, -5.432e+00,
        -1.802e+00,  1.913e+01, -4.011e+00, -5.205e+00,  5.356e+00, -1.263e+00,
         1.396e+00,  5.936e+00, -5.612e+00, -4.816e+00, -2.289e+00, -1.300e-01,
         3.550e+00, -2.134e+00, -3.803e+00, -4.474e+00, -5.358e+00,  1.719e+01,
        -3.292e+00, -4.254e+00,  2.421e+00,  1.729e+01, -4.321e+00, -2.871e+00,
        -4.235e+00,  7.069e+00, -3.683e+00,  3.345e+00, -4.233e+00, -4.160e+00,
         4.498e+00, -2.970e+00, -4.013e+00,  4.605e+00, -4.802e+00, -5.096e+00,
        -3.271e+00, -4.006e+00, -1.467e+00,  4.806e+00, -3.982e+00, -1.279e+00,
        -1.821e+00, -2.233e+00, -4.246e+00,  2.890e+00, -2.624e+00, -3.302e+00,
        -3.554e+00, -4.037e+00, -1.059e+00, -2.647e+00, -1.107e+00,  5.324e-01,
        -1.942e+00, -6.100e+00,  2.130e+01, -3.271e+00, -3.889e+00, -5.301e-02,
        -1.990e+00, -3.901e+00, -3.920e+00, -3.643e+00, -2.754e+00, -8.367e-01,
         3.766e+00, -6.190e+00, -4.381e+00,  5.078e+00, -2.970e+00,  3.005e-01,
        -2.721e+00, -4.355e+00, -1.413e+00, -1.817e+00, -4.995e+00, -3.419e+00,
        -5.791e+00, -4.432e+00, -4.605e+00,  1.514e+01, -4.564e+00, -4.702e+00,
        -4.734e-01, -1.933e+00, -2.379e+00, -4.059e+00, -3.991e+00, -2.277e+00,
        -3.263e+00,  7.708e+00, -5.645e+00, -2.738e+00, -2.406e+00, -3.656e+00,
        -1.115e+00, -1.236e+00], device='cuda:0')
v tensor([1.000e-12, 2.989e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        7.229e+00, 1.000e-12, 4.483e-01, 5.949e-01, 3.085e+00, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e-12, 2.567e+00, 8.067e-01, 1.000e-12,
        6.023e+00, 3.219e-01, 1.000e-12, 1.000e-12, 6.803e+00, 1.205e+00,
        1.000e-12, 1.000e-12, 2.273e+00, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 4.099e+00, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e-12, 3.968e+00, 1.119e+00, 1.000e-12,
        1.000e-12, 2.350e-01, 1.000e-12, 1.000e-12, 4.388e+00, 2.301e+00,
        8.552e-01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 4.122e+00, 4.740e+00, 2.096e+00, 1.000e-12, 1.000e-12,
        1.000e-12, 4.884e+00, 1.000e-12, 1.000e-12, 2.004e+00, 1.000e-12,
        7.328e+00, 2.279e+00, 1.000e-12, 1.000e-12, 1.000e+01, 1.359e+00,
        1.000e-12, 1.000e-12, 1.000e-12, 8.024e+00, 1.000e+01, 1.000e+01,
        1.000e+01, 6.212e+00, 1.000e+01, 1.000e-12, 5.670e+00, 4.488e+00,
        1.000e-12, 1.000e-12, 6.620e+00, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 5.356e+00, 1.000e-12,
        1.396e+00, 5.936e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        3.550e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01,
        1.000e-12, 1.000e-12, 2.421e+00, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e-12, 7.069e+00, 1.000e-12, 3.345e+00, 1.000e-12, 1.000e-12,
        4.498e+00, 1.000e-12, 1.000e-12, 4.605e+00, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 4.806e+00, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 2.890e+00, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 5.324e-01,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        3.766e+00, 1.000e-12, 1.000e-12, 5.078e+00, 1.000e-12, 3.005e-01,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 7.708e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12], device='cuda:0')
v before min max tensor([[[ 7.654e-01],
         [-1.562e+00],
         [-2.641e+00],
         [-4.884e-01],
         [-1.998e+00],
         [ 2.760e+00],
         [-6.601e+00],
         [ 8.881e-01],
         [ 7.379e-02],
         [-1.751e+00]],

        [[ 2.318e+00],
         [-3.703e+00],
         [-4.899e+00],
         [ 8.965e+00],
         [-1.343e-01],
         [-1.175e+00],
         [ 4.240e-01],
         [ 1.816e+01],
         [-2.138e+00],
         [ 4.943e-01]],

        [[-1.595e-01],
         [-2.800e+00],
         [-2.435e+00],
         [ 5.118e+00],
         [-3.148e+00],
         [-1.598e+00],
         [ 3.041e-01],
         [-5.063e+00],
         [ 9.325e+00],
         [-4.072e+00]],

        [[-3.486e+00],
         [ 4.157e-02],
         [-4.483e+00],
         [-5.673e+00],
         [-2.506e+00],
         [ 3.541e+01],
         [-3.703e+00],
         [ 5.418e-01],
         [-4.774e+00],
         [-3.469e+00]],

        [[ 3.872e+00],
         [-3.678e+00],
         [-1.943e+00],
         [-5.510e+00],
         [ 3.755e+00],
         [ 4.424e+00],
         [ 4.284e+00],
         [-7.255e-01],
         [ 4.826e+01],
         [ 1.479e+00]],

        [[-4.799e+00],
         [-1.308e+00],
         [ 7.466e-01],
         [ 1.156e+00],
         [ 3.910e+00],
         [-4.095e+00],
         [ 6.255e+00],
         [ 1.368e+01],
         [-3.992e+00],
         [-4.273e+00]],

        [[ 2.024e+00],
         [-7.919e-01],
         [-8.788e-01],
         [-2.390e+00],
         [-2.325e+00],
         [ 3.385e+00],
         [-1.823e+00],
         [-2.336e+00],
         [ 5.332e+00],
         [-2.095e+00]],

        [[ 1.847e+00],
         [ 2.585e-01],
         [-4.076e+00],
         [-4.219e+00],
         [ 9.778e-01],
         [ 1.131e+01],
         [-1.523e+00],
         [-5.411e+00],
         [-1.461e+00],
         [ 9.711e+00]],

        [[-3.528e+00],
         [-1.847e+00],
         [ 3.410e+00],
         [-4.451e+00],
         [-4.604e-01],
         [ 4.647e+00],
         [ 1.553e+01],
         [-4.823e+00],
         [-3.439e+00],
         [ 7.010e+00]],

        [[-3.352e+00],
         [-2.709e+00],
         [-4.558e+00],
         [-5.369e+00],
         [ 5.824e+00],
         [-2.016e-01],
         [ 5.201e+00],
         [-1.810e+00],
         [-3.578e+00],
         [-2.041e-01]],

        [[-2.643e+00],
         [ 4.854e+00],
         [ 2.942e+01],
         [-2.376e+00],
         [-4.570e+00],
         [ 9.294e-01],
         [-4.292e+00],
         [-3.424e+00],
         [-4.590e+00],
         [ 1.477e+00]],

        [[-3.876e+00],
         [ 6.439e+00],
         [-2.161e+00],
         [-4.050e+00],
         [ 4.548e+00],
         [-3.426e+00],
         [-2.820e+00],
         [-2.202e+00],
         [-2.416e+00],
         [-3.556e+00]],

        [[-5.749e-01],
         [-2.669e-01],
         [-2.629e+00],
         [-3.915e+00],
         [-6.377e+00],
         [ 7.503e-01],
         [-1.373e+00],
         [ 1.352e-01],
         [ 4.213e+00],
         [ 1.440e+00]],

        [[-4.608e+00],
         [-3.224e+00],
         [-4.515e-01],
         [-5.920e+00],
         [ 3.731e+00],
         [-2.969e+00],
         [-3.700e+00],
         [-5.996e-01],
         [-6.568e-01],
         [-4.645e+00]],

        [[-3.858e+00],
         [ 9.298e+00],
         [-3.552e+00],
         [-3.433e+00],
         [-1.031e+00],
         [-3.539e+00],
         [-3.559e+00],
         [ 3.132e+01],
         [ 1.082e+01],
         [-1.741e+00]],

        [[-3.062e+00],
         [-5.169e+00],
         [-3.596e+00],
         [ 4.568e+00],
         [-1.398e+00],
         [ 7.234e+00],
         [ 1.933e+01],
         [-5.168e+00],
         [-3.877e+00],
         [ 2.130e+00]],

        [[-2.300e+00],
         [-3.319e+00],
         [ 4.986e-01],
         [ 1.506e+00],
         [-3.545e+00],
         [ 2.510e+00],
         [-2.345e+00],
         [-4.105e+00],
         [-2.045e+00],
         [-3.832e-01]],

        [[ 5.993e+00],
         [-4.430e+00],
         [-2.523e+00],
         [ 6.264e+00],
         [-5.902e+00],
         [-5.817e+00],
         [-3.631e+00],
         [-3.908e+00],
         [-4.456e+00],
         [ 2.673e+00]],

        [[-3.954e+00],
         [ 2.366e+00],
         [ 4.726e+00],
         [-4.825e+00],
         [-4.662e+00],
         [ 2.398e+00],
         [ 2.951e+00],
         [-5.300e-02],
         [-4.141e+00],
         [-4.031e+00]],

        [[-5.436e+00],
         [ 5.083e+00],
         [-6.037e+00],
         [-5.871e+00],
         [-3.245e+00],
         [-4.118e+00],
         [ 1.544e+01],
         [-2.108e+00],
         [-2.107e+00],
         [-2.657e+00]]], device='cuda:0')
v tensor([[[7.654e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.760e+00],
         [1.000e-12],
         [8.881e-01],
         [7.379e-02],
         [1.000e-12]],

        [[2.318e+00],
         [1.000e-12],
         [1.000e-12],
         [8.965e+00],
         [1.000e-12],
         [1.000e-12],
         [4.240e-01],
         [1.000e+01],
         [1.000e-12],
         [4.943e-01]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [5.118e+00],
         [1.000e-12],
         [1.000e-12],
         [3.041e-01],
         [1.000e-12],
         [9.325e+00],
         [1.000e-12]],

        [[1.000e-12],
         [4.157e-02],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [5.418e-01],
         [1.000e-12],
         [1.000e-12]],

        [[3.872e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [3.755e+00],
         [4.424e+00],
         [4.284e+00],
         [1.000e-12],
         [1.000e+01],
         [1.479e+00]],

        [[1.000e-12],
         [1.000e-12],
         [7.466e-01],
         [1.156e+00],
         [3.910e+00],
         [1.000e-12],
         [6.255e+00],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12]],

        [[2.024e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [3.385e+00],
         [1.000e-12],
         [1.000e-12],
         [5.332e+00],
         [1.000e-12]],

        [[1.847e+00],
         [2.585e-01],
         [1.000e-12],
         [1.000e-12],
         [9.778e-01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [9.711e+00]],

        [[1.000e-12],
         [1.000e-12],
         [3.410e+00],
         [1.000e-12],
         [1.000e-12],
         [4.647e+00],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [7.010e+00]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [5.824e+00],
         [1.000e-12],
         [5.201e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [4.854e+00],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [9.294e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.477e+00]],

        [[1.000e-12],
         [6.439e+00],
         [1.000e-12],
         [1.000e-12],
         [4.548e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [7.503e-01],
         [1.000e-12],
         [1.352e-01],
         [4.213e+00],
         [1.440e+00]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [3.731e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [9.298e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [4.568e+00],
         [1.000e-12],
         [7.234e+00],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [2.130e+00]],

        [[1.000e-12],
         [1.000e-12],
         [4.986e-01],
         [1.506e+00],
         [1.000e-12],
         [2.510e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[5.993e+00],
         [1.000e-12],
         [1.000e-12],
         [6.264e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.673e+00]],

        [[1.000e-12],
         [2.366e+00],
         [4.726e+00],
         [1.000e-12],
         [1.000e-12],
         [2.398e+00],
         [2.951e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [5.083e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]]], device='cuda:0')
v before min max tensor([[-1.335],
        [-6.255],
        [-1.813],
        [-0.954],
        [13.120],
        [ 8.500],
        [ 1.452],
        [-1.934],
        [-0.675],
        [-6.163],
        [ 0.245],
        [20.469],
        [ 4.611],
        [-4.120],
        [30.062],
        [-6.090],
        [ 6.085],
        [-2.564],
        [-1.555],
        [-5.140]], device='cuda:0')
v tensor([[1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e+01],
        [8.500e+00],
        [1.452e+00],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [2.448e-01],
        [1.000e+01],
        [4.611e+00],
        [1.000e-12],
        [1.000e+01],
        [1.000e-12],
        [6.085e+00],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12]], device='cuda:0')
a after update for 1 param tensor([[ 0.024,  0.009, -0.129,  ..., -0.043,  0.026, -0.012],
        [-0.076, -0.075,  0.012,  ...,  0.149, -0.001,  0.068],
        [-0.006, -0.016,  0.010,  ..., -0.041,  0.055, -0.174],
        ...,
        [-0.003, -0.064,  0.012,  ...,  0.013, -0.043,  0.024],
        [ 0.010,  0.031,  0.075,  ..., -0.021,  0.006, -0.078],
        [ 0.018,  0.012, -0.048,  ...,  0.062,  0.033,  0.047]],
       device='cuda:0')
s after update for 1 param tensor([[1.167, 1.227, 1.767,  ..., 1.045, 1.142, 1.462],
        [1.791, 0.951, 1.887,  ..., 1.777, 1.483, 1.801],
        [1.202, 1.384, 1.448,  ..., 1.602, 0.791, 1.378],
        ...,
        [0.964, 1.282, 1.751,  ..., 0.824, 1.439, 1.671],
        [0.989, 1.393, 1.161,  ..., 1.496, 1.019, 1.986],
        [1.500, 1.337, 0.995,  ..., 1.272, 1.026, 1.723]], device='cuda:0')
b after update for 1 param tensor([[ 84.032,  86.186, 103.407,  ...,  79.530,  83.121,  94.074],
        [104.113,  75.873, 106.878,  ..., 103.711,  94.743, 104.415],
        [ 85.282,  91.532,  93.619,  ...,  98.455,  69.185,  91.330],
        ...,
        [ 76.394,  88.086, 102.949,  ...,  70.629,  93.335, 100.564],
        [ 77.357,  91.813,  83.836,  ...,  95.152,  78.517, 109.629],
        [ 95.277,  89.942,  77.589,  ...,  87.730,  78.813, 102.115]],
       device='cuda:0')
clipping threshold 0.20483110440519206
a after update for 1 param tensor([-3.344e-02,  3.577e-03, -5.199e-03,  1.219e-02,  1.793e-04, -3.353e-02,
         9.015e-02,  7.852e-02,  4.564e-02,  4.498e-02, -7.468e-02,  5.038e-02,
         9.813e-02, -3.492e-02,  1.156e-01,  1.564e-02,  8.383e-02,  6.591e-02,
        -9.970e-02, -3.791e-02, -1.208e-02,  7.347e-02, -5.185e-02,  1.200e-01,
        -6.852e-02,  9.999e-02, -6.865e-02,  3.039e-02, -6.545e-03,  7.528e-02,
         3.167e-02, -1.731e-02,  1.370e-02,  9.373e-03,  1.104e-01, -6.523e-02,
        -3.108e-02,  1.776e-02, -8.748e-03, -2.450e-02,  1.014e-01,  4.536e-02,
        -9.780e-02, -5.185e-02,  1.190e-02, -4.282e-02,  2.874e-02,  3.289e-02,
        -3.689e-02, -3.130e-03,  6.797e-02,  1.205e-01, -2.667e-03, -8.844e-02,
         2.138e-02,  9.795e-02,  1.701e-01, -2.317e-02,  9.625e-03, -3.286e-02,
        -1.511e-02,  1.915e-02, -1.426e-01, -1.620e-01,  9.270e-02, -4.109e-03,
         1.305e-01, -8.097e-04, -7.330e-02,  8.972e-02, -1.447e-02, -1.274e-01,
        -8.845e-02, -6.089e-02,  9.049e-02,  2.886e-02,  7.692e-02,  1.387e-01,
         4.604e-02,  3.314e-02,  3.388e-02, -5.470e-02, -8.216e-02,  9.681e-02,
        -2.866e-02,  3.289e-02, -1.117e-02, -1.411e-01,  3.527e-02, -7.401e-02,
        -8.971e-03,  1.659e-02, -1.045e-01,  4.065e-02,  7.453e-02,  2.547e-02,
        -1.890e-01, -1.375e-01, -1.654e-02, -4.036e-02,  1.076e-02,  9.036e-02,
         8.672e-02,  1.100e-01, -8.327e-03, -5.424e-03,  3.103e-02, -2.683e-02,
        -8.560e-02,  3.951e-02, -9.541e-02, -1.096e-03, -1.222e-01, -6.197e-03,
        -2.147e-03,  3.094e-02,  1.490e-01,  1.048e-02, -3.490e-02, -7.541e-02,
         5.625e-02,  1.265e-01, -3.283e-02, -1.210e-02, -4.840e-02, -2.036e-01,
         1.701e-01, -8.464e-04,  3.973e-02, -2.052e-02,  5.981e-03, -3.236e-02,
        -2.649e-02,  1.173e-02, -3.624e-02, -1.494e-01,  2.113e-02, -4.059e-02,
         2.339e-01,  5.160e-02,  1.833e-02, -1.412e-02,  6.308e-02, -3.660e-02,
        -1.141e-01, -3.967e-03, -2.573e-03,  1.030e-02, -9.268e-03,  1.231e-02,
         6.836e-02,  5.421e-02, -1.544e-01,  5.405e-02, -4.583e-03,  3.339e-02,
        -1.059e-03, -1.652e-01,  8.868e-02, -5.351e-03,  1.235e-01,  1.208e-01,
         1.516e-01,  1.450e-02,  1.930e-02,  6.442e-02,  2.384e-02,  1.362e-01,
         2.486e-02,  9.557e-04, -1.033e-01,  2.007e-02,  5.017e-02, -5.104e-02,
         3.375e-02,  7.927e-02, -5.875e-03,  1.292e-01, -1.300e-02,  1.479e-02,
         1.208e-01, -8.248e-03,  7.872e-02,  1.123e-01,  1.027e-02,  2.870e-02,
        -1.018e-01,  5.443e-03, -1.288e-01, -1.000e-01, -2.564e-02,  4.647e-02,
         7.599e-02, -1.380e-01, -8.217e-02,  4.397e-02,  9.449e-03,  2.327e-02,
        -1.578e-02,  4.930e-02], device='cuda:0')
s after update for 1 param tensor([1.146, 0.881, 0.642, 1.515, 0.855, 1.526, 1.406, 1.389, 0.867, 0.995,
        0.810, 0.955, 1.147, 1.402, 1.144, 1.282, 1.578, 1.359, 1.649, 0.841,
        0.904, 1.262, 1.470, 1.378, 1.681, 1.449, 1.411, 1.397, 1.221, 1.083,
        1.059, 1.332, 1.771, 1.379, 1.502, 0.761, 1.507, 1.256, 1.065, 1.096,
        1.497, 1.217, 1.367, 1.357, 1.537, 1.428, 1.774, 1.148, 1.836, 1.803,
        0.870, 1.257, 0.930, 1.119, 1.445, 0.553, 1.242, 1.361, 1.730, 1.311,
        1.311, 1.232, 1.350, 1.650, 0.901, 1.288, 0.642, 1.136, 1.807, 0.973,
        1.394, 1.230, 1.159, 1.778, 1.383, 1.497, 1.403, 1.530, 1.457, 1.397,
        1.140, 1.528, 1.831, 1.286, 1.232, 0.994, 0.965, 1.781, 1.921, 1.770,
        1.687, 1.446, 1.548, 0.841, 1.477, 1.255, 1.614, 1.467, 1.977, 0.896,
        1.568, 1.548, 1.205, 1.668, 1.343, 1.561, 1.598, 1.206, 1.181, 1.220,
        1.664, 1.383, 0.797, 0.565, 1.553, 0.698, 1.164, 1.352, 1.766, 1.757,
        1.067, 1.214, 1.516, 1.942, 1.250, 1.606, 1.210, 1.592, 1.353, 1.712,
        1.208, 1.185, 1.552, 1.119, 1.155, 1.746, 1.671, 1.454, 1.217, 1.624,
        1.231, 1.282, 1.136, 1.079, 1.103, 0.635, 1.222, 1.646, 0.756, 1.050,
        1.043, 1.168, 1.032, 1.017, 1.267, 1.063, 1.109, 1.811, 1.839, 1.103,
        1.449, 1.074, 1.646, 1.200, 1.643, 1.100, 0.950, 1.243, 1.213, 1.761,
        1.369, 1.185, 1.032, 1.219, 1.001, 1.600, 0.811, 1.283, 1.449, 1.231,
        1.653, 1.622, 1.318, 1.551, 1.453, 1.359, 1.189, 1.375, 0.685, 1.155,
        1.141, 1.165, 0.947, 1.944, 1.607, 1.683, 1.532, 1.206, 0.741, 1.067],
       device='cuda:0')
b after update for 1 param tensor([ 83.277,  73.033,  62.336,  95.766,  71.923,  96.107,  92.249,  91.679,
         72.455,  77.591,  70.035,  76.045,  83.337,  92.116,  83.208,  88.100,
         97.730,  90.680,  99.895,  71.366,  73.987,  87.390,  94.312,  91.338,
        100.870,  93.634,  92.423,  91.947,  85.971,  80.965,  80.043,  89.803,
        103.536,  91.348,  95.361,  67.883,  95.516,  87.197,  80.302,  81.434,
         95.198,  85.826,  90.963,  90.638,  96.456,  92.953, 103.632,  83.368,
        105.403, 104.459,  72.558,  87.220,  75.018,  82.299,  93.513,  57.844,
         86.697,  90.762, 102.342,  89.073,  89.088,  86.336,  90.405,  99.933,
         73.832,  88.293,  62.354,  82.923, 104.569,  76.728,  91.841,  86.271,
         83.749, 103.745,  91.484,  95.199,  92.138,  96.230,  93.899,  91.959,
         83.072,  96.183, 105.286,  88.214,  86.355,  77.572,  76.431, 103.839,
        107.820, 103.512, 101.060,  93.564,  96.800,  71.333,  94.560,  87.140,
         98.834,  94.230, 109.387,  73.652,  97.432,  96.798,  85.396, 100.466,
         90.160,  97.193,  98.335,  85.431,  84.554,  85.923, 100.345,  91.494,
         69.465,  58.459,  96.963,  65.008,  83.930,  90.455, 103.393, 103.127,
         80.380,  85.725,  95.784, 108.416,  86.997,  98.590,  85.582,  98.172,
         90.491, 101.780,  85.496,  84.683,  96.907,  82.298,  83.596, 102.813,
        100.554,  93.827,  85.840,  99.131,  86.324,  88.084,  82.925,  80.817,
         81.721,  61.979,  85.991,  99.820,  67.650,  79.723,  79.452,  84.083,
         79.024,  78.475,  87.584,  80.230,  81.936, 104.711, 105.493,  81.690,
         93.641,  80.633,  99.809,  85.208,  99.713,  81.597,  75.823,  86.743,
         85.677, 103.237,  91.027,  84.691,  79.034,  85.896,  77.832,  98.414,
         70.073,  88.107,  93.647,  86.309, 100.034,  99.088,  89.309,  96.892,
         93.793,  90.703,  84.830,  91.239,  64.387,  83.604,  83.115,  83.990,
         75.723, 108.467,  98.633, 100.938,  96.309,  85.420,  66.985,  80.350],
       device='cuda:0')
clipping threshold 0.20483110440519206
a after update for 1 param tensor([[[-2.738e-02],
         [-7.120e-02],
         [ 1.170e-02],
         [ 2.640e-01],
         [-8.277e-02],
         [-6.233e-02],
         [ 1.142e-01],
         [-1.685e-02],
         [ 4.451e-03],
         [-1.174e-01]],

        [[ 2.396e-02],
         [-8.161e-02],
         [-1.177e-01],
         [-1.955e-01],
         [ 1.037e-01],
         [ 5.649e-02],
         [-1.373e-03],
         [ 5.696e-02],
         [ 3.634e-02],
         [ 1.392e-01]],

        [[ 3.088e-02],
         [-1.400e-02],
         [-1.721e-02],
         [-1.052e-01],
         [-7.679e-02],
         [ 4.568e-02],
         [ 3.275e-03],
         [-3.100e-02],
         [ 3.921e-02],
         [-8.381e-03]],

        [[ 1.725e-02],
         [-2.488e-02],
         [-3.295e-03],
         [-5.661e-02],
         [-4.368e-02],
         [ 2.174e-03],
         [ 2.307e-02],
         [ 1.405e-02],
         [-8.307e-02],
         [-7.444e-02]],

        [[-8.415e-02],
         [ 1.939e-01],
         [-3.766e-02],
         [ 4.483e-02],
         [-5.039e-02],
         [ 3.276e-02],
         [ 9.465e-03],
         [ 1.039e-02],
         [ 8.717e-02],
         [ 4.147e-02]],

        [[ 4.231e-02],
         [-1.494e-03],
         [-6.263e-03],
         [-4.522e-02],
         [-2.581e-01],
         [ 4.284e-02],
         [-1.700e-02],
         [-1.132e-01],
         [ 8.300e-02],
         [-3.520e-03]],

        [[-5.223e-03],
         [-1.211e-01],
         [ 4.144e-02],
         [-1.027e-02],
         [-8.017e-02],
         [ 5.568e-02],
         [ 3.965e-02],
         [-1.113e-01],
         [ 1.184e-01],
         [-5.473e-02]],

        [[ 8.477e-02],
         [-6.370e-02],
         [ 6.077e-02],
         [-1.915e-02],
         [ 1.032e-01],
         [ 3.413e-02],
         [ 4.843e-02],
         [ 5.743e-02],
         [-1.339e-01],
         [-1.142e-01]],

        [[-6.056e-02],
         [ 1.734e-01],
         [-1.476e-03],
         [-1.989e-02],
         [ 4.101e-02],
         [-3.731e-02],
         [ 2.051e-01],
         [-1.113e-01],
         [-1.784e-02],
         [-8.380e-03]],

        [[-2.329e-02],
         [ 1.766e-02],
         [ 6.766e-02],
         [ 3.396e-02],
         [ 1.707e-02],
         [-6.657e-02],
         [ 3.333e-02],
         [ 5.012e-02],
         [-1.035e-01],
         [ 5.253e-03]],

        [[-4.219e-02],
         [ 1.384e-02],
         [-1.376e-01],
         [-2.234e-01],
         [-5.735e-02],
         [ 1.471e-01],
         [ 1.856e-02],
         [ 8.747e-02],
         [ 6.480e-02],
         [-1.178e-01]],

        [[-2.473e-02],
         [-2.386e-02],
         [-2.242e-03],
         [ 1.151e-04],
         [ 4.213e-02],
         [ 9.208e-02],
         [-2.326e-01],
         [ 1.363e-01],
         [-6.419e-02],
         [ 1.111e-02]],

        [[-5.343e-02],
         [ 6.362e-02],
         [-9.962e-02],
         [ 1.055e-01],
         [ 8.782e-02],
         [-1.416e-01],
         [-3.492e-02],
         [-4.047e-02],
         [ 2.401e-01],
         [-1.584e-01]],

        [[-6.354e-02],
         [-4.000e-02],
         [ 3.954e-03],
         [-2.390e-01],
         [ 3.221e-03],
         [ 1.660e-01],
         [-5.759e-02],
         [-9.055e-02],
         [ 8.576e-02],
         [-6.505e-02]],

        [[-6.393e-03],
         [-8.213e-03],
         [ 1.099e-02],
         [-1.728e-02],
         [ 8.846e-02],
         [-4.606e-02],
         [-1.378e-01],
         [ 2.306e-02],
         [ 3.327e-02],
         [ 1.992e-01]],

        [[ 3.765e-02],
         [ 5.848e-02],
         [ 2.752e-02],
         [ 5.361e-02],
         [-5.508e-02],
         [-1.391e-01],
         [ 1.112e-01],
         [ 3.492e-02],
         [-6.812e-02],
         [ 8.145e-02]],

        [[-1.022e-02],
         [-1.302e-02],
         [-6.436e-02],
         [ 2.437e-02],
         [-3.043e-02],
         [-5.889e-02],
         [ 7.241e-03],
         [ 2.781e-03],
         [-1.208e-02],
         [-7.897e-02]],

        [[ 3.370e-02],
         [ 1.495e-01],
         [-8.732e-02],
         [-2.015e-02],
         [ 1.504e-01],
         [ 4.270e-02],
         [ 9.280e-02],
         [ 1.359e-01],
         [-7.591e-02],
         [ 1.375e-01]],

        [[ 7.943e-02],
         [-1.643e-02],
         [-2.174e-02],
         [-6.222e-02],
         [-1.740e-02],
         [ 2.453e-01],
         [ 2.933e-02],
         [ 4.813e-02],
         [ 2.197e-02],
         [-5.230e-02]],

        [[-1.324e-02],
         [ 4.359e-02],
         [-3.642e-02],
         [-7.067e-03],
         [ 1.642e-01],
         [-1.340e-02],
         [-4.877e-02],
         [-1.957e-02],
         [ 4.064e-02],
         [ 4.437e-02]]], device='cuda:0')
s after update for 1 param tensor([[[1.148],
         [1.291],
         [1.481],
         [1.418],
         [1.141],
         [1.556],
         [1.893],
         [1.699],
         [1.186],
         [1.100]],

        [[1.094],
         [1.676],
         [1.450],
         [1.871],
         [1.199],
         [1.154],
         [1.308],
         [1.287],
         [1.366],
         [2.028]],

        [[1.560],
         [0.948],
         [1.606],
         [1.471],
         [0.929],
         [1.409],
         [0.942],
         [1.466],
         [1.735],
         [1.342]],

        [[1.054],
         [0.701],
         [1.388],
         [1.630],
         [0.733],
         [1.854],
         [1.162],
         [1.063],
         [1.395],
         [1.194]],

        [[1.735],
         [1.763],
         [1.064],
         [1.571],
         [1.299],
         [1.625],
         [1.181],
         [1.430],
         [1.918],
         [1.437]],

        [[1.436],
         [0.549],
         [1.442],
         [1.260],
         [1.713],
         [1.319],
         [1.160],
         [1.564],
         [1.302],
         [1.229]],

        [[1.055],
         [1.152],
         [0.729],
         [0.702],
         [1.182],
         [1.649],
         [1.145],
         [1.132],
         [1.550],
         [1.134]],

        [[1.776],
         [1.173],
         [1.340],
         [1.355],
         [1.441],
         [1.530],
         [1.270],
         [1.576],
         [0.982],
         [1.492]],

        [[1.017],
         [1.660],
         [1.331],
         [1.268],
         [1.914],
         [1.442],
         [1.615],
         [1.817],
         [0.977],
         [1.595]],

        [[0.956],
         [1.052],
         [1.317],
         [1.533],
         [1.135],
         [1.311],
         [1.572],
         [0.741],
         [1.208],
         [0.987]],

        [[1.767],
         [0.928],
         [2.018],
         [1.784],
         [1.300],
         [1.541],
         [1.220],
         [1.195],
         [1.514],
         [1.274]],

        [[1.216],
         [1.458],
         [1.593],
         [1.159],
         [1.655],
         [1.251],
         [1.137],
         [1.368],
         [1.558],
         [1.011]],

        [[1.244],
         [1.317],
         [1.446],
         [1.115],
         [1.826],
         [0.964],
         [0.798],
         [1.713],
         [1.932],
         [1.658]],

        [[1.352],
         [1.487],
         [1.530],
         [1.773],
         [1.397],
         [1.081],
         [1.255],
         [1.147],
         [1.540],
         [1.321]],

        [[1.173],
         [1.260],
         [1.253],
         [1.377],
         [1.416],
         [1.082],
         [1.012],
         [1.426],
         [2.039],
         [1.751]],

        [[1.404],
         [1.641],
         [1.276],
         [1.304],
         [1.227],
         [1.405],
         [1.779],
         [1.511],
         [1.105],
         [1.100]],

        [[0.659],
         [1.527],
         [1.664],
         [1.029],
         [1.567],
         [0.968],
         [0.828],
         [1.200],
         [1.395],
         [0.996]],

        [[1.608],
         [1.318],
         [1.276],
         [1.573],
         [1.704],
         [1.653],
         [1.084],
         [1.523],
         [1.442],
         [1.432]],

        [[1.460],
         [1.815],
         [1.862],
         [1.412],
         [1.333],
         [1.633],
         [1.042],
         [1.487],
         [1.225],
         [1.703]],

        [[1.560],
         [1.291],
         [1.824],
         [1.982],
         [1.786],
         [1.216],
         [1.767],
         [1.076],
         [0.835],
         [0.757]]], device='cuda:0')
b after update for 1 param tensor([[[ 83.363],
         [ 88.385],
         [ 94.691],
         [ 92.629],
         [ 83.101],
         [ 97.055],
         [107.037],
         [101.411],
         [ 84.721],
         [ 81.604]],

        [[ 81.371],
         [100.712],
         [ 93.689],
         [106.410],
         [ 85.175],
         [ 83.572],
         [ 88.994],
         [ 88.261],
         [ 90.929],
         [110.785]],

        [[ 97.172],
         [ 75.731],
         [ 98.600],
         [ 94.352],
         [ 74.981],
         [ 92.352],
         [ 75.489],
         [ 94.208],
         [102.480],
         [ 90.112]],

        [[ 79.879],
         [ 65.147],
         [ 91.652],
         [ 99.312],
         [ 66.608],
         [105.918],
         [ 83.880],
         [ 80.210],
         [ 91.884],
         [ 85.025]],

        [[102.464],
         [103.287],
         [ 80.250],
         [ 97.505],
         [ 88.663],
         [ 99.166],
         [ 84.559],
         [ 93.018],
         [107.734],
         [ 93.248]],

        [[ 93.241],
         [ 57.665],
         [ 93.430],
         [ 87.340],
         [101.817],
         [ 89.356],
         [ 83.799],
         [ 97.281],
         [ 88.780],
         [ 86.243]],

        [[ 79.909],
         [ 83.511],
         [ 66.417],
         [ 65.193],
         [ 84.589],
         [ 99.889],
         [ 83.265],
         [ 82.790],
         [ 96.867],
         [ 82.854]],

        [[103.686],
         [ 84.253],
         [ 90.043],
         [ 90.550],
         [ 93.387],
         [ 96.245],
         [ 87.687],
         [ 97.668],
         [ 77.093],
         [ 95.036]],

        [[ 78.447],
         [100.245],
         [ 89.770],
         [ 87.591],
         [107.639],
         [ 93.409],
         [ 98.856],
         [104.871],
         [ 76.918],
         [ 98.241]],

        [[ 76.060],
         [ 79.810],
         [ 89.273],
         [ 96.326],
         [ 82.882],
         [ 89.073],
         [ 97.551],
         [ 66.988],
         [ 85.509],
         [ 77.292]],

        [[103.413],
         [ 74.951],
         [110.528],
         [103.920],
         [ 88.687],
         [ 96.587],
         [ 85.939],
         [ 85.054],
         [ 95.723],
         [ 87.816]],

        [[ 85.797],
         [ 93.949],
         [ 98.191],
         [ 83.763],
         [100.072],
         [ 87.010],
         [ 82.960],
         [ 90.981],
         [ 97.093],
         [ 78.223]],

        [[ 86.763],
         [ 89.297],
         [ 93.554],
         [ 82.165],
         [105.116],
         [ 76.366],
         [ 69.486],
         [101.835],
         [108.145],
         [100.163]],

        [[ 90.467],
         [ 94.879],
         [ 96.229],
         [103.591],
         [ 91.962],
         [ 80.898],
         [ 87.145],
         [ 83.320],
         [ 96.533],
         [ 89.402]],

        [[ 84.257],
         [ 87.328],
         [ 87.099],
         [ 91.286],
         [ 92.583],
         [ 80.932],
         [ 78.246],
         [ 92.901],
         [111.088],
         [102.938]],

        [[ 92.195],
         [ 99.655],
         [ 87.872],
         [ 88.851],
         [ 86.185],
         [ 92.212],
         [103.767],
         [ 95.623],
         [ 81.767],
         [ 81.585]],

        [[ 63.163],
         [ 96.134],
         [100.345],
         [ 78.922],
         [ 97.402],
         [ 76.560],
         [ 70.790],
         [ 85.206],
         [ 91.876],
         [ 77.635]],

        [[ 98.664],
         [ 89.307],
         [ 87.895],
         [ 97.585],
         [101.548],
         [100.026],
         [ 81.010],
         [ 96.015],
         [ 93.435],
         [ 93.092]],

        [[ 94.016],
         [104.820],
         [106.155],
         [ 92.451],
         [ 89.830],
         [ 99.419],
         [ 79.431],
         [ 94.871],
         [ 86.104],
         [101.522]],

        [[ 97.179],
         [ 88.394],
         [105.061],
         [109.537],
         [103.967],
         [ 85.786],
         [103.418],
         [ 80.703],
         [ 71.086],
         [ 67.698]]], device='cuda:0')
clipping threshold 0.20483110440519206
a after update for 1 param tensor([[ 0.040],
        [-0.054],
        [ 0.017],
        [-0.046],
        [ 0.033],
        [-0.072],
        [ 0.015],
        [ 0.015],
        [-0.095],
        [-0.152],
        [-0.026],
        [ 0.142],
        [ 0.094],
        [-0.012],
        [-0.122],
        [-0.164],
        [-0.038],
        [-0.056],
        [-0.139],
        [ 0.012]], device='cuda:0')
s after update for 1 param tensor([[1.577],
        [1.786],
        [0.969],
        [1.496],
        [1.470],
        [1.776],
        [1.485],
        [1.301],
        [1.355],
        [1.769],
        [1.498],
        [1.739],
        [1.527],
        [1.284],
        [1.984],
        [1.968],
        [1.823],
        [1.355],
        [1.389],
        [1.469]], device='cuda:0')
b after update for 1 param tensor([[ 97.694],
        [103.983],
        [ 76.583],
        [ 95.149],
        [ 94.341],
        [103.683],
        [ 94.808],
        [ 88.744],
        [ 90.556],
        [103.465],
        [ 95.220],
        [102.600],
        [ 96.123],
        [ 88.141],
        [109.576],
        [109.138],
        [105.037],
        [ 90.545],
        [ 91.678],
        [ 94.302]], device='cuda:0')
clipping threshold 0.20483110440519206
||w||^2 0.10451540924607003
exp ma of ||w||^2 0.06977689734028662
||w|| 0.32328843042408745
exp ma of ||w|| 0.2549653506115208
||w||^2 0.05918874841042829
exp ma of ||w||^2 0.08404343912303947
||w|| 0.24328737823904528
exp ma of ||w|| 0.2810368446602931
v before min max tensor([[-2.117,  2.544,  6.731,  ..., 14.322,  3.298, -2.792],
        [-3.623,  5.699, -4.807,  ..., -1.901, -2.826, -3.546],
        [-2.759, -3.973, 20.945,  ..., -4.811, -1.828,  1.162],
        ...,
        [-4.163, -1.088, -2.896,  ..., -5.064, -0.725, -5.324],
        [ 2.833, -0.880, -0.907,  ..., -2.568, -2.134, -4.874],
        [ 8.470, -4.781, -1.087,  ..., -2.444, -4.811,  1.117]],
       device='cuda:0')
v tensor([[1.000e-12, 2.544e+00, 6.731e+00,  ..., 1.000e+01, 3.298e+00,
         1.000e-12],
        [1.000e-12, 5.699e+00, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [1.000e-12, 1.000e-12, 1.000e+01,  ..., 1.000e-12, 1.000e-12,
         1.162e+00],
        ...,
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [2.833e+00, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [8.470e+00, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.117e+00]], device='cuda:0')
v before min max tensor([ 3.053e+00, -4.067e+00, -3.773e+00, -2.859e+00, -4.456e+00,  2.330e+00,
        -3.470e+00, -4.521e+00,  4.822e+00, -5.028e+00, -3.373e+00, -4.309e+00,
         1.996e+00, -1.453e+00, -4.016e+00, -5.215e+00, -3.922e+00, -3.733e+00,
        -5.359e+00,  2.518e+00,  1.344e+01, -2.512e+00, -3.551e+00,  2.092e+00,
        -2.234e+00, -2.156e+00,  2.547e+00, -4.155e+00,  9.140e+01, -4.031e+00,
        -3.634e+00, -1.235e+00,  1.608e+01, -4.982e+00, -1.218e+00, -3.424e+00,
        -2.604e+00, -3.234e+00, -2.768e+00, -3.456e+00, -7.465e+00, -3.379e+00,
        -3.969e+00, -2.724e+00, -1.668e+00, -5.977e+00, -4.257e+00, -4.178e+00,
         2.730e+00,  1.363e+00,  5.750e-01, -5.549e+00,  1.960e+01, -1.282e+00,
        -4.501e+00, -2.898e+00,  4.010e+00, -5.083e+00, -3.543e+00, -1.296e+00,
        -1.616e+00,  6.074e-02, -3.629e+00,  1.263e+01, -3.480e+00, -4.703e+00,
        -2.788e+00,  6.021e+00, -3.160e-01, -1.799e+00, -4.396e+00, -1.277e+00,
        -4.371e+00,  4.308e+00, -2.734e+00, -3.280e+00,  9.414e+00, -1.751e+00,
         3.434e+00,  1.820e+00,  1.070e+00, -5.487e+00, -1.658e+00, -2.315e+00,
        -3.843e+00, -3.211e+00,  4.587e+00, -4.084e+00, -4.928e+00, -5.196e+00,
        -3.641e+00, -8.313e-01, -4.104e+00,  2.565e+00,  1.279e+01, -2.927e+00,
         2.462e+00,  1.170e+01, -2.821e+00, -2.166e+00, -5.222e+00, -3.477e+00,
        -5.242e+00,  1.262e+01, -3.241e+00, -1.711e-01, -4.207e+00, -1.154e-01,
        -4.286e+00, -2.623e+00,  2.592e-01, -2.033e+00, -1.922e+00,  9.523e+00,
        -3.253e+00,  4.438e+00,  3.955e-01,  3.431e+00, -4.829e+00, -4.362e+00,
        -3.472e+00,  4.861e+00,  7.235e+00, -4.035e+00,  1.538e+01,  1.019e+01,
        -3.464e+00, -1.736e+00, -3.857e+00,  1.269e+00, -1.343e+00,  2.007e+00,
         5.364e+00, -3.311e+00, -1.029e+00, -3.006e+00, -5.084e+00, -1.192e-01,
         6.915e+00, -3.834e+00, -3.115e+00, -3.142e+00,  4.133e+00, -4.213e+00,
        -4.927e+00,  2.388e+00, -5.532e+00, -1.805e-01, -3.181e+00, -4.418e+00,
        -1.252e+00, -2.399e+00,  1.801e+00,  2.277e+01, -3.216e+00,  4.401e+00,
        -2.056e+00, -2.087e+00, -3.568e+00, -1.727e+00, -3.334e+00, -3.667e+00,
         1.070e+00, -3.188e+00,  5.906e-01, -3.088e+00, -2.595e+00,  3.920e+00,
        -1.765e+00, -3.845e+00, -3.693e+00, -2.315e+00,  6.498e-01, -1.685e+00,
        -9.689e-01,  1.137e+00, -3.861e+00, -2.752e+00, -1.366e+00,  2.493e+00,
         6.694e+00, -2.556e+00, -4.900e+00,  2.454e+00, -5.565e+00,  5.484e+00,
        -1.838e+00,  2.765e+01, -4.572e+00, -4.077e+00, -3.123e+00, -3.138e+00,
         5.513e-01, -4.821e+00, -4.280e+00, -4.990e+00, -4.247e+00, -5.538e+00,
        -5.564e+00, -6.996e-01], device='cuda:0')
v tensor([3.053e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 2.330e+00,
        1.000e-12, 1.000e-12, 4.822e+00, 1.000e-12, 1.000e-12, 1.000e-12,
        1.996e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 2.518e+00, 1.000e+01, 1.000e-12, 1.000e-12, 2.092e+00,
        1.000e-12, 1.000e-12, 2.547e+00, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        2.730e+00, 1.363e+00, 5.750e-01, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 4.010e+00, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 6.074e-02, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e-12, 6.021e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 4.308e+00, 1.000e-12, 1.000e-12, 9.414e+00, 1.000e-12,
        3.434e+00, 1.820e+00, 1.070e+00, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 4.587e+00, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 2.565e+00, 1.000e+01, 1.000e-12,
        2.462e+00, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 2.592e-01, 1.000e-12, 1.000e-12, 9.523e+00,
        1.000e-12, 4.438e+00, 3.955e-01, 3.431e+00, 1.000e-12, 1.000e-12,
        1.000e-12, 4.861e+00, 7.235e+00, 1.000e-12, 1.000e+01, 1.000e+01,
        1.000e-12, 1.000e-12, 1.000e-12, 1.269e+00, 1.000e-12, 2.007e+00,
        5.364e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        6.915e+00, 1.000e-12, 1.000e-12, 1.000e-12, 4.133e+00, 1.000e-12,
        1.000e-12, 2.388e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.801e+00, 1.000e+01, 1.000e-12, 4.401e+00,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.070e+00, 1.000e-12, 5.906e-01, 1.000e-12, 1.000e-12, 3.920e+00,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 6.498e-01, 1.000e-12,
        1.000e-12, 1.137e+00, 1.000e-12, 1.000e-12, 1.000e-12, 2.493e+00,
        6.694e+00, 1.000e-12, 1.000e-12, 2.454e+00, 1.000e-12, 5.484e+00,
        1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        5.513e-01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12], device='cuda:0')
v before min max tensor([[[-3.319e+00],
         [-3.178e+00],
         [ 3.457e+00],
         [-4.531e+00],
         [-4.853e-01],
         [-2.605e+00],
         [-5.562e+00],
         [-3.277e+00],
         [-6.111e-03],
         [ 3.918e+00]],

        [[ 1.225e+00],
         [ 5.348e+00],
         [-1.639e+00],
         [-1.290e+00],
         [ 9.566e+00],
         [ 1.767e+01],
         [-5.952e+00],
         [-2.952e+00],
         [-4.170e+00],
         [ 8.079e+00]],

        [[ 1.310e+00],
         [-3.527e+00],
         [-6.511e+00],
         [ 1.078e+00],
         [ 6.673e-01],
         [-5.812e+00],
         [ 4.161e-01],
         [ 7.889e+00],
         [-2.596e+00],
         [ 3.236e-01]],

        [[-3.319e+00],
         [ 7.170e-01],
         [ 2.328e+00],
         [ 2.551e+00],
         [-5.066e+00],
         [-2.029e+00],
         [-4.125e+00],
         [-3.519e+00],
         [ 1.833e+01],
         [-3.674e+00]],

        [[-7.076e+00],
         [-5.433e+00],
         [-4.797e+00],
         [ 2.639e+00],
         [-2.431e+00],
         [ 2.783e+00],
         [-4.219e+00],
         [-1.561e+00],
         [-2.193e+00],
         [-3.052e+00]],

        [[-1.537e+00],
         [ 2.750e+00],
         [-2.162e+00],
         [ 3.539e+00],
         [-5.322e+00],
         [-7.208e-01],
         [-1.805e+00],
         [ 1.747e+01],
         [ 1.046e+01],
         [-3.157e+00]],

        [[ 4.589e+00],
         [-4.702e+00],
         [-7.233e-01],
         [ 9.559e+00],
         [-3.879e+00],
         [-4.062e+00],
         [-5.421e+00],
         [ 1.038e+01],
         [-6.875e-01],
         [-8.910e-01]],

        [[ 6.652e+00],
         [ 5.574e+00],
         [ 1.210e+01],
         [-6.015e+00],
         [-3.747e+00],
         [ 8.038e+00],
         [ 7.248e+00],
         [ 6.514e+00],
         [ 1.319e+01],
         [-5.909e+00]],

        [[-5.348e+00],
         [-4.052e+00],
         [ 1.110e+01],
         [-2.989e+00],
         [ 1.561e+01],
         [-2.384e+00],
         [-4.996e+00],
         [-4.445e+00],
         [-1.206e+00],
         [-3.331e+00]],

        [[-3.481e+00],
         [-5.093e+00],
         [-3.062e+00],
         [-1.843e+00],
         [ 2.829e-01],
         [-3.235e+00],
         [ 2.960e-01],
         [-4.289e+00],
         [-2.209e+00],
         [-1.956e+00]],

        [[-3.961e+00],
         [-1.981e-01],
         [ 1.968e+00],
         [-8.186e-01],
         [-3.183e+00],
         [ 8.793e-01],
         [-1.083e+00],
         [-3.379e+00],
         [-1.267e-01],
         [-3.085e+00]],

        [[-4.954e+00],
         [-4.006e+00],
         [-1.265e+00],
         [ 8.397e+00],
         [-2.023e+00],
         [ 5.941e+00],
         [-6.825e+00],
         [-2.494e+00],
         [ 3.805e-01],
         [-9.487e-01]],

        [[ 3.967e+00],
         [-2.445e+00],
         [ 4.341e+00],
         [-4.630e+00],
         [ 6.535e+00],
         [-2.017e+00],
         [-9.451e-01],
         [-1.277e+00],
         [-4.354e+00],
         [-3.658e+00]],

        [[-1.849e-01],
         [ 7.870e+00],
         [-5.401e+00],
         [-3.148e+00],
         [ 1.675e+01],
         [-5.827e+00],
         [-4.624e+00],
         [ 4.980e+00],
         [-3.660e+00],
         [ 1.712e+01]],

        [[-3.063e+00],
         [-2.177e+00],
         [-2.775e+00],
         [-2.636e+00],
         [-5.898e+00],
         [-3.989e-01],
         [-8.076e-01],
         [ 1.576e+00],
         [ 5.019e+00],
         [-6.127e+00]],

        [[-2.822e+00],
         [-2.312e-01],
         [ 7.302e-01],
         [-4.836e+00],
         [-1.324e+00],
         [-3.018e+00],
         [-3.228e+00],
         [-3.345e+00],
         [-4.721e+00],
         [ 9.559e+00]],

        [[-3.834e+00],
         [-4.800e+00],
         [-4.653e+00],
         [-5.643e+00],
         [ 1.508e+00],
         [-3.172e+00],
         [-5.387e+00],
         [-2.231e+00],
         [ 1.030e+01],
         [ 1.862e+00]],

        [[-3.377e+00],
         [-2.467e+00],
         [-4.141e+00],
         [-5.049e+00],
         [-1.116e+00],
         [ 1.667e+01],
         [-3.080e+00],
         [-3.573e+00],
         [-3.709e+00],
         [-2.959e+00]],

        [[-4.778e+00],
         [ 9.214e+00],
         [ 8.766e-01],
         [-1.027e+00],
         [-2.974e+00],
         [-2.047e+00],
         [ 6.232e+00],
         [-3.244e+00],
         [ 4.648e+00],
         [-1.802e+00]],

        [[-1.256e+00],
         [-4.209e+00],
         [-3.517e+00],
         [-4.944e+00],
         [ 1.638e+01],
         [ 3.712e+00],
         [-2.087e+00],
         [-2.354e+00],
         [-3.625e+00],
         [-3.774e+00]]], device='cuda:0')
v tensor([[[1.000e-12],
         [1.000e-12],
         [3.457e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [3.918e+00]],

        [[1.225e+00],
         [5.348e+00],
         [1.000e-12],
         [1.000e-12],
         [9.566e+00],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [8.079e+00]],

        [[1.310e+00],
         [1.000e-12],
         [1.000e-12],
         [1.078e+00],
         [6.673e-01],
         [1.000e-12],
         [4.161e-01],
         [7.889e+00],
         [1.000e-12],
         [3.236e-01]],

        [[1.000e-12],
         [7.170e-01],
         [2.328e+00],
         [2.551e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.639e+00],
         [1.000e-12],
         [2.783e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [2.750e+00],
         [1.000e-12],
         [3.539e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12]],

        [[4.589e+00],
         [1.000e-12],
         [1.000e-12],
         [9.559e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12]],

        [[6.652e+00],
         [5.574e+00],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [8.038e+00],
         [7.248e+00],
         [6.514e+00],
         [1.000e+01],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.829e-01],
         [1.000e-12],
         [2.960e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.968e+00],
         [1.000e-12],
         [1.000e-12],
         [8.793e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [8.397e+00],
         [1.000e-12],
         [5.941e+00],
         [1.000e-12],
         [1.000e-12],
         [3.805e-01],
         [1.000e-12]],

        [[3.967e+00],
         [1.000e-12],
         [4.341e+00],
         [1.000e-12],
         [6.535e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [7.870e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [4.980e+00],
         [1.000e-12],
         [1.000e+01]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.576e+00],
         [5.019e+00],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [7.302e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [9.559e+00]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.508e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.862e+00]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [9.214e+00],
         [8.766e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [6.232e+00],
         [1.000e-12],
         [4.648e+00],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [3.712e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]]], device='cuda:0')
v before min max tensor([[-2.401e+00],
        [ 4.789e+00],
        [ 2.034e+01],
        [-4.144e+00],
        [-6.230e+00],
        [-2.681e+00],
        [ 2.646e+00],
        [-7.407e-01],
        [-3.692e+00],
        [ 7.516e+00],
        [-5.347e-02],
        [ 1.776e-02],
        [ 7.023e+00],
        [-4.092e+00],
        [-1.801e+00],
        [-3.411e+00],
        [-4.337e+00],
        [-6.392e+00],
        [ 6.393e+00],
        [-5.202e+00]], device='cuda:0')
v tensor([[1.000e-12],
        [4.789e+00],
        [1.000e+01],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [2.646e+00],
        [1.000e-12],
        [1.000e-12],
        [7.516e+00],
        [1.000e-12],
        [1.776e-02],
        [7.023e+00],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [6.393e+00],
        [1.000e-12]], device='cuda:0')
a after update for 1 param tensor([[ 0.027, -0.017, -0.110,  ..., -0.022,  0.031, -0.017],
        [-0.063, -0.067, -0.011,  ...,  0.089,  0.014,  0.058],
        [-0.002, -0.035, -0.004,  ..., -0.040,  0.050, -0.164],
        ...,
        [-0.020, -0.064,  0.005,  ...,  0.013, -0.029,  0.005],
        [ 0.005,  0.021,  0.081,  ..., -0.032,  0.001, -0.033],
        [ 0.007,  0.013, -0.028,  ...,  0.055, -0.011,  0.015]],
       device='cuda:0')
s after update for 1 param tensor([[1.171, 0.923, 1.262,  ..., 1.366, 0.825, 0.903],
        [1.181, 0.905, 1.576,  ..., 1.915, 1.112, 1.507],
        [1.380, 1.296, 1.678,  ..., 1.218, 0.646, 1.064],
        ...,
        [1.041, 0.893, 0.941,  ..., 1.267, 0.576, 1.421],
        [1.101, 0.569, 1.334,  ..., 1.157, 0.763, 1.514],
        [1.739, 1.438, 1.191,  ..., 0.747, 1.215, 1.185]], device='cuda:0')
b after update for 1 param tensor([[ 78.450,  69.643,  81.425,  ...,  84.725,  65.840,  68.872],
        [ 78.766,  68.982,  91.005,  ..., 100.307,  76.457,  88.997],
        [ 85.144,  82.513,  93.910,  ...,  80.008,  58.270,  74.769],
        ...,
        [ 73.969,  68.513,  70.329,  ...,  81.592,  55.008,  86.404],
        [ 76.057,  54.682,  83.727,  ...,  77.986,  63.331,  89.196],
        [ 95.590,  86.920,  79.126,  ...,  62.643,  79.896,  78.903]],
       device='cuda:0')
clipping threshold 0.23438493615842576
a after update for 1 param tensor([-0.024,  0.007, -0.005,  0.004,  0.015, -0.045,  0.080,  0.062,  0.031,
         0.031, -0.060,  0.039,  0.095, -0.045,  0.083,  0.024,  0.069,  0.061,
        -0.083, -0.044, -0.003,  0.057, -0.055,  0.098, -0.036,  0.103, -0.055,
         0.037,  0.001,  0.046,  0.012, -0.027,  0.021,  0.001,  0.072, -0.058,
        -0.024,  0.013, -0.015, -0.012,  0.070,  0.041, -0.073, -0.043,  0.026,
        -0.041,  0.032,  0.052, -0.045, -0.009,  0.050,  0.079,  0.001, -0.084,
         0.007,  0.075,  0.152,  0.005, -0.006, -0.038, -0.030,  0.022, -0.125,
        -0.131,  0.081, -0.021,  0.100,  0.006, -0.053,  0.075,  0.010, -0.119,
        -0.072, -0.043,  0.063,  0.005,  0.049,  0.113,  0.008,  0.035,  0.045,
        -0.053, -0.060,  0.085, -0.042,  0.005,  0.005, -0.086,  0.029, -0.074,
        -0.018,  0.013, -0.095,  0.037,  0.034,  0.031, -0.150, -0.101, -0.006,
        -0.054, -0.009,  0.082,  0.046,  0.084,  0.008, -0.007,  0.005, -0.011,
        -0.058,  0.044, -0.079, -0.009, -0.100, -0.023,  0.011,  0.026,  0.122,
         0.009, -0.009, -0.062,  0.030,  0.092, -0.030, -0.004, -0.029, -0.149,
         0.168, -0.011,  0.024, -0.039,  0.002, -0.013, -0.036,  0.013, -0.020,
        -0.121,  0.000, -0.047,  0.198,  0.041,  0.034, -0.026,  0.057, -0.006,
        -0.063, -0.001, -0.023,  0.011, -0.003,  0.014,  0.049,  0.046, -0.142,
         0.024, -0.022,  0.029, -0.004, -0.145,  0.080,  0.013,  0.107,  0.093,
         0.140,  0.007,  0.006,  0.040,  0.015,  0.097,  0.027,  0.008, -0.094,
         0.027,  0.041, -0.041,  0.031,  0.065, -0.013,  0.116, -0.038,  0.005,
         0.115,  0.020,  0.052,  0.097,  0.012,  0.019, -0.063, -0.004, -0.095,
        -0.096, -0.033,  0.070,  0.082, -0.123, -0.086,  0.021,  0.026,  0.014,
        -0.007,  0.043], device='cuda:0')
s after update for 1 param tensor([1.326, 1.218, 0.944, 0.810, 1.114, 0.924, 0.967, 1.594, 1.370, 1.257,
        0.898, 1.077, 1.683, 1.173, 1.006, 1.448, 1.628, 1.289, 1.497, 0.963,
        1.383, 1.054, 0.900, 1.614, 0.961, 1.070, 1.109, 1.039, 1.690, 1.175,
        0.921, 0.901, 1.567, 1.411, 1.568, 0.863, 0.680, 0.843, 1.485, 0.924,
        1.866, 0.956, 1.008, 0.732, 0.878, 1.529, 1.167, 1.059, 1.107, 1.232,
        0.984, 1.571, 1.433, 1.003, 1.126, 1.071, 1.657, 1.271, 0.888, 0.559,
        1.105, 0.962, 1.046, 1.530, 1.404, 1.269, 0.900, 1.441, 0.789, 1.060,
        1.251, 1.374, 1.183, 1.256, 1.284, 0.851, 1.168, 1.318, 1.744, 1.408,
        1.094, 1.526, 1.447, 1.118, 1.298, 1.026, 1.597, 1.047, 1.340, 1.328,
        0.925, 0.723, 1.306, 1.284, 1.741, 1.009, 1.617, 1.547, 1.281, 1.070,
        1.569, 1.110, 1.437, 1.442, 1.283, 0.657, 1.307, 1.015, 1.098, 1.221,
        0.708, 1.023, 1.047, 1.478, 0.899, 0.987, 1.255, 1.894, 1.279, 1.129,
        0.986, 1.327, 1.257, 1.075, 1.486, 1.982, 0.875, 1.272, 0.971, 1.048,
        0.559, 1.202, 1.196, 1.481, 1.346, 1.317, 1.272, 1.574, 1.804, 1.285,
        1.269, 0.824, 0.943, 1.507, 1.701, 1.349, 1.465, 1.310, 0.913, 1.295,
        1.086, 0.770, 1.236, 1.662, 1.414, 0.966, 0.519, 0.881, 1.479, 1.079,
        1.126, 1.127, 1.193, 0.907, 0.650, 0.918, 0.714, 1.475, 1.394, 1.099,
        1.071, 0.694, 0.891, 0.698, 0.693, 1.194, 1.114, 1.112, 0.989, 1.101,
        1.412, 1.706, 1.227, 1.675, 1.395, 1.426, 0.906, 1.710, 1.220, 1.019,
        0.837, 1.342, 0.428, 1.207, 1.149, 1.248, 1.063, 1.386, 1.439, 0.515],
       device='cuda:0')
b after update for 1 param tensor([ 83.464,  80.008,  70.421,  65.260,  76.507,  69.676,  71.287,  91.531,
         84.841,  81.276,  68.711,  75.243,  94.050,  78.529,  72.699,  87.237,
         92.482,  82.294,  88.709,  71.140,  85.260,  74.421,  68.760,  92.106,
         71.051,  74.982,  76.344,  73.903,  94.236,  78.571,  69.560,  68.825,
         90.740,  86.101,  90.772,  67.327,  59.792,  66.558,  88.332,  69.686,
         99.039,  70.865,  72.797,  62.011,  67.933,  89.634,  78.315,  74.610,
         76.260,  80.474,  71.918,  90.856,  86.786,  72.612,  76.916,  75.021,
         93.320,  81.741,  68.301,  54.194,  76.192,  71.099,  74.140,  89.658,
         85.908,  81.666,  68.774,  87.030,  64.401,  74.631,  81.087,  84.980,
         78.842,  81.234,  82.142,  66.881,  78.361,  83.217,  95.722,  86.010,
         75.808,  89.547,  87.200,  76.661,  82.588,  73.424,  91.619,  74.171,
         83.930,  83.545,  69.730,  61.636,  82.848,  82.148,  95.652,  72.820,
         92.187,  90.158,  82.060,  74.984,  90.815,  76.387,  86.906,  87.049,
         82.109,  58.777,  82.863,  73.042,  75.955,  80.111,  60.978,  73.325,
         74.165,  88.127,  68.726,  72.038,  81.220,  99.765,  81.977,  77.013,
         72.001,  83.522,  81.285,  75.170,  88.355, 102.066,  67.824,  81.751,
         71.445,  74.227,  54.189,  79.474,  79.270,  88.226,  84.099,  83.190,
         81.774,  90.948,  97.365,  82.184,  81.664,  65.794,  70.406,  88.984,
         94.552,  84.201,  87.745,  82.966,  69.257,  82.505,  75.541,  63.620,
         80.598,  93.465,  86.198,  71.249,  52.213,  68.032,  88.176,  75.311,
         76.923,  76.954,  79.183,  69.034,  58.443,  69.457,  61.251,  88.045,
         85.605,  76.012,  75.010,  60.378,  68.441,  60.553,  60.362,  79.228,
         76.503,  76.431,  72.084,  76.055,  86.154,  94.687,  80.292,  93.827,
         85.636,  86.570,  69.008,  94.800,  80.087,  73.188,  66.337,  83.977,
         47.435,  79.633,  77.704,  80.979,  74.748,  85.354,  86.957,  52.040],
       device='cuda:0')
clipping threshold 0.23438493615842576
a after update for 1 param tensor([[[-0.034],
         [-0.053],
         [ 0.018],
         [ 0.230],
         [-0.076],
         [-0.054],
         [ 0.094],
         [-0.018],
         [ 0.022],
         [-0.079]],

        [[ 0.015],
         [-0.064],
         [-0.101],
         [-0.174],
         [ 0.080],
         [ 0.024],
         [ 0.009],
         [ 0.044],
         [ 0.023],
         [ 0.115]],

        [[ 0.030],
         [-0.011],
         [-0.001],
         [-0.104],
         [-0.079],
         [ 0.066],
         [ 0.004],
         [-0.010],
         [ 0.044],
         [-0.006]],

        [[ 0.028],
         [ 0.007],
         [ 0.002],
         [-0.053],
         [-0.040],
         [ 0.012],
         [-0.015],
         [ 0.000],
         [-0.067],
         [-0.060]],

        [[-0.062],
         [ 0.159],
         [-0.050],
         [ 0.003],
         [-0.039],
         [ 0.050],
         [-0.004],
         [-0.007],
         [ 0.058],
         [ 0.037]],

        [[ 0.041],
         [ 0.009],
         [ 0.006],
         [-0.022],
         [-0.214],
         [ 0.070],
         [-0.011],
         [-0.064],
         [ 0.078],
         [-0.014]],

        [[-0.007],
         [-0.085],
         [ 0.048],
         [ 0.000],
         [-0.065],
         [ 0.054],
         [ 0.046],
         [-0.080],
         [ 0.085],
         [-0.036]],

        [[ 0.074],
         [-0.067],
         [ 0.052],
         [-0.005],
         [ 0.075],
         [ 0.023],
         [ 0.060],
         [ 0.047],
         [-0.096],
         [-0.099]],

        [[-0.028],
         [ 0.153],
         [-0.001],
         [-0.013],
         [ 0.032],
         [-0.007],
         [ 0.185],
         [-0.087],
         [-0.007],
         [-0.020]],

        [[-0.020],
         [ 0.019],
         [ 0.055],
         [ 0.024],
         [ 0.023],
         [-0.049],
         [ 0.021],
         [ 0.061],
         [-0.097],
         [-0.005]],

        [[-0.033],
         [ 0.020],
         [-0.124],
         [-0.204],
         [-0.052],
         [ 0.108],
         [ 0.022],
         [ 0.052],
         [ 0.026],
         [-0.097]],

        [[-0.053],
         [-0.012],
         [-0.018],
         [-0.015],
         [ 0.034],
         [ 0.092],
         [-0.190],
         [ 0.122],
         [-0.050],
         [ 0.006]],

        [[-0.031],
         [ 0.041],
         [-0.069],
         [ 0.090],
         [ 0.072],
         [-0.127],
         [-0.044],
         [-0.016],
         [ 0.219],
         [-0.134]],

        [[-0.055],
         [-0.028],
         [ 0.017],
         [-0.182],
         [ 0.003],
         [ 0.119],
         [-0.034],
         [-0.080],
         [ 0.073],
         [-0.039]],

        [[-0.004],
         [-0.009],
         [ 0.004],
         [-0.011],
         [ 0.080],
         [-0.037],
         [-0.114],
         [ 0.011],
         [ 0.014],
         [ 0.156]],

        [[ 0.023],
         [ 0.055],
         [ 0.021],
         [ 0.037],
         [-0.055],
         [-0.112],
         [ 0.085],
         [ 0.025],
         [-0.054],
         [ 0.063]],

        [[-0.000],
         [-0.003],
         [-0.045],
         [ 0.014],
         [-0.005],
         [-0.025],
         [-0.004],
         [ 0.018],
         [-0.028],
         [-0.069]],

        [[ 0.033],
         [ 0.140],
         [-0.075],
         [ 0.028],
         [ 0.115],
         [ 0.006],
         [ 0.086],
         [ 0.117],
         [-0.057],
         [ 0.122]],

        [[ 0.076],
         [ 0.014],
         [-0.006],
         [-0.049],
         [-0.004],
         [ 0.202],
         [ 0.028],
         [ 0.033],
         [ 0.046],
         [-0.023]],

        [[-0.010],
         [ 0.012],
         [-0.032],
         [-0.002],
         [ 0.114],
         [-0.020],
         [-0.040],
         [-0.017],
         [ 0.004],
         [ 0.040]]], device='cuda:0')
s after update for 1 param tensor([[[0.832],
         [0.794],
         [1.292],
         [1.189],
         [0.462],
         [0.698],
         [1.391],
         [1.224],
         [0.821],
         [1.472]],

        [[0.881],
         [1.252],
         [0.483],
         [1.387],
         [1.293],
         [2.033],
         [1.620],
         [0.884],
         [1.298],
         [1.217]],

        [[0.946],
         [0.931],
         [1.726],
         [0.972],
         [0.901],
         [1.454],
         [1.238],
         [1.569],
         [1.031],
         [0.840]],

        [[1.016],
         [1.659],
         [1.254],
         [1.381],
         [1.268],
         [1.183],
         [1.676],
         [0.903],
         [2.078],
         [1.237]],

        [[1.804],
         [1.506],
         [1.213],
         [1.489],
         [0.609],
         [1.378],
         [1.372],
         [1.323],
         [1.367],
         [0.766]],

        [[1.047],
         [0.841],
         [1.414],
         [1.279],
         [1.504],
         [1.305],
         [0.812],
         [1.589],
         [1.614],
         [1.084]],

        [[1.438],
         [1.188],
         [1.128],
         [1.373],
         [0.977],
         [1.474],
         [1.517],
         [1.162],
         [1.170],
         [1.255]],

        [[1.509],
         [1.494],
         [1.720],
         [1.525],
         [0.978],
         [1.429],
         [1.265],
         [1.980],
         [1.445],
         [1.478]],

        [[1.415],
         [1.437],
         [1.600],
         [1.608],
         [1.376],
         [1.455],
         [1.363],
         [1.264],
         [0.886],
         [0.834]],

        [[1.074],
         [1.280],
         [0.792],
         [1.313],
         [1.133],
         [0.858],
         [0.728],
         [1.097],
         [0.806],
         [1.205]],

        [[1.749],
         [0.755],
         [1.253],
         [0.839],
         [1.121],
         [1.334],
         [1.233],
         [1.380],
         [0.846],
         [1.027]],

        [[1.359],
         [1.091],
         [0.962],
         [1.405],
         [0.677],
         [1.246],
         [1.971],
         [0.934],
         [0.896],
         [0.844]],

        [[1.155],
         [1.386],
         [1.060],
         [1.415],
         [1.772],
         [0.713],
         [0.798],
         [1.404],
         [1.089],
         [1.404]],

        [[0.587],
         [1.578],
         [1.664],
         [1.344],
         [1.515],
         [1.502],
         [1.230],
         [1.026],
         [1.522],
         [1.674]],

        [[0.782],
         [0.818],
         [0.784],
         [0.963],
         [1.475],
         [0.561],
         [1.295],
         [0.971],
         [1.798],
         [1.568]],

        [[1.099],
         [0.945],
         [0.793],
         [1.239],
         [1.075],
         [1.105],
         [1.410],
         [1.266],
         [1.223],
         [1.687]],

        [[1.036],
         [1.223],
         [1.552],
         [1.718],
         [1.426],
         [1.274],
         [1.428],
         [0.958],
         [1.458],
         [1.372]],

        [[1.117],
         [1.474],
         [1.038],
         [1.676],
         [1.640],
         [2.112],
         [1.232],
         [1.131],
         [0.957],
         [1.036]],

        [[1.196],
         [1.705],
         [1.484],
         [1.480],
         [1.052],
         [1.183],
         [1.365],
         [0.999],
         [1.145],
         [1.157]],

        [[1.241],
         [1.524],
         [1.216],
         [1.259],
         [1.755],
         [1.685],
         [1.158],
         [1.478],
         [0.979],
         [1.007]]], device='cuda:0')
b after update for 1 param tensor([[[ 66.139],
         [ 64.610],
         [ 82.387],
         [ 79.036],
         [ 49.271],
         [ 60.584],
         [ 85.483],
         [ 80.189],
         [ 65.674],
         [ 87.952]],

        [[ 68.062],
         [ 81.098],
         [ 50.368],
         [ 85.368],
         [ 82.419],
         [103.365],
         [ 92.257],
         [ 68.154],
         [ 82.598],
         [ 79.981]],

        [[ 70.518],
         [ 69.960],
         [ 95.234],
         [ 71.465],
         [ 68.795],
         [ 87.415],
         [ 80.666],
         [ 90.817],
         [ 73.598],
         [ 66.446]],

        [[ 73.053],
         [ 93.363],
         [ 81.184],
         [ 85.202],
         [ 81.618],
         [ 78.843],
         [ 93.836],
         [ 68.871],
         [104.508],
         [ 80.623]],

        [[ 97.369],
         [ 88.950],
         [ 79.828],
         [ 88.458],
         [ 56.569],
         [ 85.107],
         [ 84.900],
         [ 83.381],
         [ 84.755],
         [ 63.429]],

        [[ 74.183],
         [ 66.487],
         [ 86.207],
         [ 81.987],
         [ 88.890],
         [ 82.826],
         [ 65.325],
         [ 91.370],
         [ 92.096],
         [ 75.470]],

        [[ 86.944],
         [ 79.029],
         [ 77.010],
         [ 84.945],
         [ 71.663],
         [ 88.011],
         [ 89.272],
         [ 78.150],
         [ 78.406],
         [ 81.226]],

        [[ 89.047],
         [ 88.622],
         [ 95.066],
         [ 89.533],
         [ 71.685],
         [ 86.666],
         [ 81.536],
         [102.018],
         [ 87.153],
         [ 88.145]],

        [[ 86.240],
         [ 86.910],
         [ 91.687],
         [ 91.921],
         [ 85.040],
         [ 87.435],
         [ 84.637],
         [ 81.505],
         [ 68.225],
         [ 66.209]],

        [[ 75.123],
         [ 82.015],
         [ 64.534],
         [ 83.079],
         [ 77.179],
         [ 67.145],
         [ 61.856],
         [ 75.924],
         [ 65.066],
         [ 79.585]],

        [[ 95.874],
         [ 62.979],
         [ 81.142],
         [ 66.385],
         [ 76.745],
         [ 83.719],
         [ 80.487],
         [ 85.163],
         [ 66.661],
         [ 73.482]],

        [[ 84.520],
         [ 75.708],
         [ 71.085],
         [ 85.921],
         [ 59.661],
         [ 80.914],
         [101.774],
         [ 70.074],
         [ 68.638],
         [ 66.582]],

        [[ 77.922],
         [ 85.345],
         [ 74.648],
         [ 86.223],
         [ 96.495],
         [ 61.200],
         [ 64.768],
         [ 85.897],
         [ 75.645],
         [ 85.897]],

        [[ 55.534],
         [ 91.071],
         [ 93.502],
         [ 84.044],
         [ 89.234],
         [ 88.843],
         [ 80.396],
         [ 73.427],
         [ 89.439],
         [ 93.794]],

        [[ 64.106],
         [ 65.574],
         [ 64.201],
         [ 71.152],
         [ 88.040],
         [ 54.276],
         [ 82.484],
         [ 71.422],
         [ 97.196],
         [ 90.784]],

        [[ 76.012],
         [ 70.466],
         [ 64.548],
         [ 80.686],
         [ 75.164],
         [ 76.193],
         [ 86.091],
         [ 81.563],
         [ 80.180],
         [ 94.146]],

        [[ 73.771],
         [ 80.176],
         [ 90.308],
         [ 95.028],
         [ 86.582],
         [ 81.828],
         [ 86.621],
         [ 70.945],
         [ 87.532],
         [ 84.905]],

        [[ 76.628],
         [ 88.008],
         [ 73.840],
         [ 93.850],
         [ 92.846],
         [105.341],
         [ 80.461],
         [ 77.096],
         [ 70.925],
         [ 73.788]],

        [[ 79.274],
         [ 94.655],
         [ 88.305],
         [ 88.187],
         [ 74.371],
         [ 78.853],
         [ 84.691],
         [ 72.450],
         [ 77.584],
         [ 77.966]],

        [[ 80.765],
         [ 89.495],
         [ 79.942],
         [ 81.342],
         [ 96.023],
         [ 94.104],
         [ 78.002],
         [ 88.128],
         [ 71.717],
         [ 72.758]]], device='cuda:0')
clipping threshold 0.23438493615842576
a after update for 1 param tensor([[ 0.060],
        [-0.062],
        [ 0.021],
        [-0.039],
        [-0.002],
        [-0.036],
        [ 0.025],
        [ 0.007],
        [-0.064],
        [-0.102],
        [-0.032],
        [ 0.086],
        [ 0.079],
        [ 0.013],
        [-0.094],
        [-0.136],
        [-0.051],
        [-0.045],
        [-0.118],
        [-0.024]], device='cuda:0')
s after update for 1 param tensor([[1.454],
        [1.615],
        [1.632],
        [1.193],
        [1.576],
        [1.325],
        [1.726],
        [0.586],
        [1.580],
        [1.803],
        [0.939],
        [1.520],
        [1.752],
        [1.181],
        [1.001],
        [1.550],
        [1.255],
        [1.624],
        [1.924],
        [1.558]], device='cuda:0')
b after update for 1 param tensor([[ 87.404],
        [ 92.122],
        [ 92.607],
        [ 79.192],
        [ 91.014],
        [ 83.434],
        [ 95.241],
        [ 55.470],
        [ 91.125],
        [ 97.347],
        [ 70.249],
        [ 89.377],
        [ 95.950],
        [ 78.792],
        [ 72.544],
        [ 90.252],
        [ 81.201],
        [ 92.394],
        [100.561],
        [ 90.481]], device='cuda:0')
clipping threshold 0.23438493615842576
||w||^2 0.032196294118541205
exp ma of ||w||^2 0.08675548127779681
||w|| 0.17943325811716512
exp ma of ||w|| 0.28462497372366596
||w||^2 0.06437716925369215
exp ma of ||w||^2 0.08473783097317894
||w|| 0.25372656394964277
exp ma of ||w|| 0.28194969542390846
||w||^2 0.09752412673694308
exp ma of ||w||^2 0.08132602231021172
||w|| 0.3122885312286429
exp ma of ||w|| 0.27690781103642154
||w||^2 0.10268145066600229
exp ma of ||w||^2 0.08075047497855374
||w|| 0.3204394649009424
exp ma of ||w|| 0.275802866860938
||w||^2 0.12522658453536448
exp ma of ||w||^2 0.0875067669812917
||w|| 0.35387368443466444
exp ma of ||w|| 0.28634432634568685
||w||^2 0.08582936983169132
exp ma of ||w||^2 0.08471351675385713
||w|| 0.29296649950410936
exp ma of ||w|| 0.2824072970423131
||w||^2 0.06960352086734888
exp ma of ||w||^2 0.08819705889175022
||w|| 0.2638247919876919
exp ma of ||w|| 0.28796591323858156
cuda
Objective function 19.21 = squared loss an data 17.21 + 0.5*rho*h**2 0.749278 + alpha*h 0.576273 + L2reg 0.48 + L1reg 0.19 ; SHD = 50 ; DAG True
Proportion of microbatches that were clipped  0.7570912012856569
iteration 2 in inner loop, alpha 1.4886474067704256 rho 10.0 h 0.38711184534497534
4420
cuda
Objective function 25.95 = squared loss an data 17.21 + 0.5*rho*h**2 7.492779 + alpha*h 0.576273 + L2reg 0.48 + L1reg 0.19 ; SHD = 50 ; DAG True
||w||^2 1107538.4248083828
exp ma of ||w||^2 147411718.97696254
||w|| 1052.3965150115155
exp ma of ||w|| 4861.263015113935
||w||^2 0.048845588300914275
exp ma of ||w||^2 0.922557391691672
||w|| 0.22101038052750888
exp ma of ||w|| 0.24778275224263452
||w||^2 0.12410570045762795
exp ma of ||w||^2 0.09296605880484032
||w|| 0.35228638982740723
exp ma of ||w|| 0.29413046209690447
||w||^2 0.05992547419635008
exp ma of ||w||^2 0.08122319623190424
||w|| 0.2447968018507392
exp ma of ||w|| 0.2760738988894188
||w||^2 0.032676892777058986
exp ma of ||w||^2 0.09187829643303676
||w|| 0.18076751029169758
exp ma of ||w|| 0.2916762083082293
||w||^2 0.14117987010739863
exp ma of ||w||^2 0.09759900011575402
||w|| 0.3757390984544976
exp ma of ||w|| 0.30258254790159206
||w||^2 0.06048114274790827
exp ma of ||w||^2 0.09476899838873909
||w|| 0.24592914172157043
exp ma of ||w|| 0.2977333781053516
||w||^2 0.15873976261528513
exp ma of ||w||^2 0.10557085504935747
||w|| 0.3984215890426686
exp ma of ||w|| 0.3136988661940101
cuda
Objective function 20.00 = squared loss an data 18.33 + 0.5*rho*h**2 0.777802 + alpha*h 0.185670 + L2reg 0.54 + L1reg 0.17 ; SHD = 53 ; DAG True
Proportion of microbatches that were clipped  0.7583184547962993
iteration 3 in inner loop, alpha 1.4886474067704256 rho 100.0 h 0.12472385611059522
iteration 2 in outer loop, alpha = 13.961033017829948, rho = 100.0, h = 0.12472385611059522
cuda
4420
cuda
Objective function 21.56 = squared loss an data 18.33 + 0.5*rho*h**2 0.777802 + alpha*h 1.741274 + L2reg 0.54 + L1reg 0.17 ; SHD = 53 ; DAG True
||w||^2 36295889.82523435
exp ma of ||w||^2 1295749374.6840436
||w|| 6024.607026622928
exp ma of ||w|| 26640.530717065663
||w||^2 3558.632831883438
exp ma of ||w||^2 13686844.01045206
||w|| 59.65427756568206
exp ma of ||w|| 652.4236035403586
||w||^2 0.10980042796099725
exp ma of ||w||^2 21156.026419559144
||w|| 0.3313614762777913
exp ma of ||w|| 1.6895071940084616
||w||^2 0.1251498342293802
exp ma of ||w||^2 1206.4318015119966
||w|| 0.3537652247315728
exp ma of ||w|| 0.4099614447307043
||w||^2 0.039347558621183096
exp ma of ||w||^2 0.08322733681968252
||w|| 0.1983621905030873
exp ma of ||w|| 0.27729143261122785
||w||^2 0.14476721676660592
exp ma of ||w||^2 0.09417467888190843
||w|| 0.3804828731580515
exp ma of ||w|| 0.2988214252495876
||w||^2 0.06706303321310453
exp ma of ||w||^2 0.09426139985674062
||w|| 0.2589653127604246
exp ma of ||w|| 0.29657126059346284
||w||^2 0.07643396332479348
exp ma of ||w||^2 0.08886242652333119
||w|| 0.27646692989360133
exp ma of ||w|| 0.2900285144050412
||w||^2 0.07764885943156499
exp ma of ||w||^2 0.09202469951318808
||w|| 0.2786554493125247
exp ma of ||w|| 0.29493453690645627
||w||^2 0.02903299300542528
exp ma of ||w||^2 0.0955356163130836
||w|| 0.1703907069221361
exp ma of ||w|| 0.3000451503800227
||w||^2 0.0556275048722198
exp ma of ||w||^2 0.09774373887130003
||w|| 0.235854838560119
exp ma of ||w|| 0.30108657828509283
||w||^2 0.13019201966810576
exp ma of ||w||^2 0.10497608455117324
||w|| 0.3608213126578109
exp ma of ||w|| 0.3149417785482146
||w||^2 0.19092277367961527
exp ma of ||w||^2 0.11002631679479259
||w|| 0.4369471062721611
exp ma of ||w|| 0.3195873622286334
||w||^2 0.08797384731337918
exp ma of ||w||^2 0.10148900539004169
||w|| 0.2966038558639776
exp ma of ||w|| 0.3082923517209771
||w||^2 0.05132024811161762
exp ma of ||w||^2 0.08851142260512385
||w|| 0.22653972744668344
exp ma of ||w|| 0.2879579780010683
cuda
Objective function 20.74 = squared loss an data 18.58 + 0.5*rho*h**2 0.308286 + alpha*h 1.096250 + L2reg 0.60 + L1reg 0.16 ; SHD = 55 ; DAG True
Proportion of microbatches that were clipped  0.7568376759993527
iteration 1 in inner loop, alpha 13.961033017829948 rho 100.0 h 0.07852212278208981
4420
cuda
Objective function 23.52 = squared loss an data 18.58 + 0.5*rho*h**2 3.082862 + alpha*h 1.096250 + L2reg 0.60 + L1reg 0.16 ; SHD = 55 ; DAG True
||w||^2 0.185845905800447
exp ma of ||w||^2 24083.247680249307
||w|| 0.43109848735578626
exp ma of ||w|| 1.6118714870367739
||w||^2 0.11412822988834828
exp ma of ||w||^2 220.581858558373
||w|| 0.337828699030068
exp ma of ||w|| 0.3420388553180765
||w||^2 0.13659227742248012
exp ma of ||w||^2 0.10049176874514733
||w|| 0.36958392473493773
exp ma of ||w|| 0.3085847693695812
||w||^2 0.10123889784672402
exp ma of ||w||^2 0.10506214618633392
||w|| 0.31818060570487955
exp ma of ||w|| 0.3140374637313036
||w||^2 0.0972748984486346
exp ma of ||w||^2 0.10553017166852784
||w|| 0.3118892406746898
exp ma of ||w|| 0.3159409024966013
||w||^2 0.13128159637036033
exp ma of ||w||^2 0.11135996109031657
||w|| 0.3623280231645909
exp ma of ||w|| 0.3222433817260848
cuda
Objective function 20.77 = squared loss an data 18.91 + 0.5*rho*h**2 0.575827 + alpha*h 0.473782 + L2reg 0.66 + L1reg 0.16 ; SHD = 64 ; DAG True
Proportion of microbatches that were clipped  0.761870675256502
iteration 2 in inner loop, alpha 13.961033017829948 rho 1000.0 h 0.033936038108834055
4420
cuda
Objective function 25.96 = squared loss an data 18.91 + 0.5*rho*h**2 5.758273 + alpha*h 0.473782 + L2reg 0.66 + L1reg 0.16 ; SHD = 64 ; DAG True
||w||^2 120732778667.70499
exp ma of ||w||^2 44486469954.65409
||w|| 347466.2266576494
exp ma of ||w|| 134481.52465472155
||w||^2 103684373.97223319
exp ma of ||w||^2 7135263711.725805
||w|| 10182.55242914237
exp ma of ||w|| 40870.81641065438
||w||^2 39.44373561057875
exp ma of ||w||^2 25164786.15537347
||w|| 6.280424795392327
exp ma of ||w|| 266.939149572135
||w||^2 0.17319646436339436
exp ma of ||w||^2 7115.8788793771155
||w|| 0.4161687931157193
exp ma of ||w|| 0.6462105194206826
||w||^2 0.08646887867750658
exp ma of ||w||^2 0.09048869865001766
||w|| 0.2940559108018517
exp ma of ||w|| 0.28515229273352727
||w||^2 0.09103934588967556
exp ma of ||w||^2 0.0956743195816594
||w|| 0.30172727070928734
exp ma of ||w|| 0.2996683397183436
||w||^2 0.10175702002418124
exp ma of ||w||^2 0.09344269348248149
||w|| 0.3189937617323907
exp ma of ||w|| 0.29692457071248113
||w||^2 0.10760977104290612
exp ma of ||w||^2 0.09712554201020145
||w|| 0.3280392827740393
exp ma of ||w|| 0.3034892340374486
||w||^2 0.09302316308653606
exp ma of ||w||^2 0.09920081825478737
||w|| 0.30499698865158664
exp ma of ||w|| 0.3068977786536973
||w||^2 0.14868907667989173
exp ma of ||w||^2 0.10604028626018845
||w|| 0.38560222597891175
exp ma of ||w|| 0.31402134791462133
||w||^2 0.14633939505553042
exp ma of ||w||^2 0.10739144958540275
||w|| 0.382543324416373
exp ma of ||w|| 0.31724641741111703
||w||^2 0.09820927952962313
exp ma of ||w||^2 0.09402607228216013
||w|| 0.3133835980545618
exp ma of ||w|| 0.2981963058767192
cuda
Objective function 20.79 = squared loss an data 19.20 + 0.5*rho*h**2 0.596059 + alpha*h 0.152432 + L2reg 0.68 + L1reg 0.16 ; SHD = 61 ; DAG True
Proportion of microbatches that were clipped  0.7617832363027355
iteration 3 in inner loop, alpha 13.961033017829948 rho 10000.0 h 0.010918413974863483
iteration 3 in outer loop, alpha = 123.14517276646478, rho = 10000.0, h = 0.010918413974863483
cuda
4420
cuda
Objective function 21.98 = squared loss an data 19.20 + 0.5*rho*h**2 0.596059 + alpha*h 1.344550 + L2reg 0.68 + L1reg 0.16 ; SHD = 61 ; DAG True
||w||^2 0.20063966816713946
exp ma of ||w||^2 6484.815116361389
||w|| 0.44792819532503136
exp ma of ||w|| 0.5745474219442127
||w||^2 0.10085937460264924
exp ma of ||w||^2 40.648019939647426
||w|| 0.3175836497722281
exp ma of ||w|| 0.35608447677416943
||w||^2 0.12402812849960196
exp ma of ||w||^2 0.20071636815025437
||w|| 0.3521762747539958
exp ma of ||w|| 0.2887372546817319
||w||^2 0.09367281542177136
exp ma of ||w||^2 0.07723084641397003
||w|| 0.3060601500061244
exp ma of ||w|| 0.2707689007735783
||w||^2 0.04303521560175414
exp ma of ||w||^2 0.10235725208619784
||w|| 0.20744930851114965
exp ma of ||w|| 0.3103987683035011
||w||^2 0.04247821134622852
exp ma of ||w||^2 0.10399006276623313
||w|| 0.20610242925843578
exp ma of ||w|| 0.31351055340583306
||w||^2 0.11348792927889766
exp ma of ||w||^2 0.10315668482937146
||w|| 0.33687969555747593
exp ma of ||w|| 0.31153462577379143
||w||^2 0.06700527129886877
exp ma of ||w||^2 0.09770589567646044
||w|| 0.2588537643127269
exp ma of ||w|| 0.3048723757028465
||w||^2 0.11309228338298162
exp ma of ||w||^2 0.09896374876036007
||w|| 0.3362919615200185
exp ma of ||w|| 0.30545642223825653
||w||^2 0.06478128051347896
exp ma of ||w||^2 0.09634648900345359
||w|| 0.2545216700272866
exp ma of ||w|| 0.30151543346959125
||w||^2 0.14488595686503966
exp ma of ||w||^2 0.10822469348067235
||w|| 0.3806388798652072
exp ma of ||w|| 0.3217543015282286
||w||^2 0.14330297907937697
exp ma of ||w||^2 0.10172678143822587
||w|| 0.37855379945177803
exp ma of ||w|| 0.31099328779642305
cuda
Objective function 21.31 = squared loss an data 19.23 + 0.5*rho*h**2 0.293027 + alpha*h 0.942728 + L2reg 0.69 + L1reg 0.15 ; SHD = 54 ; DAG True
Proportion of microbatches that were clipped  0.7602707006369427
iteration 1 in inner loop, alpha 123.14517276646478 rho 10000.0 h 0.007655421749340974
4420
cuda
Objective function 23.95 = squared loss an data 19.23 + 0.5*rho*h**2 2.930274 + alpha*h 0.942728 + L2reg 0.69 + L1reg 0.15 ; SHD = 54 ; DAG True
||w||^2 6.040563575558847
exp ma of ||w||^2 193923485.4113231
||w|| 2.457755800635785
exp ma of ||w|| 107.40325226170069
||w||^2 0.21863789774388406
exp ma of ||w||^2 472.9153199664424
||w|| 0.4675873156362179
exp ma of ||w|| 0.5577401282511514
||w||^2 0.07197278316710876
exp ma of ||w||^2 5.532185213099191
||w|| 0.2682774369325694
exp ma of ||w|| 0.362095724882509
||w||^2 0.11506663800240591
exp ma of ||w||^2 0.09726296941950983
||w|| 0.3392147373013235
exp ma of ||w|| 0.30310679347065933
||w||^2 0.19633204046619426
exp ma of ||w||^2 0.11484371058808192
||w|| 0.44309371521856894
exp ma of ||w|| 0.3287592070361963
||w||^2 0.31464211694061617
exp ma of ||w||^2 0.11267952623238947
||w|| 0.560929689836985
exp ma of ||w|| 0.3244459449098874
||w||^2 0.06630914358091823
exp ma of ||w||^2 0.10604745969857378
||w|| 0.2575056185424276
exp ma of ||w|| 0.31823420249474477
||w||^2 0.14094686258645248
exp ma of ||w||^2 0.10873274932583839
||w|| 0.37542890483612534
exp ma of ||w|| 0.32132608912604976
||w||^2 0.061308056293350684
exp ma of ||w||^2 0.11034931176349753
||w|| 0.2476046370594676
exp ma of ||w|| 0.32290058179650694
||w||^2 0.08572976874115106
exp ma of ||w||^2 0.09888778748414183
||w|| 0.29279646299289724
exp ma of ||w|| 0.3076868997986013
||w||^2 0.09407497857266278
exp ma of ||w||^2 0.10833488621222864
||w|| 0.3067164465310962
exp ma of ||w|| 0.32212847700276764
cuda
Objective function 20.85 = squared loss an data 19.26 + 0.5*rho*h**2 0.371404 + alpha*h 0.335626 + L2reg 0.74 + L1reg 0.14 ; SHD = 57 ; DAG True
Proportion of microbatches that were clipped  0.7623603183535654
iteration 2 in inner loop, alpha 123.14517276646478 rho 100000.0 h 0.0027254511529939407
iteration 4 in outer loop, alpha = 395.69028806585885, rho = 100000.0, h = 0.0027254511529939407
cuda
4420
cuda
Objective function 21.59 = squared loss an data 19.26 + 0.5*rho*h**2 0.371404 + alpha*h 1.078435 + L2reg 0.74 + L1reg 0.14 ; SHD = 57 ; DAG True
||w||^2 1.7313575877316136
exp ma of ||w||^2 5904877.120361766
||w|| 1.3158106200101949
exp ma of ||w|| 3.6130362960131417
||w||^2 1.883210170240592
exp ma of ||w||^2 4153772.7378842775
||w|| 1.372301049420495
exp ma of ||w|| 2.941044661820429
||w||^2 0.8853466427091781
exp ma of ||w||^2 603116.3658193547
||w|| 0.9409286065951965
exp ma of ||w|| 1.5100881844072445
||w||^2 1.584447817759683
exp ma of ||w||^2 156862.7600319268
||w|| 1.2587485125153806
exp ma of ||w|| 1.2320900603106588
||w||^2 0.13215895352418333
exp ma of ||w||^2 0.12526519446322174
||w|| 0.36353672926429775
exp ma of ||w|| 0.33830942800845426
||w||^2 0.07649844875184181
exp ma of ||w||^2 0.10198230949245904
||w|| 0.27658352942979414
exp ma of ||w|| 0.31479177659648605
||w||^2 0.0858629253944936
exp ma of ||w||^2 0.10575210247507533
||w|| 0.2930237625082539
exp ma of ||w|| 0.3175999212977414
v before min max tensor([[-10.327,  -1.258,  -5.274,  ...,  -5.816,  -5.606,  72.544],
        [-14.966,  -9.184,  -7.966,  ...,  -7.506,  44.572,  -3.954],
        [  5.858,  -5.731,   5.032,  ...,   2.753,  -5.470,  45.693],
        ...,
        [ -6.315,  -5.407,  -4.266,  ...,  -7.129,   0.630,  -7.543],
        [ 27.764,   3.572,  -4.997,  ...,   7.285,  -8.541,  -9.769],
        [ -3.835,  -7.703,  -8.255,  ...,   3.752,   4.047,  38.368]],
       device='cuda:0')
v tensor([[1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e+01],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e+01,
         1.000e-12],
        [5.858e+00, 1.000e-12, 5.032e+00,  ..., 2.753e+00, 1.000e-12,
         1.000e+01],
        ...,
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 6.305e-01,
         1.000e-12],
        [1.000e+01, 3.572e+00, 1.000e-12,  ..., 7.285e+00, 1.000e-12,
         1.000e-12],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 3.752e+00, 4.047e+00,
         1.000e+01]], device='cuda:0')
v before min max tensor([ -5.074, -10.810,   4.096,  -5.272,  12.843,   0.928,  -5.798,  -7.056,
         -6.390,  -8.062,   1.119,   7.359,  -4.990,  10.754,  92.959,   4.413,
         -4.541,  -8.434,  -0.688,  -4.455, -10.574,   7.386,   2.674,  -9.814,
         -7.782,  -1.547,  -7.289,  -4.662,  -7.333,   2.997,  14.930,  -4.367,
         -6.773,  20.963,  -3.291,  -3.836,  -7.818,   0.617,  -9.544,  19.386,
          7.635,  -6.934,  22.766,  -8.261,  -4.533,  10.363,  -0.243,  -5.005,
         -4.620,  -9.691,  -3.838,   1.732,  -5.494,  -1.189,  27.211, -10.078,
         -9.481,  -3.727,  -4.586,   0.161,  -2.737,  -5.580,  -8.805,  -9.558,
         -4.312, -10.626,  39.820,  -5.471,  -7.316,  -6.323,  14.186,  -7.447,
         -1.915,  -5.578,  -4.899,  -3.400,  -9.375,  -8.151,  -7.486,   7.812,
         -4.956,  -0.703,  12.292,  -9.357,  -6.200,  -7.355,  -0.649,  -7.824,
         -7.369,  -6.280,  -8.640,  -4.819,  -8.965,  -5.423,  18.875,  -0.287,
         -4.749,  -6.356,  -1.297,  -3.242,   2.187,  14.974,  -1.205,  -7.117,
         -5.687,  -8.359,  -1.825,  -7.251,  -1.990,  -2.836, -10.826,  12.322,
         16.601, -10.700,  -7.693,  -6.550,  -0.472,  -9.144,  -6.688,  -7.040,
         -5.221,  -1.362,  -6.603, -10.361,  -9.906,   1.705,  -5.962,  -9.139,
          3.464,  -5.439,  -8.816,   0.116,  -9.169,  -1.106,  -3.382,  12.094,
         -2.020,  -3.457,  -8.376,  -8.766,   1.037,  -6.170,  -8.967, -10.443,
         -5.766,   5.092,   1.231,  -6.746,  34.640,  16.341,   1.601,  -8.077,
         -8.779, -12.708,  19.862,  -6.739,  -6.706,  -2.626,   7.106,  -3.403,
         -7.182,  -8.162,  -9.137,  -3.074,  -4.091,  16.918,   3.808,  -3.233,
         19.881,   1.735,  -0.805,  -3.897,   4.700,  -5.145,  -6.676,   4.249,
         -8.080,  -4.101,  48.721,   5.008,  -1.025,   3.372,  -2.916,   3.533,
         -1.692,  -3.940,  -5.994,  -1.505,  -4.478,  -4.701,  15.712,  -6.074,
         -2.904,  -7.822,  -5.390,   4.661,  -5.517,  -2.814,  -7.096,  -4.029],
       device='cuda:0')
v tensor([1.000e-12, 1.000e-12, 4.096e+00, 1.000e-12, 1.000e+01, 9.283e-01,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.119e+00, 7.359e+00,
        1.000e-12, 1.000e+01, 1.000e+01, 4.413e+00, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 7.386e+00, 2.674e+00, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 2.997e+00,
        1.000e+01, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e-12, 6.171e-01, 1.000e-12, 1.000e+01, 7.635e+00, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.732e+00, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.607e-01,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 7.812e+00, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 2.187e+00, 1.000e+01,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.705e+00,
        1.000e-12, 1.000e-12, 3.464e+00, 1.000e-12, 1.000e-12, 1.160e-01,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.037e+00, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 5.092e+00, 1.231e+00, 1.000e-12, 1.000e+01, 1.000e+01,
        1.601e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 7.106e+00, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 3.808e+00, 1.000e-12,
        1.000e+01, 1.735e+00, 1.000e-12, 1.000e-12, 4.700e+00, 1.000e-12,
        1.000e-12, 4.249e+00, 1.000e-12, 1.000e-12, 1.000e+01, 5.008e+00,
        1.000e-12, 3.372e+00, 1.000e-12, 3.533e+00, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 4.661e+00, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12], device='cuda:0')
v before min max tensor([[[ 1.414e+01],
         [ 1.525e+01],
         [-7.213e+00],
         [-6.518e+00],
         [ 1.140e+01],
         [-5.370e+00],
         [ 3.755e+00],
         [ 2.600e+00],
         [-4.158e+00],
         [-2.031e+00]],

        [[-4.084e+00],
         [-6.850e+00],
         [-3.233e+00],
         [-6.731e+00],
         [-4.353e+00],
         [-7.510e+00],
         [-7.205e+00],
         [-8.986e+00],
         [-2.574e-02],
         [-4.137e+00]],

        [[-1.114e+01],
         [-8.666e+00],
         [-2.654e+00],
         [-1.755e+00],
         [-9.372e-01],
         [-6.250e+00],
         [-8.772e+00],
         [-4.678e+00],
         [ 2.477e+01],
         [ 9.296e+00]],

        [[ 5.128e+00],
         [ 1.911e+01],
         [-9.295e+00],
         [ 1.530e+01],
         [-7.290e+00],
         [-9.488e+00],
         [-6.195e+00],
         [ 4.343e+01],
         [-7.283e+00],
         [-9.571e+00]],

        [[-6.056e+00],
         [-5.635e+00],
         [-1.413e-01],
         [-9.787e+00],
         [ 2.784e+00],
         [-6.592e+00],
         [-7.121e+00],
         [-1.954e+00],
         [-5.196e+00],
         [ 2.631e+00]],

        [[ 5.493e+00],
         [-3.735e-01],
         [-6.208e+00],
         [ 2.929e+01],
         [-2.457e+00],
         [-7.124e+00],
         [ 1.025e+01],
         [ 5.260e+00],
         [ 3.224e+01],
         [ 5.838e+00]],

        [[ 2.195e+00],
         [ 4.170e+00],
         [-7.294e+00],
         [-2.433e+00],
         [ 1.897e+01],
         [-4.179e+00],
         [-6.607e+00],
         [-8.669e+00],
         [-3.018e+00],
         [-4.873e+00]],

        [[-5.062e+00],
         [-9.247e+00],
         [-6.519e+00],
         [-1.023e+01],
         [ 2.374e+00],
         [-1.017e+01],
         [-4.849e+00],
         [ 9.019e+00],
         [-4.637e+00],
         [-6.231e+00]],

        [[-7.091e+00],
         [ 2.328e+01],
         [ 7.090e+00],
         [-9.555e+00],
         [-9.380e+00],
         [-6.487e+00],
         [-8.432e+00],
         [-2.985e+00],
         [-7.669e+00],
         [-9.648e-02]],

        [[ 9.893e+00],
         [-6.118e+00],
         [-3.948e+00],
         [ 7.128e+01],
         [-8.381e+00],
         [-8.751e+00],
         [-1.020e+01],
         [-7.879e+00],
         [ 2.051e+00],
         [-9.021e+00]],

        [[-8.664e+00],
         [-9.086e+00],
         [-8.909e+00],
         [-6.029e-01],
         [-3.868e+00],
         [-6.402e+00],
         [-5.539e+00],
         [-7.517e+00],
         [ 3.624e+00],
         [-6.899e+00]],

        [[-6.119e+00],
         [-1.763e+00],
         [-5.566e+00],
         [ 3.004e+01],
         [ 2.651e+00],
         [ 7.898e+00],
         [-7.083e+00],
         [-1.947e+00],
         [-6.365e+00],
         [-8.036e+00]],

        [[-4.804e+00],
         [ 2.341e+00],
         [-1.231e+00],
         [-9.045e+00],
         [-1.779e+00],
         [ 1.599e+01],
         [-7.603e+00],
         [ 1.324e+00],
         [-8.072e+00],
         [ 1.536e+01]],

        [[-6.446e+00],
         [-6.597e+00],
         [-3.552e+00],
         [-6.601e+00],
         [ 3.011e+00],
         [-3.340e+00],
         [-8.358e+00],
         [-7.733e+00],
         [-4.380e+00],
         [-8.053e+00]],

        [[-3.299e+00],
         [-7.356e+00],
         [-5.577e+00],
         [ 1.063e+01],
         [ 1.381e+01],
         [-6.377e+00],
         [-3.172e+00],
         [-4.094e+00],
         [-1.139e+01],
         [-1.847e-01]],

        [[-6.171e+00],
         [-3.936e+00],
         [-2.226e+00],
         [ 5.302e+00],
         [ 3.487e+01],
         [ 1.396e+00],
         [-6.366e+00],
         [-2.080e+00],
         [-7.840e+00],
         [-4.911e+00]],

        [[-4.360e+00],
         [-4.697e+00],
         [-1.482e+00],
         [ 2.297e+01],
         [-8.828e+00],
         [-5.697e+00],
         [ 8.446e+00],
         [-2.419e+00],
         [ 1.490e+00],
         [-1.982e-01]],

        [[-1.589e+00],
         [-7.388e-01],
         [-5.628e+00],
         [-4.290e+00],
         [ 1.072e+00],
         [ 3.811e+00],
         [-4.564e+00],
         [-8.750e+00],
         [-6.779e+00],
         [-5.141e+00]],

        [[-8.714e+00],
         [-2.698e+00],
         [ 6.097e+00],
         [ 2.100e+00],
         [-8.631e+00],
         [-9.784e+00],
         [-7.491e+00],
         [-6.683e+00],
         [-7.743e-01],
         [-7.861e+00]],

        [[-1.431e+00],
         [ 9.712e-02],
         [-9.532e+00],
         [-5.725e+00],
         [-5.205e+00],
         [ 1.207e+00],
         [-3.361e+00],
         [-6.558e+00],
         [-5.771e+00],
         [ 2.154e+01]]], device='cuda:0')
v tensor([[[1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [3.755e+00],
         [2.600e+00],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [9.296e+00]],

        [[5.128e+00],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.784e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.631e+00]],

        [[5.493e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [5.260e+00],
         [1.000e+01],
         [5.838e+00]],

        [[2.195e+00],
         [4.170e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.374e+00],
         [1.000e-12],
         [1.000e-12],
         [9.019e+00],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e+01],
         [7.090e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[9.893e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.051e+00],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [3.624e+00],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [2.651e+00],
         [7.898e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [2.341e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.324e+00],
         [1.000e-12],
         [1.000e+01]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [3.011e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [5.302e+00],
         [1.000e+01],
         [1.396e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [8.446e+00],
         [1.000e-12],
         [1.490e+00],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.072e+00],
         [3.811e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [6.097e+00],
         [2.100e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [9.712e-02],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.207e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01]]], device='cuda:0')
v before min max tensor([[  6.364],
        [ -7.016],
        [ -7.170],
        [ 25.828],
        [ -6.983],
        [ -4.298],
        [ -3.168],
        [ -7.632],
        [ -7.133],
        [  1.512],
        [ -8.674],
        [ -7.068],
        [ -5.442],
        [-12.753],
        [ -7.844],
        [ -3.211],
        [  9.410],
        [ -3.963],
        [ -9.098],
        [ -6.356]], device='cuda:0')
v tensor([[6.364e+00],
        [1.000e-12],
        [1.000e-12],
        [1.000e+01],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.512e+00],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [9.410e+00],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12]], device='cuda:0')
a after update for 1 param tensor([[ 0.015,  0.002, -0.003,  ...,  0.004,  0.007, -0.031],
        [-0.011,  0.008, -0.005,  ...,  0.008, -0.002,  0.001],
        [ 0.001, -0.016,  0.012,  ..., -0.007,  0.004,  0.019],
        ...,
        [-0.007, -0.069, -0.008,  ...,  0.002, -0.068,  0.001],
        [ 0.030, -0.046,  0.002,  ..., -0.010,  0.004,  0.005],
        [ 0.030, -0.023, -0.002,  ..., -0.020,  0.021, -0.010]],
       device='cuda:0')
s after update for 1 param tensor([[2.001, 1.900, 1.132,  ..., 1.394, 1.461, 1.956],
        [2.554, 1.616, 1.390,  ..., 1.609, 1.902, 0.856],
        [1.651, 1.194, 1.352,  ..., 1.568, 1.184, 1.558],
        ...,
        [1.263, 1.174, 1.097,  ..., 1.572, 1.228, 1.283],
        [1.626, 1.240, 1.506,  ..., 1.541, 1.447, 1.871],
        [1.378, 1.462, 1.598,  ..., 1.519, 1.908, 2.075]], device='cuda:0')
b after update for 1 param tensor([[114.982, 112.040,  86.475,  ...,  95.961,  98.246, 113.687],
        [129.899, 103.333,  95.820,  ..., 103.121, 112.109,  75.217],
        [104.431,  88.833,  94.521,  ..., 101.780,  88.444, 101.464],
        ...,
        [ 91.363,  88.055,  85.137,  ..., 101.915,  90.081,  92.058],
        [103.634,  90.501,  99.756,  ..., 100.906,  97.761, 111.172],
        [ 95.407,  98.298, 102.747,  ..., 100.187, 112.263, 117.087]],
       device='cuda:0')
clipping threshold 0.25267113085451365
a after update for 1 param tensor([ 1.293e-01, -1.248e-01, -1.716e-02, -3.215e-02, -1.517e-02, -1.122e-02,
        -4.533e-02,  2.211e-02,  2.621e-02, -5.678e-02, -9.378e-02,  2.149e-02,
        -9.114e-02,  5.349e-02, -5.145e-02, -1.216e-01, -6.377e-02,  1.396e-02,
        -5.367e-02, -8.051e-02, -7.536e-02, -8.651e-02, -2.489e-02,  7.925e-03,
         3.898e-02, -1.058e-01,  3.258e-02,  6.439e-02, -1.143e-01,  4.725e-02,
         2.362e-02,  2.977e-02, -1.066e-01,  2.095e-02,  7.311e-02,  1.114e-01,
         1.357e-01,  1.553e-02,  7.662e-02,  3.838e-02,  3.505e-02,  4.772e-02,
        -4.008e-02, -1.029e-01, -6.148e-03, -4.123e-02, -1.798e-02, -7.704e-02,
         1.535e-04,  1.515e-01, -1.667e-01, -8.217e-02,  2.193e-02,  1.533e-02,
        -2.270e-02, -1.809e-02,  7.626e-02,  2.464e-02, -1.090e-01,  4.329e-02,
        -7.988e-02, -3.458e-02, -3.579e-02, -5.588e-03,  2.163e-03,  1.804e-01,
         3.186e-04, -1.266e-01, -5.944e-02, -7.917e-04,  1.799e-02,  9.365e-02,
        -1.031e-01,  5.692e-02, -2.624e-02,  4.866e-02, -3.118e-02, -1.438e-01,
        -4.080e-02,  8.454e-02,  2.545e-03, -1.101e-01, -2.544e-02,  9.955e-02,
         3.741e-02, -4.426e-03, -6.500e-02, -1.418e-03,  1.380e-02,  8.502e-03,
        -9.439e-03,  8.174e-02,  1.196e-02,  1.341e-01, -7.929e-02, -2.240e-01,
        -1.433e-02, -5.817e-02,  7.890e-02, -2.497e-03,  1.431e-02,  2.537e-02,
         5.424e-02, -1.271e-01, -1.681e-02,  6.929e-02,  4.617e-02,  6.164e-02,
         5.235e-02, -1.502e-01,  6.692e-02,  3.822e-02, -1.017e-01, -5.155e-02,
         2.013e-02,  4.623e-02,  7.916e-02, -8.884e-02,  4.545e-02,  2.775e-02,
        -5.621e-02,  6.153e-02,  4.268e-02,  4.533e-03, -5.801e-02,  1.609e-02,
         6.523e-02,  5.122e-02,  2.259e-02, -4.273e-02,  5.263e-02, -1.636e-01,
        -1.217e-01,  4.035e-02,  5.826e-02,  6.190e-02, -9.782e-02,  4.354e-02,
         1.177e-01, -1.164e-01, -4.844e-02,  1.528e-02, -1.340e-01, -4.681e-02,
        -5.794e-02, -2.890e-02,  2.711e-02, -1.364e-01, -9.918e-02,  1.235e-03,
         9.251e-02,  3.762e-03,  4.957e-02, -3.758e-02,  1.099e-01, -6.107e-02,
        -8.233e-02, -2.513e-02,  5.339e-02,  1.532e-02, -6.566e-02, -4.118e-03,
        -2.688e-02, -4.675e-02,  1.007e-01, -4.951e-02,  8.213e-02, -8.381e-02,
         8.889e-02, -5.836e-02,  1.262e-01, -7.266e-03,  1.993e-02, -5.425e-02,
        -4.384e-02, -5.162e-02,  7.633e-03,  9.167e-02,  5.048e-02, -5.805e-02,
         4.042e-02,  9.662e-02, -6.677e-02, -5.571e-02,  1.565e-02, -6.662e-02,
        -8.397e-02, -1.787e-04, -2.520e-02, -1.517e-02, -7.709e-02, -1.277e-03,
         7.240e-04,  2.873e-02,  5.728e-02,  6.956e-03, -7.551e-02,  1.038e-02,
         1.874e-01, -1.267e-01], device='cuda:0')
s after update for 1 param tensor([1.697, 1.872, 1.046, 0.912, 1.398, 0.757, 1.030, 1.194, 1.153, 1.444,
        1.416, 1.373, 1.075, 1.990, 2.103, 1.555, 0.835, 1.429, 1.463, 0.869,
        1.870, 2.372, 1.574, 1.670, 1.460, 1.245, 1.256, 1.251, 1.261, 1.144,
        1.470, 0.946, 1.548, 1.835, 1.108, 1.245, 1.408, 1.158, 1.778, 1.898,
        1.723, 1.864, 1.871, 1.894, 1.605, 1.866, 1.355, 1.002, 1.609, 1.650,
        1.073, 1.435, 1.467, 1.194, 1.691, 1.877, 1.607, 2.108, 0.852, 1.235,
        1.639, 1.215, 1.520, 1.634, 1.447, 1.862, 1.845, 1.424, 1.471, 1.086,
        2.179, 1.618, 1.129, 1.895, 1.650, 0.792, 1.609, 1.388, 1.309, 1.627,
        0.847, 1.350, 2.155, 1.790, 1.590, 1.524, 1.229, 1.547, 1.342, 2.003,
        1.855, 1.339, 1.518, 1.213, 1.448, 1.045, 1.549, 1.207, 1.366, 1.019,
        1.320, 1.549, 1.272, 1.228, 1.608, 1.632, 0.719, 1.315, 1.829, 1.891,
        1.891, 1.729, 1.601, 1.817, 1.512, 1.410, 1.411, 1.721, 1.161, 1.417,
        1.337, 0.676, 1.295, 1.760, 1.680, 1.435, 1.201, 1.669, 1.251, 1.586,
        1.759, 1.626, 1.664, 1.527, 0.974, 1.754, 1.784, 1.121, 1.540, 2.000,
        1.182, 1.049, 1.539, 1.767, 1.155, 1.547, 1.706, 1.230, 1.925, 1.531,
        1.440, 1.482, 1.793, 2.159, 1.781, 1.284, 1.348, 1.260, 1.972, 1.418,
        1.732, 1.485, 1.686, 0.875, 1.075, 1.468, 1.249, 1.651, 1.679, 1.130,
        0.693, 0.677, 1.715, 1.476, 1.772, 1.819, 1.529, 1.655, 1.656, 1.193,
        1.146, 0.904, 1.507, 1.213, 1.515, 1.533, 1.026, 1.274, 1.379, 0.878,
        1.475, 1.076, 1.265, 1.537, 1.267, 0.911, 1.633, 1.820, 1.500, 1.482],
       device='cuda:0')
b after update for 1 param tensor([105.876, 111.211,  83.133,  77.638,  96.112,  70.734,  82.481,  88.837,
         87.296,  97.675,  96.725,  95.238,  84.260, 114.666, 117.878, 101.375,
         74.278,  97.184,  98.319,  75.757, 111.150, 125.181, 101.988, 105.054,
         98.200,  90.687,  91.111,  90.907,  91.276,  86.932,  98.553,  79.064,
        101.127, 110.095,  85.546,  90.708,  96.452,  87.469, 108.379, 111.978,
        106.683, 110.987, 111.172, 111.871, 102.988, 111.029,  94.611,  81.375,
        103.116, 104.404,  84.200,  97.361,  98.435,  88.807, 105.686, 111.373,
        103.035, 118.014,  75.043,  90.338, 104.047,  89.605, 100.213, 103.897,
         97.781, 110.929, 110.401,  96.997,  98.594,  84.722, 119.996, 103.391,
         86.370, 111.891, 104.426,  72.340, 103.108,  95.769,  93.000, 103.694,
         74.805,  94.449, 119.330, 108.753, 102.491, 100.350,  90.106, 101.088,
         94.145, 115.048, 110.709,  94.053, 100.134,  89.508,  97.810,  83.101,
        101.180,  89.302,  94.990,  82.048,  93.384, 101.153,  91.677,  90.078,
        103.087, 103.835,  68.901,  93.204, 109.914, 111.777, 111.777, 106.869,
        102.858, 109.568,  99.934,  96.524,  96.562, 106.625,  87.591,  96.754,
         93.982,  66.821,  92.484, 107.830, 105.342,  97.377,  89.067, 104.997,
         90.924, 102.366, 107.816, 103.637, 104.868, 100.438,  80.202, 107.650,
        108.582,  86.056, 100.879, 114.956,  88.378,  83.247, 100.831, 108.063,
         87.364, 101.094, 106.177,  90.131, 112.773, 100.586,  97.541,  98.962,
        108.840, 119.431, 108.470,  92.097,  94.383,  91.250, 114.135,  96.795,
        106.982,  99.048, 105.551,  76.049,  84.285,  98.470,  90.854, 104.449,
        105.323,  86.388,  67.681,  66.872, 106.439,  98.739, 108.213, 109.619,
        100.521, 104.574, 104.614,  88.790,  87.031,  77.279,  99.775,  89.537,
        100.045, 100.630,  82.323,  91.748,  95.456,  76.154,  98.728,  84.300,
         91.412, 100.765,  91.499,  77.578, 103.877, 109.653,  99.540,  98.968],
       device='cuda:0')
clipping threshold 0.25267113085451365
a after update for 1 param tensor([[[-4.654e-02],
         [ 4.438e-02],
         [ 1.044e-01],
         [ 5.712e-02],
         [ 1.125e-02],
         [-8.493e-04],
         [ 6.300e-02],
         [-6.663e-03],
         [ 5.878e-02],
         [-3.227e-02]],

        [[-7.925e-02],
         [-5.232e-02],
         [ 5.976e-02],
         [-5.808e-03],
         [-5.684e-02],
         [ 6.273e-02],
         [ 4.185e-02],
         [-1.926e-03],
         [-9.228e-02],
         [ 3.661e-02]],

        [[ 7.965e-02],
         [ 1.454e-01],
         [-1.962e-02],
         [-7.312e-02],
         [-1.379e-01],
         [-6.908e-02],
         [-3.114e-02],
         [ 5.121e-03],
         [ 7.896e-02],
         [ 3.169e-02]],

        [[-1.636e-01],
         [ 9.320e-02],
         [-1.618e-03],
         [-1.440e-03],
         [-7.088e-02],
         [ 1.004e-01],
         [-7.137e-02],
         [-1.729e-01],
         [-3.298e-02],
         [ 2.331e-02]],

        [[ 4.144e-02],
         [-1.090e-02],
         [-2.862e-02],
         [-3.218e-02],
         [-8.805e-02],
         [-3.602e-02],
         [-3.895e-02],
         [ 6.887e-02],
         [ 3.265e-02],
         [ 4.132e-02]],

        [[-4.975e-02],
         [ 3.501e-02],
         [ 8.151e-02],
         [-4.824e-03],
         [-7.796e-03],
         [-6.217e-02],
         [-3.886e-02],
         [ 5.676e-02],
         [-8.601e-02],
         [ 4.513e-02]],

        [[-8.372e-02],
         [-3.727e-02],
         [ 4.801e-02],
         [ 3.592e-02],
         [ 6.550e-02],
         [ 5.046e-02],
         [-1.111e-01],
         [-4.920e-03],
         [ 9.243e-02],
         [-1.108e-01]],

        [[-1.797e-03],
         [-6.888e-02],
         [-4.211e-02],
         [ 7.172e-02],
         [ 4.681e-02],
         [-6.036e-02],
         [-3.797e-02],
         [-1.528e-01],
         [-1.436e-02],
         [ 3.698e-02]],

        [[-5.378e-02],
         [ 2.587e-02],
         [ 9.574e-02],
         [-3.367e-02],
         [ 1.382e-02],
         [ 1.932e-02],
         [ 5.553e-03],
         [-9.278e-02],
         [ 6.635e-02],
         [-2.738e-02]],

        [[ 2.117e-02],
         [ 9.112e-02],
         [ 3.799e-02],
         [-2.269e-03],
         [ 5.963e-02],
         [ 5.212e-02],
         [-3.646e-02],
         [ 6.929e-04],
         [ 1.831e-02],
         [ 1.753e-03]],

        [[-5.432e-03],
         [-2.141e-02],
         [-7.069e-03],
         [-7.867e-02],
         [ 7.411e-03],
         [ 4.715e-02],
         [-7.943e-03],
         [-6.528e-03],
         [ 6.172e-02],
         [ 3.952e-02]],

        [[ 1.251e-05],
         [ 1.759e-02],
         [ 9.330e-02],
         [ 1.236e-01],
         [ 1.146e-01],
         [-1.286e-01],
         [-3.677e-02],
         [-3.809e-02],
         [ 2.393e-02],
         [ 6.389e-02]],

        [[-6.662e-03],
         [ 5.269e-02],
         [-4.454e-02],
         [-1.140e-01],
         [ 1.014e-01],
         [ 6.284e-02],
         [-1.883e-02],
         [-5.160e-02],
         [ 5.063e-02],
         [-9.592e-02]],

        [[-1.273e-01],
         [ 7.066e-03],
         [-7.142e-02],
         [ 5.955e-02],
         [ 8.082e-02],
         [-1.211e-02],
         [-2.220e-03],
         [ 8.323e-02],
         [-9.529e-02],
         [-9.895e-02]],

        [[-9.779e-02],
         [ 1.008e-02],
         [-7.006e-02],
         [ 5.237e-02],
         [ 1.558e-02],
         [ 1.349e-02],
         [ 7.949e-02],
         [-2.257e-02],
         [ 6.725e-02],
         [-5.969e-02]],

        [[ 1.152e-01],
         [ 8.684e-02],
         [ 2.629e-02],
         [-1.299e-02],
         [ 4.367e-02],
         [-5.049e-02],
         [-3.424e-02],
         [ 3.490e-03],
         [-8.162e-02],
         [-2.420e-02]],

        [[-1.093e-01],
         [-1.393e-01],
         [-4.482e-02],
         [ 6.494e-02],
         [-1.740e-02],
         [-9.678e-02],
         [ 3.150e-02],
         [ 4.561e-02],
         [ 4.902e-02],
         [-1.058e-02]],

        [[ 3.145e-02],
         [-8.785e-02],
         [ 6.316e-03],
         [ 2.650e-02],
         [ 4.111e-02],
         [ 4.541e-02],
         [-9.792e-02],
         [-3.381e-02],
         [ 2.316e-02],
         [ 7.432e-02]],

        [[ 2.556e-02],
         [-3.487e-02],
         [ 6.843e-02],
         [-9.196e-02],
         [-7.871e-02],
         [-1.937e-02],
         [ 1.987e-02],
         [-1.615e-02],
         [ 8.696e-03],
         [ 6.413e-03]],

        [[ 1.040e-01],
         [-2.892e-02],
         [-3.022e-02],
         [-7.174e-03],
         [ 7.057e-03],
         [-1.283e-01],
         [-5.868e-02],
         [-5.983e-02],
         [ 3.684e-02],
         [-2.375e-02]]], device='cuda:0')
s after update for 1 param tensor([[[1.961],
         [1.834],
         [1.845],
         [1.111],
         [1.755],
         [1.565],
         [1.574],
         [1.705],
         [1.269],
         [1.227]],

        [[1.613],
         [1.642],
         [1.188],
         [1.166],
         [1.424],
         [1.397],
         [1.243],
         [1.571],
         [1.855],
         [1.374]],

        [[1.924],
         [1.773],
         [1.093],
         [1.103],
         [1.604],
         [1.446],
         [1.629],
         [0.997],
         [1.744],
         [1.761]],

        [[1.606],
         [2.007],
         [1.574],
         [1.496],
         [1.234],
         [1.700],
         [1.273],
         [1.977],
         [1.272],
         [1.664]],

        [[1.657],
         [1.182],
         [0.933],
         [1.665],
         [1.305],
         [1.158],
         [1.287],
         [1.894],
         [0.915],
         [1.551]],

        [[1.436],
         [0.940],
         [1.970],
         [1.679],
         [1.357],
         [1.258],
         [1.992],
         [1.331],
         [2.101],
         [1.961]],

        [[1.842],
         [1.558],
         [1.295],
         [1.277],
         [1.798],
         [1.300],
         [1.867],
         [2.019],
         [1.652],
         [1.258]],

        [[1.507],
         [1.815],
         [1.483],
         [1.732],
         [1.604],
         [1.803],
         [1.152],
         [1.697],
         [1.399],
         [1.255]],

        [[1.234],
         [1.616],
         [2.027],
         [1.640],
         [1.736],
         [1.242],
         [1.528],
         [1.308],
         [1.376],
         [0.906]],

        [[1.479],
         [1.199],
         [1.651],
         [1.447],
         [1.454],
         [1.569],
         [1.768],
         [1.347],
         [1.200],
         [1.539]],

        [[1.518],
         [1.540],
         [1.535],
         [1.302],
         [1.494],
         [1.206],
         [0.957],
         [1.344],
         [1.517],
         [1.325]],

        [[1.411],
         [1.218],
         [1.342],
         [1.766],
         [1.635],
         [1.664],
         [1.240],
         [1.559],
         [1.111],
         [1.366]],

        [[1.971],
         [1.485],
         [1.626],
         [1.549],
         [0.977],
         [1.941],
         [1.298],
         [1.867],
         [1.449],
         [1.719]],

        [[1.321],
         [1.118],
         [1.745],
         [1.256],
         [1.591],
         [1.257],
         [1.415],
         [1.403],
         [1.744],
         [1.410]],

        [[1.379],
         [1.485],
         [1.546],
         [1.758],
         [2.165],
         [1.172],
         [1.251],
         [0.959],
         [1.938],
         [1.036]],

        [[1.086],
         [1.081],
         [0.437],
         [1.503],
         [1.475],
         [1.242],
         [1.091],
         [1.490],
         [1.327],
         [1.828]],

        [[1.106],
         [1.187],
         [1.023],
         [1.517],
         [1.550],
         [1.302],
         [1.428],
         [1.338],
         [1.752],
         [1.424]],

        [[1.138],
         [1.187],
         [1.000],
         [1.733],
         [0.950],
         [1.452],
         [1.174],
         [1.498],
         [1.613],
         [0.908]],

        [[1.483],
         [1.515],
         [1.286],
         [1.784],
         [1.504],
         [1.674],
         [1.320],
         [1.145],
         [1.217],
         [1.407]],

        [[1.510],
         [0.783],
         [1.635],
         [1.126],
         [1.607],
         [1.270],
         [1.263],
         [1.217],
         [1.209],
         [2.259]]], device='cuda:0')
b after update for 1 param tensor([[[113.839],
         [110.075],
         [110.421],
         [ 85.688],
         [107.679],
         [101.675],
         [101.967],
         [106.141],
         [ 91.566],
         [ 90.031]],

        [[103.246],
         [104.159],
         [ 88.612],
         [ 87.786],
         [ 96.999],
         [ 96.071],
         [ 90.610],
         [101.889],
         [110.701],
         [ 95.269]],

        [[112.756],
         [108.241],
         [ 84.986],
         [ 85.354],
         [102.954],
         [ 97.748],
         [103.753],
         [ 81.150],
         [107.345],
         [107.879]],

        [[103.015],
         [115.166],
         [101.988],
         [ 99.409],
         [ 90.298],
         [105.978],
         [ 91.714],
         [114.283],
         [ 91.687],
         [104.843]],

        [[104.635],
         [ 88.354],
         [ 78.512],
         [104.891],
         [ 92.840],
         [ 87.461],
         [ 92.215],
         [111.878],
         [ 77.746],
         [101.223]],

        [[ 97.414],
         [ 78.802],
         [114.088],
         [105.325],
         [ 94.705],
         [ 91.158],
         [114.708],
         [ 93.791],
         [117.832],
         [113.833]],

        [[110.325],
         [101.464],
         [ 92.498],
         [ 91.852],
         [108.994],
         [ 92.661],
         [111.076],
         [115.484],
         [104.465],
         [ 91.172]],

        [[ 99.797],
         [109.508],
         [ 98.984],
         [106.978],
         [102.954],
         [109.139],
         [ 87.242],
         [105.894],
         [ 96.135],
         [ 91.056]],

        [[ 90.309],
         [103.334],
         [115.727],
         [104.103],
         [107.111],
         [ 90.588],
         [100.462],
         [ 92.948],
         [ 95.346],
         [ 77.388]],

        [[ 98.862],
         [ 88.989],
         [104.441],
         [ 97.775],
         [ 98.014],
         [101.815],
         [108.091],
         [ 94.342],
         [ 89.047],
         [100.850]],

        [[100.142],
         [100.879],
         [100.721],
         [ 92.760],
         [ 99.355],
         [ 89.263],
         [ 79.518],
         [ 94.220],
         [100.125],
         [ 93.570]],

        [[ 96.563],
         [ 89.693],
         [ 94.148],
         [108.026],
         [103.933],
         [104.846],
         [ 90.521],
         [101.501],
         [ 85.681],
         [ 95.002]],

        [[114.113],
         [ 99.057],
         [103.634],
         [101.172],
         [ 80.353],
         [113.255],
         [ 92.598],
         [111.067],
         [ 97.854],
         [106.578]],

        [[ 93.406],
         [ 85.963],
         [107.385],
         [ 91.087],
         [102.522],
         [ 91.121],
         [ 96.697],
         [ 96.269],
         [107.333],
         [ 96.522]],

        [[ 95.456],
         [ 99.054],
         [101.081],
         [107.787],
         [119.602],
         [ 88.013],
         [ 90.927],
         [ 79.619],
         [113.160],
         [ 82.745]],

        [[ 84.724],
         [ 84.522],
         [ 53.744],
         [ 99.638],
         [ 98.707],
         [ 90.599],
         [ 84.884],
         [ 99.209],
         [ 93.639],
         [109.889]],

        [[ 85.486],
         [ 88.567],
         [ 82.213],
         [100.121],
         [101.182],
         [ 92.738],
         [ 97.124],
         [ 94.016],
         [107.585],
         [ 96.981]],

        [[ 86.698],
         [ 88.569],
         [ 81.269],
         [107.013],
         [ 79.232],
         [ 97.934],
         [ 88.089],
         [ 99.469],
         [103.248],
         [ 77.465]],

        [[ 98.975],
         [100.059],
         [ 92.167],
         [108.582],
         [ 99.689],
         [105.167],
         [ 93.401],
         [ 86.977],
         [ 89.686],
         [ 96.400]],

        [[ 99.885],
         [ 71.934],
         [103.924],
         [ 86.252],
         [103.025],
         [ 91.607],
         [ 91.333],
         [ 89.662],
         [ 89.379],
         [122.166]]], device='cuda:0')
clipping threshold 0.25267113085451365
a after update for 1 param tensor([[-0.023],
        [-0.053],
        [ 0.066],
        [-0.003],
        [-0.047],
        [ 0.026],
        [ 0.018],
        [-0.002],
        [ 0.035],
        [-0.053],
        [ 0.068],
        [-0.089],
        [ 0.024],
        [-0.016],
        [-0.091],
        [ 0.086],
        [ 0.054],
        [-0.073],
        [-0.030],
        [ 0.029]], device='cuda:0')
s after update for 1 param tensor([[1.527],
        [1.240],
        [1.235],
        [2.244],
        [1.236],
        [1.368],
        [1.493],
        [1.418],
        [1.324],
        [1.770],
        [1.683],
        [1.197],
        [1.487],
        [2.236],
        [1.576],
        [1.453],
        [2.017],
        [0.959],
        [1.758],
        [1.649]], device='cuda:0')
b after update for 1 param tensor([[100.440],
        [ 90.503],
        [ 90.333],
        [121.768],
        [ 90.362],
        [ 95.085],
        [ 99.314],
        [ 96.776],
        [ 93.528],
        [108.142],
        [105.450],
        [ 88.921],
        [ 99.107],
        [121.556],
        [102.053],
        [ 97.992],
        [115.431],
        [ 79.585],
        [107.784],
        [104.378]], device='cuda:0')
clipping threshold 0.25267113085451365
||w||^2 0.08506303252428167
exp ma of ||w||^2 0.10833482414199586
||w|| 0.29165567459640085
exp ma of ||w|| 0.32100303578099115
||w||^2 0.1356891198090085
exp ma of ||w||^2 0.10751313464320948
||w|| 0.3683600410047329
exp ma of ||w|| 0.32010151934331516
||w||^2 0.2802408946423
exp ma of ||w||^2 0.12063027830405491
||w|| 0.5293778373168828
exp ma of ||w|| 0.33737421256109773
v before min max tensor([[ -4.388,   4.928,  14.830,  ...,   2.273,  -9.263,  -6.042],
        [ -6.878,  -2.268,  47.879,  ...,  -6.660,  13.963,  17.761],
        [-13.148,  18.571,  -5.523,  ...,   7.557,  -7.923, -11.671],
        ...,
        [ -3.710,  -1.506,  31.123,  ..., -13.464,  21.564,  -9.531],
        [ -0.795,  13.086,  -8.217,  ...,  -7.083,  -4.938,  -1.412],
        [  1.295,   0.969,  -2.314,  ...,  -1.493,  13.841, -11.053]],
       device='cuda:0')
v tensor([[1.000e-12, 4.928e+00, 1.000e+01,  ..., 2.273e+00, 1.000e-12,
         1.000e-12],
        [1.000e-12, 1.000e-12, 1.000e+01,  ..., 1.000e-12, 1.000e+01,
         1.000e+01],
        [1.000e-12, 1.000e+01, 1.000e-12,  ..., 7.557e+00, 1.000e-12,
         1.000e-12],
        ...,
        [1.000e-12, 1.000e-12, 1.000e+01,  ..., 1.000e-12, 1.000e+01,
         1.000e-12],
        [1.000e-12, 1.000e+01, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [1.295e+00, 9.693e-01, 1.000e-12,  ..., 1.000e-12, 1.000e+01,
         1.000e-12]], device='cuda:0')
v before min max tensor([-7.704e+00, -8.987e+00,  4.563e+00,  3.441e+01, -1.010e+01,  1.277e+01,
        -5.964e+00, -4.634e+00,  7.563e+01, -3.459e+00, -6.644e+00, -8.561e+00,
         9.504e+00, -8.574e-01,  4.525e+01, -8.946e+00, -8.749e+00,  2.288e+01,
        -6.673e+00, -8.907e+00,  3.355e+01, -8.268e+00,  1.558e+01, -1.172e+01,
        -9.222e+00,  4.345e+01,  1.061e+01,  7.144e+00, -8.399e+00,  6.421e+00,
        -9.493e+00, -7.290e+00, -5.453e+00, -6.119e-01, -5.730e+00, -9.754e+00,
        -7.028e+00, -4.748e+00, -6.103e+00, -7.532e+00, -7.098e+00,  1.089e+01,
         5.141e+00,  2.176e+00, -5.464e+00, -1.101e+01, -2.510e+00, -7.720e+00,
         8.628e-01,  2.587e+01, -1.047e+01, -1.006e+01,  3.395e+01, -9.519e+00,
        -9.252e+00, -4.329e+00,  3.356e+00,  4.499e+00, -7.588e+00, -1.079e+00,
         1.605e+01,  6.126e+00, -2.074e+00, -6.510e+00, -5.177e+00,  7.630e+01,
         2.226e+01, -8.913e+00, -9.629e-01,  8.117e-01, -2.808e+00, -2.456e+00,
         3.057e+01,  8.213e+00, -9.152e+00,  7.824e+00, -6.008e+00, -4.345e+00,
        -1.108e+01,  7.550e+01,  2.881e+00, -7.236e+00,  3.249e+00, -4.687e+00,
        -3.628e+00, -3.636e+00, -2.439e+00,  1.216e+00, -3.989e+00, -7.507e+00,
        -5.014e+00, -2.955e+00,  8.072e+01,  4.493e+01, -3.883e+00, -4.638e+00,
         4.132e+00,  4.442e+01, -4.429e+00, -1.023e+01, -1.630e+00,  2.824e+01,
         1.502e+01, -6.391e+00,  4.662e+00,  1.571e+00,  2.306e+01,  1.144e+01,
        -3.583e+00, -8.072e+00,  3.000e+00, -4.346e+00, -8.799e+00,  2.874e+01,
         9.376e+00, -2.335e+00, -9.538e+00, -2.045e+00, -7.351e-01,  5.447e+00,
         4.298e+00, -5.855e+00, -5.044e+00,  1.769e+01, -1.144e+01, -2.922e+00,
        -7.519e+00, -4.068e+00, -3.886e+00, -8.921e-01, -6.426e+00, -5.947e-01,
        -6.932e+00,  1.650e+00, -3.477e+00,  3.609e+01, -9.800e+00,  1.645e+01,
         2.479e+00, -7.396e+00, -8.423e+00, -5.902e+00,  2.187e+01, -4.153e+00,
        -1.325e+01,  1.009e+01, -7.486e+00,  3.753e+00, -8.856e+00,  1.433e+01,
        -6.694e+00,  2.513e+00, -2.570e+00,  6.126e+01, -8.706e+00,  6.773e+00,
         2.275e+01, -1.715e+00,  2.639e+00,  1.212e+01,  2.203e+01,  1.114e+01,
         3.736e+01, -7.221e+00, -1.008e+01, -7.513e+00,  2.707e+01, -8.198e+00,
        -6.093e+00,  3.744e+00, -5.856e+00,  9.733e-01, -4.719e+00, -6.165e+00,
        -6.806e+00,  7.947e+00, -5.661e+00,  2.521e+01, -2.765e+00, -7.225e+00,
        -9.199e+00, -7.497e+00, -5.219e+00,  1.402e+01, -8.150e+00,  4.191e+00,
         5.882e-02, -5.945e+00,  3.583e-01, -4.949e+00, -9.779e+00, -2.577e+00,
        -6.230e+00,  4.567e+00,  3.206e+01,  2.490e+01,  1.209e+01,  2.253e+01,
        -4.505e+00, -7.377e+00], device='cuda:0')
v tensor([1.000e-12, 1.000e-12, 4.563e+00, 1.000e+01, 1.000e-12, 1.000e+01,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12,
        9.504e+00, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e+01,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e+01, 1.000e+01, 7.144e+00, 1.000e-12, 6.421e+00,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01,
        5.141e+00, 2.176e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        8.628e-01, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 3.356e+00, 4.499e+00, 1.000e-12, 1.000e-12,
        1.000e+01, 6.126e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01,
        1.000e+01, 1.000e-12, 1.000e-12, 8.117e-01, 1.000e-12, 1.000e-12,
        1.000e+01, 8.213e+00, 1.000e-12, 7.824e+00, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e+01, 2.881e+00, 1.000e-12, 3.249e+00, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.216e+00, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e+01, 1.000e-12, 1.000e-12,
        4.132e+00, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01,
        1.000e+01, 1.000e-12, 4.662e+00, 1.571e+00, 1.000e+01, 1.000e+01,
        1.000e-12, 1.000e-12, 3.000e+00, 1.000e-12, 1.000e-12, 1.000e+01,
        9.376e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 5.447e+00,
        4.298e+00, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.650e+00, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e+01,
        2.479e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e+01, 1.000e-12, 3.753e+00, 1.000e-12, 1.000e+01,
        1.000e-12, 2.513e+00, 1.000e-12, 1.000e+01, 1.000e-12, 6.773e+00,
        1.000e+01, 1.000e-12, 2.639e+00, 1.000e+01, 1.000e+01, 1.000e+01,
        1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e-12, 3.744e+00, 1.000e-12, 9.733e-01, 1.000e-12, 1.000e-12,
        1.000e-12, 7.947e+00, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 4.191e+00,
        5.882e-02, 1.000e-12, 3.583e-01, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 4.567e+00, 1.000e+01, 1.000e+01, 1.000e+01, 1.000e+01,
        1.000e-12, 1.000e-12], device='cuda:0')
v before min max tensor([[[  7.401],
         [  7.838],
         [ -1.184],
         [ -8.324],
         [  1.254],
         [ -2.883],
         [ -7.322],
         [  5.204],
         [ 39.544],
         [ -2.414]],

        [[ 14.057],
         [ -3.017],
         [ 37.487],
         [ 28.118],
         [ -4.117],
         [  5.186],
         [ -1.774],
         [ 11.016],
         [ -2.777],
         [-11.539]],

        [[ -9.364],
         [ -9.039],
         [ 15.988],
         [ -0.892],
         [ -9.374],
         [  6.916],
         [ -6.019],
         [ -8.018],
         [ -3.485],
         [ 25.535]],

        [[ 54.168],
         [ 33.980],
         [  5.152],
         [ 15.774],
         [ -5.625],
         [ -6.474],
         [ -8.199],
         [  7.231],
         [ 75.956],
         [ 68.728]],

        [[ 22.490],
         [ -6.105],
         [ -7.016],
         [ -3.913],
         [ -3.042],
         [ 10.162],
         [ -4.646],
         [-11.393],
         [ -2.707],
         [  8.652]],

        [[ -2.856],
         [ -7.576],
         [  7.996],
         [ 49.794],
         [ 80.628],
         [ -0.140],
         [-11.541],
         [ -2.620],
         [ 12.600],
         [-11.615]],

        [[ -9.263],
         [  0.443],
         [  1.866],
         [ -8.691],
         [  2.116],
         [ -6.852],
         [ -2.675],
         [ 24.819],
         [ -5.605],
         [  0.996]],

        [[ -8.953],
         [ -7.349],
         [ -7.941],
         [ -4.579],
         [ -6.405],
         [ -3.866],
         [ -3.633],
         [  7.821],
         [ 19.375],
         [ -7.517]],

        [[ -0.885],
         [ -7.229],
         [ -3.413],
         [ -6.986],
         [  8.594],
         [ -5.681],
         [ -9.596],
         [  0.321],
         [ -8.028],
         [-11.122]],

        [[ -6.324],
         [  8.535],
         [ -3.467],
         [ -7.243],
         [ -4.300],
         [ -7.688],
         [ -9.246],
         [  7.225],
         [  4.656],
         [ -4.157]],

        [[ -6.547],
         [ -8.632],
         [ -5.134],
         [ -0.219],
         [ 72.084],
         [ -0.127],
         [ -1.526],
         [-10.559],
         [ -2.462],
         [ -5.961]],

        [[ 12.240],
         [ -2.904],
         [ -6.122],
         [  4.191],
         [ 14.898],
         [  5.509],
         [ -5.212],
         [  2.501],
         [ 23.353],
         [ -8.218]],

        [[ 15.359],
         [ -9.032],
         [ 35.960],
         [-10.884],
         [  1.995],
         [ -6.654],
         [ 28.076],
         [ -6.964],
         [-10.495],
         [ 12.382]],

        [[ -8.703],
         [ -8.020],
         [ 16.331],
         [ 15.698],
         [  3.081],
         [  8.860],
         [  1.182],
         [ -9.804],
         [  7.153],
         [ -4.696]],

        [[ -0.892],
         [ 34.589],
         [ -3.691],
         [ 15.738],
         [ -7.112],
         [ -1.664],
         [ -4.924],
         [ 15.381],
         [  7.525],
         [-10.014]],

        [[ -3.727],
         [ -9.221],
         [ -7.624],
         [-10.885],
         [ 10.562],
         [ 15.449],
         [  9.033],
         [ -0.319],
         [ -5.564],
         [ 36.244]],

        [[ -5.114],
         [ -8.450],
         [ -9.337],
         [ -5.854],
         [ 81.289],
         [ 19.465],
         [ -1.551],
         [ -3.129],
         [  1.530],
         [ 19.686]],

        [[ -3.754],
         [ -0.553],
         [  0.482],
         [ -4.441],
         [ -7.087],
         [ -1.724],
         [ -8.333],
         [ 17.426],
         [ -0.322],
         [ -4.037]],

        [[ -6.162],
         [ 92.700],
         [ -7.065],
         [ -8.267],
         [ -9.684],
         [  6.998],
         [  1.232],
         [ -8.038],
         [  3.629],
         [ 65.891]],

        [[  4.721],
         [ -7.510],
         [ -7.681],
         [  1.088],
         [  1.813],
         [  3.322],
         [ -3.877],
         [  0.411],
         [ -8.287],
         [-12.242]]], device='cuda:0')
v tensor([[[7.401e+00],
         [7.838e+00],
         [1.000e-12],
         [1.000e-12],
         [1.254e+00],
         [1.000e-12],
         [1.000e-12],
         [5.204e+00],
         [1.000e+01],
         [1.000e-12]],

        [[1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [5.186e+00],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [6.916e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01]],

        [[1.000e+01],
         [1.000e+01],
         [5.152e+00],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [7.231e+00],
         [1.000e+01],
         [1.000e+01]],

        [[1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [8.652e+00]],

        [[1.000e-12],
         [1.000e-12],
         [7.996e+00],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12]],

        [[1.000e-12],
         [4.432e-01],
         [1.866e+00],
         [1.000e-12],
         [2.116e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [9.961e-01]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [7.821e+00],
         [1.000e+01],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [8.594e+00],
         [1.000e-12],
         [1.000e-12],
         [3.209e-01],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [8.535e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [7.225e+00],
         [4.656e+00],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [4.191e+00],
         [1.000e+01],
         [5.509e+00],
         [1.000e-12],
         [2.501e+00],
         [1.000e+01],
         [1.000e-12]],

        [[1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.995e+00],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [3.081e+00],
         [8.860e+00],
         [1.182e+00],
         [1.000e-12],
         [7.153e+00],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [7.525e+00],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [9.033e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.530e+00],
         [1.000e+01]],

        [[1.000e-12],
         [1.000e-12],
         [4.818e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [6.998e+00],
         [1.232e+00],
         [1.000e-12],
         [3.629e+00],
         [1.000e+01]],

        [[4.721e+00],
         [1.000e-12],
         [1.000e-12],
         [1.088e+00],
         [1.813e+00],
         [3.322e+00],
         [1.000e-12],
         [4.111e-01],
         [1.000e-12],
         [1.000e-12]]], device='cuda:0')
v before min max tensor([[  3.780],
        [-10.052],
        [ -5.145],
        [  8.558],
        [ 59.597],
        [ -7.570],
        [ -9.459],
        [  5.702],
        [ 58.247],
        [  6.928],
        [ -2.130],
        [ -3.852],
        [  9.760],
        [ -5.667],
        [  9.021],
        [ 15.418],
        [ -7.623],
        [ -5.598],
        [ 19.688],
        [ 23.193]], device='cuda:0')
v tensor([[3.780e+00],
        [1.000e-12],
        [1.000e-12],
        [8.558e+00],
        [1.000e+01],
        [1.000e-12],
        [1.000e-12],
        [5.702e+00],
        [1.000e+01],
        [6.928e+00],
        [1.000e-12],
        [1.000e-12],
        [9.760e+00],
        [1.000e-12],
        [9.021e+00],
        [1.000e+01],
        [1.000e-12],
        [1.000e-12],
        [1.000e+01],
        [1.000e+01]], device='cuda:0')
a after update for 1 param tensor([[-0.007,  0.003,  0.007,  ..., -0.011,  0.007, -0.011],
        [ 0.017,  0.005, -0.016,  ..., -0.000,  0.010, -0.001],
        [-0.013,  0.016,  0.017,  ..., -0.009, -0.001,  0.003],
        ...,
        [ 0.020, -0.060,  0.024,  ..., -0.019,  0.015, -0.008],
        [ 0.025, -0.057, -0.007,  ...,  0.006,  0.007,  0.002],
        [-0.003, -0.004, -0.004,  ..., -0.010,  0.008, -0.004]],
       device='cuda:0')
s after update for 1 param tensor([[1.767, 1.389, 1.697,  ..., 1.661, 1.870, 0.904],
        [2.439, 1.253, 1.891,  ..., 1.388, 1.676, 2.046],
        [2.014, 1.794, 1.308,  ..., 1.711, 1.192, 1.931],
        ...,
        [1.062, 1.378, 1.548,  ..., 2.032, 1.766, 2.082],
        [0.953, 1.874, 1.317,  ..., 1.499, 1.300, 1.443],
        [1.400, 1.768, 0.948,  ..., 1.714, 1.742, 1.931]], device='cuda:0')
b after update for 1 param tensor([[108.662,  96.341, 106.495,  ..., 105.337, 111.794,  77.728],
        [127.661,  91.495, 112.412,  ...,  96.299, 105.819, 116.919],
        [115.992, 109.483,  93.477,  ..., 106.908,  89.243, 113.585],
        ...,
        [ 84.220,  95.938, 101.689,  ..., 116.530, 108.639, 117.932],
        [ 79.788, 111.901,  93.798,  ..., 100.068,  93.214,  98.196],
        [ 96.700, 108.700,  79.573,  ..., 107.017, 107.886, 113.581]],
       device='cuda:0')
clipping threshold 0.27142042800806454
a after update for 1 param tensor([ 0.121, -0.118, -0.023, -0.045,  0.046, -0.002, -0.035,  0.013, -0.026,
        -0.048, -0.085,  0.040, -0.087,  0.064, -0.027, -0.063, -0.039,  0.001,
        -0.049, -0.041, -0.100, -0.024, -0.023,  0.011,  0.008, -0.007, -0.005,
         0.060, -0.080,  0.022,  0.005,  0.003, -0.083,  0.022,  0.044,  0.034,
         0.079, -0.001,  0.063,  0.074,  0.069,  0.024, -0.059, -0.086, -0.024,
         0.014,  0.007, -0.052, -0.006,  0.090, -0.099, -0.037, -0.001,  0.029,
        -0.073, -0.038,  0.028,  0.036, -0.085,  0.019, -0.010, -0.013, -0.017,
         0.053, -0.024,  0.107,  0.003, -0.079, -0.044, -0.016, -0.007,  0.076,
        -0.080,  0.044,  0.000,  0.054, -0.025, -0.109, -0.024,  0.062,  0.011,
        -0.063, -0.029,  0.059, -0.023,  0.021, -0.030,  0.025,  0.008, -0.011,
        -0.007,  0.095,  0.021,  0.083, -0.024, -0.153, -0.010, -0.051,  0.081,
         0.018, -0.000, -0.003,  0.032, -0.086,  0.002,  0.033,  0.058,  0.074,
         0.037, -0.104,  0.038,  0.023, -0.084, -0.065,  0.035,  0.027,  0.040,
        -0.027,  0.039,  0.002, -0.026,  0.029,  0.029,  0.021, -0.027,  0.007,
         0.033,  0.022,  0.048, -0.017, -0.003, -0.133, -0.094,  0.031,  0.055,
         0.019, -0.075,  0.053,  0.093, -0.078, -0.030, -0.041, -0.140, -0.023,
        -0.094, -0.005,  0.010, -0.061, -0.047, -0.012,  0.000,  0.031,  0.017,
        -0.039,  0.106, -0.041, -0.091, -0.036,  0.011,  0.005, -0.038,  0.015,
        -0.041, -0.042,  0.060, -0.018,  0.040, -0.063,  0.059, -0.061,  0.112,
        -0.003, -0.008, -0.056, -0.029, -0.043, -0.012,  0.103,  0.018, -0.024,
         0.037,  0.029, -0.044, -0.038,  0.019, -0.042, -0.086,  0.024, -0.016,
         0.002, -0.048, -0.004, -0.005,  0.039,  0.017, -0.010, -0.046, -0.003,
         0.136, -0.079], device='cuda:0')
s after update for 1 param tensor([1.738, 1.410, 1.365, 1.565, 1.548, 1.452, 0.899, 0.987, 1.992, 0.938,
        1.331, 1.302, 1.318, 1.295, 1.685, 1.340, 1.330, 1.840, 1.022, 1.365,
        1.826, 1.238, 1.704, 1.826, 1.392, 1.840, 1.417, 1.166, 1.258, 1.698,
        1.508, 1.383, 0.816, 1.682, 0.994, 1.464, 1.287, 0.833, 1.245, 1.165,
        1.320, 1.232, 1.506, 1.677, 1.068, 1.728, 0.570, 1.608, 0.639, 1.577,
        1.668, 1.521, 1.515, 1.553, 1.386, 1.096, 1.802, 1.711, 1.488, 1.272,
        1.981, 1.433, 0.945, 0.981, 1.829, 2.085, 1.683, 1.552, 1.200, 0.984,
        1.543, 1.024, 1.387, 1.621, 1.518, 1.581, 1.521, 1.077, 1.888, 1.506,
        1.352, 1.373, 1.739, 1.538, 1.670, 1.544, 1.257, 1.236, 0.609, 1.264,
        1.806, 1.224, 1.824, 1.424, 1.456, 1.339, 1.052, 1.429, 1.420, 1.634,
        1.600, 1.650, 1.855, 1.456, 1.470, 0.931, 1.865, 1.697, 1.103, 1.220,
        1.700, 0.869, 1.458, 1.562, 1.567, 1.220, 1.485, 0.860, 1.262, 1.876,
        1.272, 0.880, 0.763, 1.968, 2.053, 1.251, 1.135, 1.159, 1.544, 1.358,
        1.164, 0.834, 1.437, 1.276, 0.899, 1.454, 1.575, 1.449, 1.347, 1.470,
        1.313, 1.615, 1.757, 0.692, 1.984, 2.101, 1.415, 1.802, 1.466, 1.651,
        1.501, 1.276, 0.979, 1.678, 1.854, 1.414, 1.517, 1.482, 1.864, 1.359,
        1.966, 1.854, 1.679, 1.690, 1.508, 1.619, 2.234, 1.446, 1.164, 1.531,
        0.891, 0.939, 0.888, 1.240, 1.033, 1.457, 0.998, 1.861, 0.423, 1.430,
        1.450, 1.390, 1.308, 2.065, 1.665, 1.089, 1.437, 0.914, 1.244, 1.226,
        1.811, 1.786, 1.002, 1.264, 1.929, 1.484, 1.331, 1.811, 1.188, 1.539],
       device='cuda:0')
b after update for 1 param tensor([107.770,  97.071,  95.506, 102.245, 101.717,  98.502,  77.503,  81.208,
        115.373,  79.163,  94.288,  93.278,  93.856,  93.002, 106.091,  94.627,
         94.271, 110.864,  82.626,  95.516, 110.442,  90.940, 106.690, 110.445,
         96.430, 110.885,  97.298,  88.260,  91.668, 106.510, 100.363,  96.135,
         73.833, 106.017,  81.477,  98.913,  92.741,  74.606,  91.215,  88.233,
         93.912,  90.744, 100.312, 105.849,  84.458, 107.437,  61.725, 103.665,
         65.353, 102.633, 105.584, 100.821, 100.597, 101.876,  96.232,  85.557,
        109.726, 106.929,  99.712,  92.175, 115.060,  97.861,  79.449,  80.942,
        110.541, 118.029, 106.049, 101.819,  89.551,  81.102, 101.532,  82.707,
         96.252, 104.073, 100.717, 102.779, 100.817,  84.834, 112.325, 100.313,
         95.031,  95.782, 107.793, 101.377, 105.646, 101.558,  91.627,  90.893,
         63.797,  91.882, 109.848,  90.429, 110.398,  97.552,  98.637,  94.586,
         83.854,  97.707,  97.407, 104.491, 103.401, 105.012, 111.315,  98.639,
         99.098,  78.860, 111.640, 106.484,  85.836,  90.277, 106.575,  76.189,
         98.689, 102.155, 102.318,  90.287,  99.597,  75.785,  91.834, 111.961,
         92.188,  76.664,  71.414, 114.682, 117.116,  91.425,  87.101,  87.994,
        101.586,  95.271,  88.188,  74.639,  97.998,  92.335,  77.519,  98.581,
        102.596,  98.397,  94.881,  99.114,  93.671, 103.881, 108.338,  67.992,
        115.134, 118.491,  97.225, 109.713,  98.963, 105.017, 100.129,  92.341,
         80.888, 105.893, 111.299,  97.197, 100.689,  99.514, 111.594,  95.295,
        114.622, 111.299, 105.906, 106.250, 100.394, 104.020, 122.183,  98.298,
         88.191, 101.135,  77.148,  79.208,  77.025,  91.010,  83.064,  98.656,
         81.670, 111.521,  53.148,  97.759,  98.415,  96.382,  93.478, 117.472,
        105.462,  85.297,  97.986,  78.138,  91.176,  90.496, 110.002, 109.225,
         81.807,  91.889, 113.518,  99.564,  94.299, 109.987,  89.085, 101.399],
       device='cuda:0')
clipping threshold 0.27142042800806454
a after update for 1 param tensor([[[-1.973e-02],
         [ 1.314e-02],
         [ 5.853e-02],
         [ 3.516e-02],
         [ 1.495e-03],
         [-2.614e-02],
         [ 6.243e-02],
         [-6.017e-03],
         [ 4.012e-02],
         [-3.733e-02]],

        [[-4.503e-02],
         [-5.557e-02],
         [ 4.210e-02],
         [-4.842e-03],
         [-3.326e-02],
         [ 4.634e-02],
         [ 3.574e-02],
         [ 1.189e-02],
         [-8.492e-02],
         [ 5.926e-02]],

        [[ 5.500e-02],
         [ 8.681e-02],
         [-2.912e-02],
         [-8.389e-02],
         [-1.135e-01],
         [-6.731e-02],
         [-8.061e-03],
         [ 2.926e-02],
         [ 3.285e-02],
         [-4.600e-03]],

        [[-8.059e-02],
         [ 7.516e-02],
         [-1.688e-02],
         [-3.030e-02],
         [-4.161e-02],
         [ 7.389e-02],
         [-6.334e-02],
         [-1.391e-01],
         [ 5.129e-03],
         [ 6.932e-02]],

        [[ 2.707e-02],
         [-1.080e-02],
         [ 2.065e-02],
         [-3.807e-02],
         [-9.578e-02],
         [-7.816e-03],
         [-6.432e-02],
         [ 6.138e-02],
         [ 4.010e-03],
         [-1.120e-02]],

        [[-8.340e-02],
         [ 3.312e-02],
         [ 2.959e-02],
         [ 2.682e-03],
         [-7.822e-02],
         [-6.141e-02],
         [-3.256e-02],
         [ 6.249e-02],
         [-7.633e-02],
         [ 6.417e-02]],

        [[-8.674e-02],
         [-1.843e-02],
         [ 4.777e-02],
         [ 8.601e-02],
         [ 6.024e-02],
         [ 3.968e-03],
         [-8.548e-02],
         [-3.110e-02],
         [ 4.360e-02],
         [-3.911e-02]],

        [[ 1.574e-02],
         [-4.403e-02],
         [-4.372e-02],
         [ 4.767e-02],
         [-1.973e-03],
         [-2.403e-02],
         [-6.074e-02],
         [-1.001e-01],
         [ 7.116e-03],
         [ 2.042e-02]],

        [[-2.675e-02],
         [-1.902e-02],
         [ 5.560e-02],
         [-5.167e-02],
         [ 2.594e-02],
         [-1.352e-02],
         [ 1.275e-04],
         [-7.844e-02],
         [ 1.178e-01],
         [-2.132e-02]],

        [[ 3.248e-02],
         [ 1.001e-01],
         [ 5.486e-02],
         [ 3.802e-02],
         [ 4.260e-02],
         [ 3.413e-02],
         [-9.164e-03],
         [ 3.222e-02],
         [ 4.680e-02],
         [-3.223e-02]],

        [[-4.920e-03],
         [-8.793e-03],
         [-2.131e-02],
         [-3.863e-02],
         [-3.879e-02],
         [ 2.584e-03],
         [ 2.603e-02],
         [-7.409e-03],
         [ 2.251e-02],
         [-3.469e-02]],

        [[ 1.226e-02],
         [ 8.603e-03],
         [ 3.293e-02],
         [ 9.933e-02],
         [ 5.130e-02],
         [-7.841e-02],
         [-3.243e-02],
         [-2.908e-02],
         [ 3.475e-02],
         [ 6.775e-02]],

        [[-1.299e-02],
         [ 1.638e-02],
         [-1.467e-02],
         [-8.752e-02],
         [ 8.687e-02],
         [ 7.045e-02],
         [-2.849e-02],
         [-2.461e-02],
         [ 4.321e-02],
         [-1.121e-01]],

        [[-4.705e-02],
         [-7.720e-03],
         [-3.136e-02],
         [ 5.744e-02],
         [ 9.422e-02],
         [-1.924e-02],
         [-1.363e-02],
         [ 1.646e-02],
         [-5.011e-02],
         [-3.942e-02]],

        [[-7.328e-02],
         [ 5.345e-02],
         [-3.813e-02],
         [ 2.970e-02],
         [ 2.074e-02],
         [-5.187e-03],
         [ 5.494e-02],
         [ 1.852e-03],
         [ 3.310e-02],
         [-3.497e-02]],

        [[ 8.273e-02],
         [ 7.206e-02],
         [ 3.926e-02],
         [-1.424e-02],
         [ 5.587e-02],
         [ 6.166e-04],
         [ 5.407e-03],
         [-1.959e-03],
         [-1.798e-02],
         [-4.259e-02]],

        [[-2.448e-02],
         [-1.211e-01],
         [-5.371e-02],
         [ 6.277e-02],
         [-7.402e-03],
         [-8.395e-02],
         [ 1.592e-02],
         [ 4.861e-02],
         [-7.533e-03],
         [-5.019e-03]],

        [[ 5.601e-02],
         [-8.102e-02],
         [-7.855e-03],
         [-4.140e-04],
         [ 3.063e-02],
         [ 1.789e-02],
         [-4.295e-02],
         [-4.625e-03],
         [ 4.977e-02],
         [ 3.712e-02]],

        [[ 2.875e-02],
         [ 2.008e-02],
         [ 7.181e-02],
         [-8.529e-02],
         [-2.660e-02],
         [-4.678e-02],
         [ 4.045e-03],
         [ 1.267e-02],
         [-2.522e-02],
         [-1.217e-03]],

        [[ 8.541e-02],
         [-6.348e-02],
         [-4.472e-02],
         [-3.681e-02],
         [-1.318e-02],
         [-1.144e-01],
         [-3.816e-02],
         [-5.290e-02],
         [ 7.579e-02],
         [-5.607e-02]]], device='cuda:0')
s after update for 1 param tensor([[[1.607],
         [1.241],
         [0.941],
         [1.266],
         [0.989],
         [1.336],
         [1.244],
         [1.481],
         [1.925],
         [1.672]],

        [[1.508],
         [0.822],
         [1.825],
         [1.471],
         [1.400],
         [1.771],
         [1.491],
         [1.472],
         [1.116],
         [2.014]],

        [[1.514],
         [1.566],
         [1.879],
         [1.460],
         [1.474],
         [1.648],
         [1.188],
         [1.608],
         [0.827],
         [2.299]],

        [[1.591],
         [1.440],
         [1.280],
         [1.440],
         [1.006],
         [1.325],
         [1.322],
         [1.999],
         [2.047],
         [2.296]],

        [[1.798],
         [1.005],
         [1.459],
         [1.019],
         [1.431],
         [1.621],
         [1.096],
         [1.758],
         [1.140],
         [1.566]],

        [[0.798],
         [1.162],
         [1.831],
         [1.423],
         [2.052],
         [0.997],
         [1.730],
         [1.246],
         [1.409],
         [1.803]],

        [[1.458],
         [0.820],
         [0.847],
         [1.691],
         [1.126],
         [1.044],
         [1.199],
         [2.139],
         [1.628],
         [1.345]],

        [[1.371],
         [1.300],
         [1.676],
         [1.379],
         [0.982],
         [0.802],
         [0.887],
         [1.674],
         [1.816],
         [1.143]],

        [[1.473],
         [1.105],
         [1.225],
         [1.082],
         [1.234],
         [1.567],
         [1.615],
         [1.432],
         [1.251],
         [1.664]],

        [[1.467],
         [1.612],
         [1.053],
         [1.228],
         [1.665],
         [1.946],
         [1.693],
         [1.911],
         [1.894],
         [0.948]],

        [[1.115],
         [1.294],
         [0.770],
         [1.178],
         [2.068],
         [1.181],
         [1.054],
         [1.783],
         [1.734],
         [1.778]],

        [[1.595],
         [1.283],
         [1.244],
         [1.322],
         [1.874],
         [1.564],
         [1.479],
         [1.352],
         [1.465],
         [1.491]],

        [[1.992],
         [1.387],
         [1.452],
         [1.628],
         [1.679],
         [1.249],
         [1.615],
         [1.283],
         [1.619],
         [1.596]],

        [[1.477],
         [1.660],
         [1.623],
         [1.724],
         [1.442],
         [1.537],
         [1.783],
         [1.864],
         [1.387],
         [1.531]],

        [[1.305],
         [2.190],
         [1.215],
         [2.089],
         [1.514],
         [0.988],
         [1.565],
         [1.813],
         [1.534],
         [1.526]],

        [[1.764],
         [1.380],
         [1.335],
         [1.692],
         [1.538],
         [1.471],
         [1.589],
         [0.736],
         [1.418],
         [2.128]],

        [[2.086],
         [1.415],
         [1.525],
         [0.878],
         [1.918],
         [1.791],
         [0.761],
         [1.147],
         [1.674],
         [2.209]],

        [[0.942],
         [1.404],
         [0.819],
         [1.231],
         [1.201],
         [1.109],
         [1.408],
         [1.652],
         [1.015],
         [1.571]],

        [[1.141],
         [1.568],
         [1.112],
         [1.635],
         [1.559],
         [1.467],
         [1.055],
         [1.630],
         [1.241],
         [2.203]],

        [[1.965],
         [1.126],
         [1.158],
         [0.936],
         [1.144],
         [1.701],
         [1.669],
         [1.025],
         [1.637],
         [1.936]]], device='cuda:0')
b after update for 1 param tensor([[[103.610],
         [ 91.064],
         [ 79.314],
         [ 91.955],
         [ 81.287],
         [ 94.486],
         [ 91.173],
         [ 99.460],
         [113.400],
         [105.694]],

        [[100.383],
         [ 74.130],
         [110.434],
         [ 99.144],
         [ 96.723],
         [108.770],
         [ 99.821],
         [ 99.161],
         [ 86.362],
         [116.000]],

        [[100.587],
         [102.280],
         [112.039],
         [ 98.769],
         [ 99.235],
         [104.934],
         [ 89.088],
         [103.642],
         [ 74.341],
         [123.932]],

        [[103.098],
         [ 98.095],
         [ 92.478],
         [ 98.080],
         [ 81.978],
         [ 94.098],
         [ 93.967],
         [115.558],
         [116.943],
         [123.847]],

        [[109.613],
         [ 81.961],
         [ 98.743],
         [ 82.512],
         [ 97.765],
         [104.084],
         [ 85.583],
         [108.374],
         [ 87.280],
         [102.303]],

        [[ 73.039],
         [ 88.108],
         [110.605],
         [ 97.503],
         [117.092],
         [ 81.639],
         [107.502],
         [ 91.236],
         [ 97.023],
         [109.773]],

        [[ 98.704],
         [ 73.998],
         [ 75.246],
         [106.295],
         [ 86.743],
         [ 83.521],
         [ 89.515],
         [119.559],
         [104.284],
         [ 94.785]],

        [[ 95.714],
         [ 93.183],
         [105.834],
         [ 95.997],
         [ 80.989],
         [ 73.198],
         [ 76.967],
         [105.772],
         [110.152],
         [ 87.388]],

        [[ 99.221],
         [ 85.933],
         [ 90.457],
         [ 85.012],
         [ 90.816],
         [102.309],
         [103.868],
         [ 97.815],
         [ 91.430],
         [105.446]],

        [[ 98.988],
         [103.785],
         [ 83.888],
         [ 90.563],
         [105.481],
         [114.036],
         [106.346],
         [112.986],
         [112.483],
         [ 79.608]],

        [[ 86.321],
         [ 92.999],
         [ 71.717],
         [ 88.733],
         [117.540],
         [ 88.824],
         [ 83.912],
         [109.136],
         [107.643],
         [109.006]],

        [[103.222],
         [ 92.589],
         [ 91.155],
         [ 93.985],
         [111.908],
         [102.239],
         [ 99.402],
         [ 95.056],
         [ 98.950],
         [ 99.827]],

        [[115.360],
         [ 96.283],
         [ 98.495],
         [104.308],
         [105.933],
         [ 91.346],
         [103.873],
         [ 92.591],
         [104.004],
         [103.280]],

        [[ 99.352],
         [105.325],
         [104.148],
         [107.319],
         [ 98.154],
         [101.336],
         [109.139],
         [111.594],
         [ 96.273],
         [101.137]],

        [[ 93.388],
         [120.959],
         [ 90.088],
         [118.135],
         [100.589],
         [ 81.250],
         [102.242],
         [110.055],
         [101.254],
         [100.963]],

        [[108.574],
         [ 96.019],
         [ 94.452],
         [106.334],
         [101.368],
         [ 99.142],
         [103.044],
         [ 70.150],
         [ 97.331],
         [119.241]],

        [[118.072],
         [ 97.228],
         [100.956],
         [ 76.589],
         [113.190],
         [109.384],
         [ 71.304],
         [ 87.537],
         [105.746],
         [121.480]],

        [[ 79.344],
         [ 96.844],
         [ 73.995],
         [ 90.684],
         [ 89.567],
         [ 86.066],
         [ 96.988],
         [105.057],
         [ 82.366],
         [102.442]],

        [[ 87.325],
         [102.352],
         [ 86.201],
         [104.507],
         [102.062],
         [ 99.000],
         [ 83.945],
         [104.347],
         [ 91.044],
         [121.335]],

        [[114.596],
         [ 86.745],
         [ 87.947],
         [ 79.068],
         [ 87.439],
         [106.611],
         [105.612],
         [ 82.774],
         [104.591],
         [113.741]]], device='cuda:0')
clipping threshold 0.27142042800806454
a after update for 1 param tensor([[ 0.015],
        [-0.053],
        [ 0.037],
        [ 0.003],
        [ 0.021],
        [-0.015],
        [ 0.014],
        [ 0.015],
        [-0.015],
        [-0.031],
        [ 0.068],
        [-0.080],
        [ 0.012],
        [-0.058],
        [-0.095],
        [ 0.060],
        [ 0.029],
        [ 0.030],
        [-0.012],
        [-0.007]], device='cuda:0')
s after update for 1 param tensor([[1.629],
        [1.597],
        [1.398],
        [1.293],
        [1.681],
        [1.208],
        [1.785],
        [1.879],
        [1.725],
        [1.646],
        [1.110],
        [0.757],
        [1.905],
        [1.568],
        [1.442],
        [1.775],
        [1.508],
        [1.440],
        [1.853],
        [1.571]], device='cuda:0')
b after update for 1 param tensor([[104.312],
        [103.298],
        [ 96.656],
        [ 92.962],
        [105.967],
        [ 89.838],
        [109.207],
        [112.061],
        [107.369],
        [104.872],
        [ 86.111],
        [ 71.126],
        [112.820],
        [102.364],
        [ 98.169],
        [108.894],
        [100.383],
        [ 98.103],
        [111.261],
        [102.464]], device='cuda:0')
clipping threshold 0.27142042800806454
||w||^2 0.10934306422783786
exp ma of ||w||^2 0.10850333470778281
||w|| 0.33067062800895675
exp ma of ||w|| 0.3226317006939486
cuda
Objective function 21.01 = squared loss an data 19.29 + 0.5*rho*h**2 0.154714 + alpha*h 0.696041 + L2reg 0.74 + L1reg 0.13 ; SHD = 46 ; DAG True
Proportion of microbatches that were clipped  0.7614664211958697
iteration 1 in inner loop, alpha 395.69028806585885 rho 100000.0 h 0.0017590549033599245
iteration 5 in outer loop, alpha = 2154.7451914257836, rho = 1000000.0, h = 0.0017590549033599245
Threshold 0.3
[[0.002 0.312 0.191 0.109 0.441 0.411 0.181 0.027 0.074 0.24  0.33  0.279
  0.385 0.019 0.523 0.237 0.07  0.363 0.377 0.121]
 [0.008 0.002 0.275 0.115 0.142 0.634 0.304 0.003 0.012 0.191 0.221 0.178
  0.111 0.021 0.045 0.134 0.08  0.374 0.053 0.304]
 [0.013 0.009 0.002 0.015 0.122 0.15  0.103 0.007 0.014 0.361 0.093 0.006
  0.199 0.001 0.03  0.097 0.024 0.019 0.103 0.066]
 [0.025 0.03  0.231 0.002 0.108 0.108 0.161 0.012 0.004 0.173 0.149 0.004
  0.136 0.01  0.067 0.083 0.012 0.094 0.028 0.014]
 [0.007 0.019 0.023 0.023 0.003 0.155 0.019 0.004 0.002 0.018 0.11  0.003
  0.042 0.006 0.021 0.018 0.006 0.015 0.016 0.023]
 [0.007 0.004 0.017 0.023 0.025 0.002 0.01  0.006 0.006 0.007 0.021 0.007
  0.013 0.004 0.007 0.016 0.005 0.013 0.005 0.008]
 [0.01  0.007 0.03  0.016 0.198 0.284 0.001 0.008 0.009 0.049 0.211 0.006
  0.031 0.007 0.026 0.056 0.003 0.076 0.053 0.016]
 [0.102 0.598 0.238 0.255 0.637 0.181 0.265 0.001 0.16  0.322 0.299 0.637
  0.679 0.052 0.629 0.252 0.089 1.416 0.207 0.364]
 [0.035 0.275 0.396 0.609 0.801 0.449 0.291 0.008 0.003 0.342 0.557 0.295
  0.179 0.006 0.346 0.201 0.113 0.358 0.457 0.21 ]
 [0.012 0.017 0.007 0.027 0.098 0.385 0.061 0.008 0.009 0.002 0.439 0.016
  0.257 0.004 0.064 0.256 0.015 0.054 0.005 0.009]
 [0.012 0.017 0.012 0.014 0.032 0.176 0.013 0.008 0.004 0.006 0.002 0.005
  0.017 0.01  0.015 0.012 0.016 0.033 0.012 0.007]
 [0.007 0.024 0.293 0.403 0.487 0.283 0.39  0.004 0.012 0.112 0.368 0.002
  0.462 0.012 0.04  0.505 0.032 0.354 0.051 0.208]
 [0.008 0.02  0.009 0.027 0.054 0.181 0.145 0.004 0.011 0.014 0.154 0.004
  0.002 0.008 0.008 0.021 0.008 0.087 0.02  0.026]
 [0.15  0.173 2.027 0.352 0.275 0.218 0.258 0.033 0.516 0.417 0.237 0.268
  0.268 0.002 0.389 0.516 0.164 0.216 0.483 0.36 ]
 [0.005 0.059 0.072 0.03  0.113 0.46  0.089 0.002 0.007 0.057 0.174 0.053
  0.533 0.007 0.003 0.061 0.017 0.077 0.014 0.096]
 [0.009 0.016 0.029 0.04  0.177 0.176 0.047 0.007 0.01  0.016 0.255 0.004
  0.127 0.005 0.04  0.002 0.01  0.106 0.008 0.031]
 [0.047 0.034 0.125 0.22  0.374 0.212 0.743 0.042 0.037 0.116 0.217 0.112
  0.299 0.013 0.185 0.354 0.001 0.113 0.109 0.12 ]
 [0.007 0.006 0.087 0.018 0.154 0.305 0.034 0.001 0.008 0.048 0.08  0.011
  0.04  0.015 0.021 0.033 0.015 0.002 0.015 0.008]
 [0.008 0.048 0.027 0.064 0.237 0.638 0.044 0.013 0.008 0.501 0.19  0.043
  0.149 0.005 0.181 0.468 0.02  0.212 0.002 0.069]
 [0.023 0.008 0.048 0.173 0.126 0.23  0.254 0.008 0.028 0.267 0.421 0.016
  0.137 0.005 0.029 0.114 0.028 0.29  0.027 0.002]]
[[0.    0.312 0.    0.    0.441 0.411 0.    0.    0.    0.    0.33  0.
  0.385 0.    0.523 0.    0.    0.363 0.377 0.   ]
 [0.    0.    0.    0.    0.    0.634 0.304 0.    0.    0.    0.    0.
  0.    0.    0.    0.    0.    0.374 0.    0.304]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.361 0.    0.
  0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.598 0.    0.    0.637 0.    0.    0.    0.    0.322 0.    0.637
  0.679 0.    0.629 0.    0.    1.416 0.    0.364]
 [0.    0.    0.396 0.609 0.801 0.449 0.    0.    0.    0.342 0.557 0.
  0.    0.    0.346 0.    0.    0.358 0.457 0.   ]
 [0.    0.    0.    0.    0.    0.385 0.    0.    0.    0.    0.439 0.
  0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.403 0.487 0.    0.39  0.    0.    0.    0.368 0.
  0.462 0.    0.    0.505 0.    0.354 0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    2.027 0.352 0.    0.    0.    0.    0.516 0.417 0.    0.
  0.    0.    0.389 0.516 0.    0.    0.483 0.36 ]
 [0.    0.    0.    0.    0.    0.46  0.    0.    0.    0.    0.    0.
  0.533 0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.374 0.    0.743 0.    0.    0.    0.    0.
  0.    0.    0.    0.354 0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.305 0.    0.    0.    0.    0.    0.
  0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.638 0.    0.    0.    0.501 0.    0.
  0.    0.    0.    0.468 0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.421 0.
  0.    0.    0.    0.    0.    0.    0.    0.   ]]
{'fdr': 0.42105263157894735, 'tpr': 0.55, 'fpr': 0.18461538461538463, 'f1': 0.5641025641025641, 'shd': 46, 'npred': 57, 'ntrue': 60}
[3.121e-01 1.912e-01 1.085e-01 4.413e-01 4.111e-01 1.806e-01 2.718e-02
 7.440e-02 2.401e-01 3.302e-01 2.785e-01 3.850e-01 1.910e-02 5.230e-01
 2.371e-01 6.953e-02 3.632e-01 3.767e-01 1.213e-01 8.380e-03 2.746e-01
 1.154e-01 1.422e-01 6.345e-01 3.045e-01 2.956e-03 1.247e-02 1.911e-01
 2.211e-01 1.776e-01 1.108e-01 2.114e-02 4.472e-02 1.344e-01 8.043e-02
 3.744e-01 5.259e-02 3.035e-01 1.250e-02 8.669e-03 1.504e-02 1.220e-01
 1.499e-01 1.030e-01 7.065e-03 1.363e-02 3.612e-01 9.294e-02 5.654e-03
 1.995e-01 1.159e-03 3.012e-02 9.660e-02 2.356e-02 1.863e-02 1.027e-01
 6.629e-02 2.536e-02 2.982e-02 2.312e-01 1.077e-01 1.083e-01 1.614e-01
 1.174e-02 3.744e-03 1.730e-01 1.485e-01 4.139e-03 1.362e-01 1.001e-02
 6.731e-02 8.336e-02 1.207e-02 9.416e-02 2.759e-02 1.439e-02 7.458e-03
 1.937e-02 2.293e-02 2.304e-02 1.545e-01 1.888e-02 3.676e-03 1.998e-03
 1.817e-02 1.097e-01 2.752e-03 4.211e-02 5.694e-03 2.139e-02 1.800e-02
 5.525e-03 1.513e-02 1.584e-02 2.347e-02 7.308e-03 3.624e-03 1.699e-02
 2.329e-02 2.486e-02 9.520e-03 5.908e-03 6.073e-03 6.694e-03 2.068e-02
 7.278e-03 1.274e-02 4.446e-03 7.011e-03 1.597e-02 5.293e-03 1.255e-02
 4.622e-03 7.701e-03 9.763e-03 7.127e-03 3.004e-02 1.616e-02 1.976e-01
 2.844e-01 8.182e-03 8.754e-03 4.891e-02 2.111e-01 6.109e-03 3.126e-02
 6.594e-03 2.633e-02 5.582e-02 2.793e-03 7.583e-02 5.292e-02 1.567e-02
 1.021e-01 5.977e-01 2.377e-01 2.546e-01 6.369e-01 1.807e-01 2.647e-01
 1.600e-01 3.216e-01 2.987e-01 6.371e-01 6.789e-01 5.154e-02 6.295e-01
 2.523e-01 8.893e-02 1.416e+00 2.068e-01 3.642e-01 3.518e-02 2.747e-01
 3.964e-01 6.089e-01 8.006e-01 4.486e-01 2.910e-01 8.472e-03 3.416e-01
 5.570e-01 2.949e-01 1.788e-01 5.539e-03 3.463e-01 2.013e-01 1.127e-01
 3.578e-01 4.571e-01 2.099e-01 1.237e-02 1.748e-02 7.427e-03 2.727e-02
 9.773e-02 3.854e-01 6.081e-02 8.491e-03 8.834e-03 4.389e-01 1.637e-02
 2.574e-01 3.642e-03 6.351e-02 2.556e-01 1.468e-02 5.441e-02 4.908e-03
 8.882e-03 1.190e-02 1.713e-02 1.215e-02 1.442e-02 3.238e-02 1.758e-01
 1.275e-02 8.031e-03 4.311e-03 6.499e-03 5.323e-03 1.657e-02 1.005e-02
 1.488e-02 1.212e-02 1.603e-02 3.314e-02 1.156e-02 7.365e-03 6.947e-03
 2.377e-02 2.930e-01 4.033e-01 4.873e-01 2.831e-01 3.903e-01 3.702e-03
 1.152e-02 1.121e-01 3.678e-01 4.624e-01 1.203e-02 4.018e-02 5.052e-01
 3.227e-02 3.543e-01 5.095e-02 2.076e-01 7.690e-03 2.003e-02 9.000e-03
 2.712e-02 5.443e-02 1.813e-01 1.447e-01 3.529e-03 1.081e-02 1.412e-02
 1.538e-01 3.970e-03 8.113e-03 8.040e-03 2.079e-02 8.138e-03 8.707e-02
 1.986e-02 2.619e-02 1.500e-01 1.733e-01 2.027e+00 3.523e-01 2.747e-01
 2.180e-01 2.584e-01 3.309e-02 5.160e-01 4.171e-01 2.371e-01 2.680e-01
 2.679e-01 3.893e-01 5.164e-01 1.637e-01 2.160e-01 4.829e-01 3.598e-01
 5.029e-03 5.930e-02 7.223e-02 2.962e-02 1.130e-01 4.597e-01 8.862e-02
 2.152e-03 6.709e-03 5.696e-02 1.739e-01 5.265e-02 5.331e-01 7.102e-03
 6.070e-02 1.725e-02 7.716e-02 1.413e-02 9.596e-02 9.383e-03 1.576e-02
 2.894e-02 3.955e-02 1.772e-01 1.760e-01 4.679e-02 6.523e-03 9.908e-03
 1.607e-02 2.548e-01 4.418e-03 1.270e-01 5.147e-03 3.957e-02 1.020e-02
 1.058e-01 8.341e-03 3.113e-02 4.669e-02 3.442e-02 1.253e-01 2.199e-01
 3.740e-01 2.119e-01 7.434e-01 4.205e-02 3.680e-02 1.157e-01 2.166e-01
 1.119e-01 2.986e-01 1.288e-02 1.852e-01 3.545e-01 1.132e-01 1.093e-01
 1.202e-01 7.031e-03 6.146e-03 8.689e-02 1.787e-02 1.536e-01 3.046e-01
 3.363e-02 1.492e-03 7.658e-03 4.814e-02 8.044e-02 1.080e-02 3.994e-02
 1.466e-02 2.099e-02 3.288e-02 1.469e-02 1.483e-02 8.312e-03 7.567e-03
 4.761e-02 2.668e-02 6.368e-02 2.370e-01 6.377e-01 4.381e-02 1.314e-02
 7.574e-03 5.015e-01 1.900e-01 4.309e-02 1.493e-01 5.196e-03 1.808e-01
 4.679e-01 2.014e-02 2.115e-01 6.915e-02 2.339e-02 8.368e-03 4.794e-02
 1.727e-01 1.256e-01 2.298e-01 2.539e-01 8.064e-03 2.819e-02 2.672e-01
 4.207e-01 1.629e-02 1.374e-01 5.111e-03 2.914e-02 1.139e-01 2.836e-02
 2.902e-01 2.679e-02]
[[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 1. 1. 0. 0. 0. 0. 1. 1. 0.]
 [0. 0. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 1. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [0. 0. 0. 1. 0. 0. 1. 0. 1. 0. 0. 1. 1. 0. 0. 0. 0. 1. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0. 0. 1. 1. 0. 0. 0. 1. 0. 0. 0. 1. 0.]
 [0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 1.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 1. 0. 1. 1. 0. 1. 0. 1. 0. 1. 0. 1. 0. 0. 1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 1. 1. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 1. 0. 0. 1. 1.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 1. 1. 0. 0. 0. 1. 0. 0. 0. 0. 1. 1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
[0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 1. 1. 0. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0. 1.
 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 1. 0. 0. 0. 1. 1. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 1. 0. 0. 1. 1. 0. 0. 1.
 1. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 1. 1. 0. 0. 0. 1. 1. 0. 0. 0. 1. 0. 0.
 0. 1. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 1. 0. 0.
 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 1. 1. 0. 1.
 0. 1. 0. 1. 1. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 1. 0. 0.
 0. 1. 0. 0. 0. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 1. 0. 0.
 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 1. 1. 0. 0. 0. 1. 0. 0. 0. 0. 1. 1. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
aucroc, aucpr (0.7675000000000001, 0.519206908490929)
Iterations 2500
Achieves (6.086687062773559, 1e-05)-DP
