samples  5000  graph  12 24 ER mim  minibatch size  50  noise  0.5  minibatches per NN training  250 adaclip_and_quantile
cuda
cuda
iteration 1 in inner loop,alpha 0.0 rho 1.0 h 1.3547868753222367
iteration 1 in outer loop, alpha = 1.3547868753222367, rho = 1.0, h = 1.3547868753222367
cuda
iteration 1 in inner loop,alpha 1.3547868753222367 rho 1.0 h 0.8318017776157465
iteration 2 in inner loop,alpha 1.3547868753222367 rho 10.0 h 0.3389919481792134
iteration 3 in inner loop,alpha 1.3547868753222367 rho 100.0 h 0.09244439604472277
iteration 2 in outer loop, alpha = 10.599226479794513, rho = 100.0, h = 0.09244439604472277
cuda
iteration 1 in inner loop,alpha 10.599226479794513 rho 100.0 h 0.04713402619085372
iteration 2 in inner loop,alpha 10.599226479794513 rho 1000.0 h 0.013466270810381431
iteration 3 in outer loop, alpha = 24.065497290175944, rho = 1000.0, h = 0.013466270810381431
cuda
iteration 1 in inner loop,alpha 24.065497290175944 rho 1000.0 h 0.0066081900976673325
iteration 2 in inner loop,alpha 24.065497290175944 rho 10000.0 h 0.00209394708955557
iteration 4 in outer loop, alpha = 45.00496818573164, rho = 10000.0, h = 0.00209394708955557
cuda
iteration 1 in inner loop,alpha 45.00496818573164 rho 10000.0 h 0.0008565849994432995
iteration 2 in inner loop,alpha 45.00496818573164 rho 100000.0 h 0.0003074876359292489
iteration 5 in outer loop, alpha = 75.75373177865653, rho = 100000.0, h = 0.0003074876359292489
cuda
iteration 1 in inner loop,alpha 75.75373177865653 rho 100000.0 h 0.00016878818824750397
iteration 6 in outer loop, alpha = 244.54192002616048, rho = 1000000.0, h = 0.00016878818824750397
Threshold 0.3
[[0.005 0.    0.67  0.004 0.54  0.001 0.07  0.    0.    0.135 0.001 0.003]
 [2.083 0.002 0.439 0.155 0.105 0.002 0.097 0.001 0.    0.75  0.271 1.258]
 [0.004 0.001 0.005 0.011 0.442 0.    0.053 0.    0.    0.561 0.002 0.004]
 [0.045 0.    0.055 0.002 0.15  0.002 0.804 0.    0.    0.896 0.    0.322]
 [0.005 0.001 0.005 0.005 0.004 0.    0.803 0.    0.    0.61  0.002 0.001]
 [0.046 0.042 0.638 0.037 0.019 0.    0.058 0.002 0.002 0.018 0.009 0.084]
 [0.004 0.    0.002 0.001 0.001 0.001 0.003 0.    0.    0.016 0.    0.001]
 [3.155 0.028 0.707 0.029 0.07  0.004 0.847 0.    0.004 0.003 0.025 0.081]
 [0.165 2.38  0.04  2.097 0.161 0.002 0.798 0.001 0.    0.967 3.469 0.037]
 [0.002 0.001 0.002 0.001 0.003 0.002 0.01  0.    0.    0.005 0.    0.001]
 [0.17  0.005 0.016 2.475 0.029 0.002 0.077 0.002 0.    0.116 0.003 0.899]
 [0.219 0.001 0.007 0.001 0.026 0.001 1.052 0.001 0.    0.093 0.001 0.004]]
[[0.    0.    0.67  0.    0.54  0.    0.    0.    0.    0.    0.    0.   ]
 [2.083 0.    0.439 0.    0.    0.    0.    0.    0.    0.75  0.    1.258]
 [0.    0.    0.    0.    0.442 0.    0.    0.    0.    0.561 0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.804 0.    0.    0.896 0.    0.322]
 [0.    0.    0.    0.    0.    0.    0.803 0.    0.    0.61  0.    0.   ]
 [0.    0.    0.638 0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [3.155 0.    0.707 0.    0.    0.    0.847 0.    0.    0.    0.    0.   ]
 [0.    2.38  0.    2.097 0.    0.    0.798 0.    0.    0.967 3.469 0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    2.475 0.    0.    0.    0.    0.    0.    0.    0.899]
 [0.    0.    0.    0.    0.    0.    1.052 0.    0.    0.    0.    0.   ]]
{'fdr': 0.08, 'tpr': 0.9583333333333334, 'fpr': 0.047619047619047616, 'f1': 0.9387755102040817, 'shd': 2, 'npred': 25, 'ntrue': 24}
[3.444e-04 6.699e-01 3.883e-03 5.397e-01 5.918e-04 6.956e-02 2.897e-06
 5.281e-06 1.352e-01 8.404e-04 3.229e-03 2.083e+00 4.389e-01 1.550e-01
 1.054e-01 1.997e-03 9.750e-02 6.360e-04 6.539e-05 7.501e-01 2.712e-01
 1.258e+00 3.683e-03 9.039e-04 1.121e-02 4.416e-01 6.858e-05 5.348e-02
 4.637e-05 3.173e-05 5.615e-01 2.368e-03 3.680e-03 4.491e-02 4.202e-04
 5.531e-02 1.501e-01 1.646e-03 8.041e-01 3.512e-04 1.727e-05 8.956e-01
 2.768e-04 3.223e-01 4.723e-03 1.198e-03 5.158e-03 5.480e-03 4.826e-04
 8.032e-01 4.312e-05 3.288e-05 6.095e-01 1.738e-03 6.230e-04 4.567e-02
 4.233e-02 6.385e-01 3.668e-02 1.885e-02 5.759e-02 1.987e-03 2.189e-03
 1.815e-02 9.470e-03 8.433e-02 3.773e-03 4.501e-04 2.192e-03 6.780e-04
 1.194e-03 6.486e-04 2.495e-05 3.264e-06 1.562e-02 2.643e-04 1.139e-03
 3.155e+00 2.830e-02 7.073e-01 2.911e-02 7.019e-02 3.663e-03 8.467e-01
 3.637e-03 3.313e-03 2.489e-02 8.074e-02 1.647e-01 2.380e+00 3.954e-02
 2.097e+00 1.607e-01 2.255e-03 7.981e-01 5.871e-04 9.669e-01 3.469e+00
 3.731e-02 1.886e-03 8.093e-04 2.181e-03 8.467e-04 3.059e-03 2.281e-03
 1.023e-02 5.563e-05 4.655e-06 2.978e-04 1.135e-03 1.701e-01 4.950e-03
 1.650e-02 2.475e+00 2.858e-02 2.201e-03 7.723e-02 2.296e-03 8.602e-06
 1.165e-01 8.991e-01 2.188e-01 6.794e-04 6.664e-03 7.635e-04 2.619e-02
 6.357e-04 1.052e+00 5.712e-04 2.933e-06 9.348e-02 1.244e-03]
[[0. 0. 1. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 1. 0. 0. 0. 0. 0. 0. 1. 0. 1.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 1. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 1. 0. 1. 0. 0. 1. 0. 0. 1. 1. 0.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]]
[0. 1. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0.
 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 0. 0.
 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 1. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 1. 0.
 1. 1. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0.
 1. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
aucroc, aucpr (0.9780092592592593, 0.9638945746282703)
cuda
1692
cuda
Objective function 178.80 = squared loss an data 15.69 + 0.5*rho*h**2 162.682537 + alpha*h 0.000000 + L2reg 0.22 + L1reg 0.21 ; SHD = 78 ; DAG False
||w||^2 17980138015.287876
exp ma of ||w||^2 1265798709988.97
||w|| 134090.03697250545
exp ma of ||w|| 729722.0556988236
||w||^2 0.14048492184702963
exp ma of ||w||^2 4.689871339217996
||w|| 0.3748131825950491
exp ma of ||w|| 0.463683114367234
||w||^2 0.23469309990103698
exp ma of ||w||^2 0.5458244719107953
||w|| 0.4844513390434967
exp ma of ||w|| 0.47122293865961395
||w||^2 0.4513644516799296
exp ma of ||w||^2 0.44998117077881705
||w|| 0.6718366257356989
exp ma of ||w|| 0.6414198867663619
||w||^2 0.3372513806511077
exp ma of ||w||^2 0.522261253338099
||w|| 0.5807334850437916
exp ma of ||w|| 0.6857699206610964
||w||^2 0.3527795846357309
exp ma of ||w||^2 0.4419419572478836
||w|| 0.5939525104212717
exp ma of ||w|| 0.6329017149580416
||w||^2 0.319453028365398
exp ma of ||w||^2 0.41467258511269744
||w|| 0.565201758990007
exp ma of ||w|| 0.613332614664655
||w||^2 0.5487731357029267
exp ma of ||w||^2 0.5811056523903393
||w|| 0.7407922351799637
exp ma of ||w|| 0.7210777967480327
||w||^2 0.5288355347146794
exp ma of ||w||^2 0.5385139966204603
||w|| 0.7272107911153954
exp ma of ||w|| 0.7000647972081111
||w||^2 0.9850411088173623
exp ma of ||w||^2 0.5187279093867961
||w|| 0.9924923721708708
exp ma of ||w|| 0.6867479318810242
||w||^2 0.9850467692493896
exp ma of ||w||^2 0.48924200663106254
||w|| 0.9924952237917267
exp ma of ||w|| 0.6652657697791146
||w||^2 0.4253030009983914
exp ma of ||w||^2 0.4668260897384928
||w|| 0.6521525902719327
exp ma of ||w|| 0.6473917299441868
||w||^2 0.40658046286702
exp ma of ||w||^2 0.4853090169225628
||w|| 0.6376366229029038
exp ma of ||w|| 0.663496547874437
||w||^2 0.1216058182153206
exp ma of ||w||^2 0.4658833127957437
||w|| 0.3487202578218257
exp ma of ||w|| 0.6383796072314402
||w||^2 0.24868991428242662
exp ma of ||w||^2 0.4284317465369578
||w|| 0.49868819344599147
exp ma of ||w|| 0.6194373803529845
||w||^2 1.120500887366454
exp ma of ||w||^2 0.51429013632359
||w|| 1.0585371450102514
exp ma of ||w|| 0.6760688575247452
cuda
Objective function 7.42 = squared loss an data 6.28 + 0.5*rho*h**2 0.661785 + alpha*h 0.000000 + L2reg 0.39 + L1reg 0.09 ; SHD = 23 ; DAG False
Proportion of microbatches that were clipped  0.765412200821984
iteration 1 in inner loop, alpha 0.0 rho 1.0 h 1.150464963603703
iteration 1 in outer loop, alpha = 1.150464963603703, rho = 1.0, h = 1.150464963603703
cuda
1692
cuda
Objective function 8.74 = squared loss an data 6.28 + 0.5*rho*h**2 0.661785 + alpha*h 1.323570 + L2reg 0.39 + L1reg 0.09 ; SHD = 23 ; DAG False
||w||^2 1137076.7710908954
exp ma of ||w||^2 108637459.07585816
||w|| 1066.3380191528836
exp ma of ||w|| 6372.835327202415
||w||^2 0.01927740202975597
exp ma of ||w||^2 23251.915739243876
||w|| 0.13884308419851515
exp ma of ||w|| 3.363384587900925
||w||^2 0.0863083524513708
exp ma of ||w||^2 914.156086925982
||w|| 0.29378283212497425
exp ma of ||w|| 0.36068581174264064
||w||^2 0.6120480454711222
exp ma of ||w||^2 0.5731815123271308
||w|| 0.782334995683513
exp ma of ||w|| 0.7151488935410625
||w||^2 0.294601863518127
exp ma of ||w||^2 0.5284679981092079
||w|| 0.5427723864734895
exp ma of ||w|| 0.6789574158636887
||w||^2 0.7917272317981389
exp ma of ||w||^2 0.5500718901425251
||w|| 0.8897905550173809
exp ma of ||w|| 0.6898049964243529
cuda
Objective function 7.81 = squared loss an data 6.10 + 0.5*rho*h**2 0.256619 + alpha*h 0.824201 + L2reg 0.56 + L1reg 0.07 ; SHD = 19 ; DAG False
Proportion of microbatches that were clipped  0.7644859813084112
iteration 1 in inner loop, alpha 1.150464963603703 rho 1.0 h 0.7164068140329771
1692
cuda
Objective function 10.12 = squared loss an data 6.10 + 0.5*rho*h**2 2.566194 + alpha*h 0.824201 + L2reg 0.56 + L1reg 0.07 ; SHD = 19 ; DAG False
||w||^2 910557555.230316
exp ma of ||w||^2 1448287635.647776
||w|| 30175.44623084
exp ma of ||w|| 31865.535115596474
||w||^2 41102.134675605565
exp ma of ||w||^2 20577429.127689134
||w|| 202.73661404789607
exp ma of ||w|| 1736.677871347054
||w||^2 0.12938958896136654
exp ma of ||w||^2 38.18556664923923
||w|| 0.3597076437349734
exp ma of ||w|| 0.374802935094712
||w||^2 0.16148970148322608
exp ma of ||w||^2 12.773222155658635
||w|| 0.40185781251983405
exp ma of ||w|| 0.4047078321752432
||w||^2 0.22202215752177368
exp ma of ||w||^2 6.230342379841634
||w|| 0.4711922723493815
exp ma of ||w|| 0.4048071581394868
||w||^2 0.5032501836716438
exp ma of ||w||^2 0.3890868694871613
||w|| 0.7094012853608624
exp ma of ||w|| 0.5881293095013518
||w||^2 0.22278690790911956
exp ma of ||w||^2 0.36664049999148585
||w|| 0.47200308040215117
exp ma of ||w|| 0.5688238275902717
||w||^2 0.08697076648058878
exp ma of ||w||^2 0.39682064595355576
||w|| 0.2949080644549904
exp ma of ||w|| 0.5973501702577753
||w||^2 0.08632913004178379
exp ma of ||w||^2 0.47010503842772716
||w|| 0.29381819215593813
exp ma of ||w|| 0.6441613066799172
||w||^2 0.552523255523023
exp ma of ||w||^2 0.4873058687361697
||w|| 0.7433190805589636
exp ma of ||w|| 0.6560773316231805
||w||^2 1.0291137384006863
exp ma of ||w||^2 0.5200127303581129
||w|| 1.0144524327935176
exp ma of ||w|| 0.6790023609072066
||w||^2 0.43742542559678727
exp ma of ||w||^2 0.48082838299585784
||w|| 0.6613814524136485
exp ma of ||w|| 0.6537365815141392
||w||^2 0.30926481669078026
exp ma of ||w||^2 0.5727897486530071
||w|| 0.5561158302824873
exp ma of ||w|| 0.7028288595869087
||w||^2 0.16159770561652972
exp ma of ||w||^2 0.5456256310630052
||w|| 0.4019921710886043
exp ma of ||w|| 0.6838474240354027
||w||^2 0.8710772300661277
exp ma of ||w||^2 0.6376814108392457
||w|| 0.9333151825970302
exp ma of ||w|| 0.7405769165237237
||w||^2 0.4409406435957033
exp ma of ||w||^2 0.49495434428472623
||w|| 0.664033616314493
exp ma of ||w|| 0.6642906899797372
||w||^2 1.4076621556722306
exp ma of ||w||^2 0.5053649138458062
||w|| 1.1864493902700741
exp ma of ||w|| 0.6627452395219228
||w||^2 0.4570930536789483
exp ma of ||w||^2 0.48131921081050055
||w|| 0.6760865726213976
exp ma of ||w|| 0.6508932876551131
||w||^2 0.2404133071844093
exp ma of ||w||^2 0.4671178155831358
||w|| 0.4903195969818148
exp ma of ||w|| 0.6422245191672756
cuda
Objective function 8.53 = squared loss an data 7.14 + 0.5*rho*h**2 0.339763 + alpha*h 0.299900 + L2reg 0.68 + L1reg 0.07 ; SHD = 21 ; DAG True
Proportion of microbatches that were clipped  0.7670239342412765
iteration 2 in inner loop, alpha 1.150464963603703 rho 10.0 h 0.2606773573439156
iteration 2 in outer loop, alpha = 3.757238537042859, rho = 10.0, h = 0.2606773573439156
cuda
1692
cuda
Objective function 9.20 = squared loss an data 7.14 + 0.5*rho*h**2 0.339763 + alpha*h 0.979427 + L2reg 0.68 + L1reg 0.07 ; SHD = 21 ; DAG True
||w||^2 7887630147.947405
exp ma of ||w||^2 11369784985.575926
||w|| 88812.33105795279
exp ma of ||w|| 74072.95231860121
||w||^2 1242486269.8882153
exp ma of ||w||^2 3952087888.4696355
||w|| 35248.91870523428
exp ma of ||w|| 53938.003742598376
||w||^2 3719369.2079024017
exp ma of ||w||^2 171899171.7955101
||w|| 1928.5666200321941
exp ma of ||w|| 7288.723385662168
||w||^2 1090169.118762301
exp ma of ||w||^2 113616097.13914983
||w|| 1044.1116409476053
exp ma of ||w|| 5288.687694938804
||w||^2 0.523360867192407
exp ma of ||w||^2 0.40713823013519496
||w|| 0.7234368439555778
exp ma of ||w|| 0.600826104626026
||w||^2 0.4475073513180245
exp ma of ||w||^2 0.5476215604508414
||w|| 0.6689599026234865
exp ma of ||w|| 0.6907110646826216
||w||^2 0.1644208501209133
exp ma of ||w||^2 0.5579497529120385
||w|| 0.4054884093545872
exp ma of ||w|| 0.6969565392165777
||w||^2 0.45171884272933127
exp ma of ||w||^2 0.43497586315207926
||w|| 0.6721003219232463
exp ma of ||w|| 0.6154211811993564
||w||^2 0.5430919722070605
exp ma of ||w||^2 0.5433418251094686
||w|| 0.7369477404857555
exp ma of ||w|| 0.6884285306901091
||w||^2 0.17131415908834569
exp ma of ||w||^2 0.46279999196009824
||w|| 0.41390114651731236
exp ma of ||w|| 0.6357561870853131
||w||^2 0.18714051212357025
exp ma of ||w||^2 0.5415193753662202
||w|| 0.43259740189184015
exp ma of ||w|| 0.6794234176675629
||w||^2 0.2148221269392381
exp ma of ||w||^2 0.5356042289657207
||w|| 0.46348907963320785
exp ma of ||w|| 0.6845757809968238
||w||^2 0.2711991528397496
exp ma of ||w||^2 0.573403727020165
||w|| 0.520767849276191
exp ma of ||w|| 0.6938456232656569
||w||^2 1.1217004083602615
exp ma of ||w||^2 0.5229546361835558
||w|| 1.059103587171841
exp ma of ||w|| 0.6822251725676598
||w||^2 0.6816866457861104
exp ma of ||w||^2 0.5678468068303082
||w|| 0.8256431709801216
exp ma of ||w|| 0.704672473819368
||w||^2 0.5893048575183355
exp ma of ||w||^2 0.601697717603668
||w|| 0.7676619422104599
exp ma of ||w|| 0.7122928235889507
||w||^2 1.1431741836361664
exp ma of ||w||^2 0.5438457182499717
||w|| 1.0691932396139467
exp ma of ||w|| 0.6934172887925936
||w||^2 0.532140982570902
exp ma of ||w||^2 0.5892496881885378
||w|| 0.7294799398001991
exp ma of ||w|| 0.7137685137135518
||w||^2 0.9883608645354104
exp ma of ||w||^2 0.5438274204420155
||w|| 0.9941633993139208
exp ma of ||w|| 0.6973953026787033
cuda
Objective function 9.04 = squared loss an data 7.38 + 0.5*rho*h**2 0.165060 + alpha*h 0.682661 + L2reg 0.75 + L1reg 0.06 ; SHD = 20 ; DAG True
Proportion of microbatches that were clipped  0.7645863806273363
iteration 1 in inner loop, alpha 3.757238537042859 rho 10.0 h 0.18169216165877877
1692
cuda
Objective function 10.52 = squared loss an data 7.38 + 0.5*rho*h**2 1.650602 + alpha*h 0.682661 + L2reg 0.75 + L1reg 0.06 ; SHD = 20 ; DAG True
||w||^2 1374789734.2683806
exp ma of ||w||^2 12264646881.739983
||w|| 37078.15710453232
exp ma of ||w|| 91826.9330870499
||w||^2 76901137.33530983
exp ma of ||w||^2 287250532.7910731
||w|| 8769.329354934152
exp ma of ||w|| 10588.207623333092
||w||^2 1688182.6926510162
exp ma of ||w||^2 55091998.84341439
||w|| 1299.3008476296075
exp ma of ||w|| 3153.316762159175
||w||^2 0.2913277294037985
exp ma of ||w||^2 0.5491463153460119
||w|| 0.539747838720822
exp ma of ||w|| 0.6856586630314023
||w||^2 0.1580544742843724
exp ma of ||w||^2 0.5621407378696568
||w|| 0.3975606548495115
exp ma of ||w|| 0.692508028908077
||w||^2 0.39206865518582684
exp ma of ||w||^2 0.6296883158209097
||w|| 0.6261538590361213
exp ma of ||w|| 0.7381669398588488
||w||^2 0.1918119650221283
exp ma of ||w||^2 0.5768713407800279
||w|| 0.4379634288637903
exp ma of ||w|| 0.713678098414725
||w||^2 0.11277171947551415
exp ma of ||w||^2 0.6054931127772912
||w|| 0.33581500781756934
exp ma of ||w|| 0.7318375016121612
||w||^2 0.6610421250090124
exp ma of ||w||^2 0.535688068582806
||w|| 0.8130449710864783
exp ma of ||w|| 0.6780942790286189
v before min max tensor([[ 7.050,  7.882, -0.143,  ..., -0.366,  0.222, -0.910],
        [-1.377, -0.215,  0.637,  ..., -1.179,  0.979, -1.409],
        [ 1.629, -0.594,  0.577,  ..., -0.359,  0.063, -0.820],
        ...,
        [-0.355,  0.377,  1.421,  ..., -0.544,  0.997, -0.990],
        [-0.652, -0.981, -0.568,  ..., -0.855, -0.155, -0.699],
        [-0.464, -1.007,  2.308,  ...,  0.813, -0.739, -1.239]],
       device='cuda:0')
v tensor([[7.050e+00, 7.882e+00, 1.000e-12,  ..., 1.000e-12, 2.217e-01,
         1.000e-12],
        [1.000e-12, 1.000e-12, 6.368e-01,  ..., 1.000e-12, 9.794e-01,
         1.000e-12],
        [1.629e+00, 1.000e-12, 5.774e-01,  ..., 1.000e-12, 6.269e-02,
         1.000e-12],
        ...,
        [1.000e-12, 3.766e-01, 1.421e+00,  ..., 1.000e-12, 9.973e-01,
         1.000e-12],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [1.000e-12, 1.000e-12, 2.308e+00,  ..., 8.128e-01, 1.000e-12,
         1.000e-12]], device='cuda:0')
v before min max tensor([ 4.940e+00, -5.693e-01,  6.922e-01, -8.849e-01,  4.741e+00,  2.889e+00,
         1.090e-01,  4.206e-01,  5.129e-01, -2.633e-01, -6.461e-01,  5.128e-01,
        -3.310e-01, -4.060e-01, -6.543e-01, -8.936e-02, -8.633e-01,  4.151e-01,
         7.006e-01,  5.565e+00, -6.289e-01, -4.793e-01, -1.084e+00,  9.854e-01,
         1.997e+00,  9.446e-01, -2.080e-01,  2.392e+00, -8.577e-01, -7.631e-01,
        -9.931e-01, -6.225e-01, -2.796e-01,  3.200e-02, -7.975e-01, -1.091e-01,
         2.603e+00, -7.738e-01,  9.157e-02, -8.300e-01,  1.150e+00, -5.282e-01,
        -3.888e-01,  1.366e-01, -4.813e-01,  4.069e-02, -2.053e-01,  5.100e+00,
        -2.659e-01,  4.360e-02, -5.590e-01, -2.847e-01,  1.363e-01, -5.446e-04,
        -1.031e+00, -5.741e-01,  3.386e-01,  8.416e-02,  6.831e-01, -3.755e-01,
         3.479e+00,  7.286e-01,  2.147e-01,  2.546e+00, -3.703e-01, -7.048e-01,
         3.735e-02, -6.007e-01, -5.432e-01,  2.985e+00, -3.560e-01, -1.973e-01,
        -6.241e-02,  9.830e-01, -5.152e-01, -3.440e-01, -6.102e-01, -1.059e+00,
         1.176e+00, -7.066e-01, -8.885e-01,  1.675e-01,  1.746e-03, -3.339e-01,
        -5.659e-01, -5.071e-02, -5.198e-01, -6.663e-01,  2.218e+00,  4.273e-01,
        -9.814e-01, -6.758e-01, -9.750e-02,  7.057e-01, -4.973e-01,  7.532e-01,
        -4.546e-01,  3.324e+00, -7.980e-01, -9.418e-01,  9.195e-01, -1.161e+00,
        -4.490e-01, -9.801e-01, -8.471e-01, -8.671e-02, -5.986e-01, -7.207e-01,
         4.466e-01,  2.251e-01,  4.153e-01,  1.238e+00, -8.792e-01, -5.246e-01,
         4.464e+00, -2.042e-01, -1.328e-02, -5.204e-01, -7.042e-01,  2.275e+00],
       device='cuda:0')
v tensor([4.940e+00, 1.000e-12, 6.922e-01, 1.000e-12, 4.741e+00, 2.889e+00,
        1.090e-01, 4.206e-01, 5.129e-01, 1.000e-12, 1.000e-12, 5.128e-01,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 4.151e-01,
        7.006e-01, 5.565e+00, 1.000e-12, 1.000e-12, 1.000e-12, 9.854e-01,
        1.997e+00, 9.446e-01, 1.000e-12, 2.392e+00, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 3.200e-02, 1.000e-12, 1.000e-12,
        2.603e+00, 1.000e-12, 9.157e-02, 1.000e-12, 1.150e+00, 1.000e-12,
        1.000e-12, 1.366e-01, 1.000e-12, 4.069e-02, 1.000e-12, 5.100e+00,
        1.000e-12, 4.360e-02, 1.000e-12, 1.000e-12, 1.363e-01, 1.000e-12,
        1.000e-12, 1.000e-12, 3.386e-01, 8.416e-02, 6.831e-01, 1.000e-12,
        3.479e+00, 7.286e-01, 2.147e-01, 2.546e+00, 1.000e-12, 1.000e-12,
        3.735e-02, 1.000e-12, 1.000e-12, 2.985e+00, 1.000e-12, 1.000e-12,
        1.000e-12, 9.830e-01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.176e+00, 1.000e-12, 1.000e-12, 1.675e-01, 1.746e-03, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 2.218e+00, 4.273e-01,
        1.000e-12, 1.000e-12, 1.000e-12, 7.057e-01, 1.000e-12, 7.532e-01,
        1.000e-12, 3.324e+00, 1.000e-12, 1.000e-12, 9.195e-01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        4.466e-01, 2.251e-01, 4.153e-01, 1.238e+00, 1.000e-12, 1.000e-12,
        4.464e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 2.275e+00],
       device='cuda:0')
v before min max tensor([[[-0.904],
         [-0.375],
         [-1.352],
         [-0.798],
         [-0.608],
         [-0.386],
         [-0.283],
         [ 2.602],
         [-0.564],
         [ 0.831]],

        [[-0.466],
         [ 0.102],
         [ 0.271],
         [-0.715],
         [ 0.329],
         [-0.148],
         [ 2.431],
         [-0.213],
         [-0.925],
         [ 0.349]],

        [[ 5.351],
         [-0.224],
         [ 6.729],
         [-0.555],
         [-0.915],
         [-1.118],
         [ 1.690],
         [-0.560],
         [-0.682],
         [ 0.728]],

        [[-0.370],
         [ 3.287],
         [-0.588],
         [-0.398],
         [-0.645],
         [-0.070],
         [-0.431],
         [-0.050],
         [ 0.126],
         [-1.379]],

        [[-0.262],
         [-0.646],
         [ 2.061],
         [-0.180],
         [-0.019],
         [ 2.014],
         [-0.905],
         [-1.483],
         [-0.646],
         [-0.439]],

        [[-0.448],
         [-0.638],
         [-0.166],
         [ 1.115],
         [ 0.161],
         [-0.940],
         [ 0.270],
         [-0.867],
         [-0.628],
         [-0.772]],

        [[-1.815],
         [-0.449],
         [ 0.059],
         [-0.483],
         [-0.603],
         [ 1.607],
         [-0.440],
         [ 0.211],
         [-0.539],
         [ 1.880]],

        [[-0.820],
         [ 2.826],
         [ 0.160],
         [-0.207],
         [-1.076],
         [-0.193],
         [-0.591],
         [-1.437],
         [ 0.299],
         [ 0.096]],

        [[-0.574],
         [-0.369],
         [-0.773],
         [-0.257],
         [-0.647],
         [ 0.252],
         [ 0.994],
         [ 0.456],
         [ 1.341],
         [ 1.824]],

        [[-0.975],
         [ 3.319],
         [ 1.834],
         [ 4.964],
         [-0.590],
         [-0.448],
         [-0.651],
         [-0.421],
         [-0.315],
         [-0.963]],

        [[-0.980],
         [ 1.683],
         [ 0.580],
         [ 0.404],
         [ 0.550],
         [ 0.417],
         [ 0.192],
         [-0.423],
         [-1.671],
         [-0.805]],

        [[ 3.018],
         [-0.133],
         [ 1.161],
         [ 0.550],
         [ 1.088],
         [-1.043],
         [-0.650],
         [-1.197],
         [-1.096],
         [-1.038]]], device='cuda:0')
v tensor([[[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.602e+00],
         [1.000e-12],
         [8.308e-01]],

        [[1.000e-12],
         [1.017e-01],
         [2.713e-01],
         [1.000e-12],
         [3.290e-01],
         [1.000e-12],
         [2.431e+00],
         [1.000e-12],
         [1.000e-12],
         [3.494e-01]],

        [[5.351e+00],
         [1.000e-12],
         [6.729e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.690e+00],
         [1.000e-12],
         [1.000e-12],
         [7.276e-01]],

        [[1.000e-12],
         [3.287e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.256e-01],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [2.061e+00],
         [1.000e-12],
         [1.000e-12],
         [2.014e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.115e+00],
         [1.607e-01],
         [1.000e-12],
         [2.696e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [5.864e-02],
         [1.000e-12],
         [1.000e-12],
         [1.607e+00],
         [1.000e-12],
         [2.113e-01],
         [1.000e-12],
         [1.880e+00]],

        [[1.000e-12],
         [2.826e+00],
         [1.605e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.989e-01],
         [9.617e-02]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.516e-01],
         [9.937e-01],
         [4.556e-01],
         [1.341e+00],
         [1.824e+00]],

        [[1.000e-12],
         [3.319e+00],
         [1.834e+00],
         [4.964e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.683e+00],
         [5.801e-01],
         [4.041e-01],
         [5.495e-01],
         [4.170e-01],
         [1.924e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[3.018e+00],
         [1.000e-12],
         [1.161e+00],
         [5.505e-01],
         [1.088e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]]], device='cuda:0')
v before min max tensor([[ 9.793e-03],
        [ 7.268e-01],
        [-6.599e-01],
        [-7.288e-01],
        [-6.920e-01],
        [-1.275e+00],
        [-1.675e+00],
        [ 4.816e+00],
        [-1.046e+00],
        [ 1.633e+01],
        [-1.102e+00],
        [-1.604e+00]], device='cuda:0')
v tensor([[9.793e-03],
        [7.268e-01],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [4.816e+00],
        [1.000e-12],
        [1.000e+01],
        [1.000e-12],
        [1.000e-12]], device='cuda:0')
a after update for 1 param tensor([[ 0.001,  0.005,  0.016,  ..., -0.004, -0.018, -0.001],
        [ 0.000,  0.010, -0.003,  ...,  0.014,  0.009, -0.003],
        [-0.000,  0.006, -0.006,  ..., -0.019,  0.001, -0.001],
        ...,
        [ 0.009, -0.019, -0.009,  ..., -0.008,  0.004, -0.003],
        [-0.010,  0.005, -0.002,  ...,  0.016,  0.013, -0.002],
        [ 0.006, -0.002, -0.009,  ..., -0.008,  0.009, -0.003]],
       device='cuda:0')
s after update for 1 param tensor([[1.339, 1.138, 0.806,  ..., 0.929, 0.866, 1.150],
        [1.027, 0.794, 0.779,  ..., 0.914, 0.720, 1.099],
        [0.884, 0.447, 0.613,  ..., 0.364, 0.691, 0.612],
        ...,
        [0.304, 0.441, 0.480,  ..., 0.525, 0.396, 0.756],
        [0.614, 0.737, 0.661,  ..., 0.758, 0.541, 0.520],
        [0.508, 0.788, 0.909,  ..., 0.832, 0.716, 1.045]], device='cuda:0')
b after update for 1 param tensor([[39.617, 36.523, 30.732,  ..., 32.988, 31.857, 36.704],
        [34.698, 30.501, 30.215,  ..., 32.732, 29.047, 35.886],
        [32.177, 22.884, 26.805,  ..., 20.640, 28.451, 26.789],
        ...,
        [18.867, 22.739, 23.707,  ..., 24.813, 21.548, 29.766],
        [26.820, 29.396, 27.833,  ..., 29.795, 25.180, 24.676],
        [24.408, 30.378, 32.632,  ..., 31.232, 28.971, 34.992]],
       device='cuda:0')
clipping threshold 0.46579199783626474
a after update for 1 param tensor([-2.062e-02, -3.297e-02,  2.808e-03,  1.434e-03,  1.450e-02, -1.995e-02,
        -3.076e-02,  1.063e-02,  1.335e-03,  1.110e-02,  7.578e-03, -1.394e-02,
        -4.132e-03,  4.211e-03,  7.775e-03, -4.365e-03,  7.388e-03,  1.672e-02,
        -1.126e-02, -1.740e-02,  3.227e-02,  1.508e-02, -9.434e-03, -2.694e-03,
         7.116e-05, -1.207e-02,  2.210e-02,  1.356e-03,  1.247e-02, -4.911e-05,
         8.802e-03, -1.078e-02,  4.718e-03,  7.523e-03, -1.423e-02, -3.391e-03,
         7.741e-03,  1.996e-02,  5.154e-03, -1.072e-02,  1.510e-02, -3.218e-03,
         1.127e-02,  2.942e-03,  2.123e-02, -5.560e-03,  5.662e-03,  3.590e-03,
        -1.271e-03, -8.914e-03, -1.444e-02, -7.377e-03,  7.048e-03, -8.140e-03,
         1.834e-03,  2.299e-02, -3.173e-03,  5.865e-04,  4.491e-03, -6.661e-03,
        -1.042e-02, -8.178e-03, -8.058e-03,  1.587e-02,  1.084e-03, -2.114e-03,
         5.327e-03,  3.178e-04,  1.415e-02,  1.270e-02,  2.462e-03,  8.290e-03,
        -1.256e-02,  6.682e-03,  6.446e-03, -6.060e-03, -2.950e-02, -1.710e-03,
        -2.948e-02, -3.174e-03, -6.272e-03,  8.547e-04, -2.235e-02, -1.779e-03,
         8.336e-03, -2.765e-03,  3.324e-03, -1.877e-03,  8.570e-03, -1.223e-02,
        -4.290e-04, -5.786e-03,  4.051e-03,  1.877e-02, -4.662e-03, -2.495e-03,
        -8.847e-03,  1.774e-02,  1.553e-03, -8.023e-03,  1.122e-02,  3.215e-03,
         1.010e-02, -1.469e-02, -7.208e-03, -6.190e-03,  6.573e-04,  4.296e-03,
         4.518e-02, -2.153e-02, -2.179e-04,  1.409e-02, -1.802e-03,  3.056e-03,
        -5.951e-03, -4.054e-03,  1.430e-02, -1.152e-02,  7.886e-03,  1.402e-02],
       device='cuda:0')
s after update for 1 param tensor([1.334, 0.520, 0.805, 0.661, 0.923, 0.706, 0.265, 0.526, 0.409, 0.555,
        0.487, 0.749, 0.246, 0.686, 0.669, 0.442, 0.654, 0.481, 0.623, 1.071,
        0.669, 1.111, 0.863, 0.528, 0.884, 0.608, 0.250, 0.773, 0.766, 0.575,
        0.772, 0.491, 0.392, 0.312, 0.604, 0.432, 0.698, 0.635, 1.012, 0.617,
        0.598, 0.393, 0.594, 0.640, 0.425, 1.069, 0.403, 1.337, 0.254, 0.535,
        0.640, 0.785, 0.452, 0.439, 0.778, 0.429, 0.527, 0.647, 0.495, 0.287,
        0.898, 1.254, 0.672, 0.795, 0.316, 0.599, 0.547, 0.586, 0.736, 0.767,
        0.593, 0.619, 0.197, 0.627, 0.502, 0.259, 0.598, 0.855, 0.459, 0.539,
        0.676, 0.339, 0.294, 0.553, 0.499, 0.522, 0.397, 0.502, 0.606, 0.570,
        0.819, 0.585, 0.291, 0.575, 0.479, 0.535, 0.513, 1.248, 0.636, 0.800,
        0.373, 0.863, 0.389, 0.730, 0.697, 0.317, 0.823, 0.598, 0.655, 0.785,
        0.878, 0.609, 0.731, 0.507, 1.064, 0.521, 0.892, 0.674, 0.524, 0.674],
       device='cuda:0')
b after update for 1 param tensor([39.531, 24.680, 30.705, 27.835, 32.882, 28.769, 17.625, 24.837, 21.879,
        25.501, 23.879, 29.625, 16.986, 28.358, 28.006, 22.748, 27.683, 23.745,
        27.010, 35.427, 28.008, 36.087, 31.805, 24.867, 32.189, 26.686, 17.128,
        30.089, 29.954, 25.959, 30.084, 23.996, 21.432, 19.126, 26.604, 22.508,
        28.604, 27.289, 34.444, 26.883, 26.468, 21.467, 26.383, 27.392, 22.314,
        35.394, 21.720, 39.584, 17.240, 25.047, 27.394, 30.324, 23.002, 22.692,
        30.202, 22.415, 24.843, 27.538, 24.081, 18.330, 32.431, 38.334, 28.057,
        30.526, 19.231, 26.503, 25.320, 26.199, 29.370, 29.982, 26.352, 26.936,
        15.192, 27.116, 24.255, 17.431, 26.480, 31.662, 23.192, 25.128, 28.135,
        19.917, 18.548, 25.459, 24.175, 24.728, 21.576, 24.265, 26.649, 25.836,
        30.985, 26.179, 18.455, 25.951, 23.700, 25.030, 24.511, 38.240, 27.303,
        30.611, 20.911, 31.792, 21.362, 29.239, 28.572, 19.268, 31.060, 26.470,
        27.712, 30.328, 32.082, 26.709, 29.273, 24.386, 35.317, 24.706, 32.335,
        28.111, 24.769, 28.101], device='cuda:0')
clipping threshold 0.46579199783626474
a after update for 1 param tensor([[[-1.968e-03],
         [ 1.049e-02],
         [ 1.100e-02],
         [-4.885e-03],
         [-1.136e-02],
         [-1.006e-02],
         [ 3.988e-03],
         [ 2.186e-02],
         [ 5.900e-03],
         [ 5.418e-03]],

        [[ 4.942e-03],
         [ 1.605e-02],
         [-6.899e-03],
         [ 8.657e-03],
         [-1.063e-03],
         [ 1.135e-02],
         [ 2.060e-02],
         [-1.241e-02],
         [-1.338e-02],
         [-1.686e-02]],

        [[ 9.191e-03],
         [-1.602e-02],
         [ 3.959e-03],
         [-1.329e-02],
         [ 1.430e-02],
         [ 1.547e-02],
         [-1.701e-02],
         [-8.970e-03],
         [ 1.417e-02],
         [-2.488e-02]],

        [[-2.649e-03],
         [-1.785e-02],
         [ 7.875e-04],
         [-7.037e-03],
         [ 6.902e-03],
         [ 1.596e-02],
         [-4.265e-03],
         [ 3.753e-03],
         [ 1.539e-03],
         [-6.973e-03]],

        [[ 1.227e-02],
         [ 4.487e-03],
         [ 1.261e-02],
         [-3.685e-03],
         [ 5.961e-04],
         [ 7.028e-03],
         [ 2.843e-03],
         [-3.138e-03],
         [ 1.856e-02],
         [-1.431e-03]],

        [[-1.042e-02],
         [-4.173e-04],
         [ 9.022e-03],
         [ 2.457e-02],
         [-1.614e-02],
         [ 1.145e-02],
         [ 1.038e-02],
         [ 1.371e-02],
         [-1.011e-02],
         [ 2.351e-02]],

        [[ 2.741e-03],
         [ 3.329e-03],
         [-4.623e-03],
         [-3.047e-02],
         [-2.620e-02],
         [ 1.518e-03],
         [ 8.824e-03],
         [ 6.893e-03],
         [-1.786e-02],
         [ 1.249e-02]],

        [[-9.774e-03],
         [ 1.087e-02],
         [-2.279e-02],
         [ 7.776e-03],
         [ 1.980e-02],
         [ 5.516e-03],
         [-2.049e-02],
         [-2.791e-03],
         [-3.149e-04],
         [ 1.031e-03]],

        [[-1.625e-02],
         [-1.024e-02],
         [-3.617e-02],
         [ 5.048e-03],
         [-1.261e-02],
         [ 1.809e-02],
         [-1.030e-02],
         [ 8.481e-03],
         [ 1.109e-03],
         [ 4.370e-03]],

        [[-5.063e-03],
         [-5.333e-05],
         [ 4.318e-03],
         [ 1.209e-03],
         [-1.058e-03],
         [ 7.303e-03],
         [ 8.762e-03],
         [ 1.027e-02],
         [ 5.887e-03],
         [ 1.378e-02]],

        [[ 9.699e-03],
         [ 1.140e-02],
         [-4.481e-03],
         [-7.744e-03],
         [ 5.543e-03],
         [ 1.577e-02],
         [ 2.088e-03],
         [-1.829e-02],
         [ 2.088e-03],
         [ 1.649e-02]],

        [[ 2.150e-02],
         [-1.321e-02],
         [-1.980e-02],
         [-4.004e-03],
         [-1.905e-02],
         [ 1.227e-02],
         [-8.356e-03],
         [-4.716e-03],
         [ 5.002e-03],
         [-3.500e-04]]], device='cuda:0')
s after update for 1 param tensor([[[0.681],
         [0.477],
         [1.005],
         [0.624],
         [0.601],
         [0.552],
         [0.509],
         [1.201],
         [0.606],
         [0.584]],

        [[0.471],
         [0.573],
         [0.508],
         [0.609],
         [0.937],
         [0.598],
         [0.854],
         [0.512],
         [0.701],
         [1.126]],

        [[0.839],
         [0.533],
         [1.166],
         [1.075],
         [0.762],
         [0.912],
         [0.891],
         [0.789],
         [0.542],
         [0.656]],

        [[0.741],
         [0.682],
         [0.448],
         [0.315],
         [0.495],
         [0.469],
         [0.384],
         [0.592],
         [0.442],
         [1.152]],

        [[0.421],
         [0.574],
         [0.572],
         [0.626],
         [0.623],
         [0.989],
         [0.680],
         [1.132],
         [0.481],
         [0.623]],

        [[0.363],
         [0.477],
         [0.428],
         [0.895],
         [0.512],
         [0.740],
         [0.707],
         [1.290],
         [0.928],
         [1.113]],

        [[1.408],
         [0.844],
         [1.051],
         [0.791],
         [0.723],
         [0.788],
         [0.919],
         [0.547],
         [0.904],
         [0.876]],

        [[0.784],
         [0.735],
         [0.530],
         [0.396],
         [0.968],
         [0.631],
         [0.904],
         [1.068],
         [0.837],
         [0.733]],

        [[0.524],
         [0.789],
         [0.575],
         [0.335],
         [0.568],
         [0.986],
         [0.741],
         [0.575],
         [0.628],
         [0.863]],

        [[0.725],
         [1.135],
         [0.703],
         [0.965],
         [0.739],
         [1.113],
         [0.570],
         [0.838],
         [0.541],
         [1.157]],

        [[0.875],
         [0.684],
         [0.432],
         [0.831],
         [0.462],
         [0.760],
         [0.712],
         [0.513],
         [1.256],
         [0.788]],

        [[0.970],
         [0.632],
         [0.827],
         [0.566],
         [0.644],
         [0.775],
         [0.527],
         [0.954],
         [0.833],
         [0.906]]], device='cuda:0')
b after update for 1 param tensor([[[28.258],
         [23.632],
         [34.312],
         [27.037],
         [26.537],
         [25.428],
         [24.413],
         [37.515],
         [26.656],
         [26.164]],

        [[23.497],
         [25.905],
         [24.394],
         [26.725],
         [33.128],
         [26.471],
         [31.627],
         [24.496],
         [28.658],
         [36.329]],

        [[31.353],
         [24.980],
         [36.958],
         [35.484],
         [29.882],
         [32.696],
         [32.307],
         [30.403],
         [25.196],
         [27.725]],

        [[29.473],
         [28.274],
         [22.920],
         [19.219],
         [24.089],
         [23.443],
         [21.215],
         [26.330],
         [22.769],
         [36.741]],

        [[22.208],
         [25.945],
         [25.898],
         [27.091],
         [27.013],
         [34.047],
         [28.234],
         [36.422],
         [23.735],
         [27.025]],

        [[20.635],
         [23.640],
         [22.395],
         [32.379],
         [24.504],
         [29.450],
         [28.781],
         [38.876],
         [32.977],
         [36.118]],

        [[40.626],
         [31.440],
         [35.101],
         [30.451],
         [29.115],
         [30.383],
         [32.820],
         [25.314],
         [32.540],
         [32.039]],

        [[30.319],
         [29.351],
         [24.921],
         [21.551],
         [33.686],
         [27.193],
         [32.547],
         [35.377],
         [31.314],
         [29.303]],

        [[24.786],
         [30.412],
         [25.953],
         [19.807],
         [25.797],
         [33.986],
         [29.468],
         [25.959],
         [27.123],
         [31.802]],

        [[29.141],
         [36.472],
         [28.707],
         [33.624],
         [29.430],
         [36.106],
         [25.837],
         [31.342],
         [25.174],
         [36.822]],

        [[32.022],
         [28.315],
         [22.489],
         [31.201],
         [23.265],
         [29.838],
         [28.886],
         [24.510],
         [38.369],
         [30.392]],

        [[33.718],
         [27.206],
         [31.128],
         [25.746],
         [27.478],
         [30.143],
         [24.858],
         [33.442],
         [31.248],
         [32.592]]], device='cuda:0')
clipping threshold 0.46579199783626474
a after update for 1 param tensor([[ 0.002],
        [-0.026],
        [ 0.003],
        [ 0.007],
        [-0.008],
        [-0.005],
        [ 0.002],
        [ 0.001],
        [ 0.015],
        [-0.028],
        [ 0.020],
        [-0.015]], device='cuda:0')
s after update for 1 param tensor([[0.865],
        [0.703],
        [0.908],
        [0.675],
        [0.924],
        [1.043],
        [1.544],
        [1.391],
        [1.013],
        [1.723],
        [1.407],
        [1.286]], device='cuda:0')
b after update for 1 param tensor([[31.837],
        [28.710],
        [32.626],
        [28.123],
        [32.911],
        [34.960],
        [42.536],
        [40.378],
        [34.455],
        [44.938],
        [40.604],
        [38.825]], device='cuda:0')
clipping threshold 0.46579199783626474
||w||^2 0.8520600142981953
exp ma of ||w||^2 0.5220889973126094
||w|| 0.9230709692641164
exp ma of ||w|| 0.6799013555663146
cuda
Objective function 9.55 = squared loss an data 8.19 + 0.5*rho*h**2 0.265454 + alpha*h 0.273765 + L2reg 0.77 + L1reg 0.05 ; SHD = 19 ; DAG True
Proportion of microbatches that were clipped  0.7637910085054678
iteration 2 in inner loop, alpha 3.757238537042859 rho 100.0 h 0.07286346417286182
1692
cuda
Objective function 11.94 = squared loss an data 8.19 + 0.5*rho*h**2 2.654542 + alpha*h 0.273765 + L2reg 0.77 + L1reg 0.05 ; SHD = 19 ; DAG True
||w||^2 0.5774665664086795
exp ma of ||w||^2 0.7317738851831314
||w|| 0.7599122096720644
exp ma of ||w|| 0.4645449447018515
||w||^2 0.5756291640205998
exp ma of ||w||^2 0.3154976473718606
||w|| 0.7587022894525888
exp ma of ||w|| 0.5119003196235377
||w||^2 0.37974716230643846
exp ma of ||w||^2 0.5581321056060815
||w|| 0.6162362877228494
exp ma of ||w|| 0.6923481387297161
||w||^2 0.6985584265769029
exp ma of ||w||^2 0.526066709899502
||w|| 0.8357980776341274
exp ma of ||w|| 0.6837104499085711
||w||^2 0.3527296872806844
exp ma of ||w||^2 0.5578555118733961
||w|| 0.5939105044370611
exp ma of ||w|| 0.6992750544667062
||w||^2 0.22115735157941385
exp ma of ||w||^2 0.48976179850053714
||w|| 0.4702736985835098
exp ma of ||w|| 0.6495800602500509
||w||^2 0.2576075842152745
exp ma of ||w||^2 0.4385291986066892
||w|| 0.5075505730617142
exp ma of ||w|| 0.6146572547920086
||w||^2 0.5838888621765603
exp ma of ||w||^2 0.4705646324107207
||w|| 0.7641262082775072
exp ma of ||w|| 0.6522828525595836
||w||^2 0.20847004531686356
exp ma of ||w||^2 0.44892651888695134
||w|| 0.4565852005013561
exp ma of ||w|| 0.6228145839960103
cuda
Objective function 10.10 = squared loss an data 8.96 + 0.5*rho*h**2 0.241129 + alpha*h 0.082510 + L2reg 0.77 + L1reg 0.05 ; SHD = 18 ; DAG True
Proportion of microbatches that were clipped  0.7694078425146849
iteration 3 in inner loop, alpha 3.757238537042859 rho 1000.0 h 0.02196035461633805
iteration 3 in outer loop, alpha = 25.71759315338091, rho = 1000.0, h = 0.02196035461633805
cuda
1692
cuda
Objective function 10.58 = squared loss an data 8.96 + 0.5*rho*h**2 0.241129 + alpha*h 0.564767 + L2reg 0.77 + L1reg 0.05 ; SHD = 18 ; DAG True
||w||^2 5686533822.585533
exp ma of ||w||^2 12891505673.01005
||w|| 75409.10967904032
exp ma of ||w|| 97976.13232956029
||w||^2 0.06085212324544001
exp ma of ||w||^2 242.50243879503478
||w|| 0.2466822313127559
exp ma of ||w|| 0.3953289239620464
||w||^2 0.16281506624464703
exp ma of ||w||^2 0.9727643545522681
||w|| 0.40350348975522754
exp ma of ||w|| 0.46401079007915225
||w||^2 0.274636424636384
exp ma of ||w||^2 0.43155062135737743
||w|| 0.5240576539240545
exp ma of ||w|| 0.6134907271762154
||w||^2 0.37773830544881665
exp ma of ||w||^2 0.5040941614109061
||w|| 0.6146041860000765
exp ma of ||w|| 0.6587787524985254
||w||^2 0.09290019170563373
exp ma of ||w||^2 0.4905440881117864
||w|| 0.30479532756529215
exp ma of ||w|| 0.6463225126783574
||w||^2 0.41391723091705956
exp ma of ||w||^2 0.5220225103362587
||w|| 0.6433639956642426
exp ma of ||w|| 0.6773562249575933
||w||^2 0.30563181103543935
exp ma of ||w||^2 0.5303874651212099
||w|| 0.5528397697664662
exp ma of ||w|| 0.6736958005842159
||w||^2 0.8843959660857188
exp ma of ||w||^2 0.5073523204614075
||w|| 0.9404232909098534
exp ma of ||w|| 0.668977818081286
||w||^2 0.3106146341377433
exp ma of ||w||^2 0.47069735578107946
||w|| 0.5573281207132323
exp ma of ||w|| 0.638119460381126
||w||^2 0.9489252561009744
exp ma of ||w||^2 0.45221581327858745
||w|| 0.9741279464736521
exp ma of ||w|| 0.62709285462974
||w||^2 0.5750470313270087
exp ma of ||w||^2 0.4984936721832525
||w|| 0.758318555309712
exp ma of ||w|| 0.6579523403444043
||w||^2 0.06733622211119188
exp ma of ||w||^2 0.5118678181802966
||w|| 0.25949223901918894
exp ma of ||w|| 0.6677486592043668
||w||^2 0.8138235092903395
exp ma of ||w||^2 0.5139887988847331
||w|| 0.9021216710013896
exp ma of ||w|| 0.6766495265265425
cuda
Objective function 10.40 = squared loss an data 9.19 + 0.5*rho*h**2 0.086664 + alpha*h 0.338582 + L2reg 0.74 + L1reg 0.05 ; SHD = 18 ; DAG True
Proportion of microbatches that were clipped  0.7681159420289855
iteration 1 in inner loop, alpha 25.71759315338091 rho 1000.0 h 0.013165390938384647
1692
cuda
Objective function 11.18 = squared loss an data 9.19 + 0.5*rho*h**2 0.866638 + alpha*h 0.338582 + L2reg 0.74 + L1reg 0.05 ; SHD = 18 ; DAG True
||w||^2 0.28705895379907137
exp ma of ||w||^2 77516.05290203553
||w|| 0.5357788291814742
exp ma of ||w|| 5.366057795303079
||w||^2 0.10064132194554531
exp ma of ||w||^2 8409.696450923366
||w|| 0.31724016445832537
exp ma of ||w|| 1.0004906898483168
||w||^2 0.14601388349307623
exp ma of ||w||^2 1115.6211724238656
||w|| 0.3821176304399945
exp ma of ||w|| 0.4947540486782927
||w||^2 0.24885189266784624
exp ma of ||w||^2 0.46065538680021983
||w|| 0.4988505714819281
exp ma of ||w|| 0.6388870180838918
||w||^2 0.09831505337246695
exp ma of ||w||^2 0.43590516280711783
||w|| 0.3135523136136408
exp ma of ||w|| 0.6192196003445024
v before min max tensor([[ 6.993e-01, -1.449e+00,  1.508e+00,  ...,  4.550e+00,  2.696e+00,
          1.762e+00],
        [ 3.301e+00, -3.760e-01, -7.135e-03,  ...,  1.439e+01, -2.709e-01,
         -8.262e-01],
        [ 4.386e+00,  3.890e-01,  4.362e-01,  ..., -4.504e-01, -5.347e-01,
         -9.357e-01],
        ...,
        [-4.573e-01, -2.868e-01, -9.093e-01,  ..., -4.795e-01, -6.346e-01,
          9.753e-01],
        [-2.784e-01, -3.325e-01, -1.489e-02,  ..., -3.309e-01, -5.603e-01,
         -9.792e-01],
        [ 2.954e+00,  1.294e+00, -5.613e-01,  ..., -1.016e+00, -1.681e+00,
         -1.459e+00]], device='cuda:0')
v tensor([[6.993e-01, 1.000e-12, 1.508e+00,  ..., 4.550e+00, 2.696e+00,
         1.762e+00],
        [3.301e+00, 1.000e-12, 1.000e-12,  ..., 1.000e+01, 1.000e-12,
         1.000e-12],
        [4.386e+00, 3.890e-01, 4.362e-01,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        ...,
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         9.753e-01],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [2.954e+00, 1.294e+00, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12]], device='cuda:0')
v before min max tensor([-0.691, -0.588, -0.008, -0.840, -0.246, -0.513, -0.740, -0.100, -0.389,
         0.974, -0.285, -0.860,  0.437, -0.659,  0.721,  0.932, -0.629, -0.501,
        -0.417, -0.495, -0.612, -0.591, -0.979,  0.778, -0.434,  0.576,  0.023,
         4.053, -0.583, -0.346, -0.798,  0.648, -0.319,  0.596, -0.510,  0.207,
         0.078,  1.051, -0.849, -0.415, -0.719, -0.702, -0.448, -1.366, -0.574,
        -0.584,  1.979, -0.389, -0.452, -0.621, -0.052, -0.189,  0.689, -0.524,
        -0.015, -0.568, -0.144,  1.493, -0.191,  0.544, -0.129, -1.020,  0.926,
        -1.027,  0.807,  1.820, -0.443,  0.128, -1.747,  0.873, -1.203,  1.228,
        -0.310,  0.176, -0.642,  0.711, -0.855,  2.651,  0.199, -0.678, -0.599,
        -0.233, -0.075,  2.260, -0.675, -0.206, -0.503, -0.069,  0.187,  0.033,
        -0.293,  3.778, -0.722, -0.365, -0.522, -0.317,  1.353,  0.527, -1.313,
         3.489,  0.181, -1.706, -0.761,  0.371, -1.269,  0.997, -0.448, -0.212,
        -0.445,  0.725, -0.794, -0.781, -0.551, -0.584, -0.250, -0.184, -1.147,
        -0.418, -0.755, -0.184], device='cuda:0')
v tensor([1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 9.743e-01, 1.000e-12, 1.000e-12,
        4.367e-01, 1.000e-12, 7.209e-01, 9.322e-01, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 7.780e-01,
        1.000e-12, 5.755e-01, 2.319e-02, 4.053e+00, 1.000e-12, 1.000e-12,
        1.000e-12, 6.483e-01, 1.000e-12, 5.963e-01, 1.000e-12, 2.066e-01,
        7.788e-02, 1.051e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.979e+00, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 6.886e-01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.493e+00, 1.000e-12, 5.445e-01,
        1.000e-12, 1.000e-12, 9.260e-01, 1.000e-12, 8.072e-01, 1.820e+00,
        1.000e-12, 1.282e-01, 1.000e-12, 8.727e-01, 1.000e-12, 1.228e+00,
        1.000e-12, 1.756e-01, 1.000e-12, 7.109e-01, 1.000e-12, 2.651e+00,
        1.992e-01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 2.260e+00,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.867e-01, 3.350e-02,
        1.000e-12, 3.778e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.353e+00, 5.272e-01, 1.000e-12, 3.489e+00, 1.808e-01, 1.000e-12,
        1.000e-12, 3.709e-01, 1.000e-12, 9.970e-01, 1.000e-12, 1.000e-12,
        1.000e-12, 7.247e-01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12],
       device='cuda:0')
v before min max tensor([[[-4.287e-01],
         [-1.848e-01],
         [ 2.809e+00],
         [-1.314e-01],
         [-5.913e-01],
         [ 8.938e-02],
         [ 1.178e+00],
         [ 2.711e-01],
         [ 1.048e+01],
         [-6.442e-01]],

        [[-3.033e-01],
         [ 3.582e-01],
         [-8.931e-01],
         [ 3.706e+00],
         [-1.024e+00],
         [-4.792e-01],
         [ 7.896e-01],
         [-3.015e-01],
         [ 2.729e+00],
         [-9.368e-01]],

        [[-6.538e-02],
         [-5.505e-01],
         [-9.413e-01],
         [-4.057e-01],
         [ 2.258e+00],
         [-8.343e-01],
         [-5.222e-01],
         [-7.860e-01],
         [-1.010e+00],
         [-3.680e-01]],

        [[-6.823e-01],
         [-7.807e-01],
         [-6.260e-01],
         [-8.274e-01],
         [-6.763e-01],
         [-1.358e+00],
         [-8.562e-01],
         [-1.562e-01],
         [-7.695e-01],
         [-5.128e-01]],

        [[ 3.255e-01],
         [-1.122e+00],
         [-8.512e-01],
         [ 5.417e+00],
         [-7.245e-01],
         [-6.843e-01],
         [-4.415e-01],
         [-3.125e-01],
         [-1.019e+00],
         [-2.098e-01]],

        [[-6.797e-01],
         [ 7.808e-01],
         [-7.362e-01],
         [-4.247e-01],
         [ 1.852e+00],
         [ 2.783e+00],
         [ 1.931e+00],
         [ 3.157e+00],
         [ 1.020e+00],
         [-1.773e-01]],

        [[ 1.978e+00],
         [-4.818e-01],
         [ 6.100e+00],
         [-1.593e+00],
         [ 1.268e+00],
         [ 9.607e-01],
         [-2.257e-02],
         [-7.356e-01],
         [-6.452e-01],
         [-6.016e-01]],

        [[ 3.446e-01],
         [-8.467e-01],
         [-1.820e-02],
         [ 1.683e-01],
         [-5.459e-01],
         [-6.726e-01],
         [-5.596e-01],
         [-4.923e-01],
         [ 2.501e+00],
         [ 2.517e-01]],

        [[-4.356e-01],
         [ 5.076e-01],
         [-2.158e-01],
         [-1.643e-01],
         [ 1.243e+00],
         [-7.030e-01],
         [ 5.385e-01],
         [ 9.787e-01],
         [-5.089e-01],
         [ 6.069e-01]],

        [[-3.611e-01],
         [ 6.195e-01],
         [ 5.782e-01],
         [ 1.937e+00],
         [-6.584e-01],
         [-7.576e-01],
         [ 4.541e-03],
         [-8.346e-01],
         [ 1.200e-01],
         [-7.633e-01]],

        [[-2.623e-02],
         [-7.895e-01],
         [-7.756e-01],
         [ 3.788e+00],
         [ 1.638e-01],
         [-2.566e-01],
         [-8.182e-01],
         [ 1.503e+00],
         [-2.095e-01],
         [ 1.832e+00]],

        [[-1.522e+00],
         [ 2.968e-01],
         [-8.552e-02],
         [ 4.185e-01],
         [ 4.844e-01],
         [ 7.813e-01],
         [-1.783e-01],
         [-6.147e-01],
         [-9.156e-01],
         [-2.379e-01]]], device='cuda:0')
v tensor([[[1.000e-12],
         [1.000e-12],
         [2.809e+00],
         [1.000e-12],
         [1.000e-12],
         [8.938e-02],
         [1.178e+00],
         [2.711e-01],
         [1.000e+01],
         [1.000e-12]],

        [[1.000e-12],
         [3.582e-01],
         [1.000e-12],
         [3.706e+00],
         [1.000e-12],
         [1.000e-12],
         [7.896e-01],
         [1.000e-12],
         [2.729e+00],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.258e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[3.255e-01],
         [1.000e-12],
         [1.000e-12],
         [5.417e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [7.808e-01],
         [1.000e-12],
         [1.000e-12],
         [1.852e+00],
         [2.783e+00],
         [1.931e+00],
         [3.157e+00],
         [1.020e+00],
         [1.000e-12]],

        [[1.978e+00],
         [1.000e-12],
         [6.100e+00],
         [1.000e-12],
         [1.268e+00],
         [9.607e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[3.446e-01],
         [1.000e-12],
         [1.000e-12],
         [1.683e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.501e+00],
         [2.517e-01]],

        [[1.000e-12],
         [5.076e-01],
         [1.000e-12],
         [1.000e-12],
         [1.243e+00],
         [1.000e-12],
         [5.385e-01],
         [9.787e-01],
         [1.000e-12],
         [6.069e-01]],

        [[1.000e-12],
         [6.195e-01],
         [5.782e-01],
         [1.937e+00],
         [1.000e-12],
         [1.000e-12],
         [4.541e-03],
         [1.000e-12],
         [1.200e-01],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [3.788e+00],
         [1.638e-01],
         [1.000e-12],
         [1.000e-12],
         [1.503e+00],
         [1.000e-12],
         [1.832e+00]],

        [[1.000e-12],
         [2.968e-01],
         [1.000e-12],
         [4.185e-01],
         [4.844e-01],
         [7.813e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]]], device='cuda:0')
v before min max tensor([[-0.684],
        [-1.138],
        [ 0.683],
        [ 1.456],
        [ 3.034],
        [-0.399],
        [ 2.660],
        [ 1.165],
        [-0.275],
        [-0.613],
        [-0.788],
        [ 0.772]], device='cuda:0')
v tensor([[1.000e-12],
        [1.000e-12],
        [6.829e-01],
        [1.456e+00],
        [3.034e+00],
        [1.000e-12],
        [2.660e+00],
        [1.165e+00],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [7.723e-01]], device='cuda:0')
a after update for 1 param tensor([[ 0.004,  0.021,  0.013,  ..., -0.008,  0.006, -0.007],
        [-0.002, -0.041,  0.002,  ...,  0.006, -0.008,  0.009],
        [ 0.004,  0.001, -0.002,  ...,  0.001, -0.010,  0.003],
        ...,
        [-0.002, -0.012, -0.004,  ..., -0.010,  0.003, -0.002],
        [ 0.003, -0.033,  0.001,  ..., -0.003,  0.016,  0.001],
        [-0.003,  0.014, -0.011,  ..., -0.000,  0.017,  0.000]],
       device='cuda:0')
s after update for 1 param tensor([[1.248, 1.161, 1.374,  ..., 1.054, 0.772, 1.202],
        [1.269, 0.413, 1.126,  ..., 1.180, 0.854, 0.696],
        [1.402, 0.469, 0.298,  ..., 0.355, 0.550, 0.742],
        ...,
        [0.655, 0.603, 0.762,  ..., 0.382, 0.542, 1.081],
        [0.344, 0.429, 0.395,  ..., 0.512, 0.477, 0.776],
        [1.138, 0.708, 0.469,  ..., 0.922, 1.327, 1.535]], device='cuda:0')
b after update for 1 param tensor([[40.353, 38.917, 42.336,  ..., 37.088, 31.736, 39.600],
        [40.688, 23.224, 38.321,  ..., 39.229, 33.385, 30.127],
        [42.759, 24.733, 19.713,  ..., 21.529, 26.793, 31.117],
        ...,
        [29.224, 28.056, 31.526,  ..., 22.318, 26.584, 37.556],
        [21.171, 23.660, 22.701,  ..., 25.842, 24.955, 31.812],
        [38.534, 30.387, 24.730,  ..., 34.671, 41.599, 44.743]],
       device='cuda:0')
clipping threshold 0.4287362090811313
a after update for 1 param tensor([ 1.080e-02, -1.518e-02,  5.685e-03, -2.140e-02, -1.387e-03, -6.305e-03,
        -8.006e-03, -2.954e-02, -4.824e-03, -2.273e-02,  1.179e-04, -1.441e-02,
        -1.438e-02, -8.691e-03,  6.659e-03, -5.071e-04, -2.721e-03, -5.785e-03,
        -2.056e-02, -2.509e-02,  1.863e-02, -7.754e-03, -2.897e-02,  1.701e-02,
         1.010e-02, -1.798e-02,  5.641e-03, -3.092e-02,  3.523e-04, -9.189e-03,
        -8.192e-03,  1.341e-03,  2.914e-02,  5.757e-03, -1.248e-02,  9.662e-03,
        -3.079e-03, -5.227e-03, -5.386e-04,  4.377e-02,  9.962e-03, -4.532e-03,
        -1.567e-02,  4.100e-02,  5.388e-03,  1.431e-03,  6.028e-02, -9.593e-03,
        -1.087e-02, -3.576e-02, -1.800e-02,  1.775e-02,  1.123e-02, -1.994e-02,
        -6.854e-03, -8.282e-03,  2.996e-02,  3.208e-02, -2.048e-02,  1.305e-02,
        -3.387e-02,  1.824e-02, -3.031e-03, -2.266e-02, -3.423e-04,  2.198e-02,
         3.890e-03,  1.458e-02,  5.165e-03,  4.040e-03, -1.722e-02, -5.527e-03,
         4.579e-03, -9.821e-03, -2.828e-02,  6.255e-03,  2.709e-02,  8.158e-04,
        -3.605e-02,  2.659e-02,  5.294e-02,  3.452e-05,  1.834e-02, -2.860e-03,
        -1.015e-02,  9.879e-04, -1.771e-02, -1.584e-02,  2.383e-02,  9.107e-03,
        -1.502e-02,  2.018e-02,  1.098e-02, -1.488e-02, -1.585e-02, -2.445e-02,
         4.948e-03, -2.650e-03,  2.555e-04,  5.312e-03, -3.493e-03, -1.409e-02,
         6.788e-03, -2.434e-02, -1.052e-02, -5.846e-03,  2.359e-02,  3.611e-03,
        -3.442e-03, -4.961e-03,  1.356e-03,  1.806e-02, -2.455e-03,  1.980e-03,
         6.369e-03, -7.010e-03,  1.379e-02, -9.547e-03, -1.018e-02, -3.190e-02],
       device='cuda:0')
s after update for 1 param tensor([0.571, 0.588, 0.716, 0.733, 0.436, 0.408, 0.778, 0.736, 0.825, 0.444,
        0.231, 0.682, 0.565, 0.702, 0.481, 0.622, 1.063, 0.469, 0.441, 0.396,
        0.576, 0.545, 0.783, 0.770, 0.384, 0.928, 0.377, 1.251, 0.672, 0.768,
        0.853, 1.057, 0.300, 0.662, 0.529, 0.431, 0.666, 0.583, 0.684, 0.502,
        0.599, 0.556, 0.656, 1.151, 0.462, 0.637, 0.825, 0.400, 0.372, 0.578,
        0.230, 0.494, 0.474, 0.869, 0.467, 0.820, 0.265, 1.061, 0.279, 0.802,
        0.843, 0.825, 0.580, 0.812, 0.728, 0.871, 0.387, 0.453, 1.398, 0.454,
        1.121, 0.844, 0.251, 0.560, 0.545, 0.505, 0.674, 1.194, 0.716, 0.536,
        0.666, 0.276, 1.099, 0.901, 0.747, 0.422, 1.502, 1.058, 0.429, 0.209,
        0.295, 1.104, 0.590, 0.315, 0.453, 0.251, 1.211, 0.852, 1.037, 0.861,
        0.436, 1.347, 0.606, 0.418, 1.123, 0.725, 0.393, 0.391, 0.583, 0.466,
        0.637, 0.692, 1.457, 0.573, 1.142, 0.353, 0.908, 0.332, 0.798, 0.225],
       device='cuda:0')
b after update for 1 param tensor([27.282, 27.692, 30.560, 30.915, 23.849, 23.075, 31.851, 30.979, 32.803,
        24.070, 17.343, 29.817, 27.145, 30.264, 25.048, 28.478, 37.234, 24.737,
        23.979, 22.732, 27.404, 26.657, 31.955, 31.684, 22.378, 34.795, 22.184,
        40.403, 29.602, 31.654, 33.361, 37.141, 19.792, 29.389, 26.275, 23.718,
        29.468, 27.576, 29.864, 25.583, 27.951, 26.931, 29.261, 38.746, 24.553,
        28.818, 32.799, 22.850, 22.032, 27.455, 17.318, 25.385, 24.868, 33.663,
        24.676, 32.714, 18.607, 37.211, 19.071, 32.337, 33.165, 32.797, 27.514,
        32.544, 30.808, 33.711, 22.478, 24.313, 42.698, 24.322, 38.245, 33.181,
        18.089, 27.025, 26.652, 25.667, 29.653, 39.459, 30.561, 26.449, 29.468,
        18.968, 37.869, 34.289, 31.219, 23.467, 44.257, 37.154, 23.659, 16.516,
        19.621, 37.953, 27.745, 20.284, 24.306, 18.101, 39.746, 33.329, 36.783,
        33.506, 23.837, 41.919, 28.114, 23.339, 38.282, 30.748, 22.627, 22.580,
        27.574, 24.646, 28.818, 30.051, 43.603, 27.344, 38.594, 21.474, 34.407,
        20.797, 32.273, 17.134], device='cuda:0')
clipping threshold 0.4287362090811313
a after update for 1 param tensor([[[ 9.177e-03],
         [ 4.453e-02],
         [-1.812e-02],
         [ 3.191e-03],
         [-5.583e-03],
         [ 2.381e-03],
         [ 3.404e-02],
         [ 7.935e-03],
         [ 1.171e-02],
         [ 1.349e-02]],

        [[-1.878e-02],
         [ 9.151e-03],
         [-5.108e-03],
         [-7.757e-03],
         [-4.185e-03],
         [ 3.049e-02],
         [-6.491e-03],
         [ 1.549e-02],
         [-2.531e-02],
         [ 1.525e-02]],

        [[ 1.209e-02],
         [-2.679e-03],
         [-1.442e-02],
         [-2.886e-02],
         [ 3.052e-02],
         [ 2.503e-02],
         [-3.580e-02],
         [ 1.510e-02],
         [ 9.283e-04],
         [ 3.617e-02]],

        [[-1.881e-02],
         [ 2.900e-02],
         [-8.420e-03],
         [ 4.251e-02],
         [ 7.591e-04],
         [-4.685e-03],
         [ 7.003e-03],
         [-1.379e-02],
         [ 2.148e-03],
         [-1.263e-03]],

        [[-3.240e-02],
         [ 3.346e-02],
         [-1.203e-02],
         [ 3.128e-03],
         [ 2.771e-02],
         [ 8.923e-03],
         [-2.663e-02],
         [ 1.017e-02],
         [-7.179e-03],
         [ 9.293e-03]],

        [[-1.072e-02],
         [-8.675e-03],
         [ 2.413e-02],
         [ 1.552e-02],
         [-1.427e-02],
         [ 9.796e-03],
         [-1.590e-02],
         [ 1.838e-03],
         [ 2.224e-02],
         [-1.929e-02]],

        [[ 2.512e-02],
         [-2.934e-02],
         [-2.291e-03],
         [-4.083e-03],
         [-1.878e-02],
         [-3.579e-02],
         [ 1.291e-04],
         [ 2.323e-02],
         [-1.671e-02],
         [ 6.432e-04]],

        [[ 1.193e-02],
         [ 5.422e-03],
         [-2.060e-02],
         [ 7.985e-03],
         [ 8.230e-03],
         [-1.922e-02],
         [-4.942e-03],
         [ 4.863e-03],
         [-3.529e-03],
         [ 3.624e-03]],

        [[-1.402e-02],
         [-1.540e-03],
         [ 2.935e-03],
         [ 1.140e-02],
         [-8.612e-03],
         [-1.517e-03],
         [-1.207e-02],
         [ 9.328e-04],
         [ 1.732e-02],
         [ 1.007e-02]],

        [[-2.624e-02],
         [-2.013e-03],
         [ 4.142e-04],
         [ 1.306e-02],
         [-6.091e-03],
         [-1.689e-02],
         [-7.872e-03],
         [ 4.136e-03],
         [-1.678e-02],
         [ 3.159e-02]],

        [[ 4.819e-03],
         [ 2.853e-02],
         [ 1.719e-02],
         [ 3.840e-05],
         [-2.456e-02],
         [-4.771e-02],
         [-2.261e-02],
         [-2.972e-02],
         [ 4.995e-03],
         [ 1.008e-02]],

        [[-2.646e-02],
         [ 2.368e-02],
         [ 9.692e-03],
         [ 4.883e-03],
         [-3.237e-02],
         [-2.855e-02],
         [-2.410e-03],
         [-2.478e-02],
         [ 2.082e-04],
         [ 4.831e-03]]], device='cuda:0')
s after update for 1 param tensor([[[0.525],
         [0.505],
         [1.082],
         [0.526],
         [0.529],
         [0.529],
         [0.670],
         [0.869],
         [1.366],
         [0.577]],

        [[0.503],
         [0.666],
         [0.711],
         [1.148],
         [0.887],
         [0.744],
         [0.849],
         [0.398],
         [0.937],
         [0.760]],

        [[0.475],
         [0.760],
         [0.812],
         [1.043],
         [0.738],
         [0.667],
         [0.846],
         [0.621],
         [0.800],
         [0.718]],

        [[0.907],
         [0.696],
         [0.771],
         [0.950],
         [1.197],
         [1.135],
         [0.751],
         [0.209],
         [0.674],
         [0.545]],

        [[0.758],
         [0.934],
         [0.893],
         [0.876],
         [0.580],
         [0.582],
         [0.795],
         [0.480],
         [0.810],
         [0.434]],

        [[0.751],
         [0.373],
         [0.640],
         [0.649],
         [0.711],
         [0.874],
         [0.749],
         [0.925],
         [0.763],
         [0.905]],

        [[0.877],
         [0.605],
         [1.114],
         [1.306],
         [0.880],
         [0.746],
         [0.465],
         [0.782],
         [0.526],
         [0.563]],

        [[0.708],
         [0.676],
         [0.581],
         [0.697],
         [0.432],
         [0.531],
         [0.474],
         [0.525],
         [0.742],
         [0.561]],

        [[0.626],
         [0.420],
         [0.331],
         [0.338],
         [1.000],
         [0.554],
         [0.608],
         [0.540],
         [0.472],
         [0.864]],

        [[0.663],
         [0.868],
         [0.500],
         [1.291],
         [0.561],
         [0.598],
         [0.818],
         [0.925],
         [0.666],
         [0.672]],

        [[1.125],
         [0.623],
         [0.612],
         [0.940],
         [0.989],
         [0.448],
         [0.695],
         [0.848],
         [0.892],
         [0.867]],

        [[1.200],
         [0.836],
         [0.601],
         [0.478],
         [0.825],
         [1.367],
         [0.529],
         [0.591],
         [1.039],
         [1.060]]], device='cuda:0')
b after update for 1 param tensor([[[26.178],
         [25.678],
         [37.570],
         [26.201],
         [26.275],
         [26.264],
         [29.559],
         [33.665],
         [42.210],
         [27.441]],

        [[25.627],
         [29.479],
         [30.453],
         [38.691],
         [34.013],
         [31.161],
         [33.271],
         [22.791],
         [34.963],
         [31.494]],

        [[24.898],
         [31.491],
         [32.552],
         [36.880],
         [31.021],
         [29.505],
         [33.213],
         [28.473],
         [32.306],
         [30.604]],

        [[34.394],
         [30.138],
         [31.717],
         [35.195],
         [39.523],
         [38.472],
         [31.304],
         [16.523],
         [29.644],
         [26.671]],

        [[31.454],
         [34.910],
         [34.121],
         [33.809],
         [27.515],
         [27.549],
         [32.208],
         [25.026],
         [32.504],
         [23.806]],

        [[31.307],
         [22.048],
         [28.892],
         [29.101],
         [30.461],
         [33.769],
         [31.257],
         [34.734],
         [31.543],
         [34.362]],

        [[33.831],
         [28.083],
         [38.123],
         [41.281],
         [33.881],
         [31.189],
         [24.636],
         [31.945],
         [26.187],
         [27.106]],

        [[30.392],
         [29.689],
         [27.537],
         [30.159],
         [23.726],
         [26.320],
         [24.866],
         [26.172],
         [31.107],
         [27.063]],

        [[28.584],
         [23.412],
         [20.780],
         [20.987],
         [36.115],
         [26.891],
         [28.161],
         [26.546],
         [24.807],
         [33.567]],

        [[29.412],
         [33.646],
         [25.541],
         [41.032],
         [27.053],
         [27.935],
         [32.658],
         [34.741],
         [29.475],
         [29.610]],

        [[38.307],
         [28.498],
         [28.249],
         [35.015],
         [35.926],
         [24.179],
         [30.104],
         [33.268],
         [34.119],
         [33.627]],

        [[39.572],
         [33.030],
         [28.003],
         [24.960],
         [32.806],
         [42.226],
         [26.260],
         [27.754],
         [36.817],
         [37.192]]], device='cuda:0')
clipping threshold 0.4287362090811313
a after update for 1 param tensor([[ 0.036],
        [-0.015],
        [-0.022],
        [-0.006],
        [-0.026],
        [-0.004],
        [ 0.007],
        [-0.011],
        [-0.005],
        [-0.015],
        [-0.001],
        [-0.004]], device='cuda:0')
s after update for 1 param tensor([[1.338],
        [1.070],
        [1.272],
        [1.010],
        [1.458],
        [0.949],
        [1.072],
        [1.406],
        [0.579],
        [0.854],
        [0.777],
        [1.423]], device='cuda:0')
b after update for 1 param tensor([[41.783],
        [37.351],
        [40.737],
        [36.304],
        [43.617],
        [35.183],
        [37.403],
        [42.824],
        [27.479],
        [33.377],
        [31.837],
        [43.079]], device='cuda:0')
clipping threshold 0.4287362090811313
||w||^2 0.5058628608373952
exp ma of ||w||^2 0.5341487289036663
||w|| 0.7112403678345284
exp ma of ||w|| 0.6842438785298558
||w||^2 0.7962572036729814
exp ma of ||w||^2 0.4670960554933563
||w|| 0.892332451316762
exp ma of ||w|| 0.6404122229768046
||w||^2 0.1497720539877468
exp ma of ||w||^2 0.4570499881738697
||w|| 0.3870039457004887
exp ma of ||w|| 0.6290270936064347
||w||^2 0.6726136901364185
exp ma of ||w||^2 0.48277418439014025
||w|| 0.8201302885130012
exp ma of ||w|| 0.6516342823560904
||w||^2 0.5222369366131645
exp ma of ||w||^2 0.43263281742646287
||w|| 0.7226596270812176
exp ma of ||w|| 0.6211319211128745
||w||^2 0.49760800214977297
exp ma of ||w||^2 0.43058876086324627
||w|| 0.7054133555226842
exp ma of ||w|| 0.6167588290079475
||w||^2 0.6056397545798953
exp ma of ||w||^2 0.435937320055701
||w|| 0.7782286004638324
exp ma of ||w|| 0.6243443206776951
cuda
Objective function 10.48 = squared loss an data 9.47 + 0.5*rho*h**2 0.133428 + alpha*h 0.132852 + L2reg 0.70 + L1reg 0.05 ; SHD = 14 ; DAG True
Proportion of microbatches that were clipped  0.7662316995544239
iteration 2 in inner loop, alpha 25.71759315338091 rho 10000.0 h 0.005165808446598419
iteration 4 in outer loop, alpha = 77.37567761936509, rho = 10000.0, h = 0.005165808446598419
cuda
1692
cuda
Objective function 10.75 = squared loss an data 9.47 + 0.5*rho*h**2 0.133428 + alpha*h 0.399708 + L2reg 0.70 + L1reg 0.05 ; SHD = 14 ; DAG True
||w||^2 889557876.9875193
exp ma of ||w||^2 6699810585.694203
||w|| 29825.456861337752
exp ma of ||w|| 56372.013375244795
||w||^2 0.408383465797544
exp ma of ||w||^2 36319.71233707246
||w|| 0.6390488759066429
exp ma of ||w|| 2.188433277272216
||w||^2 0.20477335307546451
exp ma of ||w||^2 0.45836471437647847
||w|| 0.4525188980313027
exp ma of ||w|| 0.635191201454216
||w||^2 0.16182754365205393
exp ma of ||w||^2 0.4712533032118848
||w|| 0.4022779432830663
exp ma of ||w|| 0.6431122897961193
||w||^2 0.6157084145072717
exp ma of ||w||^2 0.40889035413113056
||w|| 0.7846708956672674
exp ma of ||w|| 0.6022768515758137
v before min max tensor([[ 2.991e+01, -8.267e-01, -3.745e-01,  ...,  2.208e-02,  8.006e-01,
         -2.859e-01],
        [-8.945e-01,  3.657e-01,  4.033e+00,  ..., -4.337e-01,  5.869e-02,
         -5.715e-01],
        [-1.692e+00,  6.361e-01, -3.984e-01,  ..., -9.403e-01, -6.116e-01,
         -2.416e-01],
        ...,
        [-7.247e-01, -2.788e-01, -1.224e-03,  ...,  6.057e-01, -9.043e-01,
          5.405e+00],
        [-2.752e-01,  3.062e-01, -7.821e-01,  ..., -2.455e-01,  3.019e-01,
         -1.249e+00],
        [-6.080e-01, -5.817e-01, -2.538e-01,  ...,  2.228e-01, -4.393e-01,
          8.711e+00]], device='cuda:0')
v tensor([[1.000e+01, 1.000e-12, 1.000e-12,  ..., 2.208e-02, 8.006e-01,
         1.000e-12],
        [1.000e-12, 3.657e-01, 4.033e+00,  ..., 1.000e-12, 5.869e-02,
         1.000e-12],
        [1.000e-12, 6.361e-01, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        ...,
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 6.057e-01, 1.000e-12,
         5.405e+00],
        [1.000e-12, 3.062e-01, 1.000e-12,  ..., 1.000e-12, 3.019e-01,
         1.000e-12],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 2.228e-01, 1.000e-12,
         8.711e+00]], device='cuda:0')
v before min max tensor([-1.044, -0.098, -0.540,  0.501,  1.234, -0.798, -0.215, -0.287,  1.022,
        -0.033, -0.575,  0.042, -0.515, -0.851, -0.380,  0.028, -1.271, -0.270,
         0.528, -0.298,  1.156, -0.193,  2.524,  0.946,  0.509,  0.289, -0.471,
         1.744, -0.016,  0.060, -0.783, -1.106,  5.285, -0.907, -0.555, -0.479,
        -0.860,  0.275, -0.479, -0.844, -1.004, -1.034, -0.700,  1.075, -0.848,
        -0.718, -0.360, -0.726, -0.620, -0.564, -0.124, -0.656, -0.812, -0.734,
        -0.351,  0.592,  0.321,  1.436,  0.390, -0.030, -0.247, -0.340,  0.446,
        -1.291, -0.505, -0.029, -0.009, -0.254, -0.580, -0.727, -0.236, -1.233,
         1.563,  1.675,  1.688, -0.334, -0.815, -0.268,  0.748,  0.094, -0.829,
        -0.537, -0.737, -0.385, -0.743, -0.031,  0.655, -0.294,  0.095, -1.047,
         0.513, -0.834, -1.264, -0.840,  1.446, -0.305, -0.392,  0.635,  0.018,
         1.257, -0.490, -0.508, -0.644, -0.740,  0.226,  1.173, -0.488,  4.123,
         0.639, -0.647,  2.408, -0.748, -0.598, -1.074, -0.442, -0.439,  0.877,
         0.869,  0.638, -0.346], device='cuda:0')
v tensor([1.000e-12, 1.000e-12, 1.000e-12, 5.006e-01, 1.234e+00, 1.000e-12,
        1.000e-12, 1.000e-12, 1.022e+00, 1.000e-12, 1.000e-12, 4.228e-02,
        1.000e-12, 1.000e-12, 1.000e-12, 2.772e-02, 1.000e-12, 1.000e-12,
        5.284e-01, 1.000e-12, 1.156e+00, 1.000e-12, 2.524e+00, 9.464e-01,
        5.092e-01, 2.893e-01, 1.000e-12, 1.744e+00, 1.000e-12, 6.005e-02,
        1.000e-12, 1.000e-12, 5.285e+00, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 2.746e-01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.075e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 5.917e-01, 3.214e-01, 1.436e+00, 3.903e-01, 1.000e-12,
        1.000e-12, 1.000e-12, 4.460e-01, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.563e+00, 1.675e+00, 1.688e+00, 1.000e-12, 1.000e-12, 1.000e-12,
        7.481e-01, 9.438e-02, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 6.546e-01, 1.000e-12, 9.507e-02, 1.000e-12,
        5.132e-01, 1.000e-12, 1.000e-12, 1.000e-12, 1.446e+00, 1.000e-12,
        1.000e-12, 6.346e-01, 1.808e-02, 1.257e+00, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 2.264e-01, 1.173e+00, 1.000e-12, 4.123e+00,
        6.389e-01, 1.000e-12, 2.408e+00, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 8.770e-01, 8.686e-01, 6.380e-01, 1.000e-12],
       device='cuda:0')
v before min max tensor([[[-0.267],
         [ 4.595],
         [ 0.910],
         [-0.851],
         [-0.192],
         [-0.061],
         [ 0.681],
         [ 0.174],
         [ 0.216],
         [ 0.601]],

        [[-0.337],
         [-1.128],
         [-0.271],
         [-1.050],
         [-0.656],
         [-0.388],
         [-1.291],
         [-0.175],
         [-0.587],
         [ 0.237]],

        [[ 3.013],
         [ 0.027],
         [-0.911],
         [ 0.399],
         [-0.897],
         [ 0.677],
         [ 3.580],
         [-0.436],
         [-0.161],
         [ 7.951]],

        [[-1.084],
         [-1.365],
         [-0.523],
         [ 1.903],
         [ 0.383],
         [-1.250],
         [ 1.042],
         [ 0.135],
         [-0.038],
         [ 1.839]],

        [[ 2.635],
         [-1.238],
         [ 3.606],
         [-0.966],
         [-0.376],
         [-1.051],
         [ 3.128],
         [-0.262],
         [ 0.421],
         [-1.213]],

        [[-0.876],
         [ 0.142],
         [-0.352],
         [-1.619],
         [-0.048],
         [-0.921],
         [-0.413],
         [ 2.415],
         [-0.969],
         [-0.506]],

        [[-0.567],
         [ 3.679],
         [-0.640],
         [ 2.023],
         [ 0.653],
         [-0.679],
         [ 1.697],
         [ 0.046],
         [ 1.716],
         [-1.242]],

        [[-0.365],
         [-0.966],
         [-0.803],
         [ 1.597],
         [-0.820],
         [-0.389],
         [-0.909],
         [ 0.307],
         [-0.080],
         [-1.112]],

        [[-0.564],
         [-0.319],
         [-0.423],
         [ 0.383],
         [-0.842],
         [-0.365],
         [-0.501],
         [-0.319],
         [-0.207],
         [-1.347]],

        [[-0.850],
         [-0.677],
         [-0.993],
         [ 3.677],
         [-0.711],
         [-1.248],
         [ 0.221],
         [ 1.539],
         [-0.046],
         [-0.985]],

        [[-1.241],
         [-0.131],
         [-0.911],
         [-0.948],
         [ 0.441],
         [-0.548],
         [-0.911],
         [ 0.948],
         [-0.200],
         [-0.751]],

        [[ 0.028],
         [ 0.729],
         [-0.683],
         [-0.904],
         [-1.130],
         [-1.694],
         [ 1.497],
         [-1.584],
         [ 2.116],
         [-0.938]]], device='cuda:0')
v tensor([[[1.000e-12],
         [4.595e+00],
         [9.099e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [6.806e-01],
         [1.745e-01],
         [2.162e-01],
         [6.007e-01]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.370e-01]],

        [[3.013e+00],
         [2.650e-02],
         [1.000e-12],
         [3.990e-01],
         [1.000e-12],
         [6.772e-01],
         [3.580e+00],
         [1.000e-12],
         [1.000e-12],
         [7.951e+00]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.903e+00],
         [3.831e-01],
         [1.000e-12],
         [1.042e+00],
         [1.347e-01],
         [1.000e-12],
         [1.839e+00]],

        [[2.635e+00],
         [1.000e-12],
         [3.606e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [3.128e+00],
         [1.000e-12],
         [4.207e-01],
         [1.000e-12]],

        [[1.000e-12],
         [1.424e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.415e+00],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [3.679e+00],
         [1.000e-12],
         [2.023e+00],
         [6.529e-01],
         [1.000e-12],
         [1.697e+00],
         [4.616e-02],
         [1.716e+00],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.597e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [3.071e-01],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [3.827e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [3.677e+00],
         [1.000e-12],
         [1.000e-12],
         [2.208e-01],
         [1.539e+00],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [4.409e-01],
         [1.000e-12],
         [1.000e-12],
         [9.481e-01],
         [1.000e-12],
         [1.000e-12]],

        [[2.759e-02],
         [7.286e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.497e+00],
         [1.000e-12],
         [2.116e+00],
         [1.000e-12]]], device='cuda:0')
v before min max tensor([[-0.457],
        [-0.417],
        [ 0.589],
        [ 2.157],
        [ 3.050],
        [ 0.444],
        [-1.314],
        [-0.441],
        [ 1.917],
        [-0.993],
        [-0.566],
        [-2.297]], device='cuda:0')
v tensor([[1.000e-12],
        [1.000e-12],
        [5.886e-01],
        [2.157e+00],
        [3.050e+00],
        [4.444e-01],
        [1.000e-12],
        [1.000e-12],
        [1.917e+00],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12]], device='cuda:0')
a after update for 1 param tensor([[-7.976e-03,  4.007e-03, -2.352e-04,  ...,  6.296e-05,  1.224e-02,
          3.962e-03],
        [ 1.157e-02,  1.974e-02,  3.816e-03,  ...,  2.416e-03,  5.357e-03,
          6.228e-04],
        [ 2.033e-03,  1.299e-02,  6.407e-04,  ..., -6.383e-04, -1.017e-02,
          4.843e-06],
        ...,
        [ 3.795e-03,  2.017e-02,  3.573e-03,  ...,  2.090e-03, -4.648e-03,
         -7.644e-03],
        [ 4.447e-03,  1.730e-02, -5.853e-03,  ...,  4.446e-03, -3.010e-03,
          2.798e-03],
        [-3.744e-03,  1.334e-02, -1.242e-02,  ...,  6.680e-03,  1.571e-02,
         -1.651e-03]], device='cuda:0')
s after update for 1 param tensor([[2.073, 0.729, 0.679,  ..., 0.866, 0.868, 0.416],
        [1.616, 0.972, 1.291,  ..., 0.591, 1.201, 0.587],
        [1.843, 0.718, 0.449,  ..., 0.665, 0.423, 0.426],
        ...,
        [0.504, 0.463, 0.329,  ..., 0.375, 0.693, 1.830],
        [0.260, 0.354, 0.545,  ..., 0.855, 0.458, 1.398],
        [0.574, 0.566, 0.906,  ..., 0.298, 0.316, 1.945]], device='cuda:0')
b after update for 1 param tensor([[50.973, 30.230, 29.176,  ..., 32.952, 32.978, 22.840],
        [45.000, 34.896, 40.219,  ..., 27.223, 38.800, 27.118],
        [48.060, 29.997, 23.715,  ..., 28.861, 23.030, 23.093],
        ...,
        [25.127, 24.088, 20.301,  ..., 21.672, 29.462, 47.891],
        [18.035, 21.073, 26.127,  ..., 32.740, 23.960, 41.854],
        [26.826, 26.639, 33.696,  ..., 19.313, 19.889, 49.375]],
       device='cuda:0')
clipping threshold 0.4653913589149573
a after update for 1 param tensor([-3.581e-03, -9.441e-03,  8.931e-03, -1.838e-02,  1.864e-03,  6.488e-04,
        -6.797e-03, -1.217e-02,  1.451e-02,  5.817e-03, -2.389e-02,  1.840e-02,
         9.666e-03, -5.914e-03,  2.099e-02,  5.276e-03, -1.210e-02,  3.701e-02,
         2.609e-02, -1.912e-02,  5.914e-03, -4.903e-03,  1.003e-02,  9.934e-03,
        -1.358e-02, -1.831e-02,  3.249e-06,  7.938e-03, -1.404e-02,  8.979e-04,
        -1.287e-02, -5.623e-03, -6.735e-04,  9.583e-03,  2.610e-03, -1.323e-02,
         1.427e-03,  4.128e-03,  1.049e-03, -2.424e-03, -4.459e-03,  5.876e-03,
        -1.495e-03, -6.545e-04,  1.023e-02, -6.068e-03,  3.636e-03,  2.743e-02,
        -2.596e-03,  3.378e-03,  9.121e-03, -5.193e-03,  6.000e-03, -3.902e-03,
         8.184e-03, -9.324e-03, -1.705e-02, -7.234e-03,  2.967e-04, -3.369e-02,
        -1.813e-02, -3.009e-03,  1.170e-02,  3.055e-03,  2.539e-02,  1.175e-02,
        -1.032e-04,  1.030e-02,  2.994e-02, -9.799e-04,  5.797e-03,  1.180e-02,
         1.851e-02,  1.746e-02, -5.253e-04,  1.238e-02, -4.913e-03,  6.282e-03,
        -1.346e-02, -3.567e-04,  1.056e-02, -5.212e-03,  2.341e-03, -7.678e-03,
        -2.110e-02,  2.665e-02,  7.344e-03, -3.154e-03,  4.831e-03,  1.334e-02,
         1.301e-04, -1.507e-02, -8.069e-03, -7.222e-03,  7.985e-03, -2.757e-02,
        -1.465e-02,  1.129e-02, -1.809e-02, -4.035e-03, -3.963e-03,  2.006e-03,
         2.151e-03, -1.780e-03, -1.836e-02,  1.559e-03, -1.317e-03, -7.956e-03,
         8.886e-03, -1.862e-02, -8.953e-03, -1.206e-03, -5.527e-03,  5.812e-03,
         1.845e-03,  1.226e-02, -1.412e-02,  8.169e-03,  2.432e-02,  7.537e-03],
       device='cuda:0')
s after update for 1 param tensor([0.753, 0.686, 0.375, 0.554, 0.719, 0.562, 0.179, 0.285, 0.587, 0.480,
        0.410, 0.294, 0.424, 0.592, 0.403, 0.663, 0.955, 0.280, 0.608, 0.319,
        0.517, 0.428, 0.944, 0.488, 0.459, 0.835, 0.467, 0.627, 0.377, 0.173,
        0.600, 1.055, 0.961, 0.629, 0.556, 0.435, 0.662, 0.723, 0.471, 0.607,
        0.697, 0.748, 0.520, 0.721, 0.588, 0.550, 0.386, 0.594, 0.432, 0.476,
        0.465, 0.455, 0.615, 0.508, 0.245, 0.439, 0.398, 0.595, 0.499, 0.305,
        0.457, 0.257, 0.454, 1.001, 0.424, 0.447, 0.366, 0.628, 0.478, 0.560,
        0.327, 0.998, 0.573, 0.820, 0.709, 0.239, 0.674, 0.433, 0.494, 0.461,
        0.778, 0.495, 0.524, 0.267, 0.546, 0.674, 0.542, 0.462, 0.365, 0.742,
        0.479, 0.688, 0.897, 0.704, 0.651, 0.331, 0.672, 0.612, 0.413, 0.701,
        0.413, 0.515, 0.446, 0.580, 0.420, 0.636, 0.340, 0.981, 0.555, 0.456,
        0.881, 0.639, 0.704, 0.753, 0.364, 0.329, 0.438, 0.494, 0.399, 0.298],
       device='cuda:0')
b after update for 1 param tensor([30.728, 29.325, 21.666, 26.340, 30.023, 26.537, 14.958, 18.914, 27.133,
        24.514, 22.668, 19.190, 23.042, 27.246, 22.474, 28.817, 34.597, 18.736,
        27.608, 20.001, 25.463, 23.150, 34.403, 24.730, 23.992, 32.349, 24.191,
        28.028, 21.730, 14.732, 27.420, 36.360, 34.706, 28.076, 26.388, 23.342,
        28.794, 30.096, 24.293, 27.572, 29.564, 30.611, 25.534, 30.058, 27.143,
        26.258, 22.005, 27.275, 23.268, 24.426, 24.129, 23.869, 27.759, 25.243,
        17.515, 23.458, 22.334, 27.299, 25.001, 19.560, 23.923, 17.949, 23.863,
        35.410, 23.050, 23.681, 21.423, 28.064, 24.467, 26.502, 20.242, 35.372,
        26.790, 32.051, 29.805, 17.320, 29.059, 23.288, 24.871, 24.045, 31.223,
        24.902, 25.635, 18.292, 26.154, 29.063, 26.070, 24.058, 21.381, 30.493,
        24.506, 29.353, 33.523, 29.705, 28.573, 20.363, 29.025, 27.691, 22.752,
        29.629, 22.743, 25.416, 23.647, 26.964, 22.946, 28.222, 20.639, 35.064,
        26.368, 23.912, 33.220, 28.288, 29.713, 30.715, 21.344, 20.294, 23.428,
        24.879, 22.360, 19.331], device='cuda:0')
clipping threshold 0.4653913589149573
a after update for 1 param tensor([[[-0.010],
         [ 0.010],
         [-0.011],
         [ 0.018],
         [ 0.015],
         [-0.003],
         [-0.026],
         [-0.005],
         [ 0.022],
         [ 0.001]],

        [[-0.001],
         [ 0.012],
         [ 0.005],
         [ 0.005],
         [-0.002],
         [-0.009],
         [ 0.011],
         [ 0.025],
         [-0.044],
         [-0.026]],

        [[ 0.001],
         [-0.018],
         [-0.014],
         [ 0.012],
         [-0.021],
         [ 0.037],
         [ 0.001],
         [ 0.027],
         [-0.035],
         [ 0.015]],

        [[-0.019],
         [ 0.045],
         [-0.013],
         [ 0.001],
         [-0.009],
         [ 0.019],
         [ 0.001],
         [-0.007],
         [-0.013],
         [-0.002]],

        [[ 0.001],
         [-0.017],
         [ 0.009],
         [-0.019],
         [ 0.001],
         [ 0.012],
         [ 0.008],
         [ 0.043],
         [-0.008],
         [ 0.009]],

        [[-0.002],
         [-0.023],
         [ 0.012],
         [ 0.020],
         [-0.005],
         [ 0.014],
         [-0.004],
         [ 0.031],
         [ 0.009],
         [-0.009]],

        [[ 0.008],
         [-0.011],
         [-0.019],
         [-0.008],
         [ 0.009],
         [ 0.015],
         [ 0.001],
         [-0.018],
         [ 0.025],
         [ 0.024]],

        [[ 0.002],
         [ 0.009],
         [ 0.016],
         [-0.018],
         [ 0.001],
         [ 0.015],
         [-0.001],
         [ 0.002],
         [ 0.014],
         [ 0.017]],

        [[-0.011],
         [-0.000],
         [ 0.013],
         [ 0.020],
         [ 0.003],
         [-0.011],
         [-0.015],
         [ 0.011],
         [-0.038],
         [-0.009]],

        [[ 0.002],
         [ 0.017],
         [ 0.004],
         [-0.005],
         [-0.011],
         [-0.002],
         [-0.006],
         [-0.011],
         [-0.012],
         [-0.021]],

        [[ 0.009],
         [ 0.042],
         [ 0.035],
         [-0.011],
         [ 0.009],
         [ 0.002],
         [ 0.002],
         [ 0.026],
         [-0.020],
         [-0.017]],

        [[-0.020],
         [-0.025],
         [ 0.009],
         [ 0.008],
         [ 0.011],
         [ 0.007],
         [ 0.007],
         [ 0.021],
         [-0.010],
         [ 0.001]]], device='cuda:0')
s after update for 1 param tensor([[[0.569],
         [0.810],
         [0.861],
         [0.722],
         [0.567],
         [0.460],
         [0.700],
         [0.886],
         [0.562],
         [0.751]],

        [[0.556],
         [0.795],
         [0.687],
         [0.774],
         [0.594],
         [0.349],
         [0.953],
         [0.498],
         [1.267],
         [0.974]],

        [[0.696],
         [0.665],
         [0.658],
         [0.558],
         [0.799],
         [0.894],
         [0.870],
         [0.568],
         [0.702],
         [1.131]],

        [[0.770],
         [1.019],
         [0.466],
         [0.744],
         [0.410],
         [0.894],
         [1.034],
         [0.659],
         [1.002],
         [0.680]],

        [[0.671],
         [0.979],
         [0.800],
         [0.676],
         [0.402],
         [0.756],
         [0.807],
         [0.815],
         [0.534],
         [0.865]],

        [[0.670],
         [0.852],
         [0.547],
         [1.254],
         [0.595],
         [0.684],
         [0.909],
         [0.753],
         [0.946],
         [0.627]],

        [[0.551],
         [1.035],
         [0.970],
         [0.914],
         [0.696],
         [0.861],
         [0.638],
         [0.536],
         [0.959],
         [0.904]],

        [[0.953],
         [0.674],
         [0.561],
         [0.716],
         [0.891],
         [0.402],
         [1.008],
         [0.432],
         [0.980],
         [0.792]],

        [[0.392],
         [0.740],
         [0.408],
         [0.411],
         [0.583],
         [0.571],
         [0.836],
         [0.617],
         [0.861],
         [1.082]],

        [[0.611],
         [0.840],
         [0.708],
         [0.837],
         [0.634],
         [0.864],
         [0.732],
         [0.955],
         [0.918],
         [0.818]],

        [[0.913],
         [0.518],
         [0.653],
         [0.734],
         [0.536],
         [0.595],
         [0.687],
         [0.895],
         [0.548],
         [0.732]],

        [[0.976],
         [0.821],
         [0.682],
         [0.659],
         [0.953],
         [1.175],
         [0.808],
         [1.096],
         [0.839],
         [0.653]]], device='cuda:0')
b after update for 1 param tensor([[[26.704],
         [31.854],
         [32.847],
         [30.089],
         [26.654],
         [24.014],
         [29.615],
         [33.317],
         [26.527],
         [30.685]],

        [[26.390],
         [31.567],
         [29.343],
         [31.143],
         [27.273],
         [20.926],
         [34.551],
         [24.975],
         [39.842],
         [34.930]],

        [[29.537],
         [28.863],
         [28.710],
         [26.444],
         [31.645],
         [33.479],
         [33.016],
         [26.668],
         [29.654],
         [37.650]],

        [[31.057],
         [35.732],
         [24.154],
         [30.531],
         [22.667],
         [33.467],
         [35.991],
         [28.741],
         [35.444],
         [29.201]],

        [[28.993],
         [35.030],
         [31.660],
         [29.108],
         [22.434],
         [30.774],
         [31.795],
         [31.959],
         [25.865],
         [32.921]],

        [[28.985],
         [32.667],
         [26.191],
         [39.644],
         [27.314],
         [29.285],
         [33.754],
         [30.718],
         [34.423],
         [28.034]],

        [[26.283],
         [36.015],
         [34.869],
         [33.841],
         [29.543],
         [32.842],
         [28.283],
         [25.911],
         [34.670],
         [33.658]],

        [[34.561],
         [29.066],
         [26.520],
         [29.954],
         [33.407],
         [22.447],
         [35.534],
         [23.255],
         [35.037],
         [31.504]],

        [[22.163],
         [30.455],
         [22.604],
         [22.699],
         [27.020],
         [26.757],
         [32.375],
         [27.809],
         [32.842],
         [36.818]],

        [[27.681],
         [32.442],
         [29.782],
         [32.388],
         [28.190],
         [32.904],
         [30.297],
         [34.603],
         [33.919],
         [32.016]],

        [[33.817],
         [25.490],
         [28.611],
         [30.319],
         [25.926],
         [27.300],
         [29.352],
         [33.495],
         [26.216],
         [30.279]],

        [[34.964],
         [32.075],
         [29.235],
         [28.747],
         [34.559],
         [38.375],
         [31.829],
         [37.067],
         [32.418],
         [28.614]]], device='cuda:0')
clipping threshold 0.4653913589149573
a after update for 1 param tensor([[-0.004],
        [-0.013],
        [-0.005],
        [-0.006],
        [-0.010],
        [-0.030],
        [-0.001],
        [-0.044],
        [-0.013],
        [ 0.011],
        [ 0.018],
        [ 0.006]], device='cuda:0')
s after update for 1 param tensor([[0.694],
        [0.902],
        [1.217],
        [1.028],
        [0.908],
        [1.447],
        [0.909],
        [1.329],
        [1.027],
        [0.833],
        [0.632],
        [1.591]], device='cuda:0')
b after update for 1 param tensor([[29.487],
        [33.622],
        [39.050],
        [35.888],
        [33.729],
        [42.587],
        [33.758],
        [40.804],
        [35.882],
        [32.310],
        [28.133],
        [44.653]], device='cuda:0')
clipping threshold 0.4653913589149573
||w||^2 0.17563855370331424
exp ma of ||w||^2 0.47016834183281514
||w|| 0.41909253596707524
exp ma of ||w|| 0.6356162557572492
||w||^2 0.11064675448513026
exp ma of ||w||^2 0.4428635322387801
||w|| 0.3326360691283046
exp ma of ||w|| 0.6282391269237455
v before min max tensor([[ 6.939e+00, -2.950e-01,  3.030e+00,  ..., -1.060e+00,  8.150e-01,
         -4.332e-01],
        [ 3.764e+01,  1.644e+00,  2.551e+00,  ...,  3.498e-01, -1.665e-01,
         -1.104e+00],
        [ 3.263e+00, -1.850e-01, -1.227e-01,  ..., -3.944e-01, -2.501e-01,
         -4.574e-01],
        ...,
        [-1.298e-01, -6.076e-01, -2.131e-01,  ..., -6.845e-01,  1.482e+00,
          1.636e+00],
        [ 2.406e-01,  4.574e-01,  1.998e-02,  ...,  5.923e+00, -1.997e-01,
         -1.038e+00],
        [ 9.240e-01, -4.802e-01, -2.402e-01,  ...,  4.694e-01,  4.449e-01,
         -1.730e+00]], device='cuda:0')
v tensor([[6.939e+00, 1.000e-12, 3.030e+00,  ..., 1.000e-12, 8.150e-01,
         1.000e-12],
        [1.000e+01, 1.644e+00, 2.551e+00,  ..., 3.498e-01, 1.000e-12,
         1.000e-12],
        [3.263e+00, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        ...,
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.482e+00,
         1.636e+00],
        [2.406e-01, 4.574e-01, 1.998e-02,  ..., 5.923e+00, 1.000e-12,
         1.000e-12],
        [9.240e-01, 1.000e-12, 1.000e-12,  ..., 4.694e-01, 4.449e-01,
         1.000e-12]], device='cuda:0')
v before min max tensor([ 4.165, -0.448, -0.414,  0.866, -0.580, -0.073, -0.232, -0.350,  2.392,
        -0.420,  0.359, -0.528, -0.363, -0.110,  0.015, -0.550,  0.649,  0.913,
        -0.683,  0.488, -0.381,  0.276, -0.528,  3.132,  0.159, -0.263,  0.395,
        -0.539, -0.297, -0.364, -0.249,  3.317,  0.949, -0.628, -0.257, -0.608,
        -0.930, -0.730,  1.812, -0.211, -0.736,  1.153, -0.115,  2.441,  2.828,
        -1.040,  0.336,  0.261,  5.443,  0.517, -0.470,  2.100, -0.462, -0.055,
         0.103,  0.022, -0.492, -0.510,  0.181,  0.742, -0.572, -0.409, -0.814,
        -0.482,  2.995, -0.405, -0.163,  0.491,  6.298, -0.395, -0.476, -0.345,
         1.424, -0.754,  0.320, -0.157, -0.422,  0.976, -0.444, -0.291, -0.382,
        -0.266, -0.287,  0.119,  0.400, -0.988,  0.509, -0.951,  0.282,  0.348,
         0.115,  5.179,  0.147,  1.140, -0.163, -0.559, -1.154, -0.699, -0.114,
         1.373, -0.730, -0.041,  1.019, -0.589,  0.272, -0.086,  0.208,  1.768,
        -0.472,  2.731,  0.018, -0.648, -0.485, -0.431, -0.019, -0.361, -0.291,
        -0.433, -0.895, -0.460], device='cuda:0')
v tensor([4.165e+00, 1.000e-12, 1.000e-12, 8.657e-01, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 2.392e+00, 1.000e-12, 3.590e-01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.530e-02, 1.000e-12, 6.491e-01, 9.132e-01,
        1.000e-12, 4.881e-01, 1.000e-12, 2.758e-01, 1.000e-12, 3.132e+00,
        1.585e-01, 1.000e-12, 3.954e-01, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 3.317e+00, 9.488e-01, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.812e+00, 1.000e-12, 1.000e-12, 1.153e+00,
        1.000e-12, 2.441e+00, 2.828e+00, 1.000e-12, 3.360e-01, 2.608e-01,
        5.443e+00, 5.169e-01, 1.000e-12, 2.100e+00, 1.000e-12, 1.000e-12,
        1.028e-01, 2.167e-02, 1.000e-12, 1.000e-12, 1.806e-01, 7.420e-01,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 2.995e+00, 1.000e-12,
        1.000e-12, 4.912e-01, 6.298e+00, 1.000e-12, 1.000e-12, 1.000e-12,
        1.424e+00, 1.000e-12, 3.205e-01, 1.000e-12, 1.000e-12, 9.755e-01,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.190e-01,
        3.998e-01, 1.000e-12, 5.094e-01, 1.000e-12, 2.819e-01, 3.483e-01,
        1.148e-01, 5.179e+00, 1.466e-01, 1.140e+00, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.373e+00, 1.000e-12, 1.000e-12,
        1.019e+00, 1.000e-12, 2.717e-01, 1.000e-12, 2.084e-01, 1.768e+00,
        1.000e-12, 2.731e+00, 1.777e-02, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12],
       device='cuda:0')
v before min max tensor([[[-0.553],
         [-0.820],
         [-0.650],
         [ 1.742],
         [-0.399],
         [-0.615],
         [ 3.199],
         [ 0.594],
         [-0.631],
         [ 8.975]],

        [[-0.133],
         [-0.983],
         [ 2.714],
         [-0.347],
         [-0.645],
         [-0.515],
         [-0.573],
         [-1.259],
         [-0.355],
         [-0.073]],

        [[ 0.311],
         [-0.980],
         [ 0.154],
         [ 1.223],
         [-0.473],
         [-0.562],
         [ 1.096],
         [-1.171],
         [-0.964],
         [-0.260]],

        [[-0.772],
         [ 6.931],
         [ 0.658],
         [-0.701],
         [-0.602],
         [ 0.735],
         [ 2.947],
         [-1.071],
         [ 3.413],
         [ 1.372]],

        [[ 4.955],
         [-0.714],
         [-1.122],
         [-0.564],
         [-0.748],
         [ 0.018],
         [-0.066],
         [-0.261],
         [-0.530],
         [-0.917]],

        [[ 0.173],
         [-0.320],
         [ 0.188],
         [-0.849],
         [-0.699],
         [-0.796],
         [ 0.457],
         [ 2.387],
         [-0.132],
         [-0.820]],

        [[-0.837],
         [ 0.415],
         [-0.652],
         [-0.724],
         [-0.620],
         [-0.965],
         [-1.361],
         [ 1.046],
         [-0.481],
         [ 0.229]],

        [[ 0.068],
         [ 0.069],
         [-0.171],
         [ 0.973],
         [-0.886],
         [ 2.043],
         [-0.633],
         [ 1.195],
         [-1.127],
         [-0.818]],

        [[-0.682],
         [ 1.217],
         [-0.206],
         [ 2.345],
         [-0.484],
         [-0.578],
         [ 3.799],
         [-0.628],
         [ 6.186],
         [-0.021]],

        [[ 0.065],
         [-0.700],
         [ 2.373],
         [ 0.076],
         [ 1.014],
         [ 2.874],
         [-1.262],
         [-0.455],
         [-0.061],
         [ 0.395]],

        [[ 2.679],
         [-0.452],
         [ 1.003],
         [-0.192],
         [-0.221],
         [ 0.732],
         [-1.002],
         [-0.715],
         [-0.184],
         [ 0.348]],

        [[-1.148],
         [-0.583],
         [-0.736],
         [ 2.612],
         [-0.962],
         [ 0.447],
         [-0.529],
         [-1.289],
         [-0.489],
         [-0.574]]], device='cuda:0')
v tensor([[[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.742e+00],
         [1.000e-12],
         [1.000e-12],
         [3.199e+00],
         [5.941e-01],
         [1.000e-12],
         [8.975e+00]],

        [[1.000e-12],
         [1.000e-12],
         [2.714e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[3.113e-01],
         [1.000e-12],
         [1.543e-01],
         [1.223e+00],
         [1.000e-12],
         [1.000e-12],
         [1.096e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [6.931e+00],
         [6.578e-01],
         [1.000e-12],
         [1.000e-12],
         [7.352e-01],
         [2.947e+00],
         [1.000e-12],
         [3.413e+00],
         [1.372e+00]],

        [[4.955e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.806e-02],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.734e-01],
         [1.000e-12],
         [1.885e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [4.569e-01],
         [2.387e+00],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [4.154e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.046e+00],
         [1.000e-12],
         [2.292e-01]],

        [[6.788e-02],
         [6.899e-02],
         [1.000e-12],
         [9.728e-01],
         [1.000e-12],
         [2.043e+00],
         [1.000e-12],
         [1.195e+00],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.217e+00],
         [1.000e-12],
         [2.345e+00],
         [1.000e-12],
         [1.000e-12],
         [3.799e+00],
         [1.000e-12],
         [6.186e+00],
         [1.000e-12]],

        [[6.463e-02],
         [1.000e-12],
         [2.373e+00],
         [7.629e-02],
         [1.014e+00],
         [2.874e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [3.947e-01]],

        [[2.679e+00],
         [1.000e-12],
         [1.003e+00],
         [1.000e-12],
         [1.000e-12],
         [7.317e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [3.484e-01]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.612e+00],
         [1.000e-12],
         [4.469e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]]], device='cuda:0')
v before min max tensor([[ 2.621],
        [-0.759],
        [ 3.742],
        [-1.054],
        [-0.191],
        [ 1.343],
        [-1.223],
        [ 2.848],
        [-0.196],
        [-0.439],
        [-0.650],
        [ 1.021]], device='cuda:0')
v tensor([[2.621e+00],
        [1.000e-12],
        [3.742e+00],
        [1.000e-12],
        [1.000e-12],
        [1.343e+00],
        [1.000e-12],
        [2.848e+00],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.021e+00]], device='cuda:0')
a after update for 1 param tensor([[ 0.001, -0.010,  0.001,  ..., -0.008,  0.017,  0.001],
        [ 0.015,  0.010, -0.000,  ..., -0.009,  0.005,  0.006],
        [ 0.000,  0.009,  0.001,  ...,  0.000, -0.012, -0.000],
        ...,
        [ 0.003,  0.019, -0.002,  ..., -0.005,  0.009,  0.000],
        [ 0.009,  0.016, -0.007,  ..., -0.014,  0.004, -0.003],
        [-0.001,  0.015, -0.007,  ..., -0.003,  0.009, -0.002]],
       device='cuda:0')
s after update for 1 param tensor([[1.383, 0.583, 1.087,  ..., 0.958, 0.817, 0.753],
        [2.030, 0.896, 0.932,  ..., 0.856, 0.619, 1.242],
        [1.631, 0.596, 0.579,  ..., 0.721, 0.384, 0.408],
        ...,
        [0.513, 0.520, 0.535,  ..., 0.687, 0.758, 1.232],
        [0.392, 0.522, 0.439,  ..., 1.177, 0.204, 1.188],
        [0.647, 0.692, 0.638,  ..., 0.616, 0.341, 1.506]], device='cuda:0')
b after update for 1 param tensor([[43.193, 28.060, 38.297,  ..., 35.951, 33.207, 31.880],
        [52.341, 34.770, 35.468,  ..., 33.989, 28.900, 40.934],
        [46.916, 28.366, 27.962,  ..., 31.196, 22.759, 23.470],
        ...,
        [26.301, 26.495, 26.878,  ..., 30.443, 31.987, 40.780],
        [23.009, 26.532, 24.350,  ..., 39.847, 16.604, 40.038],
        [29.537, 30.561, 29.332,  ..., 28.840, 21.450, 45.073]],
       device='cuda:0')
clipping threshold 0.40527821814083814
a after update for 1 param tensor([ 4.861e-03, -1.358e-02,  1.064e-02, -5.958e-03, -6.470e-04, -1.122e-03,
         6.506e-03, -1.328e-02,  2.021e-02,  7.865e-03, -1.635e-02,  1.874e-02,
         1.528e-02,  1.199e-04,  1.636e-02,  1.157e-02, -1.558e-02,  3.214e-02,
         1.725e-02, -1.339e-02,  1.740e-03, -1.324e-03,  2.540e-03, -9.922e-03,
         9.255e-03, -2.301e-02,  7.334e-04,  7.315e-03, -1.276e-02, -8.310e-03,
        -6.309e-03, -8.456e-03, -1.323e-02,  1.277e-02,  8.817e-04, -4.558e-03,
        -1.053e-02,  9.222e-03,  6.392e-03, -2.905e-03,  2.506e-03,  5.470e-03,
        -3.213e-03,  1.485e-02,  1.694e-02, -1.660e-03, -5.889e-03,  6.984e-03,
        -4.985e-03,  3.143e-03,  9.583e-03, -6.548e-03,  9.156e-03, -1.736e-02,
        -2.343e-03, -4.271e-03, -1.579e-02, -1.047e-02,  1.475e-03, -2.786e-02,
        -1.706e-02, -2.605e-04,  1.573e-02,  3.006e-03,  2.876e-02,  1.421e-02,
        -4.535e-03,  1.096e-02,  9.622e-03,  8.002e-03,  4.977e-03,  3.541e-03,
         1.028e-02,  1.564e-02, -5.938e-03,  6.291e-03, -2.283e-03,  1.092e-02,
        -1.237e-02,  2.253e-03,  9.645e-03, -2.730e-03,  2.744e-03, -1.706e-03,
        -1.742e-02,  6.745e-03,  1.241e-03, -8.891e-03,  3.158e-03, -5.847e-03,
        -2.996e-03, -1.574e-02, -9.850e-03, -9.948e-03,  1.586e-03, -1.340e-02,
        -2.941e-02,  1.486e-02, -1.606e-02, -6.282e-03,  2.605e-03,  1.438e-03,
         1.328e-03, -3.569e-03, -6.673e-03, -3.948e-03,  3.739e-03, -7.395e-03,
        -4.410e-04, -1.656e-02,  7.493e-03, -1.394e-06,  7.399e-03,  5.224e-03,
         7.560e-03, -1.234e-03, -1.489e-03,  2.844e-03,  1.459e-02,  6.320e-03],
       device='cuda:0')
s after update for 1 param tensor([1.088, 0.476, 0.398, 0.414, 0.494, 0.302, 0.441, 0.501, 0.847, 0.409,
        0.466, 0.465, 0.321, 0.528, 0.523, 0.489, 0.570, 0.544, 0.622, 0.678,
        0.335, 0.454, 0.502, 1.165, 0.528, 0.475, 0.514, 0.473, 0.547, 0.691,
        0.338, 0.803, 0.804, 0.535, 0.232, 0.718, 0.836, 0.620, 1.510, 0.730,
        0.629, 0.697, 1.199, 1.189, 0.714, 0.896, 0.545, 0.646, 1.124, 0.344,
        0.719, 0.754, 0.545, 0.307, 0.585, 0.457, 0.467, 0.433, 0.498, 0.468,
        0.617, 0.573, 0.867, 0.413, 1.065, 0.602, 0.255, 0.718, 1.075, 0.451,
        0.444, 0.469, 0.618, 0.705, 0.363, 0.192, 0.429, 0.598, 0.703, 0.253,
        0.402, 0.268, 0.277, 0.534, 0.696, 0.845, 0.507, 0.808, 0.502, 0.933,
        0.804, 1.422, 0.692, 0.758, 0.171, 0.500, 1.069, 0.800, 0.236, 0.687,
        0.835, 0.190, 0.632, 0.976, 0.851, 0.354, 0.373, 0.550, 0.453, 0.717,
        0.615, 0.682, 0.605, 0.461, 0.517, 0.473, 0.364, 0.434, 0.789, 0.451],
       device='cuda:0')
b after update for 1 param tensor([38.318, 25.344, 23.164, 23.633, 25.827, 20.178, 24.381, 25.996, 33.807,
        23.489, 25.085, 25.063, 20.828, 26.693, 26.566, 25.690, 27.745, 27.102,
        28.979, 30.253, 21.263, 24.758, 26.027, 39.656, 26.698, 25.312, 26.343,
        25.271, 27.165, 30.528, 21.343, 32.909, 32.936, 26.871, 17.678, 31.129,
        33.584, 28.926, 45.135, 31.376, 29.125, 30.676, 40.220, 40.060, 31.032,
        34.772, 27.115, 29.523, 38.952, 21.535, 31.144, 31.888, 27.124, 20.358,
        28.095, 24.832, 25.109, 24.182, 25.917, 25.140, 28.846, 27.811, 34.197,
        23.598, 37.912, 28.496, 18.563, 31.127, 38.082, 24.658, 24.477, 25.159,
        28.874, 30.851, 22.125, 16.110, 24.049, 28.410, 30.808, 18.473, 23.282,
        19.033, 19.340, 26.845, 30.649, 33.762, 26.157, 33.014, 26.034, 35.490,
        32.949, 43.802, 30.552, 31.989, 15.209, 25.984, 37.978, 32.848, 17.859,
        30.439, 33.572, 16.022, 29.193, 36.285, 33.892, 21.843, 22.434, 27.233,
        24.714, 31.113, 28.796, 30.342, 28.580, 24.931, 26.404, 25.269, 22.155,
        24.203, 32.623, 24.659], device='cuda:0')
clipping threshold 0.40527821814083814
a after update for 1 param tensor([[[-1.535e-02],
         [-2.020e-03],
         [ 1.278e-03],
         [ 3.247e-02],
         [ 1.852e-02],
         [-6.430e-03],
         [-7.625e-03],
         [-3.431e-03],
         [ 3.048e-02],
         [ 1.853e-02]],

        [[ 4.956e-03],
         [ 1.438e-02],
         [-1.431e-02],
         [ 1.574e-02],
         [-1.839e-02],
         [-7.819e-03],
         [ 7.126e-03],
         [ 3.369e-02],
         [-4.658e-02],
         [-3.124e-03]],

        [[-6.872e-03],
         [-1.288e-02],
         [-1.830e-02],
         [ 2.495e-02],
         [-2.056e-02],
         [ 2.459e-02],
         [-7.890e-03],
         [ 1.177e-02],
         [-1.675e-02],
         [ 1.675e-02]],

        [[-2.331e-02],
         [ 2.458e-02],
         [-1.631e-02],
         [-8.039e-04],
         [-1.223e-02],
         [ 1.246e-02],
         [-2.314e-04],
         [-8.137e-04],
         [ 1.043e-02],
         [-1.886e-02]],

        [[ 4.173e-03],
         [-3.262e-02],
         [ 1.083e-02],
         [-1.427e-02],
         [ 6.548e-04],
         [-9.625e-03],
         [ 4.399e-03],
         [ 4.743e-02],
         [-1.686e-02],
         [-4.454e-03]],

        [[-5.454e-03],
         [-2.209e-02],
         [ 8.245e-03],
         [ 1.618e-02],
         [-5.054e-03],
         [ 6.335e-03],
         [-7.009e-03],
         [ 1.459e-02],
         [ 1.745e-02],
         [-1.502e-02]],

        [[ 6.777e-03],
         [-8.804e-03],
         [-2.779e-02],
         [-2.029e-02],
         [ 7.423e-04],
         [ 1.637e-02],
         [-6.582e-03],
         [-1.848e-02],
         [-5.728e-04],
         [ 5.026e-04]],

        [[-1.148e-02],
         [-4.298e-03],
         [ 2.197e-02],
         [-1.300e-02],
         [-2.935e-03],
         [ 1.425e-02],
         [-4.132e-05],
         [-4.530e-03],
         [ 5.466e-03],
         [ 1.685e-02]],

        [[-5.274e-03],
         [ 1.427e-02],
         [ 8.397e-03],
         [ 2.048e-02],
         [ 3.628e-03],
         [ 1.997e-04],
         [-5.564e-03],
         [ 1.861e-02],
         [-2.820e-02],
         [-1.246e-02]],

        [[ 9.254e-04],
         [ 1.166e-02],
         [-1.173e-03],
         [ 3.769e-03],
         [ 1.085e-03],
         [ 4.785e-03],
         [ 1.133e-03],
         [-4.672e-03],
         [-1.398e-02],
         [-1.232e-02]],

        [[ 1.939e-03],
         [ 4.083e-02],
         [ 2.077e-02],
         [-1.480e-02],
         [ 1.709e-02],
         [-8.526e-03],
         [ 1.277e-02],
         [ 1.990e-02],
         [-9.345e-03],
         [-1.673e-02]],

        [[-1.689e-02],
         [-1.636e-02],
         [ 9.841e-03],
         [ 4.175e-03],
         [ 7.059e-03],
         [ 1.313e-02],
         [-2.355e-03],
         [ 1.254e-02],
         [-8.402e-03],
         [ 1.439e-02]]], device='cuda:0')
s after update for 1 param tensor([[[0.722],
         [0.767],
         [0.558],
         [1.140],
         [0.371],
         [0.703],
         [0.764],
         [0.919],
         [0.728],
         [1.437]],

        [[0.619],
         [0.870],
         [0.902],
         [0.705],
         [0.555],
         [0.456],
         [0.526],
         [1.073],
         [0.543],
         [0.728]],

        [[0.800],
         [0.852],
         [0.670],
         [0.851],
         [0.489],
         [0.610],
         [0.923],
         [0.997],
         [0.884],
         [0.608]],

        [[0.800],
         [1.543],
         [0.843],
         [0.717],
         [0.667],
         [0.587],
         [1.079],
         [0.924],
         [0.935],
         [0.836]],

        [[1.063],
         [0.801],
         [1.068],
         [0.628],
         [0.746],
         [0.791],
         [0.732],
         [1.261],
         [0.497],
         [0.851]],

        [[0.643],
         [0.324],
         [0.507],
         [0.721],
         [0.597],
         [0.678],
         [0.673],
         [1.129],
         [0.698],
         [0.725]],

        [[0.786],
         [1.039],
         [0.698],
         [0.748],
         [0.560],
         [0.823],
         [1.368],
         [0.733],
         [0.422],
         [0.811]],

        [[0.611],
         [0.912],
         [0.388],
         [0.830],
         [0.977],
         [0.843],
         [0.607],
         [0.466],
         [1.126],
         [0.700]],

        [[0.608],
         [0.724],
         [0.719],
         [0.712],
         [0.553],
         [0.848],
         [1.056],
         [0.663],
         [1.125],
         [0.321]],

        [[0.656],
         [0.884],
         [0.932],
         [0.501],
         [0.698],
         [0.984],
         [1.330],
         [0.406],
         [0.907],
         [0.827]],

        [[0.692],
         [0.386],
         [0.713],
         [0.589],
         [0.492],
         [0.755],
         [0.900],
         [0.653],
         [0.500],
         [0.465]],

        [[1.184],
         [0.616],
         [0.625],
         [1.090],
         [0.829],
         [0.739],
         [0.794],
         [1.156],
         [0.579],
         [1.057]]], device='cuda:0')
b after update for 1 param tensor([[[31.216],
         [32.173],
         [27.449],
         [39.217],
         [22.378],
         [30.797],
         [32.103],
         [35.215],
         [31.349],
         [44.037]],

        [[28.908],
         [34.263],
         [34.895],
         [30.855],
         [27.368],
         [24.793],
         [26.631],
         [38.055],
         [27.076],
         [31.351]],

        [[32.864],
         [33.912],
         [30.063],
         [33.887],
         [25.700],
         [28.698],
         [35.293],
         [36.671],
         [34.542],
         [28.634]],

        [[32.857],
         [45.624],
         [33.725],
         [31.114],
         [30.003],
         [28.138],
         [38.158],
         [35.304],
         [35.518],
         [33.592]],

        [[37.870],
         [32.879],
         [37.967],
         [29.101],
         [31.720],
         [32.674],
         [31.432],
         [41.246],
         [25.906],
         [33.893]],

        [[29.467],
         [20.918],
         [26.165],
         [31.199],
         [28.392],
         [30.253],
         [30.139],
         [39.032],
         [30.694],
         [31.273]],

        [[32.577],
         [37.453],
         [30.693],
         [31.769],
         [27.500],
         [33.322],
         [42.968],
         [31.457],
         [23.873],
         [33.084]],

        [[28.716],
         [35.073],
         [22.880],
         [33.459],
         [36.307],
         [33.718],
         [28.627],
         [25.068],
         [38.988],
         [30.742]],

        [[28.636],
         [31.256],
         [31.147],
         [30.990],
         [27.315],
         [33.825],
         [37.741],
         [29.920],
         [38.963],
         [20.815]],

        [[29.745],
         [34.543],
         [35.472],
         [26.000],
         [30.686],
         [36.444],
         [42.360],
         [23.411],
         [34.976],
         [33.410]],

        [[30.557],
         [22.826],
         [31.029],
         [28.187],
         [25.777],
         [31.923],
         [34.852],
         [29.676],
         [25.974],
         [25.052]],

        [[39.968],
         [28.838],
         [29.039],
         [38.344],
         [33.442],
         [31.577],
         [32.740],
         [39.491],
         [27.961],
         [37.776]]], device='cuda:0')
clipping threshold 0.40527821814083814
a after update for 1 param tensor([[ 0.000],
        [-0.012],
        [ 0.004],
        [ 0.004],
        [-0.006],
        [-0.020],
        [ 0.005],
        [-0.027],
        [ 0.001],
        [ 0.027],
        [ 0.001],
        [ 0.007]], device='cuda:0')
s after update for 1 param tensor([[1.155],
        [1.057],
        [1.020],
        [0.990],
        [0.729],
        [0.846],
        [1.155],
        [1.547],
        [0.841],
        [0.811],
        [0.722],
        [1.206]], device='cuda:0')
b after update for 1 param tensor([[39.475],
        [37.765],
        [37.095],
        [36.550],
        [31.361],
        [33.783],
        [39.472],
        [45.694],
        [33.684],
        [33.075],
        [31.214],
        [40.336]], device='cuda:0')
clipping threshold 0.40527821814083814
||w||^2 0.22742285991979563
exp ma of ||w||^2 0.4655222521885252
||w|| 0.47688872907607666
exp ma of ||w|| 0.6437811350126473
||w||^2 0.6868214469024112
exp ma of ||w||^2 0.36657045826490536
||w|| 0.8287469136608662
exp ma of ||w|| 0.5679050143283725
||w||^2 0.3745881316291304
exp ma of ||w||^2 0.4029477565342142
||w|| 0.612036054190544
exp ma of ||w|| 0.5977177691655635
cuda
Objective function 10.53 = squared loss an data 9.54 + 0.5*rho*h**2 0.045882 + alpha*h 0.234392 + L2reg 0.66 + L1reg 0.05 ; SHD = 12 ; DAG True
Proportion of microbatches that were clipped  0.7651454282500402
iteration 1 in inner loop, alpha 77.37567761936509 rho 10000.0 h 0.003029272245729686
1692
cuda
Objective function 10.94 = squared loss an data 9.54 + 0.5*rho*h**2 0.458825 + alpha*h 0.234392 + L2reg 0.66 + L1reg 0.05 ; SHD = 12 ; DAG True
||w||^2 0.0732014386401874
exp ma of ||w||^2 0.297970277191037
||w|| 0.27055764383988007
exp ma of ||w|| 0.4939530096402243
||w||^2 0.12301528025619252
exp ma of ||w||^2 0.4428284723549912
||w|| 0.3507353421829521
exp ma of ||w|| 0.6133103633126278
||w||^2 0.059993148222588
exp ma of ||w||^2 0.41893483182115887
||w|| 0.24493498774692846
exp ma of ||w|| 0.602092917145284
||w||^2 0.2857105109449491
exp ma of ||w||^2 0.408582493352283
||w|| 0.5345189528397932
exp ma of ||w|| 0.6016825377861523
||w||^2 0.22731315633354682
exp ma of ||w||^2 0.39700629612552135
||w|| 0.4767736950939584
exp ma of ||w|| 0.5940200725449818
||w||^2 0.17171332156042937
exp ma of ||w||^2 0.3620628588722607
||w|| 0.41438306138213393
exp ma of ||w|| 0.5669639921889825
||w||^2 0.22258995584066507
exp ma of ||w||^2 0.3754497788079869
||w|| 0.47179439996747
exp ma of ||w|| 0.5723516454417666
||w||^2 0.5610620123890669
exp ma of ||w||^2 0.40967887518006046
||w|| 0.7490407281243571
exp ma of ||w|| 0.6033406555573072
||w||^2 0.163395180111004
exp ma of ||w||^2 0.4091127682084546
||w|| 0.4042216967346063
exp ma of ||w|| 0.6037732359805676
||w||^2 0.5805916154446207
exp ma of ||w||^2 0.4369306938975273
||w|| 0.7619656261568633
exp ma of ||w|| 0.6236558068710027
||w||^2 0.24949365798500764
exp ma of ||w||^2 0.377444532910846
||w|| 0.4994934013428082
exp ma of ||w|| 0.57495057284727
cuda
Objective function 10.47 = squared loss an data 9.59 + 0.5*rho*h**2 0.089587 + alpha*h 0.103572 + L2reg 0.63 + L1reg 0.06 ; SHD = 14 ; DAG True
Proportion of microbatches that were clipped  0.7653815261044177
iteration 2 in inner loop, alpha 77.37567761936509 rho 100000.0 h 0.0013385600211819337
iteration 5 in outer loop, alpha = 1415.9356988012987, rho = 1000000.0, h = 0.0013385600211819337
Threshold 0.3
[[0.003 0.004 0.254 0.025 0.022 0.021 0.098 0.018 0.004 0.088 0.024 0.054]
 [0.769 0.003 0.363 0.221 0.282 0.302 0.237 0.087 0.002 0.607 0.359 0.62 ]
 [0.024 0.014 0.005 0.041 0.165 0.004 0.066 0.009 0.008 0.312 0.024 0.18 ]
 [0.112 0.018 0.068 0.005 0.103 0.036 0.307 0.023 0.002 0.404 0.005 0.271]
 [0.303 0.016 0.02  0.029 0.003 0.011 0.185 0.015 0.009 0.441 0.056 0.068]
 [0.168 0.019 0.382 0.074 0.403 0.002 0.161 0.059 0.012 0.178 0.031 0.169]
 [0.029 0.012 0.031 0.011 0.017 0.021 0.006 0.006 0.004 0.121 0.028 0.015]
 [0.265 0.043 0.504 0.177 0.287 0.071 0.489 0.003 0.014 0.202 0.069 0.219]
 [0.4   1.44  0.232 0.775 0.377 0.208 0.596 0.624 0.002 0.69  2.084 0.428]
 [0.058 0.009 0.011 0.013 0.01  0.024 0.032 0.019 0.003 0.004 0.009 0.084]
 [0.106 0.01  0.181 0.602 0.078 0.133 0.129 0.059 0.002 0.328 0.004 0.525]
 [0.065 0.007 0.022 0.01  0.058 0.026 0.319 0.019 0.004 0.049 0.003 0.004]]
[[0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.769 0.    0.363 0.    0.    0.302 0.    0.    0.    0.607 0.359 0.62 ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.312 0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.307 0.    0.    0.404 0.    0.   ]
 [0.303 0.    0.    0.    0.    0.    0.    0.    0.    0.441 0.    0.   ]
 [0.    0.    0.382 0.    0.403 0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.504 0.    0.    0.    0.489 0.    0.    0.    0.    0.   ]
 [0.4   1.44  0.    0.775 0.377 0.    0.596 0.624 0.    0.69  2.084 0.428]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.602 0.    0.    0.    0.    0.    0.328 0.    0.525]
 [0.    0.    0.    0.    0.    0.    0.319 0.    0.    0.    0.    0.   ]]
{'fdr': 0.35714285714285715, 'tpr': 0.75, 'fpr': 0.23809523809523808, 'f1': 0.6923076923076923, 'shd': 14, 'npred': 28, 'ntrue': 24}
[4.183e-03 2.541e-01 2.522e-02 2.205e-02 2.055e-02 9.797e-02 1.796e-02
 3.524e-03 8.780e-02 2.401e-02 5.432e-02 7.695e-01 3.630e-01 2.208e-01
 2.815e-01 3.019e-01 2.365e-01 8.742e-02 1.816e-03 6.066e-01 3.592e-01
 6.201e-01 2.359e-02 1.403e-02 4.103e-02 1.647e-01 3.865e-03 6.624e-02
 8.663e-03 8.407e-03 3.118e-01 2.432e-02 1.800e-01 1.121e-01 1.794e-02
 6.839e-02 1.032e-01 3.618e-02 3.070e-01 2.297e-02 2.323e-03 4.036e-01
 5.410e-03 2.715e-01 3.033e-01 1.561e-02 2.006e-02 2.903e-02 1.147e-02
 1.854e-01 1.465e-02 8.993e-03 4.412e-01 5.572e-02 6.783e-02 1.676e-01
 1.901e-02 3.821e-01 7.364e-02 4.034e-01 1.609e-01 5.928e-02 1.187e-02
 1.781e-01 3.108e-02 1.692e-01 2.940e-02 1.153e-02 3.078e-02 1.074e-02
 1.694e-02 2.094e-02 6.131e-03 4.168e-03 1.215e-01 2.787e-02 1.512e-02
 2.655e-01 4.310e-02 5.043e-01 1.771e-01 2.874e-01 7.057e-02 4.886e-01
 1.365e-02 2.023e-01 6.903e-02 2.193e-01 4.001e-01 1.440e+00 2.321e-01
 7.750e-01 3.770e-01 2.080e-01 5.956e-01 6.238e-01 6.897e-01 2.084e+00
 4.275e-01 5.777e-02 8.895e-03 1.068e-02 1.259e-02 1.032e-02 2.358e-02
 3.152e-02 1.921e-02 3.367e-03 8.811e-03 8.427e-02 1.063e-01 1.043e-02
 1.808e-01 6.017e-01 7.784e-02 1.333e-01 1.287e-01 5.885e-02 2.179e-03
 3.276e-01 5.253e-01 6.485e-02 7.038e-03 2.209e-02 9.745e-03 5.816e-02
 2.570e-02 3.190e-01 1.871e-02 3.896e-03 4.859e-02 3.279e-03]
[[0. 0. 1. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 1. 0. 0. 0. 0. 0. 0. 1. 0. 1.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 1. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 1. 0. 1. 0. 0. 1. 0. 0. 1. 1. 0.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]]
[0. 1. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0.
 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 0. 0.
 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 1. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 1. 0.
 1. 1. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0.
 1. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
aucroc, aucpr (0.8950617283950616, 0.7596041987129702)
Iterations 2500
Achieves (24.160548736236485, 1e-05)-DP
