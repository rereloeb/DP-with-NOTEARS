samples  5000  graph  12 24 ER mim  minibatch size  25  noise  0.5  minibatches per NN training  1000 quantile adaptive clipping
cuda
cuda
iteration 1 in inner loop,alpha 0.0 rho 1.0 h 1.3547868753222367
iteration 1 in outer loop, alpha = 1.3547868753222367, rho = 1.0, h = 1.3547868753222367
cuda
iteration 1 in inner loop,alpha 1.3547868753222367 rho 1.0 h 0.8318017776157465
iteration 2 in inner loop,alpha 1.3547868753222367 rho 10.0 h 0.3389919481792134
iteration 3 in inner loop,alpha 1.3547868753222367 rho 100.0 h 0.09244439604472277
iteration 2 in outer loop, alpha = 10.599226479794513, rho = 100.0, h = 0.09244439604472277
cuda
iteration 1 in inner loop,alpha 10.599226479794513 rho 100.0 h 0.04713402619085372
iteration 2 in inner loop,alpha 10.599226479794513 rho 1000.0 h 0.013466270810381431
iteration 3 in outer loop, alpha = 24.065497290175944, rho = 1000.0, h = 0.013466270810381431
cuda
iteration 1 in inner loop,alpha 24.065497290175944 rho 1000.0 h 0.0065997978004830316
iteration 2 in inner loop,alpha 24.065497290175944 rho 10000.0 h 0.001947447153703763
iteration 4 in outer loop, alpha = 43.53996882721357, rho = 10000.0, h = 0.001947447153703763
cuda
iteration 1 in inner loop,alpha 43.53996882721357 rho 10000.0 h 0.0008687154134001673
iteration 2 in inner loop,alpha 43.53996882721357 rho 100000.0 h 0.0003101064288770772
iteration 5 in outer loop, alpha = 74.55061171492129, rho = 100000.0, h = 0.0003101064288770772
cuda
iteration 1 in inner loop,alpha 74.55061171492129 rho 100000.0 h 0.00017443780203407755
iteration 6 in outer loop, alpha = 248.98841374899882, rho = 1000000.0, h = 0.00017443780203407755
Threshold 0.3
[[0.005 0.    0.659 0.004 0.529 0.001 0.069 0.    0.    0.134 0.    0.003]
 [2.083 0.002 0.434 0.155 0.105 0.002 0.094 0.002 0.    0.75  0.27  1.259]
 [0.004 0.001 0.005 0.012 0.433 0.    0.051 0.    0.    0.559 0.003 0.004]
 [0.042 0.001 0.054 0.002 0.146 0.001 0.8   0.001 0.    0.896 0.    0.322]
 [0.005 0.001 0.005 0.006 0.004 0.    0.801 0.    0.    0.604 0.002 0.   ]
 [0.045 0.039 0.629 0.036 0.018 0.    0.056 0.001 0.001 0.016 0.01  0.084]
 [0.004 0.    0.002 0.001 0.001 0.001 0.003 0.    0.    0.014 0.    0.001]
 [3.149 0.026 0.696 0.027 0.067 0.002 0.843 0.    0.002 0.01  0.024 0.08 ]
 [0.164 2.378 0.039 2.097 0.159 0.002 0.795 0.001 0.    0.963 3.47  0.038]
 [0.002 0.001 0.002 0.001 0.003 0.    0.011 0.    0.    0.005 0.    0.001]
 [0.166 0.005 0.017 2.475 0.027 0.002 0.075 0.001 0.    0.115 0.003 0.895]
 [0.211 0.001 0.001 0.001 0.025 0.001 1.049 0.001 0.    0.093 0.001 0.004]]
[[0.    0.    0.659 0.    0.529 0.    0.    0.    0.    0.    0.    0.   ]
 [2.083 0.    0.434 0.    0.    0.    0.    0.    0.    0.75  0.    1.259]
 [0.    0.    0.    0.    0.433 0.    0.    0.    0.    0.559 0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.8   0.    0.    0.896 0.    0.322]
 [0.    0.    0.    0.    0.    0.    0.801 0.    0.    0.604 0.    0.   ]
 [0.    0.    0.629 0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [3.149 0.    0.696 0.    0.    0.    0.843 0.    0.    0.    0.    0.   ]
 [0.    2.378 0.    2.097 0.    0.    0.795 0.    0.    0.963 3.47  0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    2.475 0.    0.    0.    0.    0.    0.    0.    0.895]
 [0.    0.    0.    0.    0.    0.    1.049 0.    0.    0.    0.    0.   ]]
{'fdr': 0.08, 'tpr': 0.9583333333333334, 'fpr': 0.047619047619047616, 'f1': 0.9387755102040817, 'shd': 2, 'npred': 25, 'ntrue': 24}
[3.887e-04 6.595e-01 4.081e-03 5.287e-01 1.186e-03 6.922e-02 2.254e-06
 5.162e-06 1.345e-01 1.033e-04 3.397e-03 2.083e+00 4.339e-01 1.546e-01
 1.047e-01 1.521e-03 9.418e-02 1.583e-03 2.495e-05 7.499e-01 2.700e-01
 1.259e+00 3.833e-03 9.424e-04 1.156e-02 4.329e-01 1.885e-05 5.054e-02
 4.645e-05 2.929e-05 5.594e-01 2.757e-03 3.986e-03 4.232e-02 9.260e-04
 5.371e-02 1.464e-01 1.042e-03 8.003e-01 6.240e-04 1.015e-05 8.958e-01
 2.800e-04 3.222e-01 5.101e-03 1.290e-03 5.272e-03 5.780e-03 6.155e-05
 8.015e-01 1.731e-05 3.663e-05 6.044e-01 1.936e-03 4.757e-04 4.550e-02
 3.897e-02 6.287e-01 3.556e-02 1.827e-02 5.630e-02 7.447e-04 1.289e-03
 1.595e-02 1.024e-02 8.355e-02 3.992e-03 4.605e-04 2.467e-03 6.890e-04
 1.219e-03 6.110e-04 2.211e-05 6.258e-06 1.433e-02 2.760e-04 1.158e-03
 3.149e+00 2.641e-02 6.959e-01 2.715e-02 6.744e-02 1.832e-03 8.432e-01
 2.451e-03 9.503e-03 2.439e-02 8.036e-02 1.640e-01 2.378e+00 3.935e-02
 2.097e+00 1.592e-01 1.782e-03 7.948e-01 6.220e-04 9.634e-01 3.470e+00
 3.822e-02 1.976e-03 8.359e-04 2.421e-03 8.447e-04 3.206e-03 3.456e-05
 1.089e-02 1.795e-05 4.437e-06 3.010e-04 1.155e-03 1.659e-01 4.822e-03
 1.661e-02 2.475e+00 2.749e-02 1.963e-03 7.547e-02 6.604e-04 8.408e-06
 1.154e-01 8.951e-01 2.110e-01 6.894e-04 8.676e-04 6.843e-04 2.541e-02
 1.262e-03 1.049e+00 1.007e-03 6.489e-06 9.284e-02 1.260e-03]
[[0. 0. 1. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 1. 0. 0. 0. 0. 0. 0. 1. 0. 1.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 1. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 1. 0. 1. 0. 0. 1. 0. 0. 1. 1. 0.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]]
[0. 1. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0.
 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 0. 0.
 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 1. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 1. 0.
 1. 1. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0.
 1. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
aucroc, aucpr (0.9791666666666666, 0.9644210751547707)
cuda
noise_multiplier  0.5  noise_multiplier_b  1.25  noise_multiplier_delta  0.5103103630798288
cuda
Objective function 178.80 = squared loss an data 15.69 + 0.5*rho*h**2 162.682537 + alpha*h 0.000000 + L2reg 0.22 + L1reg 0.21 ; SHD = 78 ; DAG False
total norm for a microbatch 6.211305964151541 clip 7.891820888128004
total norm for a microbatch 6.158087576756685 clip 7.8601695001644645
total norm for a microbatch 10.301281827339547 clip 8.707455183448635
total norm for a microbatch 12.157921074946609 clip 8.500275804961799
total norm for a microbatch 9.968686713757332 clip 9.011271015357742
total norm for a microbatch 8.219522276361678 clip 8.784735161228664
total norm for a microbatch 10.366265984038359 clip 8.884182583790626
total norm for a microbatch 13.429729836866581 clip 9.794835096424794
total norm for a microbatch 15.886395235727354 clip 8.870686444636911
total norm for a microbatch 7.97215060422686 clip 9.01813781106816
total norm for a microbatch 9.219072018659883 clip 9.170663131180001
total norm for a microbatch 8.179495986444365 clip 9.070152107232134
total norm for a microbatch 16.987851305234564 clip 9.35978164086154
total norm for a microbatch 8.5704480929173 clip 9.288418390247848
total norm for a microbatch 12.309394502768203 clip 10.115467995762799
total norm for a microbatch 14.870508160494357 clip 9.175561933552075
total norm for a microbatch 15.053320036387657 clip 9.83955849331475
total norm for a microbatch 5.350654035856114 clip 9.97209993538084
total norm for a microbatch 13.130901561890779 clip 10.357017077076167
total norm for a microbatch 18.962367372677367 clip 10.063437259444873
total norm for a microbatch 11.203819834138468 clip 10.134438214555951
total norm for a microbatch 10.877497683710573 clip 9.060276245526637
total norm for a microbatch 13.404047502065985 clip 10.291699009144208
total norm for a microbatch 8.57304086071162 clip 10.698786981723691
total norm for a microbatch 27.36860339205761 clip 10.460346835669553
total norm for a microbatch 13.940704427604025 clip 10.492168809222667
cuda
Objective function 6.73 = squared loss an data 4.79 + 0.5*rho*h**2 0.914842 + alpha*h 0.000000 + L2reg 0.92 + L1reg 0.10 ; SHD = 40 ; DAG False
Proportion of microbatches that were clipped  0.7771597921403053
iteration 1 in inner loop, alpha 0.0 rho 1.0 h 1.352658213060435
iteration 1 in outer loop, alpha = 1.352658213060435, rho = 1.0, h = 1.352658213060435
cuda
noise_multiplier  0.5  noise_multiplier_b  1.25  noise_multiplier_delta  0.5103103630798288
cuda
Objective function 8.56 = squared loss an data 4.79 + 0.5*rho*h**2 0.914842 + alpha*h 1.829684 + L2reg 0.92 + L1reg 0.10 ; SHD = 40 ; DAG False
total norm for a microbatch 15.886503010355778 clip 2.249651988898783
total norm for a microbatch 26.03098080134432 clip 9.64709068297063
total norm for a microbatch 22.324477148601378 clip 11.549952723557492
total norm for a microbatch 16.104297519310002 clip 11.994338293162672
total norm for a microbatch 8.381980703049221 clip 10.879033697926186
total norm for a microbatch 25.90014347508011 clip 12.670210435475383
total norm for a microbatch 11.509954346612204 clip 11.690446621574122
total norm for a microbatch 25.47679774459476 clip 11.357923889059254
total norm for a microbatch 7.712891726897187 clip 11.491533902063603
total norm for a microbatch 13.22318465805455 clip 11.082413578120638
total norm for a microbatch 13.129362736492565 clip 10.7015806952452
total norm for a microbatch 13.055143722074023 clip 11.660571317141645
total norm for a microbatch 7.9170646713 clip 10.984608301325096
total norm for a microbatch 25.969553719417483 clip 12.173274420714897
total norm for a microbatch 16.249380771757334 clip 12.173274420714897
total norm for a microbatch 24.137378715430245 clip 12.584825421123128
total norm for a microbatch 10.052509727209042 clip 12.575465391805933
total norm for a microbatch 22.590583000327506 clip 12.015231736349087
total norm for a microbatch 26.696601371079776 clip 11.73616504534568
total norm for a microbatch 7.829690890956353 clip 12.131522483758365
total norm for a microbatch 20.825812169355512 clip 12.034874823755702
total norm for a microbatch 11.767252668438237 clip 10.73209828208612
total norm for a microbatch 24.337950624759248 clip 13.414469498747968
total norm for a microbatch 9.74550613437932 clip 12.273480251143281
cuda
Objective function 7.80 = squared loss an data 4.96 + 0.5*rho*h**2 0.362938 + alpha*h 1.152443 + L2reg 1.24 + L1reg 0.09 ; SHD = 36 ; DAG False
Proportion of microbatches that were clipped  0.7821420052476743
iteration 1 in inner loop, alpha 1.352658213060435 rho 1.0 h 0.8519840039704576
noise_multiplier  0.5  noise_multiplier_b  1.25  noise_multiplier_delta  0.5103103630798288
cuda
Objective function 11.07 = squared loss an data 4.96 + 0.5*rho*h**2 3.629384 + alpha*h 1.152443 + L2reg 1.24 + L1reg 0.09 ; SHD = 36 ; DAG False
total norm for a microbatch 21.29613822393699 clip 1.578326788635974
total norm for a microbatch 20.263623731655844 clip 15.68199921604739
total norm for a microbatch 39.72015620162862 clip 15.856757259335287
total norm for a microbatch 24.17850261644936 clip 14.106776565428634
total norm for a microbatch 11.87306937010427 clip 14.744842626478954
total norm for a microbatch 21.4787897386973 clip 14.10235658236639
total norm for a microbatch 16.565068862752838 clip 14.366539835699157
total norm for a microbatch 18.373755039264935 clip 15.674813804913262
total norm for a microbatch 10.96354044818826 clip 14.933245516173757
total norm for a microbatch 27.98612862410739 clip 13.824432144053029
total norm for a microbatch 29.015955983031066 clip 13.189651663303737
total norm for a microbatch 36.012770148357895 clip 14.143448241145183
total norm for a microbatch 36.333925865243145 clip 14.147434778052615
total norm for a microbatch 18.499900075660243 clip 15.132532322273544
total norm for a microbatch 18.251090502867118 clip 15.522294773905847
total norm for a microbatch 24.550762640794346 clip 13.07623168287004
total norm for a microbatch 25.660535765238 clip 13.67401809877805
total norm for a microbatch 7.875374741132904 clip 13.9215527505053
total norm for a microbatch 11.92552597182807 clip 14.87375126948149
total norm for a microbatch 17.918875204481594 clip 14.444802908689153
total norm for a microbatch 25.061981423970156 clip 14.089145325502951
total norm for a microbatch 10.151528431123232 clip 15.249366902788914
total norm for a microbatch 20.904055281400364 clip 14.925667009596042
total norm for a microbatch 22.098137578627714 clip 14.760996122712237
total norm for a microbatch 13.357733089019494 clip 15.155883592162501
total norm for a microbatch 20.31519160722784 clip 13.257528125212769
total norm for a microbatch 13.27565560602572 clip 16.72076995200072
total norm for a microbatch 13.003297372895684 clip 16.25605772705363
total norm for a microbatch 21.51794508897651 clip 14.483867257904251
total norm for a microbatch 28.83903750500129 clip 15.84505213581236
total norm for a microbatch 25.219386481508355 clip 15.44535837075945
total norm for a microbatch 12.727044205676927 clip 13.52327081072083
total norm for a microbatch 13.577987065843232 clip 15.35455056288997
cuda
Objective function 8.84 = squared loss an data 6.25 + 0.5*rho*h**2 0.665202 + alpha*h 0.493378 + L2reg 1.36 + L1reg 0.08 ; SHD = 28 ; DAG True
Proportion of microbatches that were clipped  0.7801101861905336
iteration 2 in inner loop, alpha 1.352658213060435 rho 10.0 h 0.3647471697815199
noise_multiplier  0.5  noise_multiplier_b  1.25  noise_multiplier_delta  0.5103103630798288
cuda
Objective function 14.82 = squared loss an data 6.25 + 0.5*rho*h**2 6.652025 + alpha*h 0.493378 + L2reg 1.36 + L1reg 0.08 ; SHD = 28 ; DAG True
total norm for a microbatch 34.69652758253244 clip 17.121463107806754
total norm for a microbatch 30.15433772098674 clip 15.73393762439331
total norm for a microbatch 8.195943961974416 clip 19.011602434329273
total norm for a microbatch 23.317849309770168 clip 18.03964768413685
total norm for a microbatch 12.020493478811781 clip 16.231926700296512
total norm for a microbatch 30.54797305647298 clip 16.480365303583028
total norm for a microbatch 13.43114082649139 clip 17.06299581880708
total norm for a microbatch 16.61089616629904 clip 17.444909441298737
total norm for a microbatch 16.06136380166372 clip 16.76999563090367
total norm for a microbatch 10.93647327635409 clip 16.970757599292316
total norm for a microbatch 51.44163597565629 clip 15.849323343605027
total norm for a microbatch 20.949319821792308 clip 17.806611050213423
total norm for a microbatch 21.045559554027705 clip 16.957724134354155
total norm for a microbatch 20.883793969467238 clip 16.446112285474367
total norm for a microbatch 23.268625202739436 clip 16.406075168366524
total norm for a microbatch 37.661114348482556 clip 16.654888792857488
total norm for a microbatch 28.638392228758374 clip 15.422547782012511
total norm for a microbatch 20.426959335694214 clip 16.052329682873108
total norm for a microbatch 21.505206717184617 clip 17.277968159905083
total norm for a microbatch 51.39751347623457 clip 16.077483244918984
total norm for a microbatch 23.40960843406337 clip 17.33507211461899
total norm for a microbatch 33.09311497160532 clip 15.2187330239067
cuda
Objective function 10.08 = squared loss an data 7.87 + 0.5*rho*h**2 0.732914 + alpha*h 0.163768 + L2reg 1.25 + L1reg 0.07 ; SHD = 19 ; DAG True
Proportion of microbatches that were clipped  0.7818684400288438
iteration 3 in inner loop, alpha 1.352658213060435 rho 100.0 h 0.12107139972484404
iteration 2 in outer loop, alpha = 13.45979818554484, rho = 100.0, h = 0.12107139972484404
cuda
noise_multiplier  0.5  noise_multiplier_b  1.25  noise_multiplier_delta  0.5103103630798288
cuda
Objective function 11.55 = squared loss an data 7.87 + 0.5*rho*h**2 0.732914 + alpha*h 1.629597 + L2reg 1.25 + L1reg 0.07 ; SHD = 19 ; DAG True
total norm for a microbatch 20.116441753381906 clip 4.399436949228539
total norm for a microbatch 27.433108071797133 clip 5.187854497051032
total norm for a microbatch 12.106574387911175 clip 15.222864461253216
total norm for a microbatch 16.2002595803399 clip 18.199208495541672
total norm for a microbatch 13.766972034256066 clip 17.01041709690026
total norm for a microbatch 19.99461335486565 clip 17.413465911394646
total norm for a microbatch 30.727095496378 clip 17.10309363212385
total norm for a microbatch 22.796635190991047 clip 15.83506296524302
total norm for a microbatch 20.49502667513507 clip 16.314769985201714
total norm for a microbatch 34.46926370939771 clip 17.6455627403675
total norm for a microbatch 29.63142688832799 clip 17.6455627403675
total norm for a microbatch 35.86978219880742 clip 15.986132884343661
total norm for a microbatch 45.97597093517638 clip 17.352984119056234
total norm for a microbatch 25.224635727091123 clip 15.525822383520788
total norm for a microbatch 28.145439371027127 clip 15.560903142549144
total norm for a microbatch 18.842957700095663 clip 17.31233885395839
total norm for a microbatch 33.28793755690183 clip 16.80207760413095
total norm for a microbatch 22.121708510228487 clip 15.269864192428269
total norm for a microbatch 35.945538514442006 clip 15.880254211711883
total norm for a microbatch 23.14831775322624 clip 15.470936253469151
total norm for a microbatch 33.08347327268338 clip 13.67071465922157
total norm for a microbatch 27.82931582572485 clip 15.701342386728085
total norm for a microbatch 14.979461386955784 clip 16.76207834097035
total norm for a microbatch 16.364521056561934 clip 15.280668451303518
total norm for a microbatch 20.237164266359756 clip 16.140843852868763
total norm for a microbatch 23.51136693024017 clip 15.918129696242843
total norm for a microbatch 21.350478376932287 clip 14.823136522085385
total norm for a microbatch 23.738331572030383 clip 17.117207860286122
total norm for a microbatch 24.20989738590137 clip 15.834600007857802
total norm for a microbatch 16.7851555869209 clip 17.460316871574992
total norm for a microbatch 29.212723751386445 clip 15.126806710269733
total norm for a microbatch 22.60697192409965 clip 15.721343727047964
total norm for a microbatch 15.321212964891151 clip 15.262392925847177
total norm for a microbatch 8.79859695103508 clip 15.064097656664199
total norm for a microbatch 18.666869844671428 clip 15.955490360710133
total norm for a microbatch 47.21006490486222 clip 16.86686679283825
cuda
Objective function 10.85 = squared loss an data 8.57 + 0.5*rho*h**2 0.213745 + alpha*h 0.880039 + L2reg 1.12 + L1reg 0.06 ; SHD = 18 ; DAG True
Proportion of microbatches that were clipped  0.7821464393179539
iteration 1 in inner loop, alpha 13.45979818554484 rho 100.0 h 0.06538276547817823
noise_multiplier  0.5  noise_multiplier_b  1.25  noise_multiplier_delta  0.5103103630798288
cuda
Objective function 12.77 = squared loss an data 8.57 + 0.5*rho*h**2 2.137453 + alpha*h 0.880039 + L2reg 1.12 + L1reg 0.06 ; SHD = 18 ; DAG True
total norm for a microbatch 13.394376694672662 clip 17.616879313831166
total norm for a microbatch 18.56033316006042 clip 15.738599742173358
total norm for a microbatch 15.734422479883163 clip 18.271280836423202
total norm for a microbatch 19.184342410237214 clip 16.444937835980845
total norm for a microbatch 27.34402528532505 clip 14.839438269819903
total norm for a microbatch 21.578428441189256 clip 14.839438269819903
total norm for a microbatch 19.55488266263548 clip 17.481418072991655
total norm for a microbatch 26.861227197103965 clip 16.71309619738511
total norm for a microbatch 15.447157467680107 clip 18.26231312514692
total norm for a microbatch 30.233903507070977 clip 16.038207096541196
total norm for a microbatch 26.68615670619098 clip 16.709698132516678
total norm for a microbatch 11.728112339276697 clip 17.79033552494519
total norm for a microbatch 30.654179691302115 clip 17.78917124498491
total norm for a microbatch 15.716454910923176 clip 17.78917124498491
total norm for a microbatch 18.960062893719645 clip 17.71012866706822
total norm for a microbatch 32.772709908025256 clip 17.71012866706822
total norm for a microbatch 14.835030843514609 clip 16.372315375475637
total norm for a microbatch 14.012472135872372 clip 16.55367286059227
total norm for a microbatch 43.09787821539531 clip 16.496336923673127
total norm for a microbatch 22.645202262411505 clip 14.820724878910301
total norm for a microbatch 15.46448452497499 clip 16.34089608873327
total norm for a microbatch 21.78475964454012 clip 15.23513391329812
total norm for a microbatch 15.07170325206336 clip 16.393717052533123
total norm for a microbatch 18.155009670390665 clip 16.3475900509336
total norm for a microbatch 11.842944442399457 clip 14.69499594925362
total norm for a microbatch 14.981518571973393 clip 16.175452942457632
total norm for a microbatch 15.007719474998204 clip 16.731785636127807
total norm for a microbatch 14.944972622465386 clip 16.68631496684072
total norm for a microbatch 36.22058270975862 clip 14.945637586352156
total norm for a microbatch 17.360258099412405 clip 17.626856640991818
total norm for a microbatch 11.079959165554325 clip 17.393102351458012
total norm for a microbatch 33.067922966178244 clip 16.611655114815182
total norm for a microbatch 21.887831622161123 clip 15.648049058414623
total norm for a microbatch 30.980993704810658 clip 16.422562433245
total norm for a microbatch 37.624729577101064 clip 16.23219429996539
total norm for a microbatch 22.625521164933225 clip 17.494884546855832
total norm for a microbatch 17.407400017535636 clip 15.746919023095884
total norm for a microbatch 33.22058887529148 clip 15.438838037404038
total norm for a microbatch 22.77471057969318 clip 15.629604825043966
total norm for a microbatch 9.835943462962584 clip 16.068188408489405
cuda
Objective function 10.76 = squared loss an data 9.12 + 0.5*rho*h**2 0.285842 + alpha*h 0.321823 + L2reg 0.96 + L1reg 0.06 ; SHD = 22 ; DAG True
Proportion of microbatches that were clipped  0.7830889657090635
iteration 2 in inner loop, alpha 13.45979818554484 rho 1000.0 h 0.023909908327070184
iteration 3 in outer loop, alpha = 37.369706512615025, rho = 1000.0, h = 0.023909908327070184
cuda
noise_multiplier  0.5  noise_multiplier_b  1.25  noise_multiplier_delta  0.5103103630798288
cuda
Objective function 11.33 = squared loss an data 9.12 + 0.5*rho*h**2 0.285842 + alpha*h 0.893506 + L2reg 0.96 + L1reg 0.06 ; SHD = 22 ; DAG True
total norm for a microbatch 23.54644318923765 clip 1.091791714599978
total norm for a microbatch 22.052965549599765 clip 1.4524373454381683
total norm for a microbatch 52.522813097445905 clip 16.488759538714117
total norm for a microbatch 30.2200687770941 clip 17.934664977355034
total norm for a microbatch 35.170595539525245 clip 16.7267348362303
total norm for a microbatch 22.914414627069117 clip 15.72274946177802
total norm for a microbatch 41.86637983051163 clip 17.01043450745834
total norm for a microbatch 12.272975537799049 clip 16.361266332428187
total norm for a microbatch 16.8428445395915 clip 15.466813380361788
total norm for a microbatch 21.988914599490677 clip 16.157624345472406
total norm for a microbatch 18.542312757006094 clip 15.753119276080504
total norm for a microbatch 16.76384367079752 clip 15.808297193170803
total norm for a microbatch 16.471285350053115 clip 15.061478980517247
total norm for a microbatch 34.360831603294514 clip 16.601369337214894
total norm for a microbatch 27.9084257367479 clip 16.59705888074089
total norm for a microbatch 28.702174747070174 clip 15.125619375756687
total norm for a microbatch 34.55971536809822 clip 15.210330624211531
total norm for a microbatch 28.91175260386403 clip 16.225484278775713
total norm for a microbatch 26.56079925991479 clip 17.24550382455432
cuda
Objective function 11.03 = squared loss an data 9.32 + 0.5*rho*h**2 0.130299 + alpha*h 0.603262 + L2reg 0.91 + L1reg 0.07 ; SHD = 16 ; DAG True
Proportion of microbatches that were clipped  0.7834584674055536
iteration 1 in inner loop, alpha 37.369706512615025 rho 1000.0 h 0.01614307292965833
noise_multiplier  0.5  noise_multiplier_b  1.25  noise_multiplier_delta  0.5103103630798288
cuda
Objective function 12.20 = squared loss an data 9.32 + 0.5*rho*h**2 1.302994 + alpha*h 0.603262 + L2reg 0.91 + L1reg 0.07 ; SHD = 16 ; DAG True
total norm for a microbatch 34.289487639730254 clip 7.293905950908096
total norm for a microbatch 28.581111331751064 clip 22.999859237345685
total norm for a microbatch 23.637841848659647 clip 16.74581647673157
total norm for a microbatch 17.456038375490415 clip 17.405048747665315
total norm for a microbatch 23.43355722829268 clip 18.792941412728418
total norm for a microbatch 18.843733616338014 clip 18.824342391063293
total norm for a microbatch 13.2668128027337 clip 16.461411189048896
total norm for a microbatch 20.32805650793214 clip 17.03942824979224
total norm for a microbatch 16.86495787707543 clip 16.762222509244133
total norm for a microbatch 28.34079283168406 clip 16.189934941168204
total norm for a microbatch 16.915961900743444 clip 17.091511748488678
total norm for a microbatch 17.450947682128284 clip 18.699707764316734
total norm for a microbatch 26.95144628122928 clip 17.27241003251426
total norm for a microbatch 21.124830953629843 clip 17.602498675372136
total norm for a microbatch 19.60521196898461 clip 16.86460682507775
total norm for a microbatch 20.28086228072532 clip 18.868380063004093
total norm for a microbatch 24.404926663281497 clip 16.50832253319271
total norm for a microbatch 16.06932110310677 clip 16.182843130429216
total norm for a microbatch 49.31320425727209 clip 17.513046162781247
total norm for a microbatch 27.253385055046515 clip 18.607931293798327
total norm for a microbatch 17.998311852590362 clip 18.471938603322368
total norm for a microbatch 23.41022963116986 clip 18.222010539128046
total norm for a microbatch 24.03813076022815 clip 18.57308052359622
cuda
Objective function 10.95 = squared loss an data 9.52 + 0.5*rho*h**2 0.289945 + alpha*h 0.284572 + L2reg 0.78 + L1reg 0.08 ; SHD = 16 ; DAG True
Proportion of microbatches that were clipped  0.7827426194095528
iteration 2 in inner loop, alpha 37.369706512615025 rho 10000.0 h 0.007615056907265938
noise_multiplier  0.5  noise_multiplier_b  1.25  noise_multiplier_delta  0.5103103630798288
cuda
Objective function 13.56 = squared loss an data 9.52 + 0.5*rho*h**2 2.899455 + alpha*h 0.284572 + L2reg 0.78 + L1reg 0.08 ; SHD = 16 ; DAG True
total norm for a microbatch 138.74153987139525 clip 67.98386558420773
total norm for a microbatch 60.72767813213431 clip 42.97750353146534
total norm for a microbatch 17.00191718318286 clip 16.284548757523638
total norm for a microbatch 15.67324713140692 clip 14.76514094450756
total norm for a microbatch 33.141794423238636 clip 14.684867685303166
total norm for a microbatch 22.515163871046553 clip 14.841474252468505
total norm for a microbatch 17.16688473178512 clip 13.76060882063454
total norm for a microbatch 14.948593328762417 clip 15.634458455010382
total norm for a microbatch 21.009271805318555 clip 14.275728850677526
total norm for a microbatch 20.300110924872182 clip 18.678083763657085
total norm for a microbatch 14.74784522815036 clip 18.678083763657085
total norm for a microbatch 17.116763380716367 clip 18.283825711444187
total norm for a microbatch 46.38096213380811 clip 22.892692479316693
total norm for a microbatch 30.571658998547427 clip 27.372306631909282
total norm for a microbatch 23.972436138582605 clip 23.218112354436034
total norm for a microbatch 419.57772349175764 clip 189.4249826281036
total norm for a microbatch 350.6741853490163 clip 316.17827205124416
total norm for a microbatch 159.38136229453875 clip 117.17693692167946
total norm for a microbatch 143.2871575786887 clip 140.39124067262966
total norm for a microbatch 29.358452086774495 clip 30.775575054225662
total norm for a microbatch 41.076946603267885 clip 16.832346497972456
total norm for a microbatch 24.673954567369748 clip 16.372280840938302
total norm for a microbatch 17.764828380614027 clip 17.327236059647845
total norm for a microbatch 50.33531638250717 clip 14.533621938705435
total norm for a microbatch 34.14939484530429 clip 15.777247704624605
cuda
Objective function 12.21 = squared loss an data 11.10 + 0.5*rho*h**2 0.054242 + alpha*h 0.038923 + L2reg 0.94 + L1reg 0.08 ; SHD = 28 ; DAG True
Proportion of microbatches that were clipped  0.7844844646744509
iteration 3 in inner loop, alpha 37.369706512615025 rho 100000.0 h 0.0010415543701949304
iteration 4 in outer loop, alpha = 141.52514353210807, rho = 100000.0, h = 0.0010415543701949304
cuda
noise_multiplier  0.5  noise_multiplier_b  1.25  noise_multiplier_delta  0.5103103630798288
cuda
Objective function 12.32 = squared loss an data 11.10 + 0.5*rho*h**2 0.054242 + alpha*h 0.147406 + L2reg 0.94 + L1reg 0.08 ; SHD = 28 ; DAG True
total norm for a microbatch 96.99266936139223 clip 4.168420866567361
total norm for a microbatch 76.20227723330817 clip 5.484330233172733
total norm for a microbatch 94.48782804682885 clip 30.22813506115379
total norm for a microbatch 100.02804550088949 clip 96.60502069087704
total norm for a microbatch 15.113471728848957 clip 14.607430766136853
total norm for a microbatch 22.36219884860339 clip 16.178634263301
total norm for a microbatch 13.218663825225917 clip 14.76428811483183
total norm for a microbatch 25.842500833768025 clip 15.450450703996067
total norm for a microbatch 18.810442187365375 clip 17.39180437900367
total norm for a microbatch 19.630110797212605 clip 19.639735017490686
total norm for a microbatch 35.8972351193031 clip 26.12819814927588
total norm for a microbatch 43.37739242006223 clip 34.39929990009765
total norm for a microbatch 44.017638395562614 clip 45.3111928916794
total norm for a microbatch 24.80232001285105 clip 15.372744743746122
total norm for a microbatch 29.448968100201977 clip 14.107570349075178
total norm for a microbatch 28.566566221895936 clip 16.032231978726212
cuda
Objective function 12.51 = squared loss an data 11.35 + 0.5*rho*h**2 0.017358 + alpha*h 0.083387 + L2reg 0.97 + L1reg 0.09 ; SHD = 30 ; DAG True
Proportion of microbatches that were clipped  0.7823976445310946
iteration 1 in inner loop, alpha 141.52514353210807 rho 100000.0 h 0.0005891992029383175
iteration 5 in outer loop, alpha = 730.7243464704256, rho = 1000000.0, h = 0.0005891992029383175
Threshold 0.3
[[0.003 0.005 0.268 0.081 0.001 0.003 0.285 0.001 0.    0.006 0.003 0.042]
 [0.608 0.003 0.362 0.602 0.074 0.073 0.792 0.08  0.001 0.495 0.128 0.195]
 [0.01  0.006 0.005 0.197 0.002 0.002 0.02  0.006 0.001 0.022 0.006 0.065]
 [0.047 0.003 0.027 0.004 0.001 0.001 0.035 0.002 0.    0.026 0.005 0.05 ]
 [1.103 0.074 0.889 0.462 0.002 0.275 0.735 0.018 0.001 0.656 0.22  0.389]
 [0.38  0.072 0.499 0.822 0.003 0.001 1.03  0.009 0.001 0.458 0.108 0.279]
 [0.003 0.001 0.116 0.132 0.001 0.001 0.004 0.001 0.    0.015 0.002 0.03 ]
 [0.372 0.059 0.236 0.367 0.141 0.16  0.751 0.001 0.001 0.493 0.133 0.312]
 [1.82  1.545 1.46  2.115 0.461 0.676 1.897 0.763 0.002 0.803 2.518 1.107]
 [0.243 0.003 0.177 0.219 0.002 0.003 0.139 0.002 0.001 0.005 0.017 0.172]
 [0.523 0.032 0.282 0.684 0.009 0.043 0.555 0.021 0.    0.184 0.004 0.214]
 [0.084 0.016 0.062 0.129 0.002 0.004 0.18  0.003 0.    0.014 0.021 0.004]]
[[0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.608 0.    0.362 0.602 0.    0.    0.792 0.    0.    0.495 0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [1.103 0.    0.889 0.462 0.    0.    0.735 0.    0.    0.656 0.    0.389]
 [0.38  0.    0.499 0.822 0.    0.    1.03  0.    0.    0.458 0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.372 0.    0.    0.367 0.    0.    0.751 0.    0.    0.493 0.    0.312]
 [1.82  1.545 1.46  2.115 0.461 0.676 1.897 0.763 0.    0.803 2.518 1.107]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.523 0.    0.    0.684 0.    0.    0.555 0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]]
{'fdr': 0.6285714285714286, 'tpr': 0.5416666666666666, 'fpr': 0.5238095238095238, 'f1': 0.44067796610169496, 'shd': 30, 'npred': 35, 'ntrue': 24}
[5.128e-03 2.681e-01 8.075e-02 1.094e-03 2.917e-03 2.848e-01 1.451e-03
 1.784e-04 6.445e-03 2.932e-03 4.176e-02 6.079e-01 3.616e-01 6.018e-01
 7.420e-02 7.299e-02 7.924e-01 7.995e-02 7.404e-04 4.948e-01 1.280e-01
 1.952e-01 1.032e-02 5.771e-03 1.965e-01 1.723e-03 1.732e-03 2.020e-02
 6.162e-03 5.053e-04 2.203e-02 5.830e-03 6.519e-02 4.673e-02 2.968e-03
 2.675e-02 1.489e-03 1.104e-03 3.541e-02 2.352e-03 2.276e-04 2.568e-02
 5.134e-03 4.998e-02 1.103e+00 7.396e-02 8.891e-01 4.619e-01 2.752e-01
 7.349e-01 1.754e-02 1.383e-03 6.557e-01 2.200e-01 3.889e-01 3.795e-01
 7.199e-02 4.993e-01 8.220e-01 2.856e-03 1.030e+00 8.688e-03 1.138e-03
 4.576e-01 1.076e-01 2.785e-01 3.484e-03 9.172e-04 1.162e-01 1.323e-01
 1.317e-03 6.466e-04 8.838e-04 2.834e-04 1.535e-02 2.278e-03 3.013e-02
 3.720e-01 5.948e-02 2.356e-01 3.670e-01 1.410e-01 1.601e-01 7.506e-01
 7.051e-04 4.933e-01 1.331e-01 3.116e-01 1.820e+00 1.545e+00 1.460e+00
 2.115e+00 4.609e-01 6.758e-01 1.897e+00 7.627e-01 8.034e-01 2.518e+00
 1.107e+00 2.429e-01 2.649e-03 1.769e-01 2.193e-01 2.107e-03 2.502e-03
 1.389e-01 1.742e-03 1.111e-03 1.730e-02 1.716e-01 5.229e-01 3.179e-02
 2.821e-01 6.839e-01 8.684e-03 4.314e-02 5.547e-01 2.138e-02 3.659e-04
 1.839e-01 2.143e-01 8.417e-02 1.581e-02 6.215e-02 1.290e-01 2.373e-03
 3.658e-03 1.804e-01 2.812e-03 4.681e-04 1.370e-02 2.109e-02]
[[0. 0. 1. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 1. 0. 0. 0. 0. 0. 0. 1. 0. 1.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 1. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 1. 0. 1. 0. 0. 1. 0. 0. 1. 1. 0.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]]
[0. 1. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0.
 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 0. 0.
 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 1. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 1. 0.
 1. 1. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0.
 1. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
aucroc, aucpr (0.7272376543209876, 0.4479752837366518)
Iterations 10000
Achieves (24.580892305181028, 1e-05)-DP
