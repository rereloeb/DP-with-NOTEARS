samples  5000  graph  12 24 ER mim  minibatch size  25  noise  0.5  minibatches per NN training  1000 adaclip_and_quantile
cuda
cuda
iteration 1 in inner loop,alpha 0.0 rho 1.0 h 1.3547868753222367
iteration 1 in outer loop, alpha = 1.3547868753222367, rho = 1.0, h = 1.3547868753222367
cuda
iteration 1 in inner loop,alpha 1.3547868753222367 rho 1.0 h 0.8318017776157465
iteration 2 in inner loop,alpha 1.3547868753222367 rho 10.0 h 0.3389919481792134
iteration 3 in inner loop,alpha 1.3547868753222367 rho 100.0 h 0.09244439604472277
iteration 2 in outer loop, alpha = 10.599226479794513, rho = 100.0, h = 0.09244439604472277
cuda
iteration 1 in inner loop,alpha 10.599226479794513 rho 100.0 h 0.04713402619085372
iteration 2 in inner loop,alpha 10.599226479794513 rho 1000.0 h 0.013466270810381431
iteration 3 in outer loop, alpha = 24.065497290175944, rho = 1000.0, h = 0.013466270810381431
cuda
iteration 1 in inner loop,alpha 24.065497290175944 rho 1000.0 h 0.0066081900976673325
iteration 2 in inner loop,alpha 24.065497290175944 rho 10000.0 h 0.00209394708955557
iteration 4 in outer loop, alpha = 45.00496818573164, rho = 10000.0, h = 0.00209394708955557
cuda
iteration 1 in inner loop,alpha 45.00496818573164 rho 10000.0 h 0.0008565849994432995
iteration 2 in inner loop,alpha 45.00496818573164 rho 100000.0 h 0.0003074876359292489
iteration 5 in outer loop, alpha = 75.75373177865653, rho = 100000.0, h = 0.0003074876359292489
cuda
iteration 1 in inner loop,alpha 75.75373177865653 rho 100000.0 h 0.00016878818824750397
iteration 6 in outer loop, alpha = 244.54192002616048, rho = 1000000.0, h = 0.00016878818824750397
Threshold 0.3
[[0.005 0.    0.67  0.004 0.54  0.001 0.07  0.    0.    0.135 0.001 0.003]
 [2.083 0.002 0.439 0.155 0.105 0.002 0.097 0.001 0.    0.75  0.271 1.258]
 [0.004 0.001 0.005 0.011 0.442 0.    0.053 0.    0.    0.561 0.002 0.004]
 [0.045 0.    0.055 0.002 0.15  0.002 0.804 0.    0.    0.896 0.    0.322]
 [0.005 0.001 0.005 0.005 0.004 0.    0.803 0.    0.    0.61  0.002 0.001]
 [0.046 0.042 0.638 0.037 0.019 0.    0.058 0.002 0.002 0.018 0.009 0.084]
 [0.004 0.    0.002 0.001 0.001 0.001 0.003 0.    0.    0.016 0.    0.001]
 [3.155 0.028 0.707 0.029 0.07  0.004 0.847 0.    0.004 0.003 0.025 0.081]
 [0.165 2.38  0.04  2.097 0.161 0.002 0.798 0.001 0.    0.967 3.469 0.037]
 [0.002 0.001 0.002 0.001 0.003 0.002 0.01  0.    0.    0.005 0.    0.001]
 [0.17  0.005 0.016 2.475 0.029 0.002 0.077 0.002 0.    0.116 0.003 0.899]
 [0.219 0.001 0.007 0.001 0.026 0.001 1.052 0.001 0.    0.093 0.001 0.004]]
[[0.    0.    0.67  0.    0.54  0.    0.    0.    0.    0.    0.    0.   ]
 [2.083 0.    0.439 0.    0.    0.    0.    0.    0.    0.75  0.    1.258]
 [0.    0.    0.    0.    0.442 0.    0.    0.    0.    0.561 0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.804 0.    0.    0.896 0.    0.322]
 [0.    0.    0.    0.    0.    0.    0.803 0.    0.    0.61  0.    0.   ]
 [0.    0.    0.638 0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [3.155 0.    0.707 0.    0.    0.    0.847 0.    0.    0.    0.    0.   ]
 [0.    2.38  0.    2.097 0.    0.    0.798 0.    0.    0.967 3.469 0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.    0.    2.475 0.    0.    0.    0.    0.    0.    0.    0.899]
 [0.    0.    0.    0.    0.    0.    1.052 0.    0.    0.    0.    0.   ]]
{'fdr': 0.08, 'tpr': 0.9583333333333334, 'fpr': 0.047619047619047616, 'f1': 0.9387755102040817, 'shd': 2, 'npred': 25, 'ntrue': 24}
[3.444e-04 6.699e-01 3.883e-03 5.397e-01 5.918e-04 6.956e-02 2.897e-06
 5.281e-06 1.352e-01 8.404e-04 3.229e-03 2.083e+00 4.389e-01 1.550e-01
 1.054e-01 1.997e-03 9.750e-02 6.360e-04 6.539e-05 7.501e-01 2.712e-01
 1.258e+00 3.683e-03 9.039e-04 1.121e-02 4.416e-01 6.858e-05 5.348e-02
 4.637e-05 3.173e-05 5.615e-01 2.368e-03 3.680e-03 4.491e-02 4.202e-04
 5.531e-02 1.501e-01 1.646e-03 8.041e-01 3.512e-04 1.727e-05 8.956e-01
 2.768e-04 3.223e-01 4.723e-03 1.198e-03 5.158e-03 5.480e-03 4.826e-04
 8.032e-01 4.312e-05 3.288e-05 6.095e-01 1.738e-03 6.230e-04 4.567e-02
 4.233e-02 6.385e-01 3.668e-02 1.885e-02 5.759e-02 1.987e-03 2.189e-03
 1.815e-02 9.470e-03 8.433e-02 3.773e-03 4.501e-04 2.192e-03 6.780e-04
 1.194e-03 6.486e-04 2.495e-05 3.264e-06 1.562e-02 2.643e-04 1.139e-03
 3.155e+00 2.830e-02 7.073e-01 2.911e-02 7.019e-02 3.663e-03 8.467e-01
 3.637e-03 3.313e-03 2.489e-02 8.074e-02 1.647e-01 2.380e+00 3.954e-02
 2.097e+00 1.607e-01 2.255e-03 7.981e-01 5.871e-04 9.669e-01 3.469e+00
 3.731e-02 1.886e-03 8.093e-04 2.181e-03 8.467e-04 3.059e-03 2.281e-03
 1.023e-02 5.563e-05 4.655e-06 2.978e-04 1.135e-03 1.701e-01 4.950e-03
 1.650e-02 2.475e+00 2.858e-02 2.201e-03 7.723e-02 2.296e-03 8.602e-06
 1.165e-01 8.991e-01 2.188e-01 6.794e-04 6.664e-03 7.635e-04 2.619e-02
 6.357e-04 1.052e+00 5.712e-04 2.933e-06 9.348e-02 1.244e-03]
[[0. 0. 1. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 1. 0. 0. 0. 0. 0. 0. 1. 0. 1.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 1. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 1. 0. 1. 0. 0. 1. 0. 0. 1. 1. 0.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]]
[0. 1. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0.
 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 0. 0.
 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 1. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 1. 0.
 1. 1. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0.
 1. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
aucroc, aucpr (0.9780092592592593, 0.9638945746282703)
cuda
1692
cuda
Objective function 178.80 = squared loss an data 15.69 + 0.5*rho*h**2 162.682537 + alpha*h 0.000000 + L2reg 0.22 + L1reg 0.21 ; SHD = 78 ; DAG False
||w||^2 0.07145240014958802
exp ma of ||w||^2 185.12871661780352
||w|| 0.2673058176500991
exp ma of ||w|| 0.45236810155561336
||w||^2 0.08427163790059128
exp ma of ||w||^2 0.23591980772434712
||w|| 0.29029577658069927
exp ma of ||w|| 0.4611620752162734
||w||^2 0.22220941689106216
exp ma of ||w||^2 0.24737802642383916
||w|| 0.47139093849061436
exp ma of ||w|| 0.47913003222892464
||w||^2 0.2549066896996327
exp ma of ||w||^2 0.2384003087059369
||w|| 0.5048828474999252
exp ma of ||w|| 0.4715409744711745
||w||^2 0.19112107974789433
exp ma of ||w||^2 0.27605973197107225
||w|| 0.4371739696595559
exp ma of ||w|| 0.49764375851689535
||w||^2 0.13116369141496284
exp ma of ||w||^2 0.2681574895855875
||w|| 0.3621652819017345
exp ma of ||w|| 0.49077005386747596
||w||^2 0.16358891801828943
exp ma of ||w||^2 0.27638219644860434
||w|| 0.4044612688729162
exp ma of ||w|| 0.4945720487771754
v before min max tensor([[-0.410,  1.232, -0.413,  ..., -0.362, -0.545,  0.810],
        [-0.129, -0.735, -0.841,  ..., -0.646, -0.271, -0.664],
        [-0.368, -0.167,  0.273,  ...,  1.837, -0.658, -0.203],
        ...,
        [ 0.304, -0.010, -0.345,  ...,  0.998, -0.559,  8.772],
        [-0.324, -0.402, -0.230,  ...,  1.365, -0.720,  1.263],
        [-0.471,  0.612, -0.364,  ...,  0.027, -0.272, -0.166]],
       device='cuda:0')
v tensor([[1.000e-12, 1.232e+00, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         8.098e-01],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [1.000e-12, 1.000e-12, 2.734e-01,  ..., 1.837e+00, 1.000e-12,
         1.000e-12],
        ...,
        [3.041e-01, 1.000e-12, 1.000e-12,  ..., 9.982e-01, 1.000e-12,
         8.772e+00],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.365e+00, 1.000e-12,
         1.263e+00],
        [1.000e-12, 6.121e-01, 1.000e-12,  ..., 2.705e-02, 1.000e-12,
         1.000e-12]], device='cuda:0')
v before min max tensor([-0.675, -0.024, -0.324, -0.028, -0.095,  0.521, -0.352, -0.449, -0.306,
        -0.528,  0.593, -0.477,  0.904,  0.008, -0.280,  0.281, -0.427,  3.465,
         1.160, -0.492, -0.424, -0.626, -0.306,  1.623,  0.085, -0.619, -0.581,
        -0.571,  0.489, -0.265, -0.643, -0.030, -0.169,  0.031,  0.010, -0.694,
         0.854,  1.404, -0.388, -0.299, -0.249, -0.473, -0.538,  3.052, -0.669,
        -0.663,  2.764,  0.607,  1.692, -0.215, -0.237,  0.083, -0.150,  0.237,
        -0.812, -0.279, -0.164,  3.159, -0.435, -0.864, -0.457,  1.339,  0.408,
        -0.117, -0.019, -0.471,  1.317,  0.408, -0.336,  1.721, -0.528,  2.563,
         1.842,  1.936,  0.098,  1.125, -0.284,  0.230, -0.572, -0.151, -0.338,
        -0.340, -0.206, -0.087, -0.512,  0.050,  0.591, -0.083,  0.257, -0.230,
        -0.574,  0.398,  1.160, -0.417,  2.849, -0.095,  2.293,  0.426,  0.243,
         0.219, -0.207, -0.315, -0.207, -0.052, -0.761, -0.090,  1.674,  0.828,
        -0.494, -0.287, -0.596, -0.228,  0.450, -0.490, -0.031, -0.531, -0.162,
         0.617,  4.010, -0.402], device='cuda:0')
v tensor([1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 5.212e-01,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 5.931e-01, 1.000e-12,
        9.042e-01, 8.015e-03, 1.000e-12, 2.811e-01, 1.000e-12, 3.465e+00,
        1.160e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.623e+00,
        8.542e-02, 1.000e-12, 1.000e-12, 1.000e-12, 4.886e-01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 3.138e-02, 9.902e-03, 1.000e-12,
        8.536e-01, 1.404e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 3.052e+00, 1.000e-12, 1.000e-12, 2.764e+00, 6.071e-01,
        1.692e+00, 1.000e-12, 1.000e-12, 8.265e-02, 1.000e-12, 2.372e-01,
        1.000e-12, 1.000e-12, 1.000e-12, 3.159e+00, 1.000e-12, 1.000e-12,
        1.000e-12, 1.339e+00, 4.079e-01, 1.000e-12, 1.000e-12, 1.000e-12,
        1.317e+00, 4.079e-01, 1.000e-12, 1.721e+00, 1.000e-12, 2.563e+00,
        1.842e+00, 1.936e+00, 9.830e-02, 1.125e+00, 1.000e-12, 2.295e-01,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 5.044e-02, 5.910e-01, 1.000e-12, 2.566e-01, 1.000e-12,
        1.000e-12, 3.975e-01, 1.160e+00, 1.000e-12, 2.849e+00, 1.000e-12,
        2.293e+00, 4.258e-01, 2.433e-01, 2.194e-01, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.674e+00, 8.278e-01,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 4.501e-01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 6.166e-01, 4.010e+00, 1.000e-12],
       device='cuda:0')
v before min max tensor([[[ 0.818],
         [ 2.614],
         [ 1.068],
         [-0.756],
         [-0.337],
         [-0.901],
         [ 2.724],
         [ 0.013],
         [-0.400],
         [-0.448]],

        [[-0.504],
         [ 0.479],
         [-0.400],
         [-1.369],
         [ 0.575],
         [ 1.206],
         [ 0.797],
         [-0.873],
         [ 3.488],
         [-0.549]],

        [[ 2.986],
         [ 2.516],
         [-0.768],
         [-0.314],
         [ 2.021],
         [ 2.137],
         [ 1.772],
         [ 1.124],
         [ 0.324],
         [ 1.533]],

        [[ 1.510],
         [ 1.139],
         [-0.746],
         [ 0.790],
         [-0.754],
         [ 0.080],
         [ 1.560],
         [-0.597],
         [ 0.981],
         [ 0.748]],

        [[-0.437],
         [-0.034],
         [ 0.076],
         [-0.294],
         [ 2.215],
         [ 0.704],
         [-0.589],
         [ 0.485],
         [ 1.400],
         [ 2.399]],

        [[-0.507],
         [-0.414],
         [-0.741],
         [ 0.151],
         [ 0.060],
         [ 2.471],
         [-0.434],
         [-0.608],
         [ 0.048],
         [-0.740]],

        [[-0.784],
         [ 0.861],
         [ 1.584],
         [ 3.741],
         [-0.426],
         [-0.467],
         [-0.810],
         [-0.863],
         [ 0.036],
         [-0.608]],

        [[ 2.532],
         [-0.303],
         [-0.429],
         [-0.016],
         [-0.014],
         [ 0.105],
         [-0.431],
         [ 0.731],
         [-0.425],
         [-0.296]],

        [[-0.760],
         [-0.227],
         [ 0.674],
         [-0.269],
         [-0.108],
         [-0.366],
         [ 1.058],
         [-0.486],
         [-0.238],
         [-0.392]],

        [[-1.077],
         [-0.509],
         [-0.618],
         [-0.145],
         [-0.371],
         [-0.680],
         [-0.338],
         [ 1.710],
         [ 4.228],
         [ 0.517]],

        [[-0.486],
         [-1.255],
         [ 0.077],
         [-0.618],
         [-0.419],
         [ 0.133],
         [-0.378],
         [-0.095],
         [-0.858],
         [-0.384]],

        [[ 1.283],
         [ 0.771],
         [ 0.326],
         [ 3.980],
         [ 0.888],
         [ 0.321],
         [-0.505],
         [-0.285],
         [ 0.091],
         [ 1.184]]], device='cuda:0')
v tensor([[[8.177e-01],
         [2.614e+00],
         [1.068e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.724e+00],
         [1.308e-02],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [4.786e-01],
         [1.000e-12],
         [1.000e-12],
         [5.748e-01],
         [1.206e+00],
         [7.970e-01],
         [1.000e-12],
         [3.488e+00],
         [1.000e-12]],

        [[2.986e+00],
         [2.516e+00],
         [1.000e-12],
         [1.000e-12],
         [2.021e+00],
         [2.137e+00],
         [1.772e+00],
         [1.124e+00],
         [3.245e-01],
         [1.533e+00]],

        [[1.510e+00],
         [1.139e+00],
         [1.000e-12],
         [7.902e-01],
         [1.000e-12],
         [8.021e-02],
         [1.560e+00],
         [1.000e-12],
         [9.813e-01],
         [7.484e-01]],

        [[1.000e-12],
         [1.000e-12],
         [7.553e-02],
         [1.000e-12],
         [2.215e+00],
         [7.036e-01],
         [1.000e-12],
         [4.845e-01],
         [1.400e+00],
         [2.399e+00]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.506e-01],
         [6.038e-02],
         [2.471e+00],
         [1.000e-12],
         [1.000e-12],
         [4.795e-02],
         [1.000e-12]],

        [[1.000e-12],
         [8.605e-01],
         [1.584e+00],
         [3.741e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [3.596e-02],
         [1.000e-12]],

        [[2.532e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.046e-01],
         [1.000e-12],
         [7.313e-01],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [6.744e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.058e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.710e+00],
         [4.228e+00],
         [5.173e-01]],

        [[1.000e-12],
         [1.000e-12],
         [7.718e-02],
         [1.000e-12],
         [1.000e-12],
         [1.334e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.283e+00],
         [7.705e-01],
         [3.259e-01],
         [3.980e+00],
         [8.884e-01],
         [3.209e-01],
         [1.000e-12],
         [1.000e-12],
         [9.124e-02],
         [1.184e+00]]], device='cuda:0')
v before min max tensor([[ 4.300],
        [-0.068],
        [-0.461],
        [-0.688],
        [-1.926],
        [-0.289],
        [-0.254],
        [-1.010],
        [-0.086],
        [-1.085],
        [11.486],
        [-0.130]], device='cuda:0')
v tensor([[4.300e+00],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e+01],
        [1.000e-12]], device='cuda:0')
a after update for 1 param tensor([[-0.010, -0.007, -0.008,  ..., -0.004,  0.008, -0.008],
        [ 0.006, -0.012,  0.017,  ..., -0.005,  0.022, -0.005],
        [-0.005, -0.008, -0.003,  ..., -0.006,  0.017, -0.007],
        ...,
        [ 0.002, -0.012, -0.005,  ..., -0.014, -0.015,  0.002],
        [ 0.003,  0.005, -0.010,  ...,  0.029,  0.018,  0.010],
        [-0.014,  0.005, -0.007,  ...,  0.025,  0.004, -0.010]],
       device='cuda:0')
s after update for 1 param tensor([[0.349, 0.770, 0.486,  ..., 0.330, 0.466, 0.516],
        [0.621, 0.631, 1.070,  ..., 0.672, 0.291, 0.571],
        [0.314, 0.278, 0.459,  ..., 0.709, 0.621, 0.318],
        ...,
        [0.558, 0.219, 0.403,  ..., 0.512, 0.690, 1.157],
        [0.322, 0.385, 0.285,  ..., 0.723, 0.674, 0.686],
        [0.668, 0.427, 0.313,  ..., 0.548, 0.455, 0.801]], device='cuda:0')
b after update for 1 param tensor([[17.778, 26.401, 20.963,  ..., 17.285, 20.529, 21.605],
        [23.705, 23.893, 31.106,  ..., 24.665, 16.223, 22.732],
        [16.854, 15.867, 20.379,  ..., 25.329, 23.707, 16.965],
        ...,
        [22.470, 14.089, 19.097,  ..., 21.529, 24.992, 32.354],
        [17.068, 18.658, 16.051,  ..., 25.577, 24.689, 24.910],
        [24.575, 19.645, 16.838,  ..., 22.259, 20.295, 26.926]],
       device='cuda:0')
clipping threshold 0.3445455511262242
a after update for 1 param tensor([-0.002, -0.018, -0.005, -0.008, -0.011, -0.009,  0.003, -0.003,  0.011,
        -0.006, -0.009, -0.001,  0.017,  0.002,  0.003, -0.003, -0.010, -0.019,
         0.006,  0.006, -0.007,  0.029, -0.007, -0.008, -0.003,  0.012, -0.023,
         0.002,  0.027, -0.001,  0.002, -0.019, -0.017, -0.016,  0.003, -0.011,
         0.031, -0.012, -0.007,  0.006, -0.001, -0.032,  0.002, -0.013, -0.006,
        -0.007,  0.008,  0.009, -0.020, -0.014, -0.004, -0.005,  0.002, -0.007,
         0.014,  0.012,  0.002, -0.022, -0.004, -0.009,  0.002,  0.012, -0.002,
        -0.004, -0.008, -0.003, -0.007,  0.010, -0.029, -0.015, -0.017,  0.011,
         0.013, -0.002, -0.003,  0.006, -0.014,  0.003,  0.010, -0.012, -0.002,
        -0.002,  0.003,  0.017,  0.008,  0.002, -0.005, -0.008, -0.004,  0.007,
         0.013, -0.008, -0.011,  0.003,  0.011, -0.004, -0.016,  0.009,  0.005,
        -0.014, -0.002, -0.005,  0.012, -0.000,  0.004,  0.009,  0.015, -0.008,
         0.002,  0.012,  0.007,  0.012, -0.002,  0.002,  0.011, -0.005, -0.014,
        -0.002, -0.011, -0.003], device='cuda:0')
s after update for 1 param tensor([0.642, 0.554, 0.495, 0.288, 0.249, 0.585, 0.305, 0.401, 0.482, 0.740,
        0.560, 0.440, 0.645, 0.197, 0.468, 0.361, 0.507, 0.909, 0.559, 0.454,
        0.820, 0.552, 0.371, 0.640, 0.346, 0.637, 0.528, 0.545, 0.775, 0.350,
        0.550, 0.393, 0.331, 0.518, 0.544, 0.693, 0.527, 0.526, 0.392, 0.420,
        0.430, 0.695, 0.512, 0.952, 0.573, 0.572, 0.674, 0.879, 0.516, 0.186,
        0.313, 0.432, 0.379, 0.231, 0.916, 0.485, 0.161, 0.661, 0.371, 0.781,
        0.642, 0.595, 0.331, 0.628, 0.227, 0.423, 0.568, 0.887, 0.288, 0.671,
        0.521, 0.696, 0.501, 0.688, 0.406, 0.512, 0.300, 0.282, 0.544, 0.310,
        0.397, 0.296, 0.184, 0.393, 0.437, 0.368, 0.549, 0.464, 0.511, 0.219,
        0.683, 0.404, 0.453, 0.437, 0.878, 0.404, 0.707, 0.302, 0.657, 0.740,
        0.350, 0.365, 0.277, 0.370, 0.655, 0.516, 0.852, 0.442, 0.544, 0.280,
        0.512, 0.219, 0.543, 0.420, 0.316, 0.475, 0.160, 0.797, 0.937, 0.569],
       device='cuda:0')
b after update for 1 param tensor([24.107, 22.391, 21.157, 16.140, 15.008, 23.001, 16.617, 19.035, 20.892,
        25.872, 22.514, 19.946, 24.152, 13.350, 20.579, 18.074, 21.412, 28.677,
        22.483, 20.256, 27.238, 22.353, 18.324, 24.067, 17.685, 24.009, 21.851,
        22.198, 26.480, 17.805, 22.303, 18.857, 17.305, 21.642, 22.186, 25.033,
        21.840, 21.819, 18.824, 19.494, 19.732, 25.082, 21.532, 29.345, 22.777,
        22.754, 24.689, 28.192, 21.596, 12.957, 16.828, 19.761, 18.506, 14.457,
        28.780, 20.940, 12.072, 24.459, 18.328, 26.574, 24.106, 23.202, 17.305,
        23.828, 14.316, 19.562, 22.676, 28.334, 16.144, 24.637, 21.708, 25.095,
        21.294, 24.943, 19.161, 21.512, 16.464, 15.966, 22.192, 16.738, 18.944,
        16.370, 12.902, 18.867, 19.873, 18.244, 22.287, 20.493, 21.511, 14.072,
        24.858, 19.112, 20.252, 19.888, 28.189, 19.116, 25.281, 16.531, 24.374,
        25.870, 17.789, 18.169, 15.820, 18.293, 24.348, 21.612, 27.761, 19.991,
        22.189, 15.915, 21.524, 14.064, 22.156, 19.485, 16.916, 20.729, 12.022,
        26.859, 29.111, 22.682], device='cuda:0')
clipping threshold 0.3445455511262242
a after update for 1 param tensor([[[ 0.007],
         [ 0.061],
         [-0.001],
         [-0.052],
         [-0.079],
         [ 0.055],
         [-0.028],
         [ 0.044],
         [ 0.063],
         [-0.041]],

        [[ 0.040],
         [-0.046],
         [ 0.062],
         [-0.052],
         [ 0.033],
         [-0.046],
         [ 0.053],
         [-0.080],
         [-0.001],
         [-0.047]],

        [[ 0.011],
         [ 0.026],
         [ 0.054],
         [-0.096],
         [ 0.010],
         [-0.094],
         [ 0.001],
         [-0.036],
         [ 0.090],
         [-0.023]],

        [[-0.024],
         [-0.030],
         [-0.031],
         [ 0.019],
         [ 0.052],
         [-0.074],
         [ 0.072],
         [-0.039],
         [ 0.087],
         [ 0.091]],

        [[ 0.074],
         [ 0.021],
         [-0.018],
         [-0.071],
         [-0.000],
         [ 0.020],
         [ 0.010],
         [-0.027],
         [ 0.009],
         [ 0.010]],

        [[ 0.026],
         [ 0.008],
         [-0.001],
         [ 0.023],
         [-0.010],
         [-0.004],
         [-0.014],
         [ 0.010],
         [-0.006],
         [ 0.014]],

        [[-0.050],
         [ 0.055],
         [-0.038],
         [-0.019],
         [ 0.018],
         [-0.015],
         [-0.030],
         [ 0.014],
         [-0.069],
         [ 0.072]],

        [[ 0.000],
         [ 0.002],
         [ 0.009],
         [ 0.018],
         [ 0.005],
         [ 0.010],
         [-0.026],
         [ 0.006],
         [-0.011],
         [ 0.016]],

        [[-0.033],
         [-0.003],
         [-0.030],
         [ 0.009],
         [ 0.015],
         [ 0.008],
         [ 0.043],
         [-0.028],
         [ 0.007],
         [ 0.039]],

        [[ 0.035],
         [-0.001],
         [-0.053],
         [-0.046],
         [-0.001],
         [ 0.049],
         [ 0.044],
         [ 0.028],
         [ 0.079],
         [-0.117]],

        [[-0.010],
         [-0.016],
         [ 0.009],
         [ 0.057],
         [ 0.090],
         [-0.065],
         [-0.128],
         [ 0.028],
         [-0.019],
         [-0.011]],

        [[ 0.041],
         [-0.080],
         [-0.051],
         [ 0.074],
         [-0.001],
         [ 0.018],
         [ 0.088],
         [ 0.024],
         [ 0.022],
         [-0.026]]], device='cuda:0')
s after update for 1 param tensor([[[0.786],
         [0.719],
         [0.887],
         [0.820],
         [0.597],
         [1.228],
         [0.997],
         [0.615],
         [0.669],
         [0.450]],

        [[0.499],
         [0.440],
         [0.342],
         [1.188],
         [0.752],
         [0.602],
         [0.794],
         [1.003],
         [0.662],
         [0.539]],

        [[0.668],
         [1.403],
         [0.710],
         [0.722],
         [0.801],
         [0.834],
         [0.852],
         [0.619],
         [0.798],
         [0.765]],

        [[0.986],
         [0.599],
         [0.688],
         [1.059],
         [0.848],
         [0.734],
         [0.637],
         [0.518],
         [0.406],
         [0.783]],

        [[0.602],
         [0.464],
         [0.572],
         [0.640],
         [0.863],
         [0.556],
         [0.523],
         [0.948],
         [0.715],
         [0.941]],

        [[0.451],
         [0.403],
         [0.813],
         [0.439],
         [0.817],
         [0.605],
         [0.376],
         [0.540],
         [0.630],
         [0.636]],

        [[0.948],
         [0.570],
         [1.116],
         [0.979],
         [0.681],
         [1.054],
         [0.695],
         [0.902],
         [0.862],
         [0.542]],

        [[0.745],
         [0.436],
         [0.952],
         [0.661],
         [0.437],
         [0.383],
         [0.411],
         [0.638],
         [0.428],
         [0.261]],

        [[0.768],
         [0.816],
         [0.734],
         [0.325],
         [0.746],
         [0.338],
         [1.016],
         [0.526],
         [0.787],
         [0.890]],

        [[1.066],
         [0.754],
         [0.606],
         [0.574],
         [0.772],
         [0.622],
         [0.587],
         [0.848],
         [1.001],
         [0.486]],

        [[0.493],
         [1.250],
         [0.497],
         [0.568],
         [0.407],
         [0.697],
         [0.569],
         [0.240],
         [1.019],
         [0.670]],

        [[0.560],
         [0.989],
         [0.791],
         [0.735],
         [0.716],
         [0.763],
         [0.476],
         [0.610],
         [0.687],
         [0.813]]], device='cuda:0')
b after update for 1 param tensor([[[26.671],
         [25.502],
         [28.325],
         [27.241],
         [23.246],
         [33.328],
         [30.029],
         [23.592],
         [24.592],
         [20.182]],

        [[21.255],
         [19.950],
         [17.585],
         [32.783],
         [26.081],
         [23.332],
         [26.806],
         [30.123],
         [24.468],
         [22.082]],

        [[24.587],
         [35.623],
         [25.335],
         [25.563],
         [26.919],
         [27.475],
         [27.762],
         [23.658],
         [26.869],
         [26.306]],

        [[29.859],
         [23.274],
         [24.955],
         [30.945],
         [27.703],
         [25.761],
         [24.009],
         [21.653],
         [19.155],
         [26.618]],

        [[23.346],
         [20.483],
         [22.741],
         [24.070],
         [27.944],
         [22.431],
         [21.750],
         [29.290],
         [25.441],
         [29.183]],

        [[20.195],
         [19.090],
         [27.127],
         [19.919],
         [27.187],
         [23.399],
         [18.444],
         [22.094],
         [23.880],
         [23.983]],

        [[29.284],
         [22.713],
         [31.778],
         [29.765],
         [24.816],
         [30.875],
         [25.071],
         [28.564],
         [27.922],
         [22.134]],

        [[25.955],
         [19.854],
         [29.348],
         [24.460],
         [19.886],
         [18.620],
         [19.279],
         [24.018],
         [19.672],
         [15.377]],

        [[26.351],
         [27.177],
         [25.769],
         [17.149],
         [25.985],
         [17.498],
         [30.322],
         [21.819],
         [26.674],
         [28.382]],

        [[31.061],
         [26.109],
         [23.413],
         [22.795],
         [26.433],
         [23.715],
         [23.037],
         [27.704],
         [30.097],
         [20.963]],

        [[21.119],
         [33.623],
         [21.201],
         [22.662],
         [19.183],
         [25.102],
         [22.684],
         [14.723],
         [30.369],
         [24.611]],

        [[22.509],
         [29.918],
         [26.754],
         [25.786],
         [25.446],
         [26.280],
         [20.743],
         [23.492],
         [24.928],
         [27.123]]], device='cuda:0')
clipping threshold 0.3445455511262242
a after update for 1 param tensor([[-0.016],
        [ 0.005],
        [-0.006],
        [-0.014],
        [ 0.005],
        [ 0.009],
        [-0.012],
        [-0.014],
        [ 0.011],
        [ 0.015],
        [ 0.002],
        [-0.027]], device='cuda:0')
s after update for 1 param tensor([[0.935],
        [0.505],
        [1.145],
        [0.728],
        [1.764],
        [0.463],
        [1.180],
        [0.893],
        [0.962],
        [1.221],
        [1.438],
        [0.719]], device='cuda:0')
b after update for 1 param tensor([[29.088],
        [21.370],
        [32.190],
        [25.667],
        [39.942],
        [20.475],
        [32.675],
        [28.418],
        [29.506],
        [33.238],
        [36.063],
        [25.507]], device='cuda:0')
clipping threshold 0.3445455511262242
||w||^2 0.2732121968976099
exp ma of ||w||^2 0.2816978829070825
||w|| 0.5226970412175774
exp ma of ||w|| 0.5045886350286211
||w||^2 0.3125542314876131
exp ma of ||w||^2 0.23748791356511126
||w|| 0.5590654983878124
exp ma of ||w|| 0.4650321574450129
||w||^2 0.11964633201456167
exp ma of ||w||^2 0.27435992460589115
||w|| 0.34589930906921695
exp ma of ||w|| 0.49030585362392065
||w||^2 0.12774776782767566
exp ma of ||w||^2 0.28543917689298287
||w|| 0.3574181973930198
exp ma of ||w|| 0.49858513172353125
||w||^2 0.11806373173070608
exp ma of ||w||^2 0.3193544303785069
||w|| 0.34360403334464235
exp ma of ||w|| 0.5279075596137899
||w||^2 0.4034308773105842
exp ma of ||w||^2 0.2745992811824119
||w|| 0.6351620874316919
exp ma of ||w|| 0.4895688886720763
||w||^2 0.1133889110220653
exp ma of ||w||^2 0.28022440521173697
||w|| 0.3367326996626038
exp ma of ||w|| 0.49563491128064346
||w||^2 0.17344985392309792
exp ma of ||w||^2 0.29747301842948426
||w|| 0.41647311308546425
exp ma of ||w|| 0.5150045224967787
||w||^2 0.26480729204969145
exp ma of ||w||^2 0.2911493848427877
||w|| 0.5145942985009564
exp ma of ||w|| 0.5061424723563767
||w||^2 0.2624361302197293
exp ma of ||w||^2 0.28420869446311176
||w|| 0.5122852039828295
exp ma of ||w|| 0.5004823243446861
||w||^2 0.04001200723625794
exp ma of ||w||^2 0.31670622404772525
||w|| 0.2000300158382685
exp ma of ||w|| 0.5298728676551862
||w||^2 0.2061961932207004
exp ma of ||w||^2 0.3246816048024505
||w|| 0.45408830993618454
exp ma of ||w|| 0.5388393927189911
||w||^2 0.428161339934902
exp ma of ||w||^2 0.31160940443831925
||w|| 0.6543403853766799
exp ma of ||w|| 0.5228226546633958
||w||^2 0.12614848298889822
exp ma of ||w||^2 0.2804407797652081
||w|| 0.355173877120627
exp ma of ||w|| 0.4906941243455539
||w||^2 0.12536378879475563
exp ma of ||w||^2 0.29295441749753015
||w|| 0.3540674918638474
exp ma of ||w|| 0.5047305800001214
||w||^2 0.30354111052421173
exp ma of ||w||^2 0.3423130503839602
||w|| 0.5509456511528262
exp ma of ||w|| 0.5496647173748884
||w||^2 0.08839375276566576
exp ma of ||w||^2 0.25533210931969436
||w|| 0.29731086889931513
exp ma of ||w|| 0.4737562534863244
||w||^2 0.6963236681615939
exp ma of ||w||^2 0.2585393008202091
||w|| 0.8344601057939163
exp ma of ||w|| 0.47575505864980394
||w||^2 0.26343388677529495
exp ma of ||w||^2 0.360277679275404
||w|| 0.5132581093127462
exp ma of ||w|| 0.5560261115711314
cuda
Objective function 6.68 = squared loss an data 4.78 + 0.5*rho*h**2 0.869710 + alpha*h 0.000000 + L2reg 0.94 + L1reg 0.09 ; SHD = 40 ; DAG False
Proportion of microbatches that were clipped  0.7689590776226047
iteration 1 in inner loop, alpha 0.0 rho 1.0 h 1.3188709148513897
iteration 1 in outer loop, alpha = 1.3188709148513897, rho = 1.0, h = 1.3188709148513897
cuda
1692
cuda
Objective function 8.42 = squared loss an data 4.78 + 0.5*rho*h**2 0.869710 + alpha*h 1.739420 + L2reg 0.94 + L1reg 0.09 ; SHD = 40 ; DAG False
||w||^2 115283887.91174072
exp ma of ||w||^2 3075577732.8250675
||w|| 10737.033478188503
exp ma of ||w|| 42878.379198160226
||w||^2 0.821303327013372
exp ma of ||w||^2 24206717.772674117
||w|| 0.9062578700421707
exp ma of ||w|| 507.21156668995445
||w||^2 0.23220067232503858
exp ma of ||w||^2 485318.3828783286
||w|| 0.4818720497445754
exp ma of ||w|| 10.524603622850613
||w||^2 0.2527358144593099
exp ma of ||w||^2 59.26398825243986
||w|| 0.5027283704539758
exp ma of ||w|| 0.4911530640146057
||w||^2 0.06355726460358224
exp ma of ||w||^2 0.24871505398472044
||w|| 0.25210566158573716
exp ma of ||w|| 0.46984931775483724
||w||^2 0.5597478378177646
exp ma of ||w||^2 0.32374144467767435
||w|| 0.748162975439018
exp ma of ||w|| 0.5343025459881365
||w||^2 0.12612881713803414
exp ma of ||w||^2 0.26688011287325364
||w|| 0.35514619121994556
exp ma of ||w|| 0.48363780304372267
||w||^2 0.4757941421949704
exp ma of ||w||^2 0.3200589809467766
||w|| 0.6897783283019049
exp ma of ||w|| 0.526877430309062
||w||^2 0.04812458056197906
exp ma of ||w||^2 0.29130248001472786
||w|| 0.21937315369474694
exp ma of ||w|| 0.5025376710207714
||w||^2 0.20802355713122933
exp ma of ||w||^2 0.313177284214204
||w|| 0.4560959955220275
exp ma of ||w|| 0.5171214601093448
||w||^2 0.13679427090083332
exp ma of ||w||^2 0.2742161802652712
||w|| 0.36985709524197763
exp ma of ||w|| 0.47647521817502875
||w||^2 0.17203913514163388
exp ma of ||w||^2 0.3627598529445307
||w|| 0.41477600598592235
exp ma of ||w|| 0.5532029791657865
||w||^2 0.05088700446053805
exp ma of ||w||^2 0.3372439213819508
||w|| 0.22558148075703832
exp ma of ||w|| 0.5287243816584202
||w||^2 0.5082042518684545
exp ma of ||w||^2 0.31680289899565767
||w|| 0.7128844589892913
exp ma of ||w|| 0.5245575097747448
||w||^2 0.21069039465646353
exp ma of ||w||^2 0.3180881437318384
||w|| 0.45901023371648647
exp ma of ||w|| 0.5244444068565808
||w||^2 0.29332765428099733
exp ma of ||w||^2 0.35595408710693877
||w|| 0.5415973174610426
exp ma of ||w|| 0.5507765025441267
||w||^2 0.10960058396705413
exp ma of ||w||^2 0.3020812822565303
||w|| 0.3310597891122601
exp ma of ||w|| 0.5111062379716067
||w||^2 0.4553029364043205
exp ma of ||w||^2 0.328326098023021
||w|| 0.6747613922004729
exp ma of ||w|| 0.5320428747921503
||w||^2 0.4821427044668477
exp ma of ||w||^2 0.3022988262900476
||w|| 0.6943649648901129
exp ma of ||w|| 0.5067949538427998
||w||^2 0.05802671473924923
exp ma of ||w||^2 0.33277516086692716
||w|| 0.2408873486492166
exp ma of ||w|| 0.5358065369872685
||w||^2 0.33538760076724566
exp ma of ||w||^2 0.28989461796824645
||w|| 0.5791265844072828
exp ma of ||w|| 0.5044850539172234
||w||^2 0.12598398256028287
exp ma of ||w||^2 0.2979926872007072
||w|| 0.354942224256685
exp ma of ||w|| 0.5072820994060454
||w||^2 0.6491148920109518
exp ma of ||w||^2 0.3423307613358205
||w|| 0.8056766671630449
exp ma of ||w|| 0.5512639768518902
||w||^2 0.07805362853927912
exp ma of ||w||^2 0.3022146911702515
||w|| 0.27938079486478506
exp ma of ||w|| 0.5116545943206436
v before min max tensor([[-1.686,  1.176, -0.262,  ..., -0.299, -1.521,  0.132],
        [ 2.475, -1.302, -0.712,  ..., -0.416, -0.176,  0.075],
        [ 2.800,  1.483, -2.191,  ..., -0.561, -1.304,  1.326],
        ...,
        [-0.482, -1.256,  1.778,  ...,  2.571,  0.569,  0.150],
        [-2.543, -0.890, -2.194,  ...,  1.981, -0.033, -0.825],
        [-1.148, -1.079, -1.068,  ..., -0.337,  1.506, -1.881]],
       device='cuda:0')
v tensor([[1.000e-12, 1.176e+00, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.325e-01],
        [2.475e+00, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         7.528e-02],
        [2.800e+00, 1.483e+00, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.326e+00],
        ...,
        [1.000e-12, 1.000e-12, 1.778e+00,  ..., 2.571e+00, 5.689e-01,
         1.496e-01],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.981e+00, 1.000e-12,
         1.000e-12],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.506e+00,
         1.000e-12]], device='cuda:0')
v before min max tensor([-1.325, -1.369,  1.510,  2.299, -0.783, -1.419, -0.036,  1.324, -2.089,
        -2.200,  3.221, -0.519, -1.530, -0.995,  0.731, -0.656, -1.730, -0.586,
        -0.571, -1.754,  1.188, -1.301,  1.664, 10.204,  1.440, -0.185, -0.702,
        -1.364, -1.149, -1.557, -0.683,  0.110,  0.105,  2.080, -0.280, -1.434,
        -0.566, -1.056,  3.553, -2.161, -1.199, -0.693, -0.659,  0.214, -0.565,
         6.701, -0.164, -0.956,  1.924, -0.574, -0.872, -0.882,  0.379, -0.810,
        -1.419,  1.185,  3.255,  0.301, -0.524,  2.069, -1.406, -1.150,  4.777,
        -1.908, -0.594, -2.186, -1.001, -0.393, -0.052,  5.873, -0.904, -0.391,
         0.221, -0.763, -0.415, -0.294, -0.794, -0.180,  3.929,  8.713, -0.691,
        -0.919, -0.894, -0.459, -0.889,  0.311, -0.608,  2.303, -1.477,  4.001,
         1.129, -1.389,  0.208, -0.973, -0.801,  0.397, -0.866, 11.915, -0.286,
        -1.142, -2.586, -0.726, 13.838,  0.604, -0.262,  2.464, -0.101, -1.792,
        -1.371, -0.905, -0.753,  0.360,  1.200, -0.299,  1.804, -0.461, -1.321,
        -1.170,  0.701, -1.587], device='cuda:0')
v tensor([1.000e-12, 1.000e-12, 1.510e+00, 2.299e+00, 1.000e-12, 1.000e-12,
        1.000e-12, 1.324e+00, 1.000e-12, 1.000e-12, 3.221e+00, 1.000e-12,
        1.000e-12, 1.000e-12, 7.308e-01, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.188e+00, 1.000e-12, 1.664e+00, 1.000e+01,
        1.440e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.096e-01, 1.053e-01, 2.080e+00, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 3.553e+00, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 2.140e-01, 1.000e-12, 6.701e+00, 1.000e-12, 1.000e-12,
        1.924e+00, 1.000e-12, 1.000e-12, 1.000e-12, 3.788e-01, 1.000e-12,
        1.000e-12, 1.185e+00, 3.255e+00, 3.010e-01, 1.000e-12, 2.069e+00,
        1.000e-12, 1.000e-12, 4.777e+00, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 5.873e+00, 1.000e-12, 1.000e-12,
        2.212e-01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        3.929e+00, 8.713e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 3.114e-01, 1.000e-12, 2.303e+00, 1.000e-12, 4.001e+00,
        1.129e+00, 1.000e-12, 2.084e-01, 1.000e-12, 1.000e-12, 3.967e-01,
        1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e+01, 6.037e-01, 1.000e-12, 2.464e+00, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 3.599e-01, 1.200e+00, 1.000e-12,
        1.804e+00, 1.000e-12, 1.000e-12, 1.000e-12, 7.015e-01, 1.000e-12],
       device='cuda:0')
v before min max tensor([[[ 1.563],
         [-0.154],
         [-1.141],
         [-0.697],
         [-2.145],
         [ 0.972],
         [-0.771],
         [-1.155],
         [ 3.460],
         [-0.926]],

        [[-1.317],
         [-1.363],
         [-2.004],
         [-0.499],
         [-1.263],
         [-0.687],
         [-0.466],
         [-0.546],
         [-1.093],
         [ 1.198]],

        [[ 9.653],
         [ 1.080],
         [-0.911],
         [ 0.563],
         [-0.267],
         [-0.765],
         [ 0.723],
         [ 4.570],
         [ 1.101],
         [-0.825]],

        [[-0.449],
         [-0.583],
         [-0.716],
         [-0.795],
         [ 3.188],
         [ 7.327],
         [-1.242],
         [-0.738],
         [-0.413],
         [ 0.346]],

        [[-0.593],
         [-0.777],
         [-0.278],
         [-0.619],
         [-1.834],
         [ 0.480],
         [ 2.787],
         [-1.713],
         [-0.436],
         [ 0.457]],

        [[ 0.593],
         [-1.662],
         [ 4.768],
         [-1.329],
         [-1.597],
         [-0.781],
         [-1.171],
         [ 0.234],
         [ 0.780],
         [ 1.620]],

        [[-0.926],
         [ 2.254],
         [ 5.403],
         [-0.834],
         [ 0.045],
         [ 2.789],
         [-0.424],
         [-0.902],
         [-0.164],
         [ 0.363]],

        [[-0.813],
         [-0.291],
         [ 2.300],
         [ 1.944],
         [-1.863],
         [-1.491],
         [ 3.142],
         [-0.602],
         [ 0.614],
         [-1.363]],

        [[-0.053],
         [-0.999],
         [-0.398],
         [-1.575],
         [-0.742],
         [-0.840],
         [ 0.928],
         [ 1.915],
         [-0.606],
         [-1.902]],

        [[ 0.221],
         [-1.948],
         [ 1.787],
         [ 5.164],
         [-0.891],
         [-1.962],
         [ 0.621],
         [ 0.452],
         [-0.669],
         [-1.443]],

        [[-1.014],
         [-1.600],
         [-1.768],
         [-0.296],
         [ 2.505],
         [-0.689],
         [ 0.603],
         [-0.332],
         [ 2.260],
         [-1.595]],

        [[-0.839],
         [-1.486],
         [-1.160],
         [ 1.608],
         [ 1.184],
         [-1.288],
         [-1.273],
         [-0.747],
         [ 0.273],
         [ 0.801]]], device='cuda:0')
v tensor([[[1.563e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [9.717e-01],
         [1.000e-12],
         [1.000e-12],
         [3.460e+00],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.198e+00]],

        [[9.653e+00],
         [1.080e+00],
         [1.000e-12],
         [5.629e-01],
         [1.000e-12],
         [1.000e-12],
         [7.234e-01],
         [4.570e+00],
         [1.101e+00],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [3.188e+00],
         [7.327e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [3.464e-01]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [4.799e-01],
         [2.787e+00],
         [1.000e-12],
         [1.000e-12],
         [4.572e-01]],

        [[5.927e-01],
         [1.000e-12],
         [4.768e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.336e-01],
         [7.800e-01],
         [1.620e+00]],

        [[1.000e-12],
         [2.254e+00],
         [5.403e+00],
         [1.000e-12],
         [4.467e-02],
         [2.789e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [3.632e-01]],

        [[1.000e-12],
         [1.000e-12],
         [2.300e+00],
         [1.944e+00],
         [1.000e-12],
         [1.000e-12],
         [3.142e+00],
         [1.000e-12],
         [6.145e-01],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [9.280e-01],
         [1.915e+00],
         [1.000e-12],
         [1.000e-12]],

        [[2.212e-01],
         [1.000e-12],
         [1.787e+00],
         [5.164e+00],
         [1.000e-12],
         [1.000e-12],
         [6.208e-01],
         [4.524e-01],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.505e+00],
         [1.000e-12],
         [6.028e-01],
         [1.000e-12],
         [2.260e+00],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.608e+00],
         [1.184e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.726e-01],
         [8.006e-01]]], device='cuda:0')
v before min max tensor([[-0.907],
        [-0.749],
        [-1.425],
        [-1.667],
        [16.715],
        [ 6.818],
        [ 4.531],
        [ 1.146],
        [ 2.334],
        [ 5.708],
        [ 0.312],
        [ 0.208]], device='cuda:0')
v tensor([[1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e+01],
        [6.818e+00],
        [4.531e+00],
        [1.146e+00],
        [2.334e+00],
        [5.708e+00],
        [3.119e-01],
        [2.077e-01]], device='cuda:0')
a after update for 1 param tensor([[-0.013,  0.005, -0.005,  ...,  0.021, -0.005,  0.026],
        [-0.009,  0.007,  0.015,  ..., -0.001, -0.004,  0.002],
        [ 0.009, -0.025,  0.010,  ..., -0.019, -0.001, -0.017],
        ...,
        [ 0.027, -0.016,  0.018,  ..., -0.014,  0.006, -0.003],
        [ 0.016, -0.003, -0.020,  ..., -0.011, -0.004,  0.000],
        [ 0.016, -0.003,  0.007,  ...,  0.033,  0.001,  0.017]],
       device='cuda:0')
s after update for 1 param tensor([[0.995, 1.002, 0.706,  ..., 0.488, 0.922, 0.399],
        [0.880, 0.904, 0.502,  ..., 1.095, 1.009, 1.129],
        [0.725, 0.846, 1.498,  ..., 0.728, 0.722, 0.598],
        ...,
        [1.361, 0.694, 0.774,  ..., 0.731, 0.512, 0.607],
        [1.568, 0.494, 1.349,  ..., 0.823, 0.069, 0.716],
        [0.655, 0.630, 0.725,  ..., 1.052, 0.678, 1.161]], device='cuda:0')
b after update for 1 param tensor([[37.434, 37.567, 31.535,  ..., 26.219, 36.031, 23.697],
        [35.205, 35.680, 26.593,  ..., 39.263, 37.699, 39.880],
        [31.965, 34.508, 45.935,  ..., 32.018, 31.887, 29.026],
        ...,
        [43.788, 31.254, 33.014,  ..., 32.083, 26.842, 29.232],
        [46.990, 26.382, 43.588,  ..., 34.048,  9.847, 31.760],
        [30.377, 29.795, 31.946,  ..., 38.498, 30.908, 40.430]],
       device='cuda:0')
clipping threshold 0.3445186751213795
a after update for 1 param tensor([ 1.589e-02, -1.319e-02, -1.062e-02, -1.186e-02, -4.595e-02,  2.307e-02,
        -2.469e-02,  1.300e-02, -2.819e-02, -1.387e-02,  8.832e-03, -1.447e-02,
         2.697e-02,  3.682e-02,  4.229e-02,  2.777e-02,  4.182e-02,  5.182e-03,
        -2.165e-02, -1.374e-02, -2.012e-02, -3.095e-02, -2.279e-02, -2.589e-02,
        -3.355e-03, -1.647e-02, -2.992e-03,  8.129e-03,  3.748e-02,  7.106e-03,
        -9.499e-03, -4.658e-03,  3.592e-03, -4.060e-02, -6.445e-03,  5.667e-03,
         3.780e-02, -1.155e-02, -1.346e-02, -5.669e-03,  1.230e-02, -5.826e-03,
         1.125e-02, -2.441e-03,  1.790e-02,  1.729e-02,  3.925e-03, -1.584e-02,
         1.374e-02, -7.141e-03,  1.328e-02, -3.976e-03,  2.846e-02, -1.779e-04,
        -5.246e-02, -1.334e-02, -4.605e-02,  2.982e-02, -2.276e-05,  2.436e-02,
         4.125e-02, -2.367e-02, -3.085e-02, -2.574e-02, -1.873e-02, -2.207e-03,
         7.232e-02,  1.966e-02, -2.558e-02, -1.248e-02, -1.396e-02, -1.881e-02,
         1.709e-02, -1.250e-02,  4.696e-04,  9.957e-04, -8.682e-03,  1.649e-02,
        -1.843e-02,  8.050e-03, -1.789e-03,  6.029e-04,  1.164e-02, -4.169e-02,
         7.295e-03, -9.596e-03,  2.457e-02, -9.622e-03, -2.627e-02,  1.067e-02,
         4.604e-03,  1.387e-02,  1.766e-02,  2.709e-02,  5.029e-02, -6.451e-03,
         2.360e-02, -3.729e-02, -2.127e-02, -7.515e-03, -2.711e-02,  1.550e-02,
        -1.048e-02,  2.508e-02,  2.379e-02, -2.729e-03, -2.784e-03,  2.046e-02,
         1.729e-02, -6.494e-03, -3.874e-02,  2.968e-02,  8.733e-03, -1.326e-02,
        -2.208e-02, -1.152e-02,  8.125e-03,  4.661e-02,  2.749e-02, -1.607e-02],
       device='cuda:0')
s after update for 1 param tensor([0.759, 0.763, 0.984, 1.095, 0.964, 1.191, 0.644, 0.728, 1.154, 1.233,
        1.109, 0.392, 0.892, 0.920, 0.363, 0.384, 1.044, 0.387, 0.454, 1.040,
        1.221, 0.748, 0.940, 1.159, 0.870, 0.718, 0.781, 0.755, 0.666, 0.907,
        0.526, 0.631, 0.279, 0.681, 0.822, 0.985, 0.849, 0.582, 0.811, 1.320,
        0.716, 0.457, 0.364, 1.049, 1.085, 1.006, 0.759, 1.031, 0.972, 0.423,
        0.595, 0.568, 0.962, 0.559, 0.910, 0.574, 1.377, 0.905, 0.563, 0.856,
        0.854, 0.834, 1.135, 1.228, 0.328, 1.225, 0.684, 0.376, 0.329, 1.423,
        0.558, 0.529, 0.547, 0.424, 0.305, 0.347, 1.025, 0.706, 0.886, 1.280,
        0.877, 0.572, 0.509, 0.675, 0.670, 0.319, 0.647, 1.081, 0.815, 0.890,
        1.201, 0.798, 0.962, 0.548, 0.623, 0.570, 0.613, 1.487, 0.341, 0.889,
        1.427, 0.926, 1.296, 1.024, 0.561, 0.936, 0.473, 0.993, 0.994, 0.578,
        0.812, 0.699, 0.588, 1.370, 0.541, 1.137, 1.088, 0.739, 0.466, 0.879],
       device='cuda:0')
b after update for 1 param tensor([32.688, 32.790, 37.223, 39.276, 36.845, 40.950, 30.110, 32.029, 40.311,
        41.666, 39.525, 23.481, 35.450, 35.997, 22.602, 23.260, 38.352, 23.342,
        25.279, 38.277, 41.474, 32.448, 36.380, 40.405, 35.001, 31.789, 33.158,
        32.610, 30.624, 35.734, 27.224, 29.800, 19.808, 30.976, 34.016, 37.246,
        34.572, 28.639, 33.787, 43.119, 31.745, 25.374, 22.653, 38.437, 39.093,
        37.645, 32.687, 38.100, 36.999, 24.411, 28.953, 28.271, 36.802, 28.050,
        35.792, 28.433, 44.040, 35.697, 28.170, 34.713, 34.688, 34.271, 39.987,
        41.588, 21.477, 41.539, 31.042, 23.012, 21.535, 44.770, 28.038, 27.298,
        27.755, 24.437, 20.742, 22.120, 38.001, 31.523, 35.320, 42.459, 35.141,
        28.392, 26.775, 30.835, 30.718, 21.183, 30.196, 39.012, 33.875, 35.399,
        41.134, 33.527, 36.799, 27.781, 29.629, 28.342, 29.379, 45.761, 21.907,
        35.391, 44.833, 36.121, 42.720, 37.975, 28.118, 36.303, 25.809, 37.389,
        37.408, 28.535, 33.812, 31.377, 28.781, 43.929, 27.611, 40.011, 39.144,
        32.267, 25.610, 35.187], device='cuda:0')
clipping threshold 0.3445186751213795
a after update for 1 param tensor([[[-1.857e-02],
         [-1.447e-02],
         [ 2.575e-02],
         [-2.114e-02],
         [-2.626e-02],
         [ 3.019e-02],
         [ 1.998e-02],
         [ 1.523e-02],
         [ 2.036e-02],
         [-7.834e-03]],

        [[ 7.184e-03],
         [ 1.292e-02],
         [ 3.981e-02],
         [-5.626e-02],
         [ 9.372e-03],
         [-3.081e-02],
         [ 2.634e-02],
         [ 3.603e-02],
         [-5.662e-03],
         [-2.056e-02]],

        [[ 2.550e-02],
         [ 1.306e-02],
         [ 7.380e-04],
         [ 2.005e-03],
         [-1.545e-03],
         [-8.015e-03],
         [ 3.449e-02],
         [ 3.317e-02],
         [-1.455e-02],
         [ 1.619e-02]],

        [[ 4.934e-03],
         [ 3.000e-02],
         [ 1.234e-02],
         [-3.189e-02],
         [ 3.740e-02],
         [-6.863e-03],
         [ 2.272e-02],
         [-1.975e-02],
         [-4.116e-02],
         [ 3.026e-02]],

        [[ 3.364e-02],
         [ 1.423e-02],
         [ 2.179e-03],
         [-1.719e-02],
         [ 1.134e-03],
         [ 3.476e-02],
         [-5.705e-04],
         [-1.601e-02],
         [-1.288e-02],
         [ 2.591e-03]],

        [[ 1.757e-02],
         [-2.065e-02],
         [ 2.212e-02],
         [-4.990e-03],
         [-1.558e-02],
         [ 4.654e-03],
         [ 5.904e-03],
         [-2.093e-02],
         [-1.754e-02],
         [ 1.545e-02]],

        [[ 8.258e-04],
         [ 1.553e-02],
         [-1.834e-02],
         [-2.339e-02],
         [-1.539e-02],
         [-9.414e-03],
         [-1.591e-02],
         [-1.765e-02],
         [ 1.051e-02],
         [ 2.820e-02]],

        [[-1.838e-02],
         [ 4.351e-02],
         [ 3.168e-02],
         [ 1.544e-02],
         [ 1.385e-02],
         [ 9.286e-03],
         [ 1.410e-02],
         [-2.472e-02],
         [-2.732e-02],
         [ 2.320e-02]],

        [[-1.217e-02],
         [-1.275e-02],
         [ 1.765e-02],
         [ 3.535e-02],
         [ 3.036e-02],
         [-1.039e-02],
         [ 3.351e-02],
         [ 8.754e-03],
         [-1.020e-02],
         [-1.536e-02]],

        [[-2.014e-02],
         [-2.424e-02],
         [ 4.466e-03],
         [-1.284e-02],
         [ 4.787e-03],
         [ 1.457e-02],
         [ 2.776e-02],
         [-3.900e-03],
         [ 2.439e-02],
         [-2.525e-02]],

        [[ 1.774e-02],
         [ 1.462e-02],
         [-6.576e-03],
         [ 4.637e-02],
         [ 3.455e-02],
         [-2.025e-02],
         [-2.925e-03],
         [-8.770e-05],
         [ 1.606e-02],
         [ 1.827e-02]],

        [[ 3.058e-02],
         [ 3.689e-03],
         [-1.693e-02],
         [ 1.827e-02],
         [ 5.456e-03],
         [ 6.096e-03],
         [ 2.504e-02],
         [-1.874e-02],
         [ 2.186e-02],
         [-3.075e-02]]], device='cuda:0')
s after update for 1 param tensor([[[1.416],
         [1.011],
         [0.664],
         [0.983],
         [1.237],
         [0.550],
         [1.093],
         [0.684],
         [1.066],
         [0.720]],

        [[0.769],
         [0.816],
         [1.123],
         [0.673],
         [0.721],
         [1.067],
         [0.879],
         [0.739],
         [0.606],
         [0.789]],

        [[1.338],
         [0.416],
         [0.807],
         [0.515],
         [0.479],
         [0.930],
         [0.905],
         [1.011],
         [0.948],
         [0.478]],

        [[0.620],
         [0.392],
         [0.690],
         [0.811],
         [1.001],
         [1.051],
         [0.716],
         [0.407],
         [0.604],
         [0.498]],

        [[0.878],
         [0.456],
         [0.873],
         [0.931],
         [1.012],
         [0.776],
         [0.969],
         [1.129],
         [0.293],
         [0.484]],

        [[0.754],
         [0.916],
         [1.161],
         [0.764],
         [1.315],
         [0.833],
         [0.649],
         [0.691],
         [0.861],
         [0.853]],

        [[0.513],
         [0.861],
         [0.947],
         [0.460],
         [0.323],
         [0.987],
         [0.612],
         [0.566],
         [0.816],
         [0.811]],

        [[0.895],
         [1.270],
         [1.112],
         [1.125],
         [1.056],
         [0.826],
         [1.501],
         [0.639],
         [1.215],
         [0.760]],

        [[0.816],
         [0.552],
         [0.332],
         [0.928],
         [0.510],
         [0.466],
         [0.539],
         [0.898],
         [0.405],
         [1.067]],

        [[0.664],
         [1.086],
         [0.812],
         [1.028],
         [0.507],
         [1.430],
         [1.233],
         [0.474],
         [0.453],
         [0.903]],

        [[0.595],
         [0.883],
         [1.040],
         [0.990],
         [0.761],
         [0.907],
         [0.514],
         [0.975],
         [1.138],
         [0.881]],

        [[0.640],
         [0.897],
         [0.891],
         [0.785],
         [0.471],
         [0.711],
         [0.975],
         [0.543],
         [0.391],
         [0.737]]], device='cuda:0')
b after update for 1 param tensor([[[44.658],
         [37.732],
         [30.570],
         [37.205],
         [41.743],
         [27.842],
         [39.242],
         [31.045],
         [38.747],
         [31.849]],

        [[32.903],
         [33.899],
         [39.766],
         [30.776],
         [31.872],
         [38.772],
         [35.193],
         [32.264],
         [29.211],
         [33.333]],

        [[43.405],
         [24.217],
         [33.717],
         [26.926],
         [25.965],
         [36.182],
         [35.697],
         [37.739],
         [36.540],
         [25.942]],

        [[29.560],
         [23.499],
         [31.171],
         [33.801],
         [37.550],
         [38.476],
         [31.750],
         [23.946],
         [29.168],
         [26.489]],

        [[35.167],
         [25.353],
         [35.071],
         [36.218],
         [37.743],
         [33.065],
         [36.945],
         [39.870],
         [20.315],
         [26.117]],

        [[32.578],
         [35.927],
         [40.437],
         [32.809],
         [43.031],
         [34.243],
         [30.235],
         [31.190],
         [34.831],
         [34.662]],

        [[26.874],
         [34.824],
         [36.526],
         [25.452],
         [21.335],
         [37.286],
         [29.358],
         [28.223],
         [33.900],
         [33.797]],

        [[35.508],
         [42.298],
         [39.567],
         [39.796],
         [38.558],
         [34.117],
         [45.976],
         [29.998],
         [41.360],
         [32.713]],

        [[33.905],
         [27.870],
         [21.609],
         [36.154],
         [26.804],
         [25.625],
         [27.553],
         [35.553],
         [23.897],
         [38.759]],

        [[30.578],
         [39.100],
         [33.810],
         [38.059],
         [26.715],
         [44.883],
         [41.674],
         [25.829],
         [25.254],
         [35.669]],

        [[28.952],
         [35.258],
         [38.263],
         [37.343],
         [32.736],
         [35.750],
         [26.892],
         [37.047],
         [40.042],
         [35.227]],

        [[30.011],
         [35.551],
         [35.423],
         [33.255],
         [25.754],
         [31.639],
         [37.052],
         [27.646],
         [23.478],
         [32.226]]], device='cuda:0')
clipping threshold 0.3445186751213795
a after update for 1 param tensor([[ 0.000],
        [ 0.009],
        [ 0.003],
        [-0.017],
        [-0.007],
        [ 0.010],
        [-0.002],
        [ 0.000],
        [ 0.016],
        [ 0.004],
        [-0.000],
        [-0.040]], device='cuda:0')
s after update for 1 param tensor([[1.080],
        [1.106],
        [0.929],
        [0.977],
        [1.409],
        [1.276],
        [0.993],
        [0.874],
        [1.119],
        [0.822],
        [0.912],
        [0.492]], device='cuda:0')
b after update for 1 param tensor([[38.993],
        [39.467],
        [36.176],
        [37.093],
        [44.552],
        [42.392],
        [37.391],
        [35.077],
        [39.704],
        [34.032],
        [35.831],
        [26.327]], device='cuda:0')
clipping threshold 0.3445186751213795
cuda
Objective function 7.83 = squared loss an data 4.99 + 0.5*rho*h**2 0.366093 + alpha*h 1.128530 + L2reg 1.26 + L1reg 0.09 ; SHD = 33 ; DAG True
Proportion of microbatches that were clipped  0.7738729426731334
iteration 1 in inner loop, alpha 1.3188709148513897 rho 1.0 h 0.8556787722287602
1692
cuda
Objective function 11.13 = squared loss an data 4.99 + 0.5*rho*h**2 3.660931 + alpha*h 1.128530 + L2reg 1.26 + L1reg 0.09 ; SHD = 33 ; DAG True
||w||^2 3589548572.9052615
exp ma of ||w||^2 8618393924.30904
||w|| 59912.84146913132
exp ma of ||w|| 72823.8473033221
v before min max tensor([[-8.650e-05,  3.589e-06, -2.734e-05,  ...,  2.268e-05, -4.762e-05,
         -2.405e-05],
        [-1.663e-04, -3.370e-05, -8.047e-07,  ...,  2.736e-05,  2.298e-04,
         -1.337e-06],
        [-1.126e-04, -1.030e-04, -1.530e-05,  ..., -1.168e-04,  8.977e-06,
          4.910e-05],
        ...,
        [-4.584e-07, -5.416e-06, -1.171e-05,  ..., -2.385e-05,  1.757e-07,
         -1.371e-05],
        [-6.450e-06, -3.412e-05, -1.924e-04,  ..., -1.462e-05, -6.064e-05,
          1.927e-05],
        [ 5.011e-07,  3.091e-04, -9.056e-05,  ..., -2.673e-05,  5.847e-05,
         -5.866e-06]], device='cuda:0')
v tensor([[1.000e-12, 3.589e-06, 1.000e-12,  ..., 2.268e-05, 1.000e-12,
         1.000e-12],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 2.736e-05, 2.298e-04,
         1.000e-12],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 8.977e-06,
         4.910e-05],
        ...,
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.757e-07,
         1.000e-12],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.927e-05],
        [5.011e-07, 3.091e-04, 1.000e-12,  ..., 1.000e-12, 5.847e-05,
         1.000e-12]], device='cuda:0')
v before min max tensor([-2.554e-05, -7.051e-07, -8.632e-06, -1.643e-05, -3.037e-05, -2.941e-06,
         2.782e-06, -9.404e-05, -9.249e-06, -1.165e-04,  9.642e-06, -3.435e-07,
         1.065e-06, -2.210e-06, -2.761e-06, -5.535e-05,  1.336e-05,  3.059e-06,
         1.150e-03,  1.870e-05, -4.144e-05, -3.050e-05, -2.204e-05,  1.758e-05,
        -9.436e-06, -1.782e-05, -7.715e-05, -5.462e-05, -2.992e-05, -1.531e-04,
         4.315e-07, -1.037e-04,  2.343e-05, -3.371e-06, -4.087e-05,  4.528e-07,
        -1.100e-05, -1.192e-04,  5.576e-05, -2.630e-05, -3.556e-05, -7.603e-06,
        -1.017e-04,  3.971e-06, -2.459e-07, -7.447e-06, -1.180e-06, -1.506e-04,
        -2.711e-05, -4.576e-07, -6.381e-06, -2.696e-05,  1.722e-06, -4.879e-04,
        -7.028e-05, -3.550e-06, -3.694e-05, -2.915e-05,  1.271e-05,  5.556e-05,
        -2.508e-05, -4.949e-05, -2.624e-05, -1.498e-05, -4.614e-05,  2.125e-08,
        -2.331e-06, -2.864e-05,  6.340e-06, -2.537e-06, -1.814e-05, -1.074e-06,
        -1.635e-04, -1.137e-05, -2.687e-05,  2.544e-05, -1.052e-04, -3.067e-05,
        -2.505e-07, -3.410e-05, -2.015e-07, -3.242e-05,  8.549e-05,  1.790e-06,
         2.854e-05, -6.138e-06, -4.610e-05, -2.652e-06, -2.193e-05, -1.468e-04,
        -1.684e-05, -3.180e-05, -3.989e-05,  2.354e-06,  5.999e-05, -1.194e-05,
        -7.320e-06, -3.046e-05, -1.735e-04, -7.241e-06, -3.764e-05, -1.161e-06,
         2.476e-06,  4.491e-06,  6.503e-06, -9.638e-05, -4.211e-06,  5.584e-06,
        -1.905e-04, -7.151e-05,  4.464e-05, -2.748e-04,  1.161e-05, -5.334e-05,
        -2.657e-05, -6.306e-05, -6.291e-07, -4.099e-07, -2.019e-04, -2.488e-04],
       device='cuda:0')
v tensor([1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        2.782e-06, 1.000e-12, 1.000e-12, 1.000e-12, 9.642e-06, 1.000e-12,
        1.065e-06, 1.000e-12, 1.000e-12, 1.000e-12, 1.336e-05, 3.059e-06,
        1.150e-03, 1.870e-05, 1.000e-12, 1.000e-12, 1.000e-12, 1.758e-05,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        4.315e-07, 1.000e-12, 2.343e-05, 1.000e-12, 1.000e-12, 4.528e-07,
        1.000e-12, 1.000e-12, 5.576e-05, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 3.971e-06, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.722e-06, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.271e-05, 5.556e-05,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 2.125e-08,
        1.000e-12, 1.000e-12, 6.340e-06, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 2.544e-05, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 8.549e-05, 1.790e-06,
        2.854e-05, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 2.354e-06, 5.999e-05, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        2.476e-06, 4.491e-06, 6.503e-06, 1.000e-12, 1.000e-12, 5.584e-06,
        1.000e-12, 1.000e-12, 4.464e-05, 1.000e-12, 1.161e-05, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12],
       device='cuda:0')
v before min max tensor([[[-3.636e-06],
         [-4.106e-06],
         [ 1.126e-04],
         [-9.701e-05],
         [-2.805e-05],
         [-1.769e-05],
         [-1.920e-05],
         [ 2.621e-06],
         [-1.258e-05],
         [-1.437e-05]],

        [[-1.037e-04],
         [ 1.803e-06],
         [-1.836e-05],
         [-5.661e-06],
         [ 5.391e-06],
         [-6.588e-05],
         [-5.651e-05],
         [-2.149e-06],
         [-1.770e-05],
         [-5.375e-05]],

        [[-1.010e-04],
         [-5.648e-06],
         [-2.630e-05],
         [-9.330e-06],
         [-3.151e-05],
         [-2.739e-05],
         [-5.874e-05],
         [-2.120e-05],
         [ 1.706e-07],
         [-4.122e-05]],

        [[ 4.335e-05],
         [-1.308e-04],
         [-2.100e-05],
         [ 5.104e-06],
         [ 7.940e-06],
         [-1.695e-05],
         [-9.372e-06],
         [-1.194e-04],
         [-1.036e-04],
         [-3.692e-07]],

        [[-4.622e-05],
         [ 3.775e-06],
         [-1.831e-05],
         [-1.466e-07],
         [-4.227e-07],
         [ 2.626e-05],
         [-4.694e-06],
         [-4.194e-05],
         [-1.905e-05],
         [ 6.069e-05]],

        [[ 1.364e-05],
         [-1.008e-07],
         [ 4.363e-05],
         [-9.786e-06],
         [ 2.016e-05],
         [-1.468e-04],
         [-2.492e-05],
         [-2.157e-07],
         [-1.214e-04],
         [-2.340e-06]],

        [[-4.903e-05],
         [ 1.148e-05],
         [ 5.167e-05],
         [-2.226e-06],
         [ 5.489e-06],
         [ 6.919e-04],
         [-1.012e-04],
         [ 4.877e-05],
         [-2.337e-04],
         [-2.335e-04]],

        [[-6.451e-05],
         [ 3.636e-06],
         [-6.350e-06],
         [-4.560e-06],
         [-7.659e-06],
         [-3.802e-05],
         [-1.665e-05],
         [ 4.772e-06],
         [-1.348e-05],
         [-3.354e-05]],

        [[-9.704e-07],
         [-1.372e-06],
         [-6.131e-05],
         [-7.790e-05],
         [ 1.346e-06],
         [-1.545e-05],
         [-1.258e-04],
         [ 1.050e-05],
         [-4.777e-05],
         [ 1.576e-06]],

        [[-2.359e-05],
         [ 2.373e-04],
         [ 2.315e-04],
         [-1.469e-06],
         [-3.751e-05],
         [ 4.785e-05],
         [-3.902e-05],
         [-3.024e-04],
         [-7.943e-05],
         [-7.665e-05]],

        [[-3.050e-07],
         [ 5.090e-06],
         [-7.394e-05],
         [-4.602e-05],
         [ 1.000e-04],
         [-5.080e-04],
         [-2.892e-05],
         [ 4.217e-06],
         [ 1.231e-05],
         [-4.706e-05]],

        [[-2.886e-05],
         [ 4.220e-05],
         [-1.427e-04],
         [ 9.665e-06],
         [ 2.576e-04],
         [-4.433e-05],
         [-7.620e-08],
         [ 1.526e-05],
         [-2.101e-06],
         [ 1.433e-05]]], device='cuda:0')
v tensor([[[1.000e-12],
         [1.000e-12],
         [1.126e-04],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.621e-06],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.803e-06],
         [1.000e-12],
         [1.000e-12],
         [5.391e-06],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.706e-07],
         [1.000e-12]],

        [[4.335e-05],
         [1.000e-12],
         [1.000e-12],
         [5.104e-06],
         [7.940e-06],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [3.775e-06],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.626e-05],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [6.069e-05]],

        [[1.364e-05],
         [1.000e-12],
         [4.363e-05],
         [1.000e-12],
         [2.016e-05],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.148e-05],
         [5.167e-05],
         [1.000e-12],
         [5.489e-06],
         [6.919e-04],
         [1.000e-12],
         [4.877e-05],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [3.636e-06],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [4.772e-06],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.346e-06],
         [1.000e-12],
         [1.000e-12],
         [1.050e-05],
         [1.000e-12],
         [1.576e-06]],

        [[1.000e-12],
         [2.373e-04],
         [2.315e-04],
         [1.000e-12],
         [1.000e-12],
         [4.785e-05],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [5.090e-06],
         [1.000e-12],
         [1.000e-12],
         [1.000e-04],
         [1.000e-12],
         [1.000e-12],
         [4.217e-06],
         [1.231e-05],
         [1.000e-12]],

        [[1.000e-12],
         [4.220e-05],
         [1.000e-12],
         [9.665e-06],
         [2.576e-04],
         [1.000e-12],
         [1.000e-12],
         [1.526e-05],
         [1.000e-12],
         [1.433e-05]]], device='cuda:0')
v before min max tensor([[-2.330e-05],
        [-1.118e-05],
        [-1.178e-05],
        [-1.836e-05],
        [ 8.124e-05],
        [-4.185e-05],
        [ 2.390e-04],
        [-7.392e-05],
        [-1.196e-05],
        [ 4.477e-05],
        [ 1.011e-05],
        [-1.638e-04]], device='cuda:0')
v tensor([[1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [8.124e-05],
        [1.000e-12],
        [2.390e-04],
        [1.000e-12],
        [1.000e-12],
        [4.477e-05],
        [1.011e-05],
        [1.000e-12]], device='cuda:0')
a after update for 1 param tensor([[-2.435e-05, -8.548e-06,  5.288e-06,  ..., -1.675e-05,  1.277e-05,
         -1.083e-05],
        [ 2.479e-05, -1.842e-05, -3.004e-07,  ...,  1.572e-05, -3.853e-05,
          1.159e-06],
        [-1.230e-05,  1.295e-05,  2.867e-06,  ...,  1.766e-05,  9.988e-06,
         -1.355e-05],
        ...,
        [-3.509e-07, -8.405e-06, -1.655e-06,  ...,  1.416e-05, -2.358e-06,
          1.457e-06],
        [-1.507e-05,  2.076e-07, -1.937e-05,  ..., -1.094e-05,  1.362e-07,
         -3.221e-05],
        [-7.190e-06, -4.764e-05,  2.523e-05,  ..., -6.685e-06, -1.339e-05,
         -2.512e-07]], device='cuda:0')
s after update for 1 param tensor([[8.269e-04, 5.998e-04, 2.352e-04,  ..., 1.522e-03, 4.044e-04,
         2.073e-04],
        [2.001e-03, 6.807e-04, 8.887e-06,  ..., 1.715e-03, 4.819e-03,
         5.390e-05],
        [9.562e-04, 9.038e-04, 1.318e-04,  ..., 1.017e-03, 9.499e-04,
         2.264e-03],
        ...,
        [1.893e-05, 1.295e-04, 1.767e-04,  ..., 3.436e-04, 1.326e-04,
         1.166e-04],
        [1.454e-04, 2.906e-04, 1.743e-03,  ..., 1.251e-04, 6.053e-04,
         1.602e-03],
        [2.286e-04, 5.585e-03, 1.149e-03,  ..., 2.365e-04, 2.499e-03,
         4.985e-05]], device='cuda:0')
b after update for 1 param tensor([[0.036, 0.031, 0.019,  ..., 0.049, 0.025, 0.018],
        [0.056, 0.033, 0.004,  ..., 0.052, 0.087, 0.009],
        [0.039, 0.038, 0.014,  ..., 0.040, 0.039, 0.060],
        ...,
        [0.005, 0.014, 0.017,  ..., 0.023, 0.014, 0.014],
        [0.015, 0.021, 0.052,  ..., 0.014, 0.031, 0.050],
        [0.019, 0.094, 0.042,  ..., 0.019, 0.063, 0.009]], device='cuda:0')
clipping threshold 3.535280241290432
a after update for 1 param tensor([-1.151e-05, -8.625e-06, -4.957e-06,  6.578e-06,  2.433e-06,  4.333e-06,
        -3.346e-05, -1.129e-05, -1.618e-06,  8.075e-06, -3.571e-06,  2.144e-06,
        -2.574e-06,  1.789e-06,  2.038e-07,  2.389e-05,  1.976e-05,  1.188e-05,
        -5.958e-05, -1.378e-05, -4.521e-06, -8.827e-06,  2.125e-05, -2.013e-05,
        -1.711e-06, -1.904e-06,  1.784e-05, -8.894e-06,  1.483e-05,  2.158e-05,
         1.995e-06,  1.418e-06, -1.066e-05, -1.709e-06, -1.362e-05, -6.818e-06,
        -1.343e-06, -3.044e-06, -1.435e-05, -1.068e-06,  1.069e-05, -4.646e-06,
        -2.900e-05, -9.055e-06, -2.602e-07,  4.974e-06, -1.413e-06, -2.150e-05,
         5.288e-06, -8.614e-07,  6.136e-07, -2.620e-06, -5.840e-06,  4.479e-05,
         1.484e-05, -2.237e-06, -1.773e-05, -8.106e-06,  2.003e-05, -2.139e-05,
        -1.400e-05, -9.952e-06,  8.804e-06,  2.295e-06,  1.052e-06, -2.525e-06,
        -1.203e-06, -1.786e-05,  3.771e-06,  7.447e-07,  8.424e-06,  4.218e-06,
         4.308e-06,  6.170e-06, -8.610e-07, -1.878e-05, -2.947e-07,  5.524e-06,
         2.719e-08, -7.176e-06,  1.563e-06,  1.940e-05,  3.005e-05,  3.377e-06,
         1.443e-05, -3.316e-06, -6.273e-06,  2.841e-05,  4.250e-06,  5.120e-06,
         8.424e-06, -1.357e-05,  1.641e-05, -7.416e-06, -3.372e-05, -5.615e-06,
        -4.548e-06,  4.959e-07,  9.536e-06,  5.257e-06, -2.028e-06, -5.843e-08,
        -9.994e-06,  7.968e-06, -1.284e-05, -2.316e-05,  1.662e-05, -9.670e-06,
        -3.628e-05,  5.468e-06,  1.379e-05, -1.791e-05, -2.198e-05,  1.793e-05,
         2.976e-05, -3.584e-07, -4.322e-07,  4.471e-07,  3.448e-06,  6.215e-06],
       device='cuda:0')
s after update for 1 param tensor([2.643e-04, 1.084e-04, 8.331e-05, 1.434e-04, 3.589e-04, 8.065e-05,
        1.516e-03, 8.629e-04, 8.257e-05, 9.908e-04, 9.824e-04, 1.171e-05,
        3.264e-04, 2.175e-05, 2.499e-05, 9.937e-04, 1.453e-03, 5.832e-04,
        1.077e-02, 1.414e-03, 3.536e-04, 3.564e-04, 3.610e-04, 1.362e-03,
        8.226e-05, 1.517e-04, 9.131e-04, 4.745e-04, 4.645e-04, 1.300e-03,
        2.077e-04, 9.232e-04, 1.544e-03, 1.700e-04, 4.833e-04, 2.175e-04,
        9.386e-05, 1.058e-03, 2.367e-03, 2.399e-04, 3.078e-04, 7.424e-05,
        1.136e-03, 6.320e-04, 2.477e-06, 7.077e-05, 1.309e-05, 1.468e-03,
        2.309e-04, 1.060e-05, 5.422e-05, 2.292e-04, 4.443e-04, 4.154e-03,
        6.474e-04, 3.134e-05, 6.764e-04, 2.518e-04, 1.140e-03, 2.447e-03,
        2.829e-04, 4.462e-04, 3.016e-04, 1.352e-04, 3.959e-04, 9.289e-05,
        4.410e-05, 4.258e-04, 7.965e-04, 2.289e-05, 5.432e-04, 4.950e-05,
        1.746e-03, 1.336e-04, 2.306e-04, 1.659e-03, 2.243e-03, 2.611e-04,
        2.987e-06, 5.015e-04, 4.731e-06, 1.254e-03, 2.996e-03, 4.231e-04,
        1.691e-03, 5.211e-05, 3.967e-04, 1.184e-03, 2.135e-04, 1.330e-03,
        4.371e-04, 3.448e-04, 6.394e-04, 4.858e-04, 2.465e-03, 1.093e-04,
        6.221e-05, 2.621e-04, 1.481e-03, 1.034e-04, 3.381e-04, 1.003e-05,
        5.539e-04, 6.715e-04, 8.328e-04, 1.191e-03, 4.222e-04, 7.571e-04,
        1.841e-03, 6.608e-04, 2.114e-03, 2.334e-03, 1.135e-03, 4.555e-04,
        7.026e-04, 5.650e-04, 6.223e-06, 4.507e-06, 2.130e-03, 2.217e-03],
       device='cuda:0')
b after update for 1 param tensor([0.020, 0.013, 0.011, 0.015, 0.024, 0.011, 0.049, 0.037, 0.011, 0.039,
        0.039, 0.004, 0.023, 0.006, 0.006, 0.039, 0.048, 0.030, 0.130, 0.047,
        0.024, 0.024, 0.024, 0.046, 0.011, 0.015, 0.038, 0.027, 0.027, 0.045,
        0.018, 0.038, 0.049, 0.016, 0.028, 0.018, 0.012, 0.041, 0.061, 0.019,
        0.022, 0.011, 0.042, 0.031, 0.002, 0.011, 0.005, 0.048, 0.019, 0.004,
        0.009, 0.019, 0.026, 0.081, 0.032, 0.007, 0.033, 0.020, 0.042, 0.062,
        0.021, 0.026, 0.022, 0.015, 0.025, 0.012, 0.008, 0.026, 0.035, 0.006,
        0.029, 0.009, 0.052, 0.014, 0.019, 0.051, 0.059, 0.020, 0.002, 0.028,
        0.003, 0.044, 0.069, 0.026, 0.051, 0.009, 0.025, 0.043, 0.018, 0.046,
        0.026, 0.023, 0.032, 0.028, 0.062, 0.013, 0.010, 0.020, 0.048, 0.013,
        0.023, 0.004, 0.029, 0.032, 0.036, 0.043, 0.026, 0.034, 0.054, 0.032,
        0.058, 0.060, 0.042, 0.027, 0.033, 0.030, 0.003, 0.003, 0.058, 0.059],
       device='cuda:0')
clipping threshold 3.535280241290432
a after update for 1 param tensor([[[ 2.142e-06],
         [-1.852e-06],
         [ 2.983e-05],
         [ 1.825e-06],
         [ 2.416e-06],
         [ 3.532e-06],
         [-2.973e-06],
         [ 3.766e-06],
         [ 1.104e-05],
         [-5.767e-08]],

        [[-1.694e-05],
         [-2.215e-06],
         [-8.457e-06],
         [-7.087e-07],
         [ 5.748e-06],
         [-6.803e-06],
         [ 8.775e-06],
         [ 6.040e-06],
         [ 4.920e-06],
         [-2.102e-05]],

        [[-2.386e-05],
         [ 1.520e-06],
         [ 5.001e-06],
         [-2.597e-06],
         [-3.652e-05],
         [ 1.079e-05],
         [-6.008e-06],
         [ 6.188e-06],
         [ 5.697e-07],
         [-1.185e-05]],

        [[ 1.805e-05],
         [ 3.938e-05],
         [ 5.622e-07],
         [-1.699e-05],
         [-6.329e-06],
         [-2.066e-06],
         [-5.391e-06],
         [-3.008e-05],
         [ 4.529e-05],
         [-9.046e-07]],

        [[-1.373e-06],
         [-5.584e-06],
         [-7.419e-06],
         [ 1.213e-06],
         [-1.373e-06],
         [ 1.629e-05],
         [-1.706e-06],
         [-4.692e-06],
         [-3.046e-06],
         [-3.716e-05]],

        [[ 1.170e-05],
         [ 1.182e-06],
         [ 1.106e-05],
         [-2.360e-06],
         [ 1.123e-05],
         [ 6.441e-06],
         [ 1.063e-05],
         [ 1.075e-06],
         [ 1.915e-05],
         [-1.920e-07]],

        [[ 5.882e-06],
         [ 7.265e-06],
         [-3.209e-05],
         [-3.461e-07],
         [-1.340e-05],
         [ 5.480e-05],
         [-1.652e-08],
         [ 1.142e-05],
         [-2.733e-05],
         [-2.562e-05]],

        [[-7.923e-07],
         [ 1.239e-05],
         [ 1.778e-06],
         [ 1.726e-06],
         [-2.340e-05],
         [-5.941e-06],
         [-8.521e-06],
         [-2.415e-05],
         [ 7.815e-06],
         [ 9.276e-06]],

        [[-1.702e-06],
         [-2.379e-07],
         [ 2.114e-05],
         [-3.052e-05],
         [-1.105e-05],
         [ 3.349e-05],
         [ 1.270e-05],
         [-1.569e-05],
         [-4.283e-06],
         [-5.173e-06]],

        [[-1.845e-05],
         [ 3.745e-05],
         [ 4.334e-05],
         [-1.904e-06],
         [ 7.571e-06],
         [-3.037e-05],
         [ 8.747e-06],
         [ 2.766e-05],
         [ 1.185e-05],
         [ 1.975e-06]],

        [[-1.446e-06],
         [-4.349e-06],
         [-2.945e-06],
         [ 1.934e-06],
         [-3.070e-05],
         [-4.038e-05],
         [-1.030e-05],
         [-4.170e-06],
         [-1.468e-05],
         [ 2.292e-06]],

        [[-4.796e-05],
         [ 2.638e-05],
         [ 5.419e-06],
         [ 1.040e-05],
         [-2.921e-05],
         [-1.201e-06],
         [ 1.168e-06],
         [ 1.195e-05],
         [-6.127e-06],
         [ 5.585e-06]]], device='cuda:0')
s after update for 1 param tensor([[[3.153e-05],
         [3.629e-05],
         [3.385e-03],
         [9.090e-04],
         [3.107e-04],
         [1.685e-04],
         [1.630e-04],
         [5.121e-04],
         [1.380e-04],
         [1.382e-04]],

        [[1.230e-03],
         [4.307e-04],
         [2.050e-04],
         [2.470e-04],
         [7.391e-04],
         [5.614e-04],
         [5.161e-04],
         [9.171e-05],
         [1.839e-04],
         [9.879e-04]],

        [[8.584e-04],
         [5.950e-05],
         [2.286e-04],
         [1.127e-04],
         [7.868e-04],
         [4.420e-04],
         [5.004e-04],
         [3.201e-04],
         [1.306e-04],
         [8.364e-04]],

        [[2.176e-03],
         [1.627e-03],
         [1.786e-04],
         [7.626e-04],
         [8.913e-04],
         [1.744e-04],
         [1.001e-04],
         [1.647e-03],
         [2.565e-03],
         [6.136e-06]],

        [[4.296e-04],
         [6.151e-04],
         [2.229e-04],
         [5.325e-06],
         [6.310e-06],
         [1.625e-03],
         [5.101e-05],
         [4.794e-04],
         [1.636e-04],
         [2.587e-03]],

        [[1.248e-03],
         [5.870e-06],
         [2.091e-03],
         [1.145e-04],
         [1.422e-03],
         [1.260e-03],
         [2.440e-04],
         [4.506e-06],
         [1.253e-03],
         [4.034e-05]],

        [[8.173e-04],
         [1.074e-03],
         [2.447e-03],
         [1.930e-05],
         [7.722e-04],
         [8.944e-03],
         [8.926e-04],
         [2.230e-03],
         [2.031e-03],
         [2.224e-03]],

        [[6.001e-04],
         [6.548e-04],
         [8.801e-05],
         [6.933e-05],
         [3.348e-04],
         [3.239e-04],
         [1.574e-04],
         [9.307e-04],
         [1.145e-04],
         [3.211e-04]],

        [[1.935e-05],
         [1.165e-05],
         [7.443e-04],
         [1.444e-03],
         [4.152e-04],
         [1.318e-03],
         [1.232e-03],
         [1.064e-03],
         [4.242e-04],
         [4.046e-04]],

        [[3.169e-04],
         [5.043e-03],
         [5.005e-03],
         [1.268e-05],
         [7.090e-04],
         [2.211e-03],
         [9.167e-04],
         [2.734e-03],
         [8.448e-04],
         [6.517e-04]],

        [[6.429e-05],
         [7.134e-04],
         [6.550e-04],
         [5.227e-04],
         [3.185e-03],
         [4.314e-03],
         [3.289e-04],
         [6.494e-04],
         [1.337e-03],
         [4.970e-04]],

        [[2.145e-03],
         [2.110e-03],
         [1.224e-03],
         [9.912e-04],
         [5.103e-03],
         [4.070e-04],
         [1.749e-06],
         [1.258e-03],
         [1.752e-04],
         [1.198e-03]]], device='cuda:0')
b after update for 1 param tensor([[[0.007],
         [0.008],
         [0.073],
         [0.038],
         [0.022],
         [0.016],
         [0.016],
         [0.028],
         [0.015],
         [0.015]],

        [[0.044],
         [0.026],
         [0.018],
         [0.020],
         [0.034],
         [0.030],
         [0.028],
         [0.012],
         [0.017],
         [0.039]],

        [[0.037],
         [0.010],
         [0.019],
         [0.013],
         [0.035],
         [0.026],
         [0.028],
         [0.022],
         [0.014],
         [0.036]],

        [[0.058],
         [0.050],
         [0.017],
         [0.035],
         [0.037],
         [0.017],
         [0.013],
         [0.051],
         [0.063],
         [0.003]],

        [[0.026],
         [0.031],
         [0.019],
         [0.003],
         [0.003],
         [0.050],
         [0.009],
         [0.027],
         [0.016],
         [0.064]],

        [[0.044],
         [0.003],
         [0.057],
         [0.013],
         [0.047],
         [0.044],
         [0.020],
         [0.003],
         [0.044],
         [0.008]],

        [[0.036],
         [0.041],
         [0.062],
         [0.005],
         [0.035],
         [0.118],
         [0.037],
         [0.059],
         [0.056],
         [0.059]],

        [[0.031],
         [0.032],
         [0.012],
         [0.010],
         [0.023],
         [0.023],
         [0.016],
         [0.038],
         [0.013],
         [0.022]],

        [[0.006],
         [0.004],
         [0.034],
         [0.048],
         [0.026],
         [0.045],
         [0.044],
         [0.041],
         [0.026],
         [0.025]],

        [[0.022],
         [0.089],
         [0.089],
         [0.004],
         [0.033],
         [0.059],
         [0.038],
         [0.065],
         [0.036],
         [0.032]],

        [[0.010],
         [0.033],
         [0.032],
         [0.029],
         [0.071],
         [0.082],
         [0.023],
         [0.032],
         [0.046],
         [0.028]],

        [[0.058],
         [0.057],
         [0.044],
         [0.039],
         [0.089],
         [0.025],
         [0.002],
         [0.044],
         [0.017],
         [0.043]]], device='cuda:0')
clipping threshold 3.535280241290432
a after update for 1 param tensor([[-3.044e-05],
        [ 8.536e-07],
        [ 3.953e-06],
        [-4.873e-06],
        [ 1.954e-05],
        [-1.228e-05],
        [ 4.956e-05],
        [-7.878e-06],
        [-9.281e-06],
        [ 9.256e-06],
        [-9.199e-06],
        [-2.064e-05]], device='cuda:0')
s after update for 1 param tensor([[0.001],
        [0.000],
        [0.000],
        [0.000],
        [0.003],
        [0.000],
        [0.005],
        [0.001],
        [0.000],
        [0.002],
        [0.001],
        [0.001]], device='cuda:0')
b after update for 1 param tensor([[0.041],
        [0.015],
        [0.013],
        [0.016],
        [0.067],
        [0.024],
        [0.089],
        [0.036],
        [0.017],
        [0.058],
        [0.040],
        [0.048]], device='cuda:0')
clipping threshold 3.535280241290432
||w||^2 0.21496737206411373
exp ma of ||w||^2 4262.191519774053
||w|| 0.4636457398317316
exp ma of ||w|| 0.5531982171251513
||w||^2 1.0450033729601487
exp ma of ||w||^2 879.9941660739307
||w|| 1.0222540647804481
exp ma of ||w|| 0.5261860960049942
||w||^2 0.36592340942680857
exp ma of ||w||^2 215.7042766296701
||w|| 0.6049160350220587
exp ma of ||w|| 0.5105820805711301
||w||^2 0.09496467703621068
exp ma of ||w||^2 166.17456136128718
||w|| 0.30816339340715126
exp ma of ||w|| 0.5111791432985396
||w||^2 0.28900482857759674
exp ma of ||w||^2 1.5646592150427445
||w|| 0.5375916931813556
exp ma of ||w|| 0.536905091213123
||w||^2 0.21607307810451282
exp ma of ||w||^2 0.37345555891065113
||w|| 0.4648366144189943
exp ma of ||w|| 0.5642402348710783
||w||^2 0.17278278659739757
exp ma of ||w||^2 0.3224912102538087
||w|| 0.4156714887954159
exp ma of ||w|| 0.5297152505929821
||w||^2 0.07234445026362883
exp ma of ||w||^2 0.36266302461033717
||w|| 0.2689692366491544
exp ma of ||w|| 0.5610457527513775
||w||^2 0.49540954365095974
exp ma of ||w||^2 0.3235552354480831
||w|| 0.703853353796769
exp ma of ||w|| 0.5355242246138707
||w||^2 0.36047554381927654
exp ma of ||w||^2 0.2908000876464381
||w|| 0.6003961557332597
exp ma of ||w|| 0.5041431648513398
||w||^2 0.9115796633539425
exp ma of ||w||^2 0.31924276105396315
||w|| 0.9547668109826307
exp ma of ||w|| 0.5227853008315544
||w||^2 0.5401603747478536
exp ma of ||w||^2 0.3242248496037734
||w|| 0.7349560359285809
exp ma of ||w|| 0.5334056133347491
||w||^2 0.24167688621174754
exp ma of ||w||^2 0.32770933148049036
||w|| 0.49160643426601686
exp ma of ||w|| 0.535497497517185
||w||^2 0.22565415971134817
exp ma of ||w||^2 0.3616787167845005
||w|| 0.4750306934413272
exp ma of ||w|| 0.5591085004313824
||w||^2 0.3463743021278081
exp ma of ||w||^2 0.3233954589586871
||w|| 0.5885357271464563
exp ma of ||w|| 0.5207155472740841
||w||^2 0.3414044015490494
exp ma of ||w||^2 0.31907832668010194
||w|| 0.5842982128579972
exp ma of ||w|| 0.5206120679403836
||w||^2 0.046645544450910056
exp ma of ||w||^2 0.36413723426185474
||w|| 0.21597579598397146
exp ma of ||w|| 0.5545708793327896
||w||^2 0.09762594437345788
exp ma of ||w||^2 0.3396341663973491
||w|| 0.3124515072350554
exp ma of ||w|| 0.5428998166151524
||w||^2 0.19947979123482773
exp ma of ||w||^2 0.40014649685156606
||w|| 0.446631605727615
exp ma of ||w|| 0.5900172635704131
||w||^2 0.37531791810676385
exp ma of ||w||^2 0.3041099715831212
||w|| 0.6126319597497047
exp ma of ||w|| 0.510365395823549
||w||^2 0.06837783236063742
exp ma of ||w||^2 0.3280525889941919
||w|| 0.26149155313439365
exp ma of ||w|| 0.530017192673116
||w||^2 0.23643339878084374
exp ma of ||w||^2 0.35046966263781804
||w|| 0.48624417608938386
exp ma of ||w|| 0.5510204903354359
||w||^2 0.22417901264931814
exp ma of ||w||^2 0.30734655907479674
||w|| 0.4734754615070544
exp ma of ||w|| 0.5176475046119347
||w||^2 0.12393985104243051
exp ma of ||w||^2 0.3311386510530212
||w|| 0.3520509210930011
exp ma of ||w|| 0.5411177435566767
||w||^2 0.2888022189722733
exp ma of ||w||^2 0.3250309347629536
||w|| 0.5374032182377337
exp ma of ||w|| 0.5291978344266851
||w||^2 0.11480794657510125
exp ma of ||w||^2 0.3387525013555282
||w|| 0.33883321350644074
exp ma of ||w|| 0.5422006027813233
||w||^2 0.12784527770476364
exp ma of ||w||^2 0.4224974742688962
||w|| 0.35755458003606055
exp ma of ||w|| 0.6002201584150535
||w||^2 0.3051614965378909
exp ma of ||w||^2 0.3196125743590843
||w|| 0.552414243605187
exp ma of ||w|| 0.5278244674888338
||w||^2 0.5245996064914361
exp ma of ||w||^2 0.30108288831819985
||w|| 0.724292486839009
exp ma of ||w|| 0.5184862520128729
||w||^2 0.31342751426107124
exp ma of ||w||^2 0.33549030514954753
||w|| 0.5598459736937216
exp ma of ||w|| 0.5400228678138331
||w||^2 0.11676126559788132
exp ma of ||w||^2 0.32816228159251504
||w|| 0.3417034761278868
exp ma of ||w|| 0.5220787028282711
||w||^2 0.09322685103013986
exp ma of ||w||^2 0.32176098309758494
||w|| 0.3053307240192835
exp ma of ||w|| 0.5291740481270272
cuda
Objective function 8.87 = squared loss an data 6.34 + 0.5*rho*h**2 0.609631 + alpha*h 0.460522 + L2reg 1.39 + L1reg 0.08 ; SHD = 28 ; DAG True
Proportion of microbatches that were clipped  0.7712631197973218
iteration 2 in inner loop, alpha 1.3188709148513897 rho 10.0 h 0.3491792599767862
1692
cuda
Objective function 14.36 = squared loss an data 6.34 + 0.5*rho*h**2 6.096308 + alpha*h 0.460522 + L2reg 1.39 + L1reg 0.08 ; SHD = 28 ; DAG True
||w||^2 0.5940618104308326
exp ma of ||w||^2 74.78545427527493
||w|| 0.7707540531394127
exp ma of ||w|| 0.5128365291703989
||w||^2 0.40226107201550354
exp ma of ||w||^2 0.31214837594898387
||w|| 0.6342405474388274
exp ma of ||w|| 0.5215042320035992
||w||^2 0.03456873488605632
exp ma of ||w||^2 0.39621172407237826
||w|| 0.18592669223663483
exp ma of ||w|| 0.5834367591769288
||w||^2 0.24644688805332776
exp ma of ||w||^2 0.37314069940057903
||w|| 0.4964341729306392
exp ma of ||w|| 0.5656159413119102
||w||^2 0.07585181270987758
exp ma of ||w||^2 0.33661078460647914
||w|| 0.2754120780029038
exp ma of ||w|| 0.5361468173375942
||w||^2 0.34298229493752524
exp ma of ||w||^2 0.3323132661030818
||w|| 0.5856469029522186
exp ma of ||w|| 0.5405733980827216
||w||^2 0.08573257401278514
exp ma of ||w||^2 0.3562200880690599
||w|| 0.2928012534344502
exp ma of ||w|| 0.5503885634852389
||w||^2 0.14601255797516782
exp ma of ||w||^2 0.36792353448375303
||w|| 0.3821158959990644
exp ma of ||w|| 0.5591964597513015
||w||^2 0.12379876680778662
exp ma of ||w||^2 0.4047023328189413
||w|| 0.35185048928172125
exp ma of ||w|| 0.5894286524359345
||w||^2 0.05427739396068588
exp ma of ||w||^2 0.37960898214225136
||w|| 0.23297509300499458
exp ma of ||w|| 0.5692381487994675
||w||^2 1.3006033716925853
exp ma of ||w||^2 0.40029089395799
||w|| 1.1404399903951918
exp ma of ||w|| 0.5845760031658248
||w||^2 0.19839720704694797
exp ma of ||w||^2 0.3351410481059328
||w|| 0.44541801383301505
exp ma of ||w|| 0.5423150785475572
||w||^2 0.19784921848912174
exp ma of ||w||^2 0.3152896614374611
||w|| 0.444802448834448
exp ma of ||w|| 0.529106489609258
||w||^2 0.2303567491168061
exp ma of ||w||^2 0.3596266105472491
||w|| 0.47995494488212753
exp ma of ||w|| 0.5560128060944463
||w||^2 0.26596641038229807
exp ma of ||w||^2 0.3057007257951622
||w|| 0.5157193135633937
exp ma of ||w|| 0.5155874659956982
||w||^2 0.6859464350977769
exp ma of ||w||^2 0.3070493950009278
||w|| 0.8282188328562547
exp ma of ||w|| 0.5159209852506522
v before min max tensor([[-1.817e+00,  1.657e+00,  1.464e+01,  ..., -1.143e+00, -2.246e+00,
          6.728e+00],
        [ 4.835e+00,  4.147e-01, -2.193e+00,  ...,  2.143e+00,  4.030e-02,
         -2.815e-01],
        [ 6.742e+00, -1.064e+00, -1.907e+00,  ...,  1.116e+00, -2.753e+00,
          7.681e-01],
        ...,
        [-1.078e-02, -1.623e+00, -1.452e+00,  ..., -1.313e-01,  9.086e-01,
         -1.800e-01],
        [-1.640e-01,  2.990e+01, -2.095e+00,  ...,  1.129e+00, -3.592e+00,
          3.480e+00],
        [-1.500e+00,  2.383e+01,  1.090e+01,  ..., -1.979e+00,  1.754e-01,
          4.877e+00]], device='cuda:0')
v tensor([[1.000e-12, 1.657e+00, 1.000e+01,  ..., 1.000e-12, 1.000e-12,
         6.728e+00],
        [4.835e+00, 4.147e-01, 1.000e-12,  ..., 2.143e+00, 4.030e-02,
         1.000e-12],
        [6.742e+00, 1.000e-12, 1.000e-12,  ..., 1.116e+00, 1.000e-12,
         7.681e-01],
        ...,
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 9.086e-01,
         1.000e-12],
        [1.000e-12, 1.000e+01, 1.000e-12,  ..., 1.129e+00, 1.000e-12,
         3.480e+00],
        [1.000e-12, 1.000e+01, 1.000e+01,  ..., 1.000e-12, 1.754e-01,
         4.877e+00]], device='cuda:0')
v before min max tensor([ 5.651, -0.718,  0.866,  0.287, -1.736, -2.243, -1.536,  2.460, -2.016,
         2.183,  0.367, -0.324, -0.792, -1.096, -0.367, -2.136, -1.424,  5.228,
        -0.519, -2.120,  0.755,  0.836,  0.568,  0.020,  0.687, -4.278, -4.519,
         1.233, -3.232, -1.340, -1.077, -3.304, -1.028, -0.851, -1.221,  0.700,
        -1.171,  5.840, -0.380, -2.023,  0.158, -2.133, -2.137,  0.424, 14.170,
        -1.013, -2.125, -0.667,  0.558, -1.649,  5.943, -1.205, -2.745,  2.857,
        -1.261, -2.191,  6.558, 19.471,  8.559, -2.209, -0.132,  3.235,  0.380,
         6.429, 10.622,  0.871, -3.702, -0.879,  2.059, -0.944, -2.636, -2.281,
        -1.448,  0.913, -3.715,  0.235, -0.811, -1.700, -1.237,  5.957, -2.573,
         0.922, -1.938,  8.589,  4.592, -2.643, -0.756,  0.947, -1.262, -2.611,
        -3.359, -0.808, -3.772,  0.466, -1.543,  1.487, -0.469, -1.328, -0.179,
         3.071, -2.921, -2.432, -0.135, -2.695, -0.867, -0.166,  1.164, -1.468,
        -2.303,  1.005, -1.186, 10.344,  2.728, -0.150,  3.927, -0.391, -3.502,
        -0.994,  8.890, -2.362], device='cuda:0')
v tensor([5.651e+00, 1.000e-12, 8.663e-01, 2.870e-01, 1.000e-12, 1.000e-12,
        1.000e-12, 2.460e+00, 1.000e-12, 2.183e+00, 3.671e-01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 5.228e+00,
        1.000e-12, 1.000e-12, 7.546e-01, 8.358e-01, 5.675e-01, 2.039e-02,
        6.865e-01, 1.000e-12, 1.000e-12, 1.233e+00, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 6.995e-01,
        1.000e-12, 5.840e+00, 1.000e-12, 1.000e-12, 1.580e-01, 1.000e-12,
        1.000e-12, 4.237e-01, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12,
        5.582e-01, 1.000e-12, 5.943e+00, 1.000e-12, 1.000e-12, 2.857e+00,
        1.000e-12, 1.000e-12, 6.558e+00, 1.000e+01, 8.559e+00, 1.000e-12,
        1.000e-12, 3.235e+00, 3.802e-01, 6.429e+00, 1.000e+01, 8.711e-01,
        1.000e-12, 1.000e-12, 2.059e+00, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 9.134e-01, 1.000e-12, 2.349e-01, 1.000e-12, 1.000e-12,
        1.000e-12, 5.957e+00, 1.000e-12, 9.216e-01, 1.000e-12, 8.589e+00,
        4.592e+00, 1.000e-12, 1.000e-12, 9.470e-01, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 4.663e-01, 1.000e-12, 1.487e+00,
        1.000e-12, 1.000e-12, 1.000e-12, 3.071e+00, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.164e+00, 1.000e-12,
        1.000e-12, 1.005e+00, 1.000e-12, 1.000e+01, 2.728e+00, 1.000e-12,
        3.927e+00, 1.000e-12, 1.000e-12, 1.000e-12, 8.890e+00, 1.000e-12],
       device='cuda:0')
v before min max tensor([[[ 7.334e-01],
         [-2.154e+00],
         [ 1.980e-01],
         [-1.131e+00],
         [-2.480e+00],
         [ 2.232e+00],
         [-1.100e+00],
         [-2.304e+00],
         [-2.133e-01],
         [-2.590e+00]],

        [[-8.905e-01],
         [-2.366e+00],
         [ 1.230e+00],
         [-4.050e+00],
         [-1.963e+00],
         [-2.099e+00],
         [ 1.190e+01],
         [-1.400e+00],
         [ 1.052e+00],
         [ 4.296e-01]],

        [[-5.199e-01],
         [-1.464e+00],
         [-2.167e+00],
         [ 7.940e-01],
         [ 1.619e+01],
         [-1.929e+00],
         [ 3.702e+00],
         [-1.666e+00],
         [-2.833e+00],
         [-6.563e-01]],

        [[ 2.535e-01],
         [-6.424e-01],
         [-1.265e+00],
         [-2.813e+00],
         [-1.127e+00],
         [ 2.150e+00],
         [ 6.304e-01],
         [ 1.596e-01],
         [-2.856e+00],
         [ 1.031e+01]],

        [[-2.597e+00],
         [-9.297e-01],
         [-2.323e+00],
         [-1.046e+00],
         [-2.135e+00],
         [-8.783e-01],
         [-9.058e-01],
         [-2.210e+00],
         [ 2.528e+01],
         [ 1.066e+01]],

        [[ 3.333e+00],
         [-2.283e+00],
         [ 2.196e+00],
         [-1.454e+00],
         [-2.542e+00],
         [-1.981e+00],
         [-1.543e+00],
         [-7.316e-01],
         [-5.484e-01],
         [ 7.861e+00]],

        [[ 1.923e+00],
         [-1.925e+00],
         [ 8.149e+00],
         [-1.256e+00],
         [ 1.178e+01],
         [ 1.172e+01],
         [-1.152e+00],
         [-3.137e+00],
         [-1.664e+00],
         [-3.189e+00]],

        [[-2.439e+00],
         [ 8.151e-01],
         [ 3.886e+00],
         [ 4.676e+00],
         [ 4.234e+00],
         [-2.986e+00],
         [-3.589e-01],
         [ 2.120e+00],
         [ 4.078e+00],
         [ 5.871e-01]],

        [[ 9.368e+00],
         [-6.255e-01],
         [-8.404e-01],
         [-9.946e-01],
         [ 3.770e-01],
         [-5.643e-01],
         [-2.828e+00],
         [-2.173e+00],
         [-2.480e+00],
         [-2.152e+00]],

        [[-1.202e+00],
         [ 5.554e-03],
         [-2.301e+00],
         [-3.359e+00],
         [-2.973e+00],
         [-8.977e-01],
         [ 1.539e+01],
         [ 5.068e+00],
         [ 9.197e+00],
         [-1.886e+00]],

        [[ 4.795e+00],
         [ 1.876e-03],
         [-1.695e+00],
         [-1.267e+00],
         [-7.684e-01],
         [-1.336e+00],
         [ 1.151e-01],
         [-1.985e+00],
         [ 8.134e-01],
         [ 6.324e-01]],

        [[ 2.979e+00],
         [ 3.219e+00],
         [-1.554e+00],
         [ 3.895e+00],
         [-5.609e-01],
         [ 5.078e+00],
         [-3.225e+00],
         [-2.345e+00],
         [-2.708e+00],
         [-3.050e+00]]], device='cuda:0')
v tensor([[[7.334e-01],
         [1.000e-12],
         [1.980e-01],
         [1.000e-12],
         [1.000e-12],
         [2.232e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.230e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.052e+00],
         [4.296e-01]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [7.940e-01],
         [1.000e+01],
         [1.000e-12],
         [3.702e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[2.535e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.150e+00],
         [6.304e-01],
         [1.596e-01],
         [1.000e-12],
         [1.000e+01]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01]],

        [[3.333e+00],
         [1.000e-12],
         [2.196e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [7.861e+00]],

        [[1.923e+00],
         [1.000e-12],
         [8.149e+00],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [8.151e-01],
         [3.886e+00],
         [4.676e+00],
         [4.234e+00],
         [1.000e-12],
         [1.000e-12],
         [2.120e+00],
         [4.078e+00],
         [5.871e-01]],

        [[9.368e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [3.770e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [5.554e-03],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [5.068e+00],
         [9.197e+00],
         [1.000e-12]],

        [[4.795e+00],
         [1.876e-03],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.151e-01],
         [1.000e-12],
         [8.134e-01],
         [6.324e-01]],

        [[2.979e+00],
         [3.219e+00],
         [1.000e-12],
         [3.895e+00],
         [1.000e-12],
         [5.078e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]]], device='cuda:0')
v before min max tensor([[-0.774],
        [10.946],
        [-3.423],
        [-1.240],
        [-2.157],
        [-1.389],
        [-2.908],
        [-2.715],
        [-2.362],
        [-1.361],
        [-1.243],
        [-1.074]], device='cuda:0')
v tensor([[1.000e-12],
        [1.000e+01],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12]], device='cuda:0')
a after update for 1 param tensor([[-0.003,  0.015,  0.049,  ...,  0.002,  0.028, -0.054],
        [-0.005,  0.006, -0.003,  ..., -0.002,  0.027,  0.040],
        [-0.002, -0.002,  0.019,  ...,  0.009,  0.021, -0.002],
        ...,
        [ 0.002,  0.002, -0.019,  ...,  0.022,  0.005,  0.023],
        [-0.004,  0.016,  0.021,  ..., -0.035,  0.009, -0.002],
        [-0.007,  0.069, -0.030,  ...,  0.016,  0.015,  0.003]],
       device='cuda:0')
s after update for 1 param tensor([[1.415, 1.134, 1.538,  ..., 0.634, 1.190, 1.110],
        [1.490, 1.085, 0.898,  ..., 0.713, 0.890, 1.244],
        [1.343, 0.433, 0.747,  ..., 0.679, 1.206, 0.443],
        ...,
        [0.378, 0.725, 1.211,  ..., 0.600, 0.863, 1.611],
        [0.876, 1.462, 0.832,  ..., 1.052, 1.410, 0.930],
        [1.477, 1.965, 1.782,  ..., 0.768, 1.266, 1.352]], device='cuda:0')
b after update for 1 param tensor([[50.269, 44.994, 52.397,  ..., 33.660, 46.099, 44.512],
        [51.577, 44.010, 40.054,  ..., 35.682, 39.867, 47.123],
        [48.974, 27.805, 36.531,  ..., 34.813, 46.401, 28.128],
        ...,
        [25.989, 35.988, 46.493,  ..., 32.729, 39.254, 53.632],
        [39.543, 51.091, 38.542,  ..., 43.349, 50.185, 40.742],
        [51.363, 59.230, 56.412,  ..., 37.030, 47.546, 49.127]],
       device='cuda:0')
clipping threshold 0.3644942492023646
a after update for 1 param tensor([ 2.971e-02, -1.720e-02,  8.521e-03, -3.676e-02,  4.354e-02, -2.446e-02,
         1.895e-02, -3.171e-03,  3.716e-02, -4.552e-02,  1.991e-02, -3.663e-02,
        -8.024e-02,  4.748e-03,  5.568e-05, -2.006e-03,  3.112e-02,  6.038e-04,
        -6.256e-02,  1.965e-02,  3.689e-02, -1.436e-02, -1.537e-02, -5.990e-04,
         5.676e-03,  1.108e-02,  3.560e-02, -7.693e-02,  5.731e-04, -8.265e-03,
        -1.486e-02,  1.600e-02,  8.160e-02,  2.362e-02, -1.671e-02, -8.608e-03,
         1.213e-02, -4.973e-02, -2.423e-02,  1.926e-03,  3.109e-02, -4.897e-03,
        -4.458e-02,  2.975e-02,  1.056e-02,  1.083e-02,  5.763e-02,  6.604e-03,
        -1.882e-02, -2.110e-02, -4.111e-02, -3.719e-03,  9.931e-03, -2.548e-02,
        -1.476e-02, -1.057e-02, -2.283e-03, -9.338e-03,  8.812e-04,  5.313e-02,
        -2.147e-02, -1.423e-02,  7.698e-03,  1.264e-02, -1.148e-03,  2.532e-02,
        -4.614e-02,  3.585e-02,  1.391e-02, -2.771e-02, -3.702e-02, -4.842e-03,
         2.052e-02, -1.027e-02,  4.223e-03,  2.190e-02,  1.244e-03, -1.640e-02,
        -3.366e-02,  5.673e-03,  4.435e-02, -1.763e-03,  3.911e-03,  4.092e-02,
        -7.620e-03,  3.085e-02,  9.092e-03, -7.691e-03,  2.461e-02,  1.672e-02,
         3.619e-03,  1.318e-02,  1.753e-02, -1.788e-02,  5.635e-03,  2.031e-04,
         2.390e-02,  2.824e-02, -5.383e-02, -1.498e-03,  2.377e-02, -1.072e-02,
         1.150e-02, -4.329e-02, -3.697e-02, -4.448e-02,  3.384e-02,  5.297e-03,
        -9.729e-03, -1.066e-04, -1.733e-03,  3.003e-02,  1.363e-02, -2.720e-02,
         3.097e-02,  1.797e-02, -2.693e-03, -8.888e-03,  1.655e-02, -1.280e-02],
       device='cuda:0')
s after update for 1 param tensor([1.057, 0.498, 1.197, 0.846, 0.982, 1.600, 1.392, 0.912, 0.916, 0.872,
        0.734, 1.452, 0.516, 0.471, 0.628, 1.101, 0.796, 1.216, 0.756, 1.285,
        0.760, 1.135, 1.236, 0.947, 0.768, 1.695, 1.736, 0.551, 1.399, 0.535,
        0.533, 1.293, 0.705, 1.073, 0.759, 1.270, 1.628, 0.983, 0.853, 1.000,
        1.133, 1.040, 1.012, 1.126, 1.420, 0.732, 0.841, 0.470, 1.060, 0.676,
        1.106, 0.973, 1.070, 0.782, 0.656, 0.974, 1.118, 1.432, 1.621, 0.907,
        0.906, 1.189, 1.400, 1.696, 1.501, 0.997, 1.458, 0.481, 0.684, 1.315,
        1.014, 0.915, 1.103, 0.791, 1.434, 0.666, 0.706, 0.980, 0.486, 1.447,
        1.004, 1.197, 1.286, 1.512, 0.760, 1.067, 1.327, 1.530, 0.612, 1.377,
        1.413, 1.036, 1.449, 0.849, 1.160, 0.900, 1.060, 0.562, 0.823, 1.412,
        1.424, 1.185, 0.586, 1.049, 0.644, 0.757, 0.949, 0.601, 1.054, 1.115,
        1.039, 1.487, 0.683, 1.280, 1.301, 0.956, 1.709, 0.701, 1.246, 1.001],
       device='cuda:0')
b after update for 1 param tensor([43.446, 29.828, 46.223, 38.864, 41.883, 53.454, 49.849, 40.361, 40.440,
        39.466, 36.198, 50.916, 30.366, 29.016, 33.492, 44.344, 37.699, 46.597,
        36.735, 47.896, 36.827, 45.025, 46.976, 41.117, 37.023, 55.015, 55.674,
        31.363, 49.984, 30.911, 30.837, 48.059, 35.472, 43.767, 36.817, 47.612,
        53.915, 41.900, 39.027, 42.249, 44.971, 43.088, 42.518, 44.838, 50.361,
        36.158, 38.749, 28.977, 43.504, 34.751, 44.441, 41.672, 43.707, 37.365,
        34.226, 41.696, 44.689, 50.575, 53.796, 40.239, 40.212, 46.081, 50.003,
        55.031, 51.764, 42.190, 51.017, 29.312, 34.949, 48.449, 42.543, 40.427,
        44.382, 37.592, 50.605, 34.486, 35.507, 41.842, 29.473, 50.834, 42.337,
        46.229, 47.914, 51.955, 36.843, 43.658, 48.671, 52.271, 33.049, 49.594,
        50.234, 43.008, 50.860, 38.934, 45.517, 40.087, 43.515, 31.665, 38.332,
        50.221, 50.430, 45.991, 32.357, 43.285, 33.922, 36.759, 41.166, 32.769,
        43.379, 44.626, 43.065, 51.529, 34.925, 47.817, 48.206, 41.312, 55.238,
        35.382, 47.162, 42.279], device='cuda:0')
clipping threshold 0.3644942492023646
a after update for 1 param tensor([[[-0.005],
         [ 0.006],
         [-0.039],
         [ 0.007],
         [ 0.029],
         [-0.031],
         [ 0.072],
         [-0.017],
         [ 0.026],
         [ 0.010]],

        [[-0.015],
         [ 0.034],
         [-0.050],
         [ 0.005],
         [-0.010],
         [ 0.044],
         [ 0.013],
         [-0.021],
         [-0.048],
         [-0.012]],

        [[-0.019],
         [ 0.050],
         [-0.020],
         [-0.061],
         [-0.009],
         [ 0.022],
         [-0.009],
         [ 0.044],
         [-0.017],
         [ 0.074]],

        [[-0.051],
         [ 0.029],
         [ 0.003],
         [ 0.074],
         [ 0.020],
         [ 0.058],
         [ 0.017],
         [-0.011],
         [-0.025],
         [ 0.026]],

        [[-0.018],
         [-0.012],
         [-0.019],
         [ 0.019],
         [ 0.036],
         [ 0.028],
         [-0.023],
         [-0.009],
         [-0.002],
         [ 0.035]],

        [[-0.025],
         [-0.011],
         [ 0.026],
         [ 0.001],
         [ 0.006],
         [ 0.029],
         [-0.027],
         [-0.016],
         [ 0.062],
         [-0.014]],

        [[ 0.039],
         [-0.012],
         [-0.012],
         [ 0.024],
         [-0.014],
         [-0.054],
         [ 0.040],
         [ 0.014],
         [-0.013],
         [-0.050]],

        [[ 0.001],
         [-0.011],
         [-0.022],
         [-0.028],
         [-0.015],
         [-0.021],
         [ 0.026],
         [ 0.024],
         [ 0.011],
         [ 0.026]],

        [[-0.006],
         [ 0.028],
         [-0.026],
         [-0.024],
         [-0.013],
         [ 0.071],
         [-0.024],
         [-0.017],
         [ 0.001],
         [-0.019]],

        [[-0.010],
         [-0.018],
         [-0.005],
         [ 0.030],
         [-0.023],
         [-0.003],
         [ 0.029],
         [-0.035],
         [-0.038],
         [ 0.026]],

        [[ 0.029],
         [ 0.019],
         [ 0.008],
         [-0.004],
         [ 0.005],
         [-0.046],
         [ 0.024],
         [-0.016],
         [-0.011],
         [ 0.010]],

        [[-0.044],
         [ 0.021],
         [ 0.001],
         [-0.032],
         [-0.040],
         [-0.051],
         [ 0.011],
         [-0.014],
         [ 0.013],
         [ 0.026]]], device='cuda:0')
s after update for 1 param tensor([[[1.296],
         [0.829],
         [0.823],
         [0.505],
         [0.988],
         [1.441],
         [1.192],
         [1.009],
         [0.593],
         [1.147]],

        [[0.958],
         [1.046],
         [0.803],
         [1.599],
         [0.769],
         [1.110],
         [1.886],
         [0.609],
         [0.883],
         [1.109]],

        [[0.702],
         [0.935],
         [0.911],
         [0.904],
         [1.404],
         [0.831],
         [1.065],
         [0.773],
         [1.093],
         [1.038]],

        [[1.417],
         [0.254],
         [0.585],
         [1.088],
         [1.076],
         [1.367],
         [0.733],
         [0.940],
         [1.392],
         [1.479]],

        [[1.084],
         [0.696],
         [1.066],
         [0.563],
         [0.825],
         [0.979],
         [1.313],
         [1.033],
         [1.461],
         [1.502]],

        [[1.108],
         [0.951],
         [0.731],
         [0.690],
         [1.260],
         [0.780],
         [1.485],
         [0.685],
         [0.948],
         [1.026]],

        [[1.484],
         [1.312],
         [1.307],
         [0.759],
         [1.363],
         [1.771],
         [1.337],
         [1.327],
         [1.244],
         [1.232]],

        [[0.946],
         [0.864],
         [1.125],
         [1.310],
         [1.253],
         [1.156],
         [1.182],
         [1.003],
         [1.567],
         [0.969]],

        [[1.401],
         [0.751],
         [0.361],
         [0.427],
         [0.708],
         [1.140],
         [1.168],
         [0.837],
         [1.029],
         [0.928]],

        [[1.082],
         [0.787],
         [0.909],
         [1.436],
         [1.152],
         [1.064],
         [1.759],
         [1.375],
         [1.736],
         [0.781]],

        [[1.303],
         [0.685],
         [0.764],
         [0.523],
         [1.591],
         [0.699],
         [1.186],
         [0.763],
         [0.848],
         [1.387]],

        [[1.249],
         [1.095],
         [0.695],
         [1.217],
         [0.942],
         [1.297],
         [1.817],
         [0.918],
         [1.094],
         [1.254]]], device='cuda:0')
b after update for 1 param tensor([[[48.111],
         [38.477],
         [38.339],
         [30.028],
         [42.004],
         [50.731],
         [46.144],
         [42.440],
         [32.531],
         [45.249]],

        [[41.361],
         [43.210],
         [37.875],
         [53.437],
         [37.063],
         [44.523],
         [58.030],
         [32.981],
         [39.697],
         [44.497]],

        [[35.411],
         [40.869],
         [40.333],
         [40.167],
         [50.068],
         [38.529],
         [43.603],
         [37.160],
         [44.176],
         [43.061]],

        [[50.302],
         [21.277],
         [32.328],
         [44.083],
         [43.841],
         [49.412],
         [36.187],
         [40.965],
         [49.850],
         [51.399]],

        [[43.989],
         [35.245],
         [43.629],
         [31.708],
         [38.374],
         [41.804],
         [48.421],
         [42.952],
         [51.082],
         [51.782]],

        [[44.489],
         [41.218],
         [36.135],
         [35.092],
         [47.438],
         [37.327],
         [51.490],
         [34.976],
         [41.135],
         [42.807]],

        [[51.484],
         [48.401],
         [48.304],
         [36.808],
         [49.342],
         [56.235],
         [48.865],
         [48.670],
         [47.128],
         [46.913]],

        [[41.109],
         [39.268],
         [44.813],
         [48.362],
         [47.309],
         [45.429],
         [45.949],
         [42.315],
         [52.899],
         [41.603]],

        [[50.017],
         [36.631],
         [25.373],
         [27.619],
         [35.568],
         [45.125],
         [45.672],
         [38.649],
         [42.861],
         [40.702]],

        [[43.958],
         [37.495],
         [40.292],
         [50.635],
         [45.350],
         [43.589],
         [56.037],
         [49.549],
         [55.677],
         [37.352]],

        [[48.232],
         [34.962],
         [36.926],
         [30.555],
         [53.308],
         [35.328],
         [46.011],
         [36.908],
         [38.921],
         [49.760]],

        [[47.219],
         [44.225],
         [35.223],
         [46.613],
         [41.018],
         [48.130],
         [56.958],
         [40.494],
         [44.188],
         [47.319]]], device='cuda:0')
clipping threshold 0.3644942492023646
a after update for 1 param tensor([[-0.004],
        [ 0.012],
        [-0.010],
        [-0.018],
        [-0.007],
        [ 0.031],
        [ 0.035],
        [ 0.008],
        [-0.003],
        [-0.043],
        [ 0.000],
        [ 0.019]], device='cuda:0')
s after update for 1 param tensor([[0.868],
        [1.361],
        [1.530],
        [1.589],
        [0.884],
        [1.007],
        [1.371],
        [1.311],
        [1.154],
        [1.068],
        [0.561],
        [1.255]], device='cuda:0')
b after update for 1 param tensor([[39.370],
        [49.299],
        [52.266],
        [53.271],
        [39.731],
        [42.397],
        [49.477],
        [48.381],
        [45.403],
        [43.669],
        [31.663],
        [47.342]], device='cuda:0')
clipping threshold 0.3644942492023646
||w||^2 0.3897216121302577
exp ma of ||w||^2 0.355280185834985
||w|| 0.6242768713721962
exp ma of ||w|| 0.557556798367762
||w||^2 0.26719124471333244
exp ma of ||w||^2 0.3619121913019279
||w|| 0.5169054504581398
exp ma of ||w|| 0.5577169291568829
||w||^2 0.21135226163558202
exp ma of ||w||^2 0.36339832126661964
||w|| 0.4597306403053662
exp ma of ||w|| 0.5593771912097356
||w||^2 1.386313481690137
exp ma of ||w||^2 0.37939061077731906
||w|| 1.1774181422460488
exp ma of ||w|| 0.5667920202236393
||w||^2 0.29165812227914706
exp ma of ||w||^2 0.3476675930534277
||w|| 0.5400538142436798
exp ma of ||w|| 0.5494863194631677
||w||^2 0.6262796725952919
exp ma of ||w||^2 0.27633298074503826
||w|| 0.7913783372036992
exp ma of ||w|| 0.4884790971844072
v before min max tensor([[-1.400,  0.029, -2.680,  ..., -4.077, -1.928,  0.734],
        [-2.027,  2.500, -1.503,  ..., -2.419, -2.564, -2.231],
        [-2.728, -1.480, -3.395,  ..., -0.020, -1.496,  2.245],
        ...,
        [ 8.705,  0.118, -1.387,  ..., -2.788, -1.713, -4.577],
        [-3.560, -1.664, -2.978,  ..., -2.496, 15.414, -6.292],
        [-3.118, -2.437, -2.079,  ..., -2.167, -3.730, -0.754]],
       device='cuda:0')
v tensor([[1.000e-12, 2.922e-02, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         7.344e-01],
        [1.000e-12, 2.500e+00, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         2.245e+00],
        ...,
        [8.705e+00, 1.182e-01, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e+01,
         1.000e-12],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12]], device='cuda:0')
v before min max tensor([ 3.440e+00,  1.248e+01,  2.971e+00, -3.951e+00,  5.446e+00, -2.534e+00,
        -1.484e+00, -3.834e+00, -2.242e+00, -9.929e-01, -2.802e+00,  9.364e-01,
        -2.298e+00, -5.095e-02, -9.623e-01, -1.510e+00,  1.445e+00, -1.739e+00,
        -3.195e+00, -8.410e-01, -1.777e+00,  1.892e+00, -7.612e-01, -2.500e+00,
         6.481e-01, -4.859e+00, -4.594e+00, -1.793e+00, -2.021e+00, -3.470e+00,
        -1.734e+00, -2.095e-01, -1.021e+00, -3.465e+00, -2.746e+00, -2.711e+00,
        -2.394e+00, -2.106e+00, -2.196e+00, -2.545e+00,  5.493e+00, -2.125e+00,
        -3.738e-01, -2.851e+00, -1.236e+00, -2.165e-01, -3.266e+00,  2.202e+00,
        -4.541e+00, -8.177e-01,  1.275e+01, -2.133e+00, -3.704e-01, -3.494e+00,
         1.593e+00, -3.322e+00,  3.481e+00, -3.052e+00, -1.732e+00, -2.588e+00,
        -3.068e+00, -4.824e+00, -2.723e+00, -4.012e+00, -2.050e+00,  1.247e+00,
        -4.531e+00, -8.606e-01, -3.542e+00, -2.547e+00,  1.183e-01, -3.224e+00,
        -2.518e+00, -1.251e+00, -3.025e+00,  1.970e+00,  2.883e+00, -2.564e+00,
        -1.692e+00,  3.593e+00, -1.122e+00,  3.527e+00, -2.401e+00, -5.027e+00,
         1.241e+01, -3.395e+00, -3.576e-01, -4.499e-01, -2.287e+00, -3.345e+00,
        -3.556e+00, -4.616e-01,  6.207e-01, -4.441e+00, -1.952e+00, -4.073e+00,
         5.312e+00,  4.221e+00, -2.049e+00, -1.880e+00,  2.578e+01,  4.009e+00,
         4.996e-01, -3.673e+00, -1.317e-02,  1.067e+00, -3.145e+00, -3.888e+00,
         4.544e+00, -1.900e+00, -2.724e+00, -1.708e+00, -1.002e+00, -3.131e+00,
         4.483e+00, -2.473e+00,  1.814e-01, -4.495e+00, -7.019e-01, -3.174e+00],
       device='cuda:0')
v tensor([3.440e+00, 1.000e+01, 2.971e+00, 1.000e-12, 5.446e+00, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 9.364e-01,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.445e+00, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.892e+00, 1.000e-12, 1.000e-12,
        6.481e-01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 5.493e+00, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 2.202e+00,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12,
        1.593e+00, 1.000e-12, 3.481e+00, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.247e+00,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.183e-01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.970e+00, 2.883e+00, 1.000e-12,
        1.000e-12, 3.593e+00, 1.000e-12, 3.527e+00, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 6.207e-01, 1.000e-12, 1.000e-12, 1.000e-12,
        5.312e+00, 4.221e+00, 1.000e-12, 1.000e-12, 1.000e+01, 4.009e+00,
        4.996e-01, 1.000e-12, 1.000e-12, 1.067e+00, 1.000e-12, 1.000e-12,
        4.544e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        4.483e+00, 1.000e-12, 1.814e-01, 1.000e-12, 1.000e-12, 1.000e-12],
       device='cuda:0')
v before min max tensor([[[-3.038],
         [-3.695],
         [ 3.305],
         [ 0.731],
         [ 3.808],
         [-3.809],
         [10.441],
         [-3.552],
         [-2.439],
         [-3.397]],

        [[-0.210],
         [-4.948],
         [10.855],
         [-4.397],
         [-3.539],
         [-2.625],
         [ 0.255],
         [-3.071],
         [-2.124],
         [-1.525]],

        [[-2.040],
         [-1.749],
         [ 2.589],
         [-0.984],
         [ 2.234],
         [-2.050],
         [-2.714],
         [-2.562],
         [-3.499],
         [ 1.091]],

        [[ 8.814],
         [-2.388],
         [21.002],
         [-4.333],
         [-4.144],
         [-0.530],
         [-2.814],
         [-3.075],
         [-0.301],
         [-0.489]],

        [[-0.458],
         [-1.797],
         [-1.209],
         [ 6.224],
         [-2.396],
         [-4.416],
         [-2.693],
         [ 3.840],
         [-3.128],
         [-3.233]],

        [[ 0.880],
         [-3.263],
         [-2.548],
         [ 1.710],
         [-4.831],
         [-1.350],
         [-2.171],
         [-1.008],
         [-4.762],
         [-2.558]],

        [[-3.143],
         [-1.485],
         [-1.592],
         [ 4.993],
         [-1.959],
         [-0.689],
         [-1.323],
         [-0.903],
         [ 0.427],
         [-5.285]],

        [[ 4.093],
         [-2.899],
         [-2.940],
         [-1.597],
         [ 4.767],
         [ 6.502],
         [ 2.212],
         [-3.306],
         [ 1.608],
         [ 0.115]],

        [[-3.519],
         [-3.260],
         [-3.141],
         [-0.530],
         [-4.732],
         [-2.564],
         [ 0.914],
         [ 1.906],
         [-3.869],
         [-1.945]],

        [[-0.873],
         [-3.121],
         [-3.348],
         [-3.230],
         [-1.088],
         [ 5.221],
         [ 0.096],
         [ 4.655],
         [-2.864],
         [-1.926]],

        [[-3.177],
         [-3.954],
         [-1.945],
         [-3.118],
         [-1.852],
         [ 0.949],
         [-2.766],
         [-2.596],
         [-5.040],
         [-2.330]],

        [[ 0.282],
         [-0.873],
         [ 0.964],
         [-1.936],
         [-3.923],
         [-1.672],
         [-1.577],
         [14.398],
         [-0.474],
         [-1.779]]], device='cuda:0')
v tensor([[[1.000e-12],
         [1.000e-12],
         [3.305e+00],
         [7.314e-01],
         [3.808e+00],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.546e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [2.589e+00],
         [1.000e-12],
         [2.234e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.091e+00]],

        [[8.814e+00],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [6.224e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [3.840e+00],
         [1.000e-12],
         [1.000e-12]],

        [[8.805e-01],
         [1.000e-12],
         [1.000e-12],
         [1.710e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [4.993e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [4.270e-01],
         [1.000e-12]],

        [[4.093e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [4.767e+00],
         [6.502e+00],
         [2.212e+00],
         [1.000e-12],
         [1.608e+00],
         [1.153e-01]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [9.138e-01],
         [1.906e+00],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [5.221e+00],
         [9.613e-02],
         [4.655e+00],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [9.493e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[2.819e-01],
         [1.000e-12],
         [9.641e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12]]], device='cuda:0')
v before min max tensor([[-2.514],
        [ 0.443],
        [-2.561],
        [-3.842],
        [ 3.580],
        [-0.213],
        [-3.295],
        [ 0.278],
        [ 3.235],
        [-1.895],
        [-3.128],
        [-3.233]], device='cuda:0')
v tensor([[1.000e-12],
        [4.429e-01],
        [1.000e-12],
        [1.000e-12],
        [3.580e+00],
        [1.000e-12],
        [1.000e-12],
        [2.782e-01],
        [3.235e+00],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12]], device='cuda:0')
a after update for 1 param tensor([[ 0.006, -0.103,  0.003,  ..., -0.014, -0.004, -0.016],
        [ 0.014,  0.011,  0.004,  ...,  0.003, -0.002, -0.004],
        [ 0.003, -0.018,  0.004,  ...,  0.023,  0.010, -0.003],
        ...,
        [ 0.021,  0.008,  0.012,  ..., -0.013,  0.007,  0.005],
        [ 0.007,  0.013, -0.012,  ...,  0.001, -0.008,  0.010],
        [ 0.007, -0.014, -0.008,  ..., -0.010,  0.011,  0.014]],
       device='cuda:0')
s after update for 1 param tensor([[1.199, 0.813, 0.855,  ..., 1.377, 1.089, 0.601],
        [1.346, 1.179, 1.146,  ..., 0.780, 0.878, 0.726],
        [1.161, 0.955, 1.294,  ..., 1.293, 0.771, 1.191],
        ...,
        [1.398, 0.713, 0.690,  ..., 0.947, 0.694, 1.537],
        [1.244, 0.935, 1.411,  ..., 1.397, 1.767, 1.991],
        [1.092, 0.896, 0.687,  ..., 0.722, 1.199, 1.759]], device='cuda:0')
b after update for 1 param tensor([[47.506, 39.123, 40.109,  ..., 50.917, 45.266, 33.632],
        [50.343, 47.114, 46.448,  ..., 38.318, 40.662, 36.957],
        [46.751, 42.396, 49.354,  ..., 49.328, 38.108, 47.357],
        ...,
        [51.307, 36.623, 36.041,  ..., 42.209, 36.137, 53.795],
        [48.383, 41.942, 51.537,  ..., 51.285, 57.676, 61.215],
        [45.330, 41.072, 35.972,  ..., 36.866, 47.513, 57.546]],
       device='cuda:0')
clipping threshold 0.3903077437707102
a after update for 1 param tensor([ 0.043,  0.051,  0.002, -0.038,  0.018,  0.014,  0.000,  0.016, -0.036,
        -0.008,  0.015, -0.005, -0.033,  0.022,  0.066,  0.038,  0.024,  0.010,
        -0.018,  0.024,  0.017, -0.036,  0.021,  0.047, -0.018, -0.000, -0.023,
        -0.056, -0.015, -0.002, -0.019, -0.021,  0.015,  0.007,  0.001, -0.023,
        -0.017,  0.001,  0.024,  0.021,  0.021,  0.025, -0.053,  0.042,  0.013,
         0.013,  0.053, -0.011,  0.012, -0.037,  0.007, -0.031, -0.021, -0.029,
         0.040,  0.022, -0.018,  0.044, -0.064, -0.028,  0.041,  0.009, -0.023,
         0.034,  0.015, -0.005,  0.007, -0.033,  0.044, -0.007,  0.012, -0.005,
         0.009, -0.008, -0.024, -0.004,  0.014, -0.037, -0.037,  0.014,  0.029,
         0.050,  0.021,  0.001,  0.018, -0.038, -0.030, -0.002, -0.005, -0.021,
        -0.004,  0.004,  0.007, -0.038,  0.014,  0.048, -0.015, -0.023,  0.003,
         0.003,  0.036,  0.009, -0.000,  0.003,  0.017, -0.000, -0.035, -0.005,
        -0.005,  0.028,  0.001, -0.022,  0.017, -0.011,  0.011,  0.021, -0.021,
         0.010,  0.004, -0.042], device='cuda:0')
s after update for 1 param tensor([1.378, 1.722, 1.400, 1.254, 1.195, 1.012, 0.597, 1.283, 0.748, 1.053,
        0.941, 0.816, 0.730, 0.519, 0.994, 0.837, 1.121, 0.773, 1.161, 0.581,
        1.038, 0.744, 0.710, 0.795, 0.845, 1.533, 1.445, 0.986, 0.646, 1.159,
        0.553, 0.726, 1.244, 1.304, 0.890, 1.305, 1.074, 1.198, 0.801, 1.056,
        1.500, 0.845, 0.696, 1.114, 1.541, 1.224, 1.028, 1.188, 1.450, 0.785,
        1.151, 1.273, 1.149, 1.309, 1.039, 1.294, 1.232, 1.214, 1.118, 1.013,
        0.980, 1.547, 1.068, 1.470, 0.779, 0.792, 1.488, 0.330, 1.194, 0.799,
        0.348, 1.014, 0.998, 0.866, 1.201, 0.865, 1.369, 0.917, 0.703, 1.839,
        1.342, 1.477, 0.768, 1.606, 1.338, 1.203, 1.143, 0.357, 0.967, 1.419,
        1.378, 0.888, 0.580, 1.439, 0.693, 1.303, 1.469, 1.082, 1.482, 0.648,
        1.428, 1.384, 0.919, 1.366, 1.377, 1.027, 1.239, 1.220, 1.622, 0.602,
        0.972, 0.790, 0.384, 0.983, 1.961, 0.779, 1.001, 1.619, 0.845, 1.042],
       device='cuda:0')
b after update for 1 param tensor([50.928, 56.928, 51.339, 48.589, 47.418, 43.644, 33.512, 49.146, 37.525,
        44.519, 42.081, 39.202, 37.065, 31.255, 43.250, 39.692, 45.929, 38.147,
        46.742, 33.069, 44.213, 37.423, 36.550, 38.676, 39.893, 53.709, 52.149,
        43.070, 34.860, 46.700, 32.259, 36.971, 48.385, 49.539, 40.926, 49.566,
        44.963, 47.497, 38.826, 44.580, 53.128, 39.893, 36.187, 45.799, 53.855,
        47.999, 43.992, 47.298, 52.238, 38.444, 46.537, 48.943, 46.505, 49.638,
        44.230, 49.347, 48.148, 47.811, 45.873, 43.671, 42.951, 53.969, 44.846,
        52.608, 38.297, 38.602, 52.917, 24.923, 47.408, 38.790, 25.598, 43.681,
        43.338, 40.376, 47.548, 40.344, 50.769, 41.542, 36.372, 58.832, 50.266,
        52.722, 38.011, 54.980, 50.181, 47.596, 46.377, 25.922, 42.665, 51.675,
        50.934, 40.883, 33.037, 52.051, 36.123, 49.532, 52.588, 45.121, 52.811,
        34.933, 51.850, 51.049, 41.600, 50.704, 50.918, 43.961, 48.289, 47.922,
        55.257, 33.663, 42.768, 38.564, 26.874, 43.014, 60.758, 38.296, 43.409,
        55.203, 39.889, 44.290], device='cuda:0')
clipping threshold 0.3903077437707102
a after update for 1 param tensor([[[ 0.053],
         [ 0.006],
         [-0.013],
         [ 0.002],
         [ 0.029],
         [-0.026],
         [-0.018],
         [-0.002],
         [ 0.006],
         [-0.011]],

        [[-0.054],
         [ 0.019],
         [ 0.034],
         [ 0.015],
         [-0.037],
         [ 0.020],
         [-0.049],
         [ 0.011],
         [ 0.017],
         [-0.057]],

        [[-0.015],
         [-0.013],
         [-0.021],
         [ 0.038],
         [-0.001],
         [ 0.002],
         [ 0.023],
         [ 0.012],
         [-0.030],
         [ 0.011]],

        [[ 0.015],
         [ 0.006],
         [-0.054],
         [ 0.008],
         [-0.018],
         [-0.001],
         [ 0.016],
         [-0.019],
         [ 0.000],
         [ 0.029]],

        [[-0.004],
         [ 0.018],
         [-0.009],
         [ 0.013],
         [ 0.008],
         [ 0.079],
         [-0.001],
         [-0.021],
         [ 0.011],
         [ 0.015]],

        [[ 0.025],
         [-0.053],
         [ 0.031],
         [-0.019],
         [ 0.026],
         [-0.031],
         [ 0.019],
         [-0.005],
         [ 0.038],
         [ 0.013]],

        [[-0.002],
         [ 0.011],
         [ 0.008],
         [ 0.045],
         [ 0.013],
         [ 0.002],
         [-0.007],
         [ 0.019],
         [ 0.021],
         [-0.039]],

        [[-0.038],
         [ 0.078],
         [-0.001],
         [ 0.028],
         [-0.024],
         [ 0.001],
         [ 0.049],
         [-0.039],
         [-0.026],
         [-0.017]],

        [[ 0.012],
         [-0.006],
         [-0.017],
         [ 0.028],
         [-0.011],
         [-0.002],
         [ 0.039],
         [-0.003],
         [-0.024],
         [ 0.001]],

        [[-0.031],
         [-0.012],
         [-0.007],
         [ 0.044],
         [-0.004],
         [-0.007],
         [ 0.071],
         [ 0.024],
         [ 0.015],
         [ 0.006]],

        [[ 0.026],
         [-0.009],
         [ 0.011],
         [-0.025],
         [-0.019],
         [-0.022],
         [ 0.022],
         [-0.005],
         [-0.072],
         [-0.035]],

        [[-0.051],
         [ 0.048],
         [-0.008],
         [-0.020],
         [-0.036],
         [-0.014],
         [-0.012],
         [-0.000],
         [ 0.030],
         [ 0.055]]], device='cuda:0')
s after update for 1 param tensor([[[0.960],
         [1.187],
         [1.152],
         [0.956],
         [1.076],
         [1.255],
         [1.333],
         [1.428],
         [0.948],
         [1.088]],

        [[1.451],
         [1.553],
         [1.752],
         [1.407],
         [1.314],
         [0.851],
         [0.723],
         [1.103],
         [1.241],
         [0.637]],

        [[0.716],
         [0.610],
         [1.485],
         [1.207],
         [0.961],
         [0.684],
         [1.036],
         [1.177],
         [1.273],
         [0.467]],

        [[1.525],
         [1.372],
         [1.552],
         [1.398],
         [1.357],
         [0.821],
         [0.998],
         [1.298],
         [0.974],
         [1.235]],

        [[0.672],
         [0.822],
         [0.947],
         [1.819],
         [1.554],
         [1.454],
         [1.523],
         [1.251],
         [1.009],
         [1.249]],

        [[0.884],
         [1.190],
         [1.033],
         [0.889],
         [1.712],
         [0.732],
         [0.696],
         [0.375],
         [1.565],
         [0.983]],

        [[1.622],
         [1.174],
         [0.874],
         [1.524],
         [0.620],
         [1.351],
         [1.260],
         [1.407],
         [0.383],
         [1.667]],

        [[1.238],
         [0.941],
         [0.950],
         [0.866],
         [1.608],
         [1.246],
         [1.460],
         [1.047],
         [0.949],
         [1.023]],

        [[1.158],
         [1.249],
         [1.457],
         [0.413],
         [1.486],
         [1.241],
         [0.860],
         [1.044],
         [1.253],
         [0.624]],

        [[1.155],
         [1.619],
         [1.156],
         [1.240],
         [0.822],
         [1.124],
         [0.907],
         [1.204],
         [0.901],
         [0.692]],

        [[1.216],
         [1.341],
         [0.707],
         [1.120],
         [0.942],
         [1.134],
         [0.902],
         [0.817],
         [1.594],
         [0.835]],

        [[0.642],
         [1.196],
         [0.994],
         [0.699],
         [1.310],
         [0.720],
         [0.775],
         [1.605],
         [0.931],
         [0.827]]], device='cuda:0')
b after update for 1 param tensor([[[42.517],
         [47.267],
         [46.564],
         [42.417],
         [45.007],
         [48.608],
         [50.083],
         [51.839],
         [42.241],
         [45.246]],

        [[52.268],
         [54.066],
         [57.426],
         [51.462],
         [49.725],
         [40.026],
         [36.891],
         [45.563],
         [48.332],
         [34.617]],

        [[36.713],
         [33.892],
         [52.874],
         [47.656],
         [42.521],
         [35.893],
         [44.162],
         [47.060],
         [48.943],
         [29.656]],

        [[53.570],
         [50.812],
         [54.045],
         [51.301],
         [50.543],
         [39.313],
         [43.340],
         [49.432],
         [42.826],
         [48.208]],

        [[35.564],
         [39.335],
         [42.216],
         [58.517],
         [54.078],
         [52.309],
         [53.540],
         [48.529],
         [43.572],
         [48.488]],

        [[40.790],
         [47.335],
         [44.099],
         [40.918],
         [56.767],
         [37.130],
         [36.197],
         [26.583],
         [54.280],
         [43.006]],

        [[55.257],
         [47.005],
         [40.550],
         [53.555],
         [34.160],
         [50.423],
         [48.701],
         [51.455],
         [26.844],
         [56.021]],

        [[48.265],
         [42.094],
         [42.289],
         [40.367],
         [55.015],
         [48.434],
         [52.420],
         [44.385],
         [42.271],
         [43.873]],

        [[46.681],
         [48.495],
         [52.361],
         [27.884],
         [52.891],
         [48.327],
         [40.241],
         [44.335],
         [48.569],
         [34.266]],

        [[46.624],
         [55.198],
         [46.653],
         [48.316],
         [39.334],
         [45.999],
         [41.316],
         [47.598],
         [41.184],
         [36.087]],

        [[47.843],
         [50.249],
         [36.479],
         [45.905],
         [42.115],
         [46.209],
         [41.200],
         [39.211],
         [54.782],
         [39.656]],

        [[34.775],
         [47.438],
         [43.246],
         [36.278],
         [49.652],
         [36.824],
         [38.205],
         [54.964],
         [41.854],
         [39.463]]], device='cuda:0')
clipping threshold 0.3903077437707102
a after update for 1 param tensor([[ 0.002],
        [ 0.045],
        [ 0.022],
        [ 0.003],
        [-0.023],
        [-0.058],
        [-0.025],
        [ 0.030],
        [-0.020],
        [-0.035],
        [ 0.023],
        [ 0.015]], device='cuda:0')
s after update for 1 param tensor([[1.375],
        [0.736],
        [1.244],
        [1.908],
        [1.535],
        [0.684],
        [1.170],
        [1.119],
        [1.139],
        [1.209],
        [1.115],
        [1.109]], device='cuda:0')
b after update for 1 param tensor([[50.874],
        [37.209],
        [48.383],
        [59.935],
        [53.751],
        [35.878],
        [46.920],
        [45.898],
        [46.307],
        [47.695],
        [45.822],
        [45.685]], device='cuda:0')
clipping threshold 0.3903077437707102
cuda
Objective function 10.00 = squared loss an data 7.80 + 0.5*rho*h**2 0.696534 + alpha*h 0.155664 + L2reg 1.28 + L1reg 0.07 ; SHD = 26 ; DAG True
Proportion of microbatches that were clipped  0.7715327297492188
iteration 3 in inner loop, alpha 1.3188709148513897 rho 100.0 h 0.11802828355576622
iteration 2 in outer loop, alpha = 13.121699270428012, rho = 100.0, h = 0.11802828355576622
cuda
1692
cuda
Objective function 11.39 = squared loss an data 7.80 + 0.5*rho*h**2 0.696534 + alpha*h 1.548732 + L2reg 1.28 + L1reg 0.07 ; SHD = 26 ; DAG True
||w||^2 312689.9100127704
exp ma of ||w||^2 1288910619.5189679
||w|| 559.1868292554559
exp ma of ||w|| 14636.381724244276
||w||^2 50483.33888358087
exp ma of ||w||^2 741729802.6716257
||w|| 224.68497698684902
exp ma of ||w|| 8620.37402829136
||w||^2 0.1115246056795844
exp ma of ||w||^2 26637980.47674259
||w|| 0.3339529992073501
exp ma of ||w|| 314.01610252523363
||w||^2 0.09243230541011446
exp ma of ||w||^2 175024.65311619683
||w|| 0.3040268169259325
exp ma of ||w|| 2.537627646689437
||w||^2 0.08567585218439423
exp ma of ||w||^2 520.1711698026932
||w|| 0.2927043767769697
exp ma of ||w|| 0.5342692277077548
||w||^2 0.1415625366682169
exp ma of ||w||^2 141.09312970294698
||w|| 0.37624797231110346
exp ma of ||w|| 0.5435900681714603
||w||^2 0.3810101012463157
exp ma of ||w||^2 85.48091230024188
||w|| 0.6172601568595819
exp ma of ||w|| 0.5308056262796303
||w||^2 0.21911842745758492
exp ma of ||w||^2 0.36321294256457254
||w|| 0.4681008731647324
exp ma of ||w|| 0.5565724336840414
||w||^2 0.18209427941548917
exp ma of ||w||^2 0.3452548012611649
||w|| 0.42672506302710783
exp ma of ||w|| 0.5405991332962821
||w||^2 0.7426460001184533
exp ma of ||w||^2 0.3739581327998222
||w|| 0.8617691106778272
exp ma of ||w|| 0.5710449163246821
||w||^2 0.4694054595395728
exp ma of ||w||^2 0.36218146594107103
||w|| 0.6851317096293039
exp ma of ||w|| 0.5621514004922724
||w||^2 0.6836903301289535
exp ma of ||w||^2 0.36722020310044956
||w|| 0.8268556888169504
exp ma of ||w|| 0.5584827835616483
||w||^2 1.097022197454831
exp ma of ||w||^2 0.36411707412716043
||w|| 1.047388274449753
exp ma of ||w|| 0.5621497087139835
||w||^2 0.3392473828358319
exp ma of ||w||^2 0.3077175774942099
||w|| 0.5824494680535229
exp ma of ||w|| 0.5141290086258784
||w||^2 0.30512088988084957
exp ma of ||w||^2 0.31748858308902267
||w|| 0.5523774885717643
exp ma of ||w|| 0.5223141981152204
||w||^2 0.22173326376956182
exp ma of ||w||^2 0.3925770032188812
||w|| 0.47088561643945104
exp ma of ||w|| 0.5827731461134618
||w||^2 0.6775729684610163
exp ma of ||w||^2 0.35858589888715464
||w|| 0.8231482056476928
exp ma of ||w|| 0.5567634353647767
v before min max tensor([[-4.773, -1.015, -1.402,  ..., -0.243, -1.242, -1.748],
        [-3.005,  3.805, -1.771,  ...,  0.018, -1.211,  5.263],
        [ 5.075, -1.863, -1.027,  ..., -1.943, -2.242, -2.963],
        ...,
        [-1.100,  1.765, -1.162,  ..., -1.842, -1.063,  1.516],
        [-0.580, -1.061,  0.348,  ...,  0.151, -2.293, 11.657],
        [-1.694,  0.300, -2.946,  ..., -1.022, -2.545, -3.275]],
       device='cuda:0')
v tensor([[1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [1.000e-12, 3.805e+00, 1.000e-12,  ..., 1.779e-02, 1.000e-12,
         5.263e+00],
        [5.075e+00, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        ...,
        [1.000e-12, 1.765e+00, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.516e+00],
        [1.000e-12, 1.000e-12, 3.480e-01,  ..., 1.506e-01, 1.000e-12,
         1.000e+01],
        [1.000e-12, 3.002e-01, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12]], device='cuda:0')
v before min max tensor([-1.055, 12.730, -1.367, -3.694,  1.301, -0.420, -0.534,  9.637, -2.055,
        -2.120, -3.373,  1.042, -2.699, -2.279,  1.197,  6.611,  0.591, -2.584,
        -2.335, -1.740, -1.313, -1.222, -3.042, -2.720,  0.292,  5.129, -2.025,
         0.043, -1.861, -1.631, -0.519, -2.180, -3.279, -1.758, -1.719, -1.561,
        -0.304,  2.367, -0.737,  8.447,  2.041, -1.885, -1.602, -2.174, -0.689,
         3.392, -0.970,  8.183, -1.482, -1.165, -2.952, -2.202, -2.937,  0.376,
        -2.148,  3.050, -1.844, -2.556, -0.935, -2.733,  7.866,  5.895, -0.234,
        -1.691, -1.125, -1.914,  1.306,  4.799, -2.462, -3.693, -1.602, -1.174,
        -1.716, -0.643,  0.930, -2.236,  2.202, -1.031, -2.148,  1.412, -1.520,
        -1.188, -2.867, -1.105,  2.613,  2.608,  5.295, -1.797, -2.494,  0.457,
        -1.016, -2.083, -0.998, -3.186, -2.542, -0.858,  0.998, -3.277, -1.805,
        -1.543,  1.396,  4.454, 11.692, -0.728,  0.578,  4.824, -2.146, -2.410,
         4.672, -2.788, -1.239, -1.706, -3.436, -1.749, -0.299,  2.528, -1.483,
         0.703,  1.512, -1.957], device='cuda:0')
v tensor([1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.301e+00, 1.000e-12,
        1.000e-12, 9.637e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.042e+00,
        1.000e-12, 1.000e-12, 1.197e+00, 6.611e+00, 5.907e-01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        2.924e-01, 5.129e+00, 1.000e-12, 4.253e-02, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 2.367e+00, 1.000e-12, 8.447e+00, 2.041e+00, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 3.392e+00, 1.000e-12, 8.183e+00,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 3.762e-01,
        1.000e-12, 3.050e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        7.866e+00, 5.895e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.306e+00, 4.799e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 9.297e-01, 1.000e-12, 2.202e+00, 1.000e-12,
        1.000e-12, 1.412e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        2.613e+00, 2.608e+00, 5.295e+00, 1.000e-12, 1.000e-12, 4.570e-01,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        9.979e-01, 1.000e-12, 1.000e-12, 1.000e-12, 1.396e+00, 4.454e+00,
        1.000e+01, 1.000e-12, 5.781e-01, 4.824e+00, 1.000e-12, 1.000e-12,
        4.672e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 2.528e+00, 1.000e-12, 7.033e-01, 1.512e+00, 1.000e-12],
       device='cuda:0')
v before min max tensor([[[-1.594e+00],
         [-1.917e+00],
         [-6.366e-02],
         [ 4.569e+00],
         [-2.149e+00],
         [-8.384e-01],
         [-3.630e+00],
         [ 1.602e+00],
         [ 1.874e-01],
         [-2.139e+00]],

        [[-6.921e-01],
         [-1.143e+00],
         [-2.990e+00],
         [-2.043e+00],
         [-9.745e-01],
         [ 1.596e+00],
         [ 2.598e+00],
         [ 8.130e-01],
         [ 2.358e-03],
         [ 1.285e+00]],

        [[ 3.357e+00],
         [ 2.123e+00],
         [ 1.007e+01],
         [ 1.299e+01],
         [ 1.753e+00],
         [ 3.756e+00],
         [ 1.150e+00],
         [-1.353e+00],
         [-1.458e+00],
         [-1.354e+00]],

        [[-2.701e+00],
         [ 4.962e-01],
         [ 2.931e-01],
         [-5.346e-02],
         [ 3.615e+00],
         [ 7.288e-01],
         [-3.509e+00],
         [-2.805e+00],
         [-1.196e+00],
         [-1.645e+00]],

        [[ 2.122e+00],
         [ 3.017e+00],
         [ 3.741e-01],
         [-3.629e+00],
         [-1.418e+00],
         [ 8.208e+00],
         [ 6.009e+00],
         [-3.278e-01],
         [-1.205e+00],
         [-3.777e+00]],

        [[ 5.059e+00],
         [ 1.135e+01],
         [-3.396e+00],
         [-2.511e+00],
         [-4.264e+00],
         [-9.093e-01],
         [ 8.152e+00],
         [ 1.376e+01],
         [-4.912e-02],
         [ 1.000e-01]],

        [[-3.413e-01],
         [-2.821e+00],
         [ 6.607e+00],
         [ 7.422e+00],
         [-3.872e+00],
         [-1.715e+00],
         [ 3.023e+00],
         [ 3.245e+00],
         [-2.625e+00],
         [-2.027e+00]],

        [[-9.156e-01],
         [ 5.792e+00],
         [-4.013e-01],
         [-2.236e+00],
         [ 3.553e+00],
         [-3.191e+00],
         [-9.458e-01],
         [-1.142e+00],
         [ 6.137e-01],
         [-1.648e+00]],

        [[-2.145e+00],
         [ 2.277e+00],
         [-1.481e+00],
         [-3.730e-01],
         [-1.999e+00],
         [-3.372e+00],
         [-2.405e+00],
         [-1.624e+00],
         [-2.239e+00],
         [ 1.034e+01]],

        [[ 3.117e+00],
         [-1.747e+00],
         [-1.958e+00],
         [-2.774e+00],
         [-2.033e+00],
         [-1.875e-01],
         [ 3.462e+00],
         [ 2.434e+00],
         [-1.399e+00],
         [-6.065e-01]],

        [[-4.055e-01],
         [-3.429e+00],
         [ 9.808e+00],
         [ 3.760e+00],
         [-2.043e+00],
         [-2.838e+00],
         [-1.345e+00],
         [ 1.878e+01],
         [-1.332e+00],
         [-1.976e+00]],

        [[-1.476e+00],
         [ 4.136e+00],
         [-2.431e+00],
         [ 1.057e+01],
         [-7.323e-01],
         [-1.508e+00],
         [-3.448e+00],
         [-5.041e-01],
         [-2.245e+00],
         [-1.545e+00]]], device='cuda:0')
v tensor([[[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [4.569e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.602e+00],
         [1.874e-01],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.596e+00],
         [2.598e+00],
         [8.130e-01],
         [2.358e-03],
         [1.285e+00]],

        [[3.357e+00],
         [2.123e+00],
         [1.000e+01],
         [1.000e+01],
         [1.753e+00],
         [3.756e+00],
         [1.150e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [4.962e-01],
         [2.931e-01],
         [1.000e-12],
         [3.615e+00],
         [7.288e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[2.122e+00],
         [3.017e+00],
         [3.741e-01],
         [1.000e-12],
         [1.000e-12],
         [8.208e+00],
         [6.009e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[5.059e+00],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [8.152e+00],
         [1.000e+01],
         [1.000e-12],
         [1.000e-01]],

        [[1.000e-12],
         [1.000e-12],
         [6.607e+00],
         [7.422e+00],
         [1.000e-12],
         [1.000e-12],
         [3.023e+00],
         [3.245e+00],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [5.792e+00],
         [1.000e-12],
         [1.000e-12],
         [3.553e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [6.137e-01],
         [1.000e-12]],

        [[1.000e-12],
         [2.277e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01]],

        [[3.117e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [3.462e+00],
         [2.434e+00],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [9.808e+00],
         [3.760e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [4.136e+00],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]]], device='cuda:0')
v before min max tensor([[ 1.141],
        [-1.739],
        [-2.786],
        [ 3.914],
        [ 1.171],
        [ 2.310],
        [-2.045],
        [-1.049],
        [-0.241],
        [-2.405],
        [ 1.949],
        [-2.439]], device='cuda:0')
v tensor([[1.141e+00],
        [1.000e-12],
        [1.000e-12],
        [3.914e+00],
        [1.171e+00],
        [2.310e+00],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.949e+00],
        [1.000e-12]], device='cuda:0')
a after update for 1 param tensor([[ 0.000,  0.042, -0.013,  ...,  0.022, -0.013, -0.018],
        [ 0.003,  0.000, -0.002,  ..., -0.017, -0.013, -0.031],
        [-0.006, -0.028, -0.018,  ...,  0.014,  0.020,  0.008],
        ...,
        [-0.031, -0.014, -0.024,  ...,  0.009,  0.012, -0.022],
        [-0.004, -0.002, -0.006,  ...,  0.000,  0.016,  0.002],
        [ 0.010, -0.005, -0.002,  ...,  0.007, -0.010, -0.005]],
       device='cuda:0')
s after update for 1 param tensor([[1.970, 0.417, 0.577,  ..., 1.299, 1.122, 0.682],
        [1.386, 1.847, 1.094,  ..., 1.428, 0.997, 1.749],
        [1.918, 0.846, 1.068,  ..., 1.480, 1.488, 1.191],
        ...,
        [0.940, 1.013, 0.530,  ..., 0.835, 0.753, 1.627],
        [0.612, 0.482, 0.765,  ..., 1.124, 1.013, 2.157],
        [0.996, 0.617, 1.292,  ..., 0.812, 0.995, 1.316]], device='cuda:0')
b after update for 1 param tensor([[61.935, 28.512, 33.515,  ..., 50.297, 46.750, 36.451],
        [51.954, 59.977, 46.150,  ..., 52.736, 44.063, 58.361],
        [61.114, 40.599, 45.606,  ..., 53.687, 53.825, 48.167],
        ...,
        [42.786, 44.422, 32.115,  ..., 40.324, 38.285, 56.281],
        [34.532, 30.625, 38.587,  ..., 46.789, 44.422, 64.814],
        [44.032, 34.654, 50.157,  ..., 39.764, 44.019, 50.614]],
       device='cuda:0')
clipping threshold 0.34557998305317944
a after update for 1 param tensor([ 1.058e-02, -1.810e-02, -1.495e-02,  4.290e-03,  2.252e-03,  1.687e-02,
         2.681e-02, -5.922e-02, -6.143e-03, -2.393e-02,  8.970e-03,  5.749e-02,
         4.124e-03, -1.602e-02,  3.024e-02,  1.176e-02, -1.305e-02, -1.033e-03,
         3.544e-02,  5.419e-03,  4.256e-02,  2.005e-02, -6.058e-03,  1.392e-02,
        -5.399e-03,  2.254e-02,  1.477e-03, -1.656e-02, -1.810e-02, -1.269e-02,
        -2.419e-02, -4.803e-02,  5.253e-04, -1.226e-02, -2.508e-02,  2.156e-02,
        -1.674e-02,  3.894e-02,  1.391e-02, -5.346e-03, -4.139e-02,  3.808e-02,
        -1.999e-02,  3.841e-02,  7.410e-02,  4.920e-05, -2.820e-02, -6.508e-03,
         2.788e-02, -1.493e-02, -3.016e-02,  6.573e-04,  4.988e-02, -1.533e-02,
        -3.313e-03, -5.842e-02, -2.179e-02,  1.872e-02, -8.699e-04,  2.876e-03,
         4.776e-02, -6.061e-02,  2.592e-02,  3.706e-02,  5.794e-02, -3.903e-03,
         2.561e-02,  1.012e-03,  1.062e-02,  2.325e-02,  7.870e-03, -1.678e-02,
        -2.980e-02, -5.078e-02,  5.156e-02, -8.075e-03,  3.801e-02,  4.026e-03,
        -1.827e-02,  9.521e-03, -1.974e-02, -1.636e-02,  2.584e-02, -2.525e-02,
        -2.280e-03,  5.718e-02,  5.367e-03, -4.763e-02, -2.044e-02,  5.221e-02,
        -1.257e-02,  3.005e-02,  1.068e-02, -5.092e-02,  2.816e-02,  6.667e-03,
        -1.728e-02,  1.568e-02,  9.438e-03, -3.995e-02, -1.393e-02, -1.233e-02,
        -5.185e-02, -1.550e-02,  5.855e-02, -2.408e-02, -1.068e-03, -1.938e-02,
        -4.295e-02, -7.143e-02,  8.146e-03,  8.064e-03,  6.283e-02,  2.126e-02,
         1.068e-02,  3.291e-02,  4.432e-02,  2.666e-02,  6.252e-03,  3.490e-02],
       device='cuda:0')
s after update for 1 param tensor([0.568, 1.731, 1.874, 1.493, 0.650, 0.933, 1.134, 1.544, 0.892, 1.059,
        1.442, 0.923, 1.369, 1.196, 0.723, 1.148, 0.891, 1.288, 1.504, 0.685,
        1.106, 1.108, 1.200, 1.439, 0.501, 1.355, 1.285, 1.171, 1.162, 0.686,
        0.580, 0.865, 1.505, 0.848, 0.675, 0.827, 1.217, 1.045, 0.984, 1.639,
        1.210, 0.936, 0.797, 0.966, 1.039, 1.021, 0.489, 1.647, 1.003, 1.225,
        1.519, 0.911, 1.269, 1.026, 0.838, 1.465, 0.720, 1.000, 1.170, 1.395,
        1.580, 1.381, 0.776, 1.119, 0.439, 1.171, 1.150, 1.108, 1.026, 1.446,
        0.912, 0.534, 0.925, 1.059, 0.769, 0.920, 1.413, 0.919, 1.459, 0.574,
        0.641, 0.479, 1.151, 0.651, 0.646, 1.141, 1.362, 0.757, 1.169, 0.897,
        0.436, 0.955, 0.391, 1.329, 1.201, 1.049, 0.770, 1.296, 1.209, 0.814,
        1.122, 1.532, 1.475, 1.090, 1.258, 1.484, 1.101, 1.158, 1.390, 1.096,
        1.044, 0.668, 1.342, 0.724, 1.435, 0.953, 0.759, 1.171, 0.865, 0.796],
       device='cuda:0')
b after update for 1 param tensor([33.263, 58.058, 60.412, 53.912, 35.564, 42.620, 46.999, 54.831, 41.672,
        45.420, 52.988, 42.395, 51.631, 48.265, 37.513, 47.277, 41.648, 50.076,
        54.110, 36.522, 46.412, 46.445, 48.340, 52.938, 31.231, 51.374, 50.016,
        47.746, 47.568, 36.557, 33.612, 41.045, 54.132, 40.648, 36.255, 40.135,
        48.673, 45.120, 43.776, 56.500, 48.543, 42.686, 39.387, 43.381, 44.972,
        44.587, 30.861, 56.639, 44.198, 48.842, 54.384, 42.127, 49.706, 44.691,
        40.403, 53.409, 37.441, 44.118, 47.723, 52.123, 55.473, 51.849, 38.861,
        46.672, 29.250, 47.748, 47.320, 46.443, 44.698, 53.068, 42.149, 32.244,
        42.431, 45.420, 38.698, 42.336, 52.449, 42.311, 53.309, 33.436, 35.335,
        30.555, 47.350, 35.593, 35.475, 47.134, 51.507, 38.385, 47.703, 41.784,
        29.127, 43.115, 27.602, 50.882, 48.355, 45.193, 38.720, 50.242, 48.528,
        39.805, 46.750, 54.618, 53.585, 46.072, 49.504, 53.760, 46.311, 47.480,
        52.024, 46.205, 45.094, 36.069, 51.127, 37.549, 52.862, 43.088, 38.448,
        47.752, 41.031, 39.361], device='cuda:0')
clipping threshold 0.34557998305317944
a after update for 1 param tensor([[[-5.011e-02],
         [-4.851e-03],
         [ 2.772e-02],
         [ 4.906e-02],
         [ 1.632e-02],
         [-3.443e-02],
         [-2.612e-03],
         [-5.836e-03],
         [-1.916e-02],
         [ 3.695e-02]],

        [[-3.980e-03],
         [-1.390e-02],
         [-2.238e-02],
         [ 2.351e-02],
         [-2.370e-02],
         [-2.153e-02],
         [ 1.816e-02],
         [ 9.887e-03],
         [ 3.784e-03],
         [-2.236e-02]],

        [[-1.153e-02],
         [-2.329e-02],
         [ 3.910e-02],
         [ 4.436e-02],
         [ 1.512e-02],
         [ 2.304e-02],
         [-1.656e-02],
         [-1.277e-02],
         [-2.667e-02],
         [ 1.101e-02]],

        [[ 2.218e-02],
         [ 8.377e-03],
         [-4.001e-02],
         [-2.544e-02],
         [ 2.157e-02],
         [ 1.992e-03],
         [-5.340e-02],
         [-4.452e-02],
         [ 2.340e-02],
         [-5.813e-02]],

        [[ 4.604e-02],
         [-3.944e-02],
         [-1.006e-02],
         [ 9.513e-03],
         [-1.001e-02],
         [-2.407e-02],
         [-4.829e-02],
         [ 3.733e-02],
         [ 1.052e-02],
         [-1.772e-02]],

        [[-2.725e-02],
         [-1.794e-02],
         [ 4.659e-02],
         [ 3.448e-02],
         [-1.187e-02],
         [ 2.541e-02],
         [-2.273e-02],
         [ 5.650e-03],
         [ 4.731e-02],
         [-1.930e-03]],

        [[-2.440e-03],
         [ 1.135e-02],
         [-4.844e-02],
         [-1.493e-02],
         [ 9.585e-02],
         [ 6.880e-05],
         [ 2.150e-02],
         [-2.685e-02],
         [-3.733e-02],
         [-4.781e-02]],

        [[ 1.099e-02],
         [ 4.063e-02],
         [ 5.940e-02],
         [-5.570e-03],
         [-1.902e-02],
         [ 1.824e-03],
         [ 1.917e-02],
         [-1.155e-02],
         [-1.123e-02],
         [ 3.028e-02]],

        [[ 2.818e-02],
         [ 3.969e-02],
         [-1.436e-02],
         [ 2.338e-02],
         [-2.123e-04],
         [-3.282e-02],
         [-1.549e-02],
         [ 5.572e-02],
         [-2.623e-03],
         [-3.411e-02]],

        [[ 2.565e-02],
         [-1.248e-02],
         [ 1.215e-03],
         [ 5.685e-02],
         [ 2.856e-02],
         [-2.976e-04],
         [-1.450e-02],
         [ 2.425e-02],
         [ 1.734e-02],
         [-4.777e-02]],

        [[ 1.007e-01],
         [-3.247e-02],
         [-3.184e-02],
         [-1.537e-02],
         [-3.210e-02],
         [-8.397e-03],
         [ 3.546e-03],
         [ 1.521e-03],
         [ 2.030e-03],
         [-2.555e-02]],

        [[-3.815e-03],
         [-2.410e-03],
         [ 7.887e-03],
         [ 1.456e-03],
         [-1.797e-02],
         [-5.185e-02],
         [-3.410e-02],
         [ 9.532e-03],
         [ 2.588e-02],
         [-4.882e-02]]], device='cuda:0')
s after update for 1 param tensor([[[1.077],
         [0.748],
         [1.369],
         [1.650],
         [0.957],
         [1.088],
         [1.416],
         [0.957],
         [0.814],
         [0.870]],

        [[1.183],
         [1.140],
         [1.173],
         [1.008],
         [0.930],
         [0.577],
         [1.707],
         [0.529],
         [0.490],
         [0.979]],

        [[1.434],
         [0.983],
         [1.639],
         [1.555],
         [1.205],
         [0.974],
         [0.809],
         [0.566],
         [0.569],
         [1.038]],

        [[1.084],
         [1.017],
         [0.591],
         [0.610],
         [1.182],
         [0.926],
         [1.419],
         [1.392],
         [0.529],
         [0.685]],

        [[0.717],
         [1.155],
         [1.025],
         [1.486],
         [0.796],
         [1.181],
         [1.424],
         [1.411],
         [0.633],
         [1.485]],

        [[1.307],
         [1.333],
         [1.361],
         [1.011],
         [1.800],
         [0.810],
         [1.258],
         [2.037],
         [0.798],
         [0.636]],

        [[0.703],
         [1.243],
         [1.166],
         [1.371],
         [1.513],
         [0.845],
         [0.832],
         [0.933],
         [1.408],
         [1.056]],

        [[1.074],
         [1.535],
         [0.777],
         [1.172],
         [1.253],
         [1.522],
         [0.643],
         [0.682],
         [1.273],
         [0.644]],

        [[0.863],
         [1.204],
         [0.960],
         [0.393],
         [0.788],
         [1.361],
         [1.308],
         [0.745],
         [0.928],
         [1.359]],

        [[1.159],
         [0.784],
         [1.029],
         [1.288],
         [1.113],
         [0.685],
         [1.334],
         [1.424],
         [1.165],
         [1.364]],

        [[1.214],
         [1.405],
         [1.263],
         [1.421],
         [1.409],
         [1.108],
         [1.018],
         [1.391],
         [1.704],
         [0.912]],

        [[0.973],
         [1.331],
         [1.141],
         [1.755],
         [0.785],
         [0.613],
         [1.398],
         [0.721],
         [1.207],
         [0.696]]], device='cuda:0')
b after update for 1 param tensor([[[45.803],
         [38.169],
         [51.627],
         [56.691],
         [43.161],
         [46.021],
         [52.518],
         [43.166],
         [39.816],
         [41.155]],

        [[47.990],
         [47.107],
         [47.796],
         [44.295],
         [42.547],
         [33.510],
         [57.655],
         [32.099],
         [30.896],
         [43.662]],

        [[52.847],
         [43.762],
         [56.493],
         [55.024],
         [48.437],
         [43.559],
         [39.701],
         [33.208],
         [33.285],
         [44.950]],

        [[45.941],
         [44.511],
         [33.933],
         [34.459],
         [47.970],
         [42.465],
         [52.558],
         [52.058],
         [32.089],
         [36.515]],

        [[37.354],
         [47.436],
         [44.681],
         [53.799],
         [39.361],
         [47.966],
         [52.664],
         [52.420],
         [35.110],
         [53.781]],

        [[50.443],
         [50.950],
         [51.474],
         [44.361],
         [59.204],
         [39.708],
         [49.503],
         [62.984],
         [39.427],
         [35.190]],

        [[37.007],
         [49.198],
         [47.658],
         [51.663],
         [54.285],
         [40.571],
         [40.251],
         [42.622],
         [52.360],
         [45.354]],

        [[45.737],
         [54.671],
         [38.906],
         [47.769],
         [49.404],
         [54.433],
         [35.382],
         [36.450],
         [49.787],
         [35.409]],

        [[40.996],
         [48.426],
         [43.236],
         [27.669],
         [39.170],
         [51.478],
         [50.474],
         [38.082],
         [42.511],
         [51.444]],

        [[47.505],
         [39.085],
         [44.769],
         [50.091],
         [46.549],
         [36.525],
         [50.961],
         [52.661],
         [47.631],
         [51.540]],

        [[48.619],
         [52.308],
         [49.589],
         [52.597],
         [52.383],
         [46.458],
         [44.514],
         [52.036],
         [57.612],
         [42.142]],

        [[43.526],
         [50.915],
         [47.141],
         [58.468],
         [39.090],
         [34.546],
         [52.180],
         [37.469],
         [48.478],
         [36.815]]], device='cuda:0')
clipping threshold 0.34557998305317944
a after update for 1 param tensor([[-0.014],
        [-0.036],
        [-0.010],
        [ 0.019],
        [-0.027],
        [-0.027],
        [ 0.032],
        [-0.031],
        [-0.026],
        [-0.023],
        [ 0.001],
        [ 0.020]], device='cuda:0')
s after update for 1 param tensor([[1.309],
        [0.694],
        [1.105],
        [1.033],
        [1.375],
        [1.151],
        [0.799],
        [0.824],
        [1.116],
        [1.347],
        [0.866],
        [0.953]], device='cuda:0')
b after update for 1 param tensor([[50.486],
        [36.770],
        [46.397],
        [44.853],
        [51.750],
        [47.335],
        [39.447],
        [40.052],
        [46.622],
        [51.207],
        [41.067],
        [43.090]], device='cuda:0')
clipping threshold 0.34557998305317944
||w||^2 0.2922999567496954
exp ma of ||w||^2 0.35853959919120754
||w|| 0.5406477196379315
exp ma of ||w|| 0.5541479604180831
||w||^2 0.5403360928620049
exp ma of ||w||^2 0.33026617663798963
||w|| 0.735075569490651
exp ma of ||w|| 0.5351714497881551
||w||^2 0.28817109358802195
exp ma of ||w||^2 0.39506607069375055
||w|| 0.5368156979709349
exp ma of ||w|| 0.5795860792738873
||w||^2 0.5669397827807697
exp ma of ||w||^2 0.2837260301332733
||w|| 0.7529540376283068
exp ma of ||w|| 0.49590098763241985
||w||^2 0.56829433542168
exp ma of ||w||^2 0.3647143736850177
||w|| 0.7538529932431653
exp ma of ||w|| 0.5581367553382914
||w||^2 0.12825169164673622
exp ma of ||w||^2 0.34794496546523795
||w|| 0.35812245342443444
exp ma of ||w|| 0.5534001615365841
||w||^2 0.15063212766017925
exp ma of ||w||^2 0.3548961491505371
||w|| 0.3881135499569414
exp ma of ||w|| 0.5544048919804829
||w||^2 0.2762745746166538
exp ma of ||w||^2 0.3399307495516513
||w|| 0.5256182784270861
exp ma of ||w|| 0.5472258931363568
||w||^2 0.3300789676820169
exp ma of ||w||^2 0.33577221125939993
||w|| 0.5745249930873477
exp ma of ||w|| 0.540115825726867
||w||^2 0.18631178280789898
exp ma of ||w||^2 0.33368905339149807
||w|| 0.4316384862450277
exp ma of ||w|| 0.5274730006602766
||w||^2 0.29949301389890465
exp ma of ||w||^2 0.3680663651961165
||w|| 0.5472595489335061
exp ma of ||w|| 0.5639237843451418
||w||^2 0.2557317089803245
exp ma of ||w||^2 0.3639072969689477
||w|| 0.5056992277830019
exp ma of ||w|| 0.5574158504996516
||w||^2 0.14355875162801748
exp ma of ||w||^2 0.37289222339992445
||w|| 0.3788914773758015
exp ma of ||w|| 0.5677280803192398
||w||^2 0.5331133725378814
exp ma of ||w||^2 0.3455362055246233
||w|| 0.7301461309476901
exp ma of ||w|| 0.5415976108214141
||w||^2 0.2620554097564727
exp ma of ||w||^2 0.35036646312199493
||w|| 0.5119134787798351
exp ma of ||w|| 0.5476550071915177
||w||^2 0.10369526619116368
exp ma of ||w||^2 0.31350496332036387
||w|| 0.3220174936104616
exp ma of ||w|| 0.5151280094917803
||w||^2 0.038869627704984686
exp ma of ||w||^2 0.321195104136018
||w|| 0.19715381737360474
exp ma of ||w|| 0.5241582251678176
||w||^2 0.20524834738226566
exp ma of ||w||^2 0.3611918221270552
||w|| 0.45304342770011097
exp ma of ||w|| 0.5631324587446567
||w||^2 1.435442160779878
exp ma of ||w||^2 0.38364773436795035
||w|| 1.198099395200531
exp ma of ||w|| 0.5799471827397845
cuda
Objective function 10.92 = squared loss an data 8.43 + 0.5*rho*h**2 0.267049 + alpha*h 0.958961 + L2reg 1.19 + L1reg 0.07 ; SHD = 30 ; DAG True
Proportion of microbatches that were clipped  0.7725977933801405
iteration 1 in inner loop, alpha 13.121699270428012 rho 100.0 h 0.07308206941218032
1692
cuda
Objective function 13.32 = squared loss an data 8.43 + 0.5*rho*h**2 2.670494 + alpha*h 0.958961 + L2reg 1.19 + L1reg 0.07 ; SHD = 30 ; DAG True
||w||^2 0.06029561057250752
exp ma of ||w||^2 105396.36079757077
||w|| 0.24555164542822253
exp ma of ||w|| 1.6067051075526162
||w||^2 0.1594842554304322
exp ma of ||w||^2 342.97277650098465
||w|| 0.3993547989325184
exp ma of ||w|| 0.5082807409262612
||w||^2 0.1510754424561389
exp ma of ||w||^2 0.430603341480518
||w|| 0.38868424518642236
exp ma of ||w|| 0.602486610961805
||w||^2 0.16998527756506251
exp ma of ||w||^2 0.3715336788387028
||w|| 0.4122927086004099
exp ma of ||w|| 0.5653753185843736
||w||^2 0.34811470277581513
exp ma of ||w||^2 0.3390160526771736
||w|| 0.5900124598479384
exp ma of ||w|| 0.5403149598083282
||w||^2 0.19504168991260804
exp ma of ||w||^2 0.33173083122386265
||w|| 0.44163524532424725
exp ma of ||w|| 0.5355961670509869
||w||^2 0.1765500337460092
exp ma of ||w||^2 0.3612180776381967
||w|| 0.4201785736398385
exp ma of ||w|| 0.5538634238790237
||w||^2 0.3696156953540261
exp ma of ||w||^2 0.369659493854401
||w|| 0.6079602744867678
exp ma of ||w|| 0.5593460589334374
||w||^2 0.14193355536491326
exp ma of ||w||^2 0.3719881510231939
||w|| 0.3767407004358744
exp ma of ||w|| 0.5625089287721853
||w||^2 0.37518113308786555
exp ma of ||w||^2 0.3199543311692662
||w|| 0.6125203123879776
exp ma of ||w|| 0.5286296240684599
||w||^2 0.27874154291686326
exp ma of ||w||^2 0.3110514697882795
||w|| 0.5279597928979661
exp ma of ||w|| 0.5225007941228575
||w||^2 0.06005309227315941
exp ma of ||w||^2 0.4092019334110695
||w|| 0.2450573244633986
exp ma of ||w|| 0.5971724262067825
||w||^2 0.4105446799426445
exp ma of ||w||^2 0.3271965035175566
||w|| 0.6407376061560961
exp ma of ||w|| 0.536882722861511
||w||^2 0.1479682253796977
exp ma of ||w||^2 0.3211981563374421
||w|| 0.3846663819203567
exp ma of ||w|| 0.5316482054137538
||w||^2 0.19015802979571803
exp ma of ||w||^2 0.38675866022728733
||w|| 0.43607112928479685
exp ma of ||w|| 0.5847712890442238
||w||^2 0.7349092650443324
exp ma of ||w||^2 0.3767112617244104
||w|| 0.8572684906400867
exp ma of ||w|| 0.5743417121243957
||w||^2 0.08626595295178562
exp ma of ||w||^2 0.3005685513026871
||w|| 0.2937106619647738
exp ma of ||w|| 0.5167800461822748
||w||^2 0.09323953099093375
exp ma of ||w||^2 0.3021836379595225
||w|| 0.3053514876186683
exp ma of ||w|| 0.5143682573124926
v before min max tensor([[-3.386,  0.555, -2.376,  ..., -1.979, -0.964, -2.169],
        [ 9.270, -1.882, -1.652,  ..., -1.757, -1.545, -2.600],
        [ 0.942, -1.663, -2.508,  ..., -4.896, -3.214,  2.073],
        ...,
        [-1.707,  2.596, -2.719,  ..., -1.837, -1.177, -1.993],
        [ 1.807,  2.427, -2.123,  ..., -2.519,  3.375, -2.047],
        [-3.096,  1.011, -1.919,  ...,  0.758, -0.084, -3.328]],
       device='cuda:0')
v tensor([[1.000e-12, 5.546e-01, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [9.270e+00, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [9.421e-01, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         2.073e+00],
        ...,
        [1.000e-12, 2.596e+00, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [1.807e+00, 2.427e+00, 1.000e-12,  ..., 1.000e-12, 3.375e+00,
         1.000e-12],
        [1.000e-12, 1.011e+00, 1.000e-12,  ..., 7.580e-01, 1.000e-12,
         1.000e-12]], device='cuda:0')
v before min max tensor([ 1.036, -1.521, -3.494, -1.089,  1.476,  1.028,  1.791, -1.086, -2.674,
        -0.649, -2.137, -2.836, -0.402, -2.463, -2.680, -4.450, -0.660, -2.338,
        -2.127, -2.036, -1.152, -0.926,  5.615, -3.212, -1.775, -2.380, -0.588,
        -3.189, -1.903, -1.380,  0.909, -1.638, -2.252, -3.545,  9.290, -0.175,
        -0.603,  0.161, -0.897, -3.736, -2.400,  0.167, -2.581, -2.562, -2.826,
        -2.705, -2.420, -3.067, -1.483, -0.620, -1.810, -1.780, -2.398, -2.439,
        -1.203,  1.095, -3.121, -1.435,  0.183, -2.172, -1.498, -3.326,  0.718,
        -1.724, -2.030, -2.063, -3.037, -0.323,  1.076, -2.717, -2.249, -1.908,
        -0.967, -2.800,  0.795, -1.469, -2.930, -1.789, -0.191,  6.348, -1.113,
        -2.262,  2.912, -0.746,  0.366, -1.348, -1.183, -0.920, -0.995, -2.648,
        -4.067, -0.544, -2.133, -1.640, -2.575, -2.548, -3.390, -1.460, -2.177,
        -3.293, -1.145, -0.874,  0.790, -1.328,  1.329, -2.301, -2.023,  0.230,
         7.119, -0.479,  7.050, -1.787, -2.904,  2.646, -2.855,  9.166, -2.951,
        -1.198, -3.495, -1.283], device='cuda:0')
v tensor([1.036e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.476e+00, 1.028e+00,
        1.791e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 5.615e+00, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        9.090e-01, 1.000e-12, 1.000e-12, 1.000e-12, 9.290e+00, 1.000e-12,
        1.000e-12, 1.609e-01, 1.000e-12, 1.000e-12, 1.000e-12, 1.673e-01,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.095e+00, 1.000e-12, 1.000e-12, 1.831e-01, 1.000e-12,
        1.000e-12, 1.000e-12, 7.184e-01, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.076e+00, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 7.949e-01, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 6.348e+00, 1.000e-12, 1.000e-12, 2.912e+00, 1.000e-12,
        3.659e-01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        7.903e-01, 1.000e-12, 1.329e+00, 1.000e-12, 1.000e-12, 2.305e-01,
        7.119e+00, 1.000e-12, 7.050e+00, 1.000e-12, 1.000e-12, 2.646e+00,
        1.000e-12, 9.166e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12],
       device='cuda:0')
v before min max tensor([[[-2.670e+00],
         [-1.381e+00],
         [-1.707e+00],
         [-1.272e+00],
         [-1.558e+00],
         [-8.639e-03],
         [-2.809e+00],
         [-1.718e+00],
         [-3.083e+00],
         [-1.841e+00]],

        [[-2.567e+00],
         [-4.797e+00],
         [-1.127e+00],
         [-1.944e+00],
         [-3.245e+00],
         [-1.611e+00],
         [-2.204e+00],
         [-3.307e+00],
         [ 4.245e+00],
         [-4.497e+00]],

        [[-1.112e+00],
         [-2.434e+00],
         [-9.308e-01],
         [-1.473e+00],
         [ 1.227e+00],
         [-5.199e-01],
         [-3.144e+00],
         [-3.478e+00],
         [ 1.310e+00],
         [-3.249e+00]],

        [[-1.165e-01],
         [ 3.592e+00],
         [-2.593e+00],
         [-2.664e+00],
         [ 2.029e+00],
         [-3.220e+00],
         [-3.916e+00],
         [ 3.343e+00],
         [ 1.340e+00],
         [-2.033e+00]],

        [[-1.932e+00],
         [ 7.972e-02],
         [-7.801e-01],
         [-2.445e+00],
         [ 3.302e+00],
         [-2.516e+00],
         [-1.055e+00],
         [-2.228e+00],
         [-1.683e+00],
         [-7.262e-01]],

        [[-1.615e+00],
         [-1.660e+00],
         [-1.941e+00],
         [-9.415e-01],
         [-2.154e+00],
         [-8.247e-01],
         [-2.067e-01],
         [ 6.852e-01],
         [-2.023e+00],
         [-1.233e+00]],

        [[-1.973e+00],
         [-1.254e+00],
         [ 4.197e-01],
         [-1.743e+00],
         [-2.944e+00],
         [ 7.389e-01],
         [-2.578e+00],
         [ 3.545e-01],
         [-2.271e+00],
         [-3.358e+00]],

        [[ 8.676e-01],
         [-1.019e+00],
         [ 8.358e-01],
         [-2.545e+00],
         [-1.563e+00],
         [ 5.226e+00],
         [-1.863e+00],
         [-1.918e+00],
         [-1.270e+00],
         [-2.650e+00]],

        [[-3.615e-01],
         [-2.986e+00],
         [-2.039e+00],
         [-1.986e+00],
         [ 1.101e+01],
         [-1.513e+00],
         [-1.615e+00],
         [-1.440e+00],
         [-2.340e+00],
         [ 1.030e+00]],

        [[-1.786e+00],
         [-2.795e+00],
         [-2.776e+00],
         [-2.425e+00],
         [ 1.168e+00],
         [-2.184e+00],
         [-1.668e+00],
         [-2.146e+00],
         [-2.306e+00],
         [-6.838e-01]],

        [[-1.289e+00],
         [-9.592e-01],
         [-8.664e-01],
         [-5.314e-01],
         [-1.198e-01],
         [-2.641e+00],
         [-1.160e+00],
         [-3.868e+00],
         [-3.977e+00],
         [-1.516e+00]],

        [[-2.241e+00],
         [ 1.562e+00],
         [-3.007e-01],
         [ 7.890e-01],
         [-8.429e-01],
         [ 3.280e-01],
         [-1.407e+00],
         [-4.191e+00],
         [-2.313e+00],
         [-2.912e+00]]], device='cuda:0')
v tensor([[[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [4.245e+00],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.227e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.310e+00],
         [1.000e-12]],

        [[1.000e-12],
         [3.592e+00],
         [1.000e-12],
         [1.000e-12],
         [2.029e+00],
         [1.000e-12],
         [1.000e-12],
         [3.343e+00],
         [1.340e+00],
         [1.000e-12]],

        [[1.000e-12],
         [7.972e-02],
         [1.000e-12],
         [1.000e-12],
         [3.302e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [6.852e-01],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [4.197e-01],
         [1.000e-12],
         [1.000e-12],
         [7.389e-01],
         [1.000e-12],
         [3.545e-01],
         [1.000e-12],
         [1.000e-12]],

        [[8.676e-01],
         [1.000e-12],
         [8.358e-01],
         [1.000e-12],
         [1.000e-12],
         [5.226e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.030e+00]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.168e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.562e+00],
         [1.000e-12],
         [7.890e-01],
         [1.000e-12],
         [3.280e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]]], device='cuda:0')
v before min max tensor([[-1.425],
        [-0.306],
        [-0.506],
        [ 0.112],
        [-3.584],
        [-1.798],
        [ 0.595],
        [-3.580],
        [-1.951],
        [-2.737],
        [-3.528],
        [-2.142]], device='cuda:0')
v tensor([[1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.120e-01],
        [1.000e-12],
        [1.000e-12],
        [5.953e-01],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12]], device='cuda:0')
a after update for 1 param tensor([[ 0.020,  0.016,  0.014,  ..., -0.014, -0.028,  0.033],
        [ 0.007,  0.018, -0.009,  ...,  0.001, -0.027, -0.008],
        [ 0.001, -0.010, -0.008,  ...,  0.037,  0.023, -0.008],
        ...,
        [-0.022, -0.001, -0.010,  ...,  0.021, -0.001,  0.012],
        [ 0.023,  0.015,  0.021,  ..., -0.024,  0.025,  0.005],
        [ 0.018,  0.054, -0.001,  ..., -0.010,  0.000,  0.004]],
       device='cuda:0')
s after update for 1 param tensor([[1.629, 0.811, 1.254,  ..., 1.073, 0.741, 1.195],
        [1.638, 0.724, 0.627,  ..., 0.997, 0.623, 1.033],
        [1.710, 0.632, 1.054,  ..., 1.962, 1.217, 1.106],
        ...,
        [0.789, 1.153, 1.166,  ..., 0.723, 1.175, 1.563],
        [1.138, 0.853, 0.908,  ..., 1.100, 1.453, 1.047],
        [1.348, 1.181, 0.910,  ..., 0.745, 1.508, 1.405]], device='cuda:0')
b after update for 1 param tensor([[55.013, 38.824, 48.276,  ..., 44.656, 37.115, 47.133],
        [55.175, 36.680, 34.142,  ..., 43.054, 34.039, 43.809],
        [56.367, 34.273, 44.248,  ..., 60.389, 47.565, 45.334],
        ...,
        [38.284, 46.279, 46.556,  ..., 36.656, 46.729, 53.896],
        [45.978, 39.824, 41.088,  ..., 45.219, 51.960, 44.105],
        [50.057, 46.844, 41.113,  ..., 37.206, 52.934, 51.098]],
       device='cuda:0')
clipping threshold 0.35534623150779404
a after update for 1 param tensor([-0.010,  0.011, -0.012, -0.002,  0.038, -0.007, -0.001, -0.017, -0.032,
        -0.007,  0.047,  0.002, -0.006, -0.059, -0.016, -0.039,  0.002, -0.006,
         0.010, -0.035, -0.046,  0.006, -0.040,  0.001,  0.013,  0.018,  0.015,
        -0.003, -0.024, -0.023,  0.004,  0.021, -0.001, -0.035, -0.003, -0.000,
         0.058, -0.001,  0.021, -0.018, -0.013,  0.025, -0.057, -0.006,  0.008,
         0.004, -0.008,  0.060, -0.036, -0.004, -0.050,  0.043,  0.030,  0.004,
        -0.001,  0.006,  0.033,  0.021, -0.008, -0.054,  0.005,  0.052,  0.037,
        -0.011, -0.007,  0.063,  0.046, -0.053, -0.012, -0.006,  0.026, -0.013,
        -0.036, -0.043, -0.021,  0.048, -0.023,  0.028, -0.006,  0.022,  0.051,
         0.003,  0.025, -0.007,  0.036,  0.012, -0.008,  0.014,  0.045,  0.015,
        -0.005, -0.005, -0.019,  0.029,  0.014,  0.009, -0.002,  0.018,  0.030,
         0.047,  0.017,  0.019,  0.011,  0.023,  0.017,  0.002,  0.015,  0.012,
        -0.037, -0.033, -0.010, -0.003, -0.019,  0.036,  0.013, -0.003, -0.001,
         0.036,  0.029, -0.044], device='cuda:0')
s after update for 1 param tensor([1.142, 0.821, 1.420, 0.763, 1.302, 0.759, 0.562, 0.542, 1.297, 0.729,
        1.005, 1.240, 0.732, 0.928, 1.415, 1.675, 0.486, 1.017, 1.119, 0.849,
        0.459, 0.736, 0.981, 1.267, 0.737, 1.008, 1.162, 1.217, 0.850, 0.641,
        1.259, 0.624, 0.967, 1.344, 1.663, 1.175, 1.360, 0.551, 0.942, 1.444,
        0.950, 1.213, 1.306, 1.115, 1.105, 1.058, 1.018, 1.178, 0.898, 0.570,
        0.852, 0.845, 0.947, 1.124, 0.514, 0.962, 1.208, 0.571, 1.098, 0.973,
        1.451, 1.714, 0.737, 0.702, 0.844, 1.040, 1.144, 0.705, 0.795, 1.133,
        0.874, 0.993, 1.365, 1.091, 0.659, 1.244, 1.209, 0.967, 1.012, 1.225,
        0.632, 0.870, 1.328, 1.139, 1.274, 0.534, 0.521, 0.538, 0.580, 1.153,
        1.534, 0.554, 0.987, 0.645, 1.117, 1.452, 1.518, 0.586, 0.907, 1.585,
        0.532, 0.722, 0.652, 0.797, 0.923, 0.904, 0.922, 1.397, 1.553, 0.653,
        1.380, 1.310, 1.189, 0.989, 1.248, 1.917, 1.124, 0.814, 1.338, 0.979],
       device='cuda:0')
b after update for 1 param tensor([46.070, 39.066, 51.366, 37.660, 49.182, 37.548, 32.314, 31.737, 49.093,
        36.806, 43.223, 48.002, 36.890, 41.527, 51.286, 55.799, 30.058, 43.474,
        45.608, 39.715, 29.195, 36.975, 42.689, 48.523, 37.003, 43.271, 46.478,
        47.556, 39.736, 34.504, 48.360, 34.048, 42.395, 49.983, 55.599, 46.728,
        50.277, 31.991, 41.839, 51.799, 42.026, 47.485, 49.273, 45.516, 45.311,
        44.336, 43.503, 46.780, 40.841, 32.536, 39.780, 39.627, 41.941, 45.712,
        30.919, 42.278, 47.378, 32.577, 45.169, 42.532, 51.927, 56.432, 37.003,
        36.106, 39.594, 43.970, 46.102, 36.183, 38.446, 45.886, 40.290, 42.962,
        50.359, 45.021, 35.003, 48.085, 47.407, 42.383, 43.372, 47.704, 34.271,
        40.198, 49.671, 46.012, 48.649, 31.511, 31.102, 31.613, 32.827, 46.282,
        53.390, 32.087, 42.829, 34.626, 45.556, 51.941, 53.107, 33.002, 41.052,
        54.269, 31.448, 36.636, 34.810, 38.484, 41.412, 40.987, 41.390, 50.959,
        53.718, 34.845, 50.643, 49.343, 47.005, 42.863, 48.153, 59.685, 45.693,
        38.893, 49.872, 42.649], device='cuda:0')
clipping threshold 0.35534623150779404
a after update for 1 param tensor([[[-0.020],
         [ 0.014],
         [-0.036],
         [-0.006],
         [ 0.001],
         [ 0.016],
         [-0.024],
         [ 0.022],
         [-0.075],
         [-0.008]],

        [[-0.021],
         [ 0.004],
         [ 0.032],
         [ 0.002],
         [ 0.023],
         [ 0.051],
         [-0.006],
         [ 0.014],
         [-0.029],
         [ 0.063]],

        [[-0.058],
         [-0.046],
         [ 0.005],
         [ 0.016],
         [-0.021],
         [ 0.015],
         [-0.003],
         [-0.029],
         [-0.024],
         [-0.008]],

        [[-0.021],
         [-0.042],
         [ 0.012],
         [-0.021],
         [-0.047],
         [ 0.076],
         [-0.069],
         [ 0.086],
         [-0.026],
         [-0.046]],

        [[-0.057],
         [ 0.020],
         [-0.004],
         [ 0.033],
         [ 0.025],
         [-0.071],
         [ 0.023],
         [-0.013],
         [ 0.011],
         [ 0.031]],

        [[-0.002],
         [ 0.011],
         [ 0.026],
         [ 0.006],
         [ 0.008],
         [-0.018],
         [-0.001],
         [-0.049],
         [ 0.048],
         [ 0.050]],

        [[-0.030],
         [ 0.003],
         [-0.004],
         [ 0.014],
         [-0.017],
         [-0.013],
         [-0.030],
         [ 0.037],
         [ 0.026],
         [-0.017]],

        [[ 0.024],
         [-0.019],
         [-0.035],
         [ 0.011],
         [-0.039],
         [ 0.037],
         [ 0.022],
         [-0.023],
         [-0.047],
         [ 0.008]],

        [[-0.003],
         [ 0.040],
         [-0.017],
         [-0.013],
         [-0.018],
         [ 0.000],
         [-0.006],
         [ 0.003],
         [ 0.021],
         [-0.037]],

        [[-0.028],
         [ 0.020],
         [-0.006],
         [ 0.009],
         [ 0.044],
         [-0.050],
         [-0.064],
         [ 0.019],
         [-0.020],
         [ 0.001]],

        [[ 0.011],
         [ 0.001],
         [ 0.008],
         [ 0.036],
         [-0.052],
         [-0.026],
         [ 0.036],
         [ 0.017],
         [-0.005],
         [-0.008]],

        [[-0.014],
         [ 0.021],
         [-0.087],
         [-0.004],
         [ 0.026],
         [-0.011],
         [-0.007],
         [ 0.026],
         [-0.018],
         [-0.016]]], device='cuda:0')
s after update for 1 param tensor([[[1.005],
         [0.522],
         [1.054],
         [1.153],
         [0.640],
         [0.968],
         [1.059],
         [1.069],
         [1.160],
         [0.747]],

        [[1.022],
         [1.842],
         [1.016],
         [0.814],
         [1.225],
         [0.852],
         [0.836],
         [1.253],
         [0.878],
         [1.779]],

        [[1.106],
         [1.270],
         [0.569],
         [0.632],
         [1.365],
         [0.957],
         [1.198],
         [1.315],
         [1.358],
         [1.229]],

        [[0.915],
         [1.294],
         [0.986],
         [1.447],
         [1.061],
         [1.559],
         [1.503],
         [1.583],
         [0.765],
         [1.069]],

        [[1.428],
         [0.507],
         [1.108],
         [1.117],
         [1.352],
         [1.309],
         [1.067],
         [0.842],
         [0.853],
         [1.238]],

        [[0.641],
         [0.914],
         [0.850],
         [0.800],
         [0.819],
         [1.152],
         [0.454],
         [1.497],
         [0.991],
         [0.942]],

        [[0.826],
         [0.505],
         [0.802],
         [0.723],
         [1.111],
         [1.272],
         [1.264],
         [0.448],
         [0.866],
         [1.264]],

        [[0.813],
         [1.163],
         [0.999],
         [1.086],
         [0.882],
         [1.385],
         [1.133],
         [0.750],
         [1.082],
         [1.262]],

        [[0.968],
         [1.129],
         [1.268],
         [1.135],
         [1.775],
         [0.664],
         [1.070],
         [0.542],
         [1.556],
         [1.192]],

        [[0.694],
         [1.143],
         [1.058],
         [0.986],
         [1.581],
         [0.852],
         [1.466],
         [0.812],
         [0.990],
         [0.788]],

        [[0.526],
         [0.721],
         [1.378],
         [1.202],
         [0.897],
         [1.086],
         [0.488],
         [1.783],
         [1.676],
         [0.646]],

        [[0.994],
         [0.842],
         [1.814],
         [1.248],
         [1.387],
         [0.939],
         [0.683],
         [1.578],
         [0.912],
         [1.096]]], device='cuda:0')
b after update for 1 param tensor([[[43.226],
         [31.140],
         [44.254],
         [46.290],
         [34.491],
         [42.423],
         [44.356],
         [44.566],
         [46.438],
         [37.263]],

        [[43.578],
         [58.498],
         [43.442],
         [38.898],
         [47.711],
         [39.793],
         [39.421],
         [48.254],
         [40.394],
         [57.492]],

        [[45.330],
         [48.587],
         [32.518],
         [34.267],
         [50.362],
         [42.167],
         [47.181],
         [49.430],
         [50.226],
         [47.790]],

        [[41.237],
         [49.045],
         [42.810],
         [51.853],
         [44.395],
         [53.822],
         [52.845],
         [54.240],
         [37.715],
         [44.564]],

        [[51.507],
         [30.680],
         [45.369],
         [45.567],
         [50.132],
         [49.316],
         [44.532],
         [39.549],
         [39.807],
         [47.974]],

        [[34.517],
         [41.220],
         [39.733],
         [38.557],
         [39.017],
         [46.263],
         [29.034],
         [52.740],
         [42.904],
         [41.844]],

        [[39.172],
         [30.620],
         [38.594],
         [36.653],
         [45.438],
         [48.613],
         [48.467],
         [28.865],
         [40.106],
         [48.465]],

        [[38.861],
         [46.493],
         [43.092],
         [44.922],
         [40.490],
         [50.733],
         [45.882],
         [37.325],
         [44.843],
         [48.427]],

        [[42.423],
         [45.808],
         [48.534],
         [45.927],
         [57.426],
         [35.121],
         [44.594],
         [31.738],
         [53.768],
         [47.058]],

        [[35.907],
         [46.080],
         [44.340],
         [42.808],
         [54.199],
         [39.785],
         [52.199],
         [38.854],
         [42.888],
         [38.278]],

        [[31.272],
         [36.615],
         [50.606],
         [47.270],
         [40.825],
         [44.926],
         [30.106],
         [57.559],
         [55.805],
         [34.660]],

        [[42.970],
         [39.554],
         [58.054],
         [48.151],
         [50.775],
         [41.769],
         [35.635],
         [54.157],
         [41.168],
         [45.135]]], device='cuda:0')
clipping threshold 0.35534623150779404
a after update for 1 param tensor([[ 0.021],
        [-0.010],
        [-0.020],
        [ 0.036],
        [ 0.032],
        [-0.022],
        [-0.046],
        [ 0.028],
        [-0.013],
        [ 0.022],
        [-0.047],
        [ 0.003]], device='cuda:0')
s after update for 1 param tensor([[0.666],
        [0.668],
        [0.653],
        [1.154],
        [1.351],
        [1.708],
        [1.206],
        [1.353],
        [1.403],
        [1.043],
        [1.428],
        [1.500]], device='cuda:0')
b after update for 1 param tensor([[35.183],
        [35.239],
        [34.832],
        [46.305],
        [50.101],
        [56.340],
        [47.346],
        [50.143],
        [51.064],
        [44.034],
        [51.522],
        [52.798]], device='cuda:0')
clipping threshold 0.35534623150779404
||w||^2 1.0369356725445953
exp ma of ||w||^2 0.3407230639961218
||w|| 1.0183003842406204
exp ma of ||w|| 0.5386198074735538
||w||^2 0.2727387467290767
exp ma of ||w||^2 0.30760204572096167
||w|| 0.5222439532719136
exp ma of ||w|| 0.5157639054665619
||w||^2 0.1111990848598203
exp ma of ||w||^2 0.27684462394082116
||w|| 0.3334652678463235
exp ma of ||w|| 0.49314083331409464
||w||^2 0.22078146449278463
exp ma of ||w||^2 0.2669471273898078
||w|| 0.4698738814754281
exp ma of ||w|| 0.4857065961204142
||w||^2 0.12396591759600138
exp ma of ||w||^2 0.293891000576423
||w|| 0.35208794014564226
exp ma of ||w|| 0.507225454551722
||w||^2 0.1613276134372905
exp ma of ||w||^2 0.2902353642717696
||w|| 0.4016560885101712
exp ma of ||w|| 0.5068052457567683
||w||^2 0.08530139905214404
exp ma of ||w||^2 0.27894932164446495
||w|| 0.29206403245203616
exp ma of ||w|| 0.4934268918498431
||w||^2 0.13142065534153263
exp ma of ||w||^2 0.3744153452163566
||w|| 0.36251986889208243
exp ma of ||w|| 0.5723222817380137
||w||^2 0.11093148290605996
exp ma of ||w||^2 0.3321534788932806
||w|| 0.33306378203890613
exp ma of ||w|| 0.5343029411884448
||w||^2 0.10486758127435643
exp ma of ||w||^2 0.3085061579761121
||w|| 0.3238326439294785
exp ma of ||w|| 0.5219981127739112
||w||^2 0.5888443403828019
exp ma of ||w||^2 0.26815811404452894
||w|| 0.7673619357140422
exp ma of ||w|| 0.4841867072506081
||w||^2 0.1560241941545745
exp ma of ||w||^2 0.28871980961571597
||w|| 0.39499897994118227
exp ma of ||w|| 0.506091095373695
||w||^2 0.06066568212855343
exp ma of ||w||^2 0.2939182447023176
||w|| 0.2463040440767334
exp ma of ||w|| 0.5080835459968032
||w||^2 0.5139599194770595
exp ma of ||w||^2 0.2758980149726116
||w|| 0.7169099800372845
exp ma of ||w|| 0.497268491725081
||w||^2 0.24287302848555176
exp ma of ||w||^2 0.3296030346782819
||w|| 0.4928214975886825
exp ma of ||w|| 0.5335226141917586
||w||^2 0.4781426361741862
exp ma of ||w||^2 0.2995264949412389
||w|| 0.6914785869238368
exp ma of ||w|| 0.5108151015912675
||w||^2 0.6294461041924151
exp ma of ||w||^2 0.2858686278774686
||w|| 0.7933763950310188
exp ma of ||w|| 0.502626236584373
||w||^2 0.22272806177424648
exp ma of ||w||^2 0.28347391412862144
||w|| 0.47194073968481093
exp ma of ||w|| 0.5060068300346738
||w||^2 0.13431839704783805
exp ma of ||w||^2 0.2781698910578173
||w|| 0.3664947435473503
exp ma of ||w|| 0.49368132242460816
||w||^2 0.5057808121671773
exp ma of ||w||^2 0.2819979379047391
||w|| 0.711182685508567
exp ma of ||w|| 0.5010675093024889
||w||^2 0.23771571880023015
exp ma of ||w||^2 0.29464813239609444
||w|| 0.4875609898261244
exp ma of ||w|| 0.5091534604641452
||w||^2 0.04186292274964191
exp ma of ||w||^2 0.2749604971034321
||w|| 0.20460430774947508
exp ma of ||w|| 0.4950652144283526
cuda
Objective function 10.94 = squared loss an data 9.22 + 0.5*rho*h**2 0.320020 + alpha*h 0.331966 + L2reg 1.00 + L1reg 0.07 ; SHD = 25 ; DAG True
Proportion of microbatches that were clipped  0.7741884213454127
iteration 2 in inner loop, alpha 13.121699270428012 rho 1000.0 h 0.025299005526566276
iteration 3 in outer loop, alpha = 38.420704796994286, rho = 1000.0, h = 0.025299005526566276
cuda
1692
cuda
Objective function 11.58 = squared loss an data 9.22 + 0.5*rho*h**2 0.320020 + alpha*h 0.972006 + L2reg 1.00 + L1reg 0.07 ; SHD = 25 ; DAG True
||w||^2 18190010351.395813
exp ma of ||w||^2 13019458826.562803
||w|| 134870.34644945423
exp ma of ||w|| 64228.32973564233
||w||^2 4774634070.491978
exp ma of ||w||^2 13538633878.936516
||w|| 69098.72698170334
exp ma of ||w|| 88441.95889373012
||w||^2 0.5701021022246604
exp ma of ||w||^2 888306.471227363
||w|| 0.7550510593494061
exp ma of ||w|| 11.530173993382805
||w||^2 0.4491380957562411
exp ma of ||w||^2 0.31604251020659135
||w|| 0.6701776598456868
exp ma of ||w|| 0.5130175180656454
||w||^2 0.5933446763300012
exp ma of ||w||^2 0.2850403322473909
||w|| 0.7702886967429817
exp ma of ||w|| 0.4992636686295463
||w||^2 0.2682700903683284
exp ma of ||w||^2 0.25746634722692247
||w|| 0.5179479610620438
exp ma of ||w|| 0.4789748816463063
||w||^2 0.8358455384045458
exp ma of ||w||^2 0.2870334687623544
||w|| 0.9142458850902999
exp ma of ||w|| 0.507529908930563
||w||^2 0.07140443037037382
exp ma of ||w||^2 0.2976550795014414
||w|| 0.26721607431135913
exp ma of ||w|| 0.5119214111000366
||w||^2 0.12407383028119984
exp ma of ||w||^2 0.28547180911042164
||w|| 0.35224115358827657
exp ma of ||w|| 0.49650894064966583
||w||^2 0.2397973699247857
exp ma of ||w||^2 0.28893503236588514
||w|| 0.48969109643201164
exp ma of ||w|| 0.5073359669866373
||w||^2 0.15134475800106517
exp ma of ||w||^2 0.27713261831482255
||w|| 0.3890305360779089
exp ma of ||w|| 0.49525549654860135
||w||^2 0.14123767897581327
exp ma of ||w||^2 0.2781191994337421
||w|| 0.3758160174551016
exp ma of ||w|| 0.49998272719323794
||w||^2 0.10781668945242202
exp ma of ||w||^2 0.25111649473392395
||w|| 0.3283545179412368
exp ma of ||w|| 0.4717314263688548
||w||^2 0.6111650257858211
exp ma of ||w||^2 0.26573448714986586
||w|| 0.781770443151838
exp ma of ||w|| 0.48574827589227737
||w||^2 0.39169993633464656
exp ma of ||w||^2 0.29643080565271185
||w|| 0.6258593582704077
exp ma of ||w|| 0.508635773201289
||w||^2 0.37126246249528266
exp ma of ||w||^2 0.24040505875097515
||w|| 0.6093131071093766
exp ma of ||w|| 0.46136768720865523
||w||^2 0.47832672637403467
exp ma of ||w||^2 0.2611276704924316
||w|| 0.6916116875632125
exp ma of ||w|| 0.47881930334892736
||w||^2 0.3924720413969994
exp ma of ||w||^2 0.2697711661347081
||w|| 0.6264758905153489
exp ma of ||w|| 0.4884041102434755
||w||^2 0.34102369897560175
exp ma of ||w||^2 0.30914621119233177
||w|| 0.5839723443585336
exp ma of ||w|| 0.5202651697734065
cuda
Objective function 11.03 = squared loss an data 9.31 + 0.5*rho*h**2 0.138323 + alpha*h 0.639040 + L2reg 0.87 + L1reg 0.07 ; SHD = 24 ; DAG True
Proportion of microbatches that were clipped  0.7737258173439797
iteration 1 in inner loop, alpha 38.420704796994286 rho 1000.0 h 0.0166326926944933
1692
cuda
Objective function 12.27 = squared loss an data 9.31 + 0.5*rho*h**2 1.383232 + alpha*h 0.639040 + L2reg 0.87 + L1reg 0.07 ; SHD = 24 ; DAG True
||w||^2 16.261279018742187
exp ma of ||w||^2 560697795.7070866
||w|| 4.032527621572131
exp ma of ||w|| 2332.6472012701247
||w||^2 0.13264711665146767
exp ma of ||w||^2 1171489.5220411748
||w|| 0.3642075186641095
exp ma of ||w|| 5.303283837197596
||w||^2 0.21311322278025294
exp ma of ||w||^2 0.25115876420585687
||w|| 0.4616418771951402
exp ma of ||w|| 0.47721172544276824
||w||^2 0.11697460933043059
exp ma of ||w||^2 0.27533550021741526
||w|| 0.34201551036529115
exp ma of ||w|| 0.4938664820104383
||w||^2 0.250682558418907
exp ma of ||w||^2 0.27543372231047725
||w|| 0.5006820931678174
exp ma of ||w|| 0.496658922844458
||w||^2 0.1781475792486484
exp ma of ||w||^2 0.25953614910270106
||w|| 0.4220753241409031
exp ma of ||w|| 0.4823826025018707
||w||^2 0.06625554338551767
exp ma of ||w||^2 0.23291921388548056
||w|| 0.25740152172339165
exp ma of ||w|| 0.4599986814965199
||w||^2 0.15918894143915419
exp ma of ||w||^2 0.2194984762109709
||w|| 0.3989848887353432
exp ma of ||w|| 0.4474125882607438
||w||^2 0.11380159745076483
exp ma of ||w||^2 0.251168984489697
||w|| 0.3373449235586106
exp ma of ||w|| 0.476042161256818
||w||^2 0.30382382075010855
exp ma of ||w||^2 0.21435998873702392
||w|| 0.5512021596021813
exp ma of ||w|| 0.4417857836872064
||w||^2 0.10893267876602887
exp ma of ||w||^2 0.2321896096706256
||w|| 0.3300495095679266
exp ma of ||w|| 0.45887205487594124
||w||^2 0.11911700213959509
exp ma of ||w||^2 0.24812151148183112
||w|| 0.34513331067805536
exp ma of ||w|| 0.47840562170850987
||w||^2 0.288857805606849
exp ma of ||w||^2 0.24777749218743897
||w|| 0.537454933558944
exp ma of ||w|| 0.4729321316295793
||w||^2 0.1544770018893111
exp ma of ||w||^2 0.27952727671559124
||w|| 0.3930356241987628
exp ma of ||w|| 0.4972436812925465
||w||^2 0.1335824155136661
exp ma of ||w||^2 0.21823174909494578
||w|| 0.36548928235129696
exp ma of ||w|| 0.44610173900342875
v before min max tensor([[-4.630, -3.754, -1.803,  ..., -0.418, -2.102, -0.705],
        [ 9.039, -2.178,  0.770,  ..., -2.903,  1.916, -1.815],
        [39.231,  1.509,  0.842,  ..., -0.832, -1.582, -1.172],
        ...,
        [ 4.474,  1.691, -2.321,  ..., -0.939,  0.256, -2.198],
        [19.883, -1.824, -0.478,  ...,  6.315,  8.693, 55.392],
        [-2.393, -4.105,  0.803,  ..., -1.944, -2.098,  2.814]],
       device='cuda:0')
v tensor([[1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [9.039e+00, 1.000e-12, 7.696e-01,  ..., 1.000e-12, 1.916e+00,
         1.000e-12],
        [1.000e+01, 1.509e+00, 8.420e-01,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        ...,
        [4.474e+00, 1.691e+00, 1.000e-12,  ..., 1.000e-12, 2.557e-01,
         1.000e-12],
        [1.000e+01, 1.000e-12, 1.000e-12,  ..., 6.315e+00, 8.693e+00,
         1.000e+01],
        [1.000e-12, 1.000e-12, 8.035e-01,  ..., 1.000e-12, 1.000e-12,
         2.814e+00]], device='cuda:0')
v before min max tensor([-0.693, -1.629, -0.508, -3.514, -3.266, -0.432, -2.404,  4.179,  0.626,
         8.729, -0.648, -1.937, 13.668,  3.883, -1.983,  2.897, -1.905,  2.008,
        -3.270, -2.891, -2.939, -1.285,  0.656,  3.967, -2.810,  0.505,  6.414,
        -3.254, -1.918, -3.831, -2.073, -1.346, -2.418,  2.777,  0.202, -1.177,
        -2.258, -0.257,  2.083, -1.120,  3.152, -1.103, -2.881, -0.848, -0.144,
         2.101, -1.648,  1.954,  4.987,  5.467, -2.458,  8.345, -1.725,  5.678,
        -3.506, -0.035, -2.441, -3.805,  3.877,  1.456,  8.921, -2.381, -1.066,
        -2.902,  9.585, -3.501, -2.029, -0.808, -0.680, -1.866, 23.595,  0.220,
         0.132, -2.866,  0.642,  0.976, -0.576, -0.975,  0.930, -2.577,  1.538,
        -1.124,  3.216, -1.801, -1.884,  5.809, -1.241, -1.159, -3.855,  1.019,
        -1.432, -2.471,  4.858, -1.670, -1.414,  1.244, -2.390,  1.244, -1.401,
         1.626, -1.436, -1.012, 30.292, -1.716, -2.597,  7.599,  2.747, -1.654,
        -3.322,  1.023, -1.134, -1.500, -1.732, -2.255,  2.235,  0.060,  1.189,
        -1.635, -1.330, -3.387], device='cuda:0')
v tensor([1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 4.179e+00, 6.262e-01, 8.729e+00, 1.000e-12, 1.000e-12,
        1.000e+01, 3.883e+00, 1.000e-12, 2.897e+00, 1.000e-12, 2.008e+00,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 6.558e-01, 3.967e+00,
        1.000e-12, 5.052e-01, 6.414e+00, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 2.777e+00, 2.024e-01, 1.000e-12,
        1.000e-12, 1.000e-12, 2.083e+00, 1.000e-12, 3.152e+00, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 2.101e+00, 1.000e-12, 1.954e+00,
        4.987e+00, 5.467e+00, 1.000e-12, 8.345e+00, 1.000e-12, 5.678e+00,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 3.877e+00, 1.456e+00,
        8.921e+00, 1.000e-12, 1.000e-12, 1.000e-12, 9.585e+00, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 2.196e-01,
        1.323e-01, 1.000e-12, 6.418e-01, 9.763e-01, 1.000e-12, 1.000e-12,
        9.297e-01, 1.000e-12, 1.538e+00, 1.000e-12, 3.216e+00, 1.000e-12,
        1.000e-12, 5.809e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.019e+00,
        1.000e-12, 1.000e-12, 4.858e+00, 1.000e-12, 1.000e-12, 1.244e+00,
        1.000e-12, 1.244e+00, 1.000e-12, 1.626e+00, 1.000e-12, 1.000e-12,
        1.000e+01, 1.000e-12, 1.000e-12, 7.599e+00, 2.747e+00, 1.000e-12,
        1.000e-12, 1.023e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        2.235e+00, 6.013e-02, 1.189e+00, 1.000e-12, 1.000e-12, 1.000e-12],
       device='cuda:0')
v before min max tensor([[[-0.583],
         [-3.848],
         [ 1.905],
         [-3.507],
         [-2.989],
         [-0.284],
         [ 5.133],
         [-1.878],
         [16.354],
         [11.144]],

        [[-2.508],
         [-3.958],
         [-2.205],
         [-2.265],
         [ 2.010],
         [ 1.973],
         [ 0.680],
         [-2.963],
         [ 0.395],
         [ 1.844]],

        [[-3.366],
         [ 5.724],
         [-0.807],
         [-1.669],
         [-1.029],
         [-0.126],
         [-1.121],
         [-0.036],
         [ 0.205],
         [19.204]],

        [[-1.646],
         [-2.210],
         [-1.257],
         [ 9.661],
         [ 3.782],
         [11.841],
         [-2.238],
         [-1.123],
         [ 5.623],
         [-3.244]],

        [[-3.632],
         [-3.165],
         [-2.385],
         [ 5.571],
         [ 3.922],
         [ 4.422],
         [ 3.552],
         [ 3.506],
         [ 8.343],
         [ 0.063]],

        [[-3.153],
         [-1.443],
         [ 1.647],
         [-3.019],
         [ 4.497],
         [-3.079],
         [-2.165],
         [-3.374],
         [-0.818],
         [-3.645]],

        [[ 0.333],
         [-3.460],
         [-1.824],
         [-0.928],
         [-1.601],
         [ 4.074],
         [ 8.075],
         [-2.345],
         [-1.429],
         [-3.434]],

        [[ 4.255],
         [ 2.903],
         [-2.194],
         [ 0.111],
         [17.382],
         [-1.988],
         [ 3.343],
         [ 9.321],
         [ 7.740],
         [-0.063]],

        [[-0.878],
         [-0.371],
         [-2.236],
         [-0.265],
         [-3.547],
         [ 5.352],
         [ 1.432],
         [-2.422],
         [ 2.888],
         [ 6.979]],

        [[-4.234],
         [-2.546],
         [-0.851],
         [-4.691],
         [-4.441],
         [ 3.707],
         [ 0.256],
         [ 0.853],
         [-3.218],
         [-2.667]],

        [[-1.701],
         [-1.787],
         [ 2.992],
         [ 5.611],
         [ 0.256],
         [-1.537],
         [ 0.200],
         [ 1.298],
         [-2.047],
         [-2.308]],

        [[-2.320],
         [ 0.853],
         [-2.142],
         [-3.117],
         [-4.081],
         [-3.211],
         [-1.228],
         [-1.263],
         [-3.929],
         [-2.840]]], device='cuda:0')
v tensor([[[1.000e-12],
         [1.000e-12],
         [1.905e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [5.133e+00],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.010e+00],
         [1.973e+00],
         [6.802e-01],
         [1.000e-12],
         [3.952e-01],
         [1.844e+00]],

        [[1.000e-12],
         [5.724e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.047e-01],
         [1.000e+01]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [9.661e+00],
         [3.782e+00],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [5.623e+00],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [5.571e+00],
         [3.922e+00],
         [4.422e+00],
         [3.552e+00],
         [3.506e+00],
         [8.343e+00],
         [6.319e-02]],

        [[1.000e-12],
         [1.000e-12],
         [1.647e+00],
         [1.000e-12],
         [4.497e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[3.330e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [4.074e+00],
         [8.075e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[4.255e+00],
         [2.903e+00],
         [1.000e-12],
         [1.107e-01],
         [1.000e+01],
         [1.000e-12],
         [3.343e+00],
         [9.321e+00],
         [7.740e+00],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [5.352e+00],
         [1.432e+00],
         [1.000e-12],
         [2.888e+00],
         [6.979e+00]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [3.707e+00],
         [2.558e-01],
         [8.526e-01],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [2.992e+00],
         [5.611e+00],
         [2.558e-01],
         [1.000e-12],
         [1.997e-01],
         [1.298e+00],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [8.532e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]]], device='cuda:0')
v before min max tensor([[-3.547],
        [13.162],
        [-4.102],
        [-2.932],
        [-1.331],
        [ 2.726],
        [ 9.855],
        [ 0.197],
        [ 1.809],
        [-2.981],
        [-2.915],
        [-4.081]], device='cuda:0')
v tensor([[1.000e-12],
        [1.000e+01],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [2.726e+00],
        [9.855e+00],
        [1.967e-01],
        [1.809e+00],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12]], device='cuda:0')
a after update for 1 param tensor([[-0.001, -0.037,  0.005,  ...,  0.010, -0.008,  0.004],
        [ 0.010, -0.026, -0.009,  ...,  0.003, -0.022, -0.033],
        [-0.000, -0.002, -0.002,  ...,  0.015,  0.015, -0.013],
        ...,
        [ 0.008,  0.005, -0.009,  ..., -0.007, -0.028,  0.003],
        [-0.011,  0.025,  0.011,  ..., -0.010,  0.015,  0.002],
        [ 0.007, -0.005, -0.013,  ...,  0.007, -0.015,  0.002]],
       device='cuda:0')
s after update for 1 param tensor([[1.848, 1.379, 0.784,  ..., 0.238, 0.821, 0.654],
        [2.072, 0.890, 1.314,  ..., 1.058, 0.920, 0.687],
        [2.187, 0.691, 0.918,  ..., 1.260, 0.574, 0.420],
        ...,
        [1.357, 1.573, 0.883,  ..., 0.653, 1.133, 0.933],
        [1.299, 0.804, 0.972,  ..., 1.465, 1.220, 2.187],
        [1.091, 1.521, 1.150,  ..., 0.916, 0.753, 1.295]], device='cuda:0')
b after update for 1 param tensor([[62.220, 53.755, 40.518,  ..., 22.335, 41.468, 37.004],
        [65.877, 43.170, 52.459,  ..., 47.078, 43.900, 37.926],
        [67.684, 38.056, 43.855,  ..., 51.379, 34.686, 29.670],
        ...,
        [53.322, 57.407, 43.015,  ..., 36.998, 48.717, 44.199],
        [52.171, 41.040, 45.122,  ..., 55.399, 50.559, 67.690],
        [47.802, 56.448, 49.083,  ..., 43.812, 39.721, 52.073]],
       device='cuda:0')
clipping threshold 0.35008416910540463
a after update for 1 param tensor([-1.019e-02, -2.783e-02, -3.513e-03,  2.553e-02, -6.458e-04,  1.058e-02,
         1.785e-02,  2.145e-02,  5.438e-03, -2.061e-03, -4.486e-03, -2.287e-02,
         3.834e-02, -1.883e-02, -1.412e-02,  5.903e-03,  5.534e-02, -2.287e-02,
        -1.593e-02, -6.764e-03,  9.263e-03, -1.610e-02, -6.375e-05, -1.856e-02,
         5.708e-03,  2.135e-02,  8.077e-03,  7.063e-03,  1.272e-02,  4.556e-02,
         3.471e-03, -9.975e-03,  7.010e-03,  1.363e-02, -1.246e-02,  4.208e-02,
         4.871e-02,  1.023e-03,  3.193e-03,  3.752e-02,  1.044e-03, -6.345e-03,
        -4.324e-02, -2.986e-02,  3.172e-02,  7.131e-03,  5.060e-02, -6.715e-02,
        -2.730e-02,  1.238e-02,  4.287e-02, -3.798e-02,  2.113e-03,  3.294e-02,
        -1.064e-02, -3.010e-02, -1.509e-02, -3.605e-02,  4.043e-02, -1.568e-02,
        -3.347e-03,  4.165e-02,  2.723e-03,  1.407e-02, -1.691e-02,  1.614e-02,
        -3.343e-03, -3.660e-02, -2.560e-02, -2.677e-02,  9.824e-03,  5.867e-03,
        -4.744e-02,  7.304e-02,  1.906e-02,  5.564e-02, -3.161e-04,  7.561e-03,
        -3.483e-02, -7.565e-03, -4.410e-02,  2.423e-03,  2.747e-02, -7.318e-03,
         5.299e-02, -8.037e-03, -3.480e-02,  1.481e-02,  2.074e-02, -6.062e-03,
         3.329e-03,  3.424e-02, -8.643e-04,  2.610e-02, -5.316e-02, -2.342e-02,
        -6.912e-03,  4.632e-02, -4.710e-04,  1.788e-02, -4.508e-03, -9.718e-03,
         1.964e-02,  1.016e-02,  4.764e-05,  4.324e-02,  2.105e-03, -1.927e-02,
        -2.038e-02,  2.976e-02, -7.428e-03,  4.747e-03,  6.057e-02, -1.322e-02,
        -1.284e-02, -2.078e-03, -1.761e-02,  1.497e-02, -2.309e-02,  9.806e-03],
       device='cuda:0')
s after update for 1 param tensor([0.326, 1.276, 0.512, 1.355, 1.171, 0.624, 0.981, 1.155, 0.801, 1.144,
        1.406, 0.812, 1.484, 1.394, 0.937, 1.577, 1.266, 0.903, 1.465, 1.037,
        1.100, 1.090, 0.595, 1.312, 1.403, 1.327, 0.990, 1.171, 1.336, 1.464,
        0.910, 0.604, 1.210, 0.937, 0.794, 0.431, 0.865, 0.515, 1.374, 0.636,
        1.176, 0.744, 1.082, 0.560, 1.772, 1.535, 1.071, 1.625, 1.351, 1.338,
        1.048, 1.343, 0.793, 1.388, 1.583, 0.751, 1.059, 1.696, 1.071, 1.099,
        1.817, 0.862, 0.681, 1.104, 1.661, 1.531, 0.839, 1.322, 0.697, 0.724,
        1.733, 0.700, 1.556, 1.702, 0.683, 1.044, 1.106, 0.417, 1.032, 0.958,
        1.710, 0.855, 1.402, 0.653, 0.961, 1.626, 0.499, 1.422, 1.383, 1.309,
        0.598, 1.005, 1.449, 0.783, 0.736, 1.744, 0.865, 1.072, 0.940, 1.292,
        0.654, 0.960, 1.417, 0.738, 0.931, 1.117, 0.922, 0.600, 1.229, 0.675,
        1.232, 0.994, 0.793, 0.969, 1.210, 0.752, 1.124, 1.230, 0.922, 1.367],
       device='cuda:0')
b after update for 1 param tensor([26.143, 51.708, 32.763, 53.275, 49.531, 36.164, 45.337, 49.180, 40.951,
        48.949, 54.260, 41.241, 55.759, 54.036, 44.293, 57.471, 51.499, 43.491,
        55.388, 46.596, 48.011, 47.784, 35.306, 52.415, 54.206, 52.718, 45.538,
        49.533, 52.901, 55.369, 43.648, 35.569, 50.339, 44.313, 40.775, 30.046,
        42.561, 32.843, 53.650, 36.501, 49.643, 39.482, 47.607, 34.264, 60.929,
        56.706, 47.364, 58.338, 53.200, 52.936, 46.850, 53.043, 40.768, 53.923,
        57.577, 39.671, 47.107, 59.601, 47.359, 47.970, 61.698, 42.496, 37.764,
        48.097, 58.991, 56.623, 41.919, 52.621, 38.213, 38.937, 60.245, 38.281,
        57.090, 59.717, 37.825, 46.763, 48.136, 29.571, 46.500, 44.798, 59.845,
        42.331, 54.202, 36.978, 44.878, 58.354, 32.325, 54.572, 53.825, 52.361,
        35.395, 45.890, 55.099, 40.491, 39.259, 60.438, 42.574, 47.379, 44.380,
        52.024, 37.010, 44.846, 54.483, 39.308, 44.173, 48.372, 43.943, 35.453,
        50.745, 37.616, 50.793, 45.622, 40.754, 45.043, 50.347, 39.697, 48.524,
        50.752, 43.957, 53.503], device='cuda:0')
clipping threshold 0.35008416910540463
a after update for 1 param tensor([[[ 0.008],
         [ 0.007],
         [ 0.002],
         [ 0.039],
         [-0.003],
         [ 0.021],
         [ 0.013],
         [-0.018],
         [-0.049],
         [-0.017]],

        [[ 0.007],
         [ 0.011],
         [-0.011],
         [ 0.024],
         [-0.000],
         [ 0.001],
         [-0.008],
         [-0.020],
         [-0.004],
         [-0.023]],

        [[-0.033],
         [-0.012],
         [ 0.009],
         [ 0.037],
         [ 0.051],
         [ 0.025],
         [ 0.024],
         [ 0.010],
         [ 0.028],
         [-0.003]],

        [[ 0.028],
         [ 0.009],
         [-0.010],
         [ 0.013],
         [-0.021],
         [ 0.043],
         [-0.022],
         [ 0.023],
         [-0.008],
         [ 0.016]],

        [[-0.037],
         [-0.014],
         [ 0.033],
         [ 0.037],
         [-0.007],
         [ 0.002],
         [-0.006],
         [-0.010],
         [ 0.018],
         [-0.005]],

        [[-0.015],
         [-0.001],
         [ 0.024],
         [ 0.002],
         [-0.024],
         [ 0.003],
         [ 0.036],
         [ 0.054],
         [-0.035],
         [-0.001]],

        [[-0.000],
         [-0.006],
         [ 0.047],
         [ 0.039],
         [-0.033],
         [-0.030],
         [-0.007],
         [ 0.036],
         [ 0.035],
         [-0.019]],

        [[ 0.033],
         [-0.062],
         [-0.031],
         [-0.020],
         [ 0.019],
         [ 0.013],
         [-0.038],
         [ 0.025],
         [ 0.005],
         [ 0.009]],

        [[ 0.029],
         [ 0.008],
         [ 0.003],
         [-0.001],
         [-0.006],
         [-0.034],
         [-0.032],
         [ 0.028],
         [ 0.026],
         [-0.006]],

        [[ 0.022],
         [-0.027],
         [ 0.018],
         [ 0.033],
         [ 0.032],
         [-0.013],
         [-0.051],
         [-0.030],
         [ 0.002],
         [ 0.017]],

        [[-0.007],
         [ 0.010],
         [ 0.005],
         [-0.045],
         [-0.053],
         [ 0.015],
         [-0.003],
         [-0.023],
         [ 0.031],
         [ 0.042]],

        [[-0.019],
         [ 0.038],
         [ 0.014],
         [ 0.021],
         [-0.052],
         [ 0.005],
         [-0.035],
         [-0.008],
         [ 0.050],
         [-0.004]]], device='cuda:0')
s after update for 1 param tensor([[[0.674],
         [1.387],
         [0.939],
         [1.279],
         [1.114],
         [0.789],
         [1.061],
         [0.899],
         [1.708],
         [1.659]],

        [[0.935],
         [1.432],
         [1.036],
         [0.945],
         [1.427],
         [1.431],
         [1.422],
         [1.064],
         [0.602],
         [0.708]],

        [[1.395],
         [1.387],
         [0.458],
         [1.360],
         [0.385],
         [0.974],
         [0.833],
         [0.620],
         [0.755],
         [1.286]],

        [[0.830],
         [0.981],
         [0.460],
         [1.396],
         [1.679],
         [1.654],
         [0.883],
         [1.126],
         [1.447],
         [1.377]],

        [[1.328],
         [1.197],
         [0.860],
         [1.401],
         [0.988],
         [1.238],
         [0.999],
         [1.556],
         [1.721],
         [0.728]],

        [[1.184],
         [0.519],
         [0.982],
         [1.213],
         [1.454],
         [1.169],
         [0.781],
         [1.453],
         [0.590],
         [1.412]],

        [[1.245],
         [1.343],
         [1.177],
         [1.379],
         [1.280],
         [1.350],
         [1.854],
         [1.229],
         [0.526],
         [1.235]],

        [[1.053],
         [1.390],
         [1.017],
         [0.477],
         [1.530],
         [0.750],
         [1.604],
         [1.320],
         [1.387],
         [1.282]],

        [[0.938],
         [0.762],
         [1.088],
         [0.784],
         [1.319],
         [1.138],
         [1.091],
         [0.966],
         [1.127],
         [1.599]],

        [[1.585],
         [0.918],
         [0.791],
         [1.755],
         [1.621],
         [1.461],
         [1.070],
         [1.278],
         [1.158],
         [0.957]],

        [[1.039],
         [0.728],
         [1.297],
         [1.774],
         [1.276],
         [0.768],
         [0.610],
         [0.953],
         [0.736],
         [1.063]],

        [[0.832],
         [1.077],
         [1.181],
         [1.207],
         [1.648],
         [1.214],
         [0.650],
         [0.998],
         [1.413],
         [1.040]]], device='cuda:0')
b after update for 1 param tensor([[[37.575],
         [53.908],
         [44.352],
         [51.768],
         [48.317],
         [40.663],
         [47.149],
         [43.397],
         [59.816],
         [58.953]],

        [[44.257],
         [54.770],
         [46.586],
         [44.494],
         [54.666],
         [54.752],
         [54.577],
         [47.204],
         [35.514],
         [38.508]],

        [[54.057],
         [53.899],
         [30.962],
         [53.376],
         [28.411],
         [45.168],
         [41.769],
         [36.029],
         [39.772],
         [51.899]],

        [[41.700],
         [45.333],
         [31.042],
         [54.071],
         [59.300],
         [58.866],
         [42.997],
         [48.557],
         [55.054],
         [53.715]],

        [[52.750],
         [50.070],
         [42.443],
         [54.172],
         [45.502],
         [50.915],
         [45.753],
         [57.084],
         [60.047],
         [39.044]],

        [[49.797],
         [32.983],
         [45.364],
         [50.401],
         [55.181],
         [49.492],
         [40.460],
         [55.174],
         [35.155],
         [54.377]],

        [[51.064],
         [53.034],
         [49.656],
         [53.748],
         [51.790],
         [53.183],
         [62.313],
         [50.744],
         [33.180],
         [50.864]],

        [[46.963],
         [53.959],
         [46.165],
         [31.613],
         [56.607],
         [39.633],
         [57.957],
         [52.587],
         [53.898],
         [51.824]],

        [[44.323],
         [39.961],
         [47.732],
         [40.533],
         [52.567],
         [48.822],
         [47.802],
         [44.990],
         [48.580],
         [57.874]],

        [[57.612],
         [43.861],
         [40.707],
         [60.633],
         [58.273],
         [55.326],
         [47.338],
         [51.744],
         [49.253],
         [44.781]],

        [[46.642],
         [39.063],
         [52.133],
         [60.955],
         [51.706],
         [40.120],
         [35.758],
         [44.684],
         [39.275],
         [47.179]],

        [[41.740],
         [47.496],
         [49.728],
         [50.290],
         [58.751],
         [50.424],
         [36.900],
         [45.726],
         [54.404],
         [46.668]]], device='cuda:0')
clipping threshold 0.35008416910540463
a after update for 1 param tensor([[ 0.010],
        [ 0.040],
        [-0.032],
        [ 0.039],
        [-0.030],
        [-0.020],
        [-0.011],
        [-0.016],
        [ 0.034],
        [-0.030],
        [-0.026],
        [-0.014]], device='cuda:0')
s after update for 1 param tensor([[1.610],
        [1.295],
        [1.491],
        [1.106],
        [0.965],
        [1.442],
        [1.864],
        [0.947],
        [1.449],
        [1.071],
        [1.053],
        [1.504]], device='cuda:0')
b after update for 1 param tensor([[58.077],
        [52.083],
        [55.880],
        [48.127],
        [44.962],
        [54.952],
        [62.482],
        [44.531],
        [55.098],
        [47.364],
        [46.963],
        [56.129]], device='cuda:0')
clipping threshold 0.35008416910540463
||w||^2 0.1530328499774304
exp ma of ||w||^2 0.23515041314756077
||w|| 0.39119413336274667
exp ma of ||w|| 0.460784411857713
||w||^2 0.21118033488052387
exp ma of ||w||^2 0.2353739130768531
||w|| 0.4595436158630907
exp ma of ||w|| 0.46123190588042157
||w||^2 0.11228435389355204
exp ma of ||w||^2 0.1932882074695812
||w|| 0.3350885761907619
exp ma of ||w|| 0.42380658345091365
||w||^2 0.9338171239960789
exp ma of ||w||^2 0.23088237188001665
||w|| 0.9663421360967754
exp ma of ||w|| 0.4608139314060786
||w||^2 0.2501504045849589
exp ma of ||w||^2 0.22292497933469071
||w|| 0.500150381970222
exp ma of ||w|| 0.4547705389760443
||w||^2 0.1035546811819049
exp ma of ||w||^2 0.2184378456158605
||w|| 0.32179913172956964
exp ma of ||w|| 0.4514793369963351
||w||^2 0.25439530136583594
exp ma of ||w||^2 0.22227164990427464
||w|| 0.5043761506711394
exp ma of ||w|| 0.454804586820873
||w||^2 0.21112122528016458
exp ma of ||w||^2 0.2144313826360293
||w|| 0.4594792979886739
exp ma of ||w|| 0.4474575736093939
cuda
Objective function 10.94 = squared loss an data 9.55 + 0.5*rho*h**2 0.289276 + alpha*h 0.292238 + L2reg 0.73 + L1reg 0.07 ; SHD = 19 ; DAG True
Proportion of microbatches that were clipped  0.7719417553404272
iteration 2 in inner loop, alpha 38.420704796994286 rho 10000.0 h 0.007606263750133735
1692
cuda
Objective function 13.54 = squared loss an data 9.55 + 0.5*rho*h**2 2.892762 + alpha*h 0.292238 + L2reg 0.73 + L1reg 0.07 ; SHD = 19 ; DAG True
||w||^2 0.2582586107861848
exp ma of ||w||^2 40076890.558702745
||w|| 0.5081915099509089
exp ma of ||w|| 7.327718192034927
||w||^2 0.2931018509789487
exp ma of ||w||^2 26626.76283654351
||w|| 0.5413888168210983
exp ma of ||w|| 0.3927436721027737
||w||^2 0.14640907155057512
exp ma of ||w||^2 0.24899987948956587
||w|| 0.38263438364916336
exp ma of ||w|| 0.47709749674262814
||w||^2 0.1530905223003836
exp ma of ||w||^2 0.24593862057683097
||w|| 0.3912678395937796
exp ma of ||w|| 0.47101558018923734
||w||^2 0.5163630490922796
exp ma of ||w||^2 0.22540892999345136
||w|| 0.718584058473523
exp ma of ||w|| 0.4522931317572258
||w||^2 0.2990614824916423
exp ma of ||w||^2 0.24594658169906689
||w|| 0.5468651410463482
exp ma of ||w|| 0.468378749556866
||w||^2 0.14079789100276519
exp ma of ||w||^2 0.21233321264046967
||w|| 0.375230450527093
exp ma of ||w|| 0.4367190531527265
||w||^2 0.09506916068370416
exp ma of ||w||^2 0.24302936428116478
||w|| 0.30833287318043817
exp ma of ||w|| 0.4647979697541214
||w||^2 0.20972231566039296
exp ma of ||w||^2 0.23848380156011087
||w|| 0.4579544908180211
exp ma of ||w|| 0.4620611879321637
||w||^2 0.1920714396355836
exp ma of ||w||^2 0.24228280363501437
||w|| 0.4382595573807645
exp ma of ||w|| 0.46963301642052907
||w||^2 0.10561899085153788
exp ma of ||w||^2 0.25111857250306346
||w|| 0.32499075502472047
exp ma of ||w|| 0.47799765863747834
||w||^2 0.11186712677303859
exp ma of ||w||^2 0.24557725533908975
||w|| 0.33446543434716625
exp ma of ||w|| 0.4716023191418681
||w||^2 0.6223018217297037
exp ma of ||w||^2 0.21489621103990578
||w|| 0.7888610915298737
exp ma of ||w|| 0.44930169790552776
||w||^2 0.22819760042796858
exp ma of ||w||^2 0.18304153373927365
||w|| 0.4777003249192621
exp ma of ||w|| 0.41780160468407823
||w||^2 0.11803408607266973
exp ma of ||w||^2 0.1873730244939171
||w|| 0.3435608913608616
exp ma of ||w|| 0.42277998595811433
||w||^2 0.15385294417487214
exp ma of ||w||^2 0.20390332383558094
||w|| 0.3922409261855169
exp ma of ||w|| 0.4421397365804707
||w||^2 0.1265318699088543
exp ma of ||w||^2 0.20670468591736288
||w|| 0.35571318489599774
exp ma of ||w|| 0.4493119293321692
||w||^2 0.15237206577511156
exp ma of ||w||^2 0.23319126111448102
||w|| 0.3903486464368892
exp ma of ||w|| 0.47557412818885914
||w||^2 0.3509749271387225
exp ma of ||w||^2 0.23410981019310717
||w|| 0.5924313691379978
exp ma of ||w|| 0.4734747431500047
||w||^2 0.4031013992603468
exp ma of ||w||^2 0.28792644710371135
||w|| 0.6349026691236593
exp ma of ||w|| 0.5204923045319125
v before min max tensor([[-8.407,  1.964, -5.890,  ..., -3.194, -3.721,  0.610],
        [67.354,  5.456,  4.397,  ..., -5.656, -4.698, -6.838],
        [31.975,  0.305, -5.471,  ...,  8.053, -1.639,  1.251],
        ...,
        [-5.309, -4.774, 60.936,  ...,  4.137, -2.981, -6.748],
        [ 4.020, -5.481, -4.377,  ...,  2.605, -1.467, -7.832],
        [-0.437, -4.369,  5.609,  ..., -4.580, -3.876, -8.316]],
       device='cuda:0')
v tensor([[1.000e-12, 1.964e+00, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         6.097e-01],
        [1.000e+01, 5.456e+00, 4.397e+00,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [1.000e+01, 3.047e-01, 1.000e-12,  ..., 8.053e+00, 1.000e-12,
         1.251e+00],
        ...,
        [1.000e-12, 1.000e-12, 1.000e+01,  ..., 4.137e+00, 1.000e-12,
         1.000e-12],
        [4.020e+00, 1.000e-12, 1.000e-12,  ..., 2.605e+00, 1.000e-12,
         1.000e-12],
        [1.000e-12, 1.000e-12, 5.609e+00,  ..., 1.000e-12, 1.000e-12,
         1.000e-12]], device='cuda:0')
v before min max tensor([-4.601, -5.486, -2.731, -4.175, -5.159, -6.553, -1.018,  2.762, -5.800,
        -5.590, -5.389, -2.913, -0.557, -0.768,  9.808, -2.861, -3.219, -2.964,
         4.282, -3.646, -0.894, -5.200, -5.964, -4.081, -2.952, -1.470, -6.896,
         3.951,  6.821,  7.217,  7.935, -2.065, -1.960,  3.270, -7.097, -7.320,
         4.168,  2.326, -2.818,  4.307, -3.058,  7.799, -0.048, -7.880, -5.350,
         7.815,  7.535, -7.226,  3.333,  5.080, 30.192, -3.089, -0.337, -4.160,
        -8.751, -6.038, -4.619, -6.355, -3.067, -5.683, -3.962, -5.926,  7.900,
         0.361, -5.780, -4.852, -3.197, -5.399,  3.592, -4.978, -3.890, -3.189,
        -3.953, -2.285, -6.618, -4.925, 29.289,  0.054, -2.905, -6.040, -3.155,
        -6.139,  6.018, 13.222, -6.026,  0.713, -5.277, -1.791, -3.992,  4.549,
        -4.529, -5.304, -0.471,  1.519, -3.684, -4.551, -2.518, -6.811, -4.852,
        -4.521, -2.659, -6.389, -4.053, 11.653, -2.058,  2.365,  1.904, -2.170,
        -2.760, 10.445, -5.371, -4.037,  0.343, 17.983, -4.274, -6.811, 43.816,
        -2.846, -5.484, -7.076], device='cuda:0')
v tensor([1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 2.762e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 9.808e+00, 1.000e-12, 1.000e-12, 1.000e-12,
        4.282e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 3.951e+00, 6.821e+00, 7.217e+00,
        7.935e+00, 1.000e-12, 1.000e-12, 3.270e+00, 1.000e-12, 1.000e-12,
        4.168e+00, 2.326e+00, 1.000e-12, 4.307e+00, 1.000e-12, 7.799e+00,
        1.000e-12, 1.000e-12, 1.000e-12, 7.815e+00, 7.535e+00, 1.000e-12,
        3.333e+00, 5.080e+00, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 7.900e+00, 3.610e-01, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 3.592e+00, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 5.357e-02,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 6.018e+00, 1.000e+01,
        1.000e-12, 7.127e-01, 1.000e-12, 1.000e-12, 1.000e-12, 4.549e+00,
        1.000e-12, 1.000e-12, 1.000e-12, 1.519e+00, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e+01, 1.000e-12, 2.365e+00, 1.904e+00, 1.000e-12,
        1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 3.430e-01, 1.000e+01,
        1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12, 1.000e-12],
       device='cuda:0')
v before min max tensor([[[ 7.353],
         [ 4.853],
         [ 7.606],
         [27.731],
         [-3.499],
         [-6.221],
         [-2.330],
         [-6.440],
         [ 7.190],
         [ 4.205]],

        [[-3.682],
         [-4.712],
         [ 5.611],
         [-4.928],
         [ 2.493],
         [-5.499],
         [-5.125],
         [-3.422],
         [-2.404],
         [ 2.616]],

        [[-4.307],
         [-2.721],
         [-5.269],
         [ 4.142],
         [-2.057],
         [-4.299],
         [ 8.112],
         [23.560],
         [ 0.188],
         [ 3.852]],

        [[-5.473],
         [-0.593],
         [-2.423],
         [ 2.309],
         [ 0.549],
         [ 7.346],
         [-4.160],
         [-7.082],
         [18.403],
         [-1.124]],

        [[ 3.397],
         [ 1.250],
         [-5.804],
         [ 5.354],
         [-3.550],
         [-2.315],
         [ 0.647],
         [ 4.750],
         [-6.175],
         [-3.435]],

        [[-6.226],
         [-4.465],
         [-2.397],
         [-1.859],
         [-0.453],
         [-1.668],
         [ 2.526],
         [-1.893],
         [-5.913],
         [36.477]],

        [[ 6.705],
         [-5.798],
         [-5.749],
         [10.295],
         [20.171],
         [-2.280],
         [-7.445],
         [ 5.735],
         [-4.650],
         [-4.524]],

        [[-6.509],
         [-1.657],
         [-2.848],
         [10.489],
         [ 4.713],
         [-3.323],
         [-3.506],
         [16.395],
         [13.706],
         [-6.079]],

        [[-4.371],
         [-6.576],
         [-6.062],
         [-5.521],
         [-5.779],
         [ 9.503],
         [-4.401],
         [ 1.318],
         [-2.255],
         [-6.408]],

        [[ 1.063],
         [-5.907],
         [-2.379],
         [ 0.923],
         [16.958],
         [27.310],
         [20.253],
         [-4.301],
         [-6.473],
         [-6.376]],

        [[-5.279],
         [-6.474],
         [-4.580],
         [-6.347],
         [-1.678],
         [-1.051],
         [-4.097],
         [ 6.388],
         [-6.053],
         [-1.549]],

        [[-6.443],
         [ 0.437],
         [-6.091],
         [-0.554],
         [-3.215],
         [-2.554],
         [-5.583],
         [ 5.521],
         [-4.754],
         [ 6.685]]], device='cuda:0')
v tensor([[[7.353e+00],
         [4.853e+00],
         [7.606e+00],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [7.190e+00],
         [4.205e+00]],

        [[1.000e-12],
         [1.000e-12],
         [5.611e+00],
         [1.000e-12],
         [2.493e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.616e+00]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [4.142e+00],
         [1.000e-12],
         [1.000e-12],
         [8.112e+00],
         [1.000e+01],
         [1.879e-01],
         [3.852e+00]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.309e+00],
         [5.488e-01],
         [7.346e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12]],

        [[3.397e+00],
         [1.250e+00],
         [1.000e-12],
         [5.354e+00],
         [1.000e-12],
         [1.000e-12],
         [6.468e-01],
         [4.750e+00],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.526e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01]],

        [[6.705e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [5.735e+00],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [4.713e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [9.503e+00],
         [1.000e-12],
         [1.318e+00],
         [1.000e-12],
         [1.000e-12]],

        [[1.063e+00],
         [1.000e-12],
         [1.000e-12],
         [9.235e-01],
         [1.000e+01],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [6.388e+00],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [4.367e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [5.521e+00],
         [1.000e-12],
         [6.685e+00]]], device='cuda:0')
v before min max tensor([[-6.270],
        [10.430],
        [-5.187],
        [-3.323],
        [-4.725],
        [-4.475],
        [-6.046],
        [ 5.064],
        [ 3.943],
        [-6.276],
        [-2.736],
        [ 6.528]], device='cuda:0')
v tensor([[1.000e-12],
        [1.000e+01],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [5.064e+00],
        [3.943e+00],
        [1.000e-12],
        [1.000e-12],
        [6.528e+00]], device='cuda:0')
a after update for 1 param tensor([[-0.020,  0.018, -0.017,  ...,  0.014,  0.015, -0.013],
        [ 0.004,  0.059,  0.003,  ...,  0.007, -0.018, -0.005],
        [ 0.006,  0.042, -0.014,  ..., -0.011,  0.009,  0.008],
        ...,
        [-0.019, -0.016,  0.009,  ..., -0.029, -0.043, -0.005],
        [-0.037,  0.080, -0.002,  ...,  0.001,  0.013, -0.013],
        [ 0.009,  0.005,  0.024,  ...,  0.024,  0.068,  0.018]],
       device='cuda:0')
s after update for 1 param tensor([[2.439, 0.902, 1.785,  ..., 1.011, 0.980, 0.674],
        [1.998, 1.659, 1.371,  ..., 1.446, 1.262, 1.802],
        [2.407, 0.931, 1.276,  ..., 1.837, 0.718, 1.574],
        ...,
        [1.509, 1.109, 1.767,  ..., 1.675, 1.188, 1.595],
        [1.666, 1.259, 1.532,  ..., 1.583, 1.170, 2.033],
        [1.653, 1.002, 1.404,  ..., 1.172, 1.265, 2.598]], device='cuda:0')
b after update for 1 param tensor([[82.212, 50.004, 70.341,  ..., 52.940, 52.105, 43.228],
        [74.422, 67.801, 61.652,  ..., 63.312, 59.142, 70.675],
        [81.680, 50.808, 59.480,  ..., 71.355, 44.596, 66.043],
        ...,
        [64.662, 55.429, 69.987,  ..., 68.125, 57.381, 66.488],
        [67.943, 59.067, 65.172,  ..., 66.234, 56.934, 75.070],
        [67.682, 52.706, 62.369,  ..., 56.982, 59.209, 84.859]],
       device='cuda:0')
clipping threshold 0.37664961022789234
a after update for 1 param tensor([-0.022, -0.014,  0.078,  0.012,  0.093,  0.008,  0.040,  0.005, -0.008,
        -0.002, -0.052, -0.043,  0.031,  0.022, -0.027, -0.009,  0.014,  0.006,
        -0.040, -0.011,  0.027,  0.073, -0.010,  0.046, -0.009,  0.033,  0.057,
        -0.012, -0.009, -0.037, -0.015,  0.002, -0.012, -0.068,  0.024,  0.047,
        -0.003, -0.035, -0.054,  0.002,  0.050,  0.033, -0.002, -0.043,  0.003,
        -0.010, -0.029,  0.001,  0.061,  0.026,  0.011, -0.000,  0.058, -0.004,
        -0.048,  0.058,  0.032,  0.042,  0.038, -0.028, -0.010, -0.011,  0.043,
         0.003,  0.112,  0.034,  0.010,  0.015, -0.013, -0.009,  0.056,  0.014,
        -0.008,  0.027,  0.012,  0.036, -0.036, -0.029, -0.036, -0.027,  0.017,
         0.065, -0.002,  0.012, -0.008, -0.044,  0.038, -0.023,  0.042, -0.072,
         0.004,  0.015,  0.034, -0.011, -0.000,  0.002, -0.028,  0.047,  0.063,
         0.009, -0.007, -0.059, -0.040,  0.005,  0.016,  0.008,  0.031,  0.007,
         0.005,  0.041,  0.042, -0.034, -0.026,  0.015, -0.016, -0.027, -0.015,
        -0.037, -0.009,  0.011], device='cuda:0')
s after update for 1 param tensor([1.099, 1.261, 1.445, 1.477, 1.276, 1.535, 1.578, 1.245, 1.389, 1.400,
        1.236, 1.015, 1.193, 1.517, 1.889, 1.175, 0.757, 1.377, 1.557, 0.981,
        1.581, 1.242, 1.601, 1.261, 1.044, 1.072, 1.655, 1.554, 1.788, 1.915,
        1.147, 0.971, 1.316, 1.251, 1.716, 1.884, 1.026, 1.177, 0.667, 1.456,
        1.480, 1.960, 0.911, 1.887, 1.359, 1.852, 1.531, 1.693, 1.369, 1.339,
        1.836, 0.760, 0.584, 1.364, 2.034, 1.443, 1.325, 1.496, 1.254, 1.944,
        1.437, 1.369, 2.114, 0.656, 1.375, 1.232, 1.555, 1.256, 1.145, 1.470,
        0.895, 1.054, 1.022, 0.982, 1.605, 1.328, 1.615, 1.438, 1.477, 1.618,
        1.158, 1.408, 1.442, 1.659, 1.395, 1.824, 1.808, 1.183, 0.976, 1.577,
        1.044, 1.227, 1.208, 1.512, 1.144, 1.506, 1.041, 1.585, 1.173, 1.071,
        1.530, 1.714, 1.644, 1.409, 0.614, 0.888, 1.726, 1.702, 0.637, 1.958,
        1.499, 1.228, 0.939, 2.126, 0.981, 1.566, 1.680, 0.673, 1.761, 1.771],
       device='cuda:0')
b after update for 1 param tensor([55.194, 59.122, 63.283, 63.972, 59.476, 65.228, 66.132, 58.747, 62.041,
        62.297, 58.538, 53.051, 57.497, 64.836, 72.358, 57.070, 45.818, 61.776,
        65.684, 52.146, 66.196, 58.671, 66.613, 59.121, 53.800, 54.517, 67.717,
        65.625, 70.395, 72.851, 56.384, 51.864, 60.390, 58.893, 68.973, 72.252,
        53.336, 57.115, 43.011, 63.530, 64.039, 73.710, 50.259, 72.315, 61.367,
        71.646, 65.147, 68.501, 61.598, 60.909, 71.329, 45.884, 40.215, 61.479,
        75.089, 63.235, 60.595, 64.382, 58.965, 73.411, 63.099, 61.593, 76.553,
        42.654, 61.731, 58.439, 65.652, 59.010, 56.331, 63.834, 49.812, 54.051,
        53.230, 52.180, 66.691, 60.679, 66.902, 63.126, 63.976, 66.967, 56.653,
        62.475, 63.228, 67.815, 62.179, 71.110, 70.782, 57.270, 52.011, 66.112,
        53.794, 58.326, 57.856, 64.734, 56.313, 64.596, 53.710, 66.285, 57.014,
        54.493, 65.121, 68.928, 67.492, 62.482, 41.255, 49.619, 69.164, 68.683,
        42.021, 73.667, 64.458, 58.351, 51.007, 76.768, 52.132, 65.881, 68.244,
        43.198, 69.856, 70.052], device='cuda:0')
clipping threshold 0.37664961022789234
a after update for 1 param tensor([[[-0.038],
         [ 0.011],
         [-0.012],
         [ 0.025],
         [ 0.006],
         [-0.034],
         [-0.026],
         [ 0.032],
         [ 0.078],
         [ 0.003]],

        [[ 0.002],
         [-0.054],
         [-0.013],
         [-0.001],
         [-0.016],
         [ 0.007],
         [-0.010],
         [ 0.016],
         [ 0.045],
         [ 0.025]],

        [[-0.039],
         [-0.042],
         [-0.019],
         [ 0.003],
         [ 0.026],
         [-0.002],
         [-0.012],
         [-0.026],
         [-0.059],
         [ 0.000]],

        [[-0.072],
         [-0.007],
         [-0.056],
         [-0.024],
         [-0.038],
         [-0.024],
         [ 0.023],
         [-0.028],
         [ 0.033],
         [ 0.115]],

        [[ 0.020],
         [ 0.046],
         [-0.035],
         [ 0.040],
         [ 0.011],
         [ 0.033],
         [ 0.072],
         [ 0.047],
         [-0.013],
         [-0.044]],

        [[ 0.019],
         [ 0.055],
         [ 0.010],
         [ 0.006],
         [ 0.045],
         [ 0.013],
         [-0.009],
         [ 0.016],
         [-0.007],
         [-0.022]],

        [[-0.001],
         [-0.029],
         [-0.041],
         [ 0.025],
         [ 0.020],
         [ 0.025],
         [-0.003],
         [-0.029],
         [-0.034],
         [ 0.005]],

        [[ 0.044],
         [-0.019],
         [-0.051],
         [ 0.004],
         [-0.021],
         [ 0.041],
         [-0.005],
         [ 0.006],
         [-0.036],
         [ 0.029]],

        [[ 0.040],
         [-0.050],
         [ 0.081],
         [-0.043],
         [-0.006],
         [-0.030],
         [ 0.032],
         [-0.035],
         [-0.004],
         [ 0.013]],

        [[-0.022],
         [-0.023],
         [-0.053],
         [-0.011],
         [ 0.038],
         [-0.003],
         [ 0.005],
         [ 0.049],
         [-0.019],
         [ 0.065]],

        [[-0.070],
         [ 0.019],
         [-0.080],
         [ 0.006],
         [ 0.066],
         [ 0.056],
         [-0.037],
         [ 0.016],
         [ 0.044],
         [-0.074]],

        [[-0.022],
         [ 0.077],
         [-0.027],
         [-0.011],
         [ 0.071],
         [-0.055],
         [-0.052],
         [ 0.007],
         [-0.045],
         [ 0.009]]], device='cuda:0')
s after update for 1 param tensor([[[1.723],
         [1.442],
         [1.804],
         [1.815],
         [0.865],
         [1.427],
         [0.539],
         [1.751],
         [1.469],
         [1.639]],

        [[1.223],
         [1.310],
         [1.697],
         [1.227],
         [1.693],
         [1.547],
         [1.180],
         [1.025],
         [0.886],
         [1.463]],

        [[2.007],
         [1.805],
         [1.209],
         [1.509],
         [1.103],
         [1.178],
         [1.704],
         [1.766],
         [1.055],
         [1.529]],

        [[1.501],
         [1.452],
         [1.378],
         [1.911],
         [1.293],
         [1.525],
         [1.410],
         [1.843],
         [1.898],
         [1.359]],

        [[1.157],
         [1.756],
         [1.799],
         [1.789],
         [1.307],
         [1.709],
         [1.637],
         [0.939],
         [1.612],
         [1.285]],

        [[1.430],
         [1.024],
         [1.496],
         [1.693],
         [1.034],
         [1.037],
         [1.743],
         [1.074],
         [1.821],
         [1.918]],

        [[1.204],
         [1.386],
         [1.356],
         [2.019],
         [1.603],
         [0.536],
         [1.709],
         [1.697],
         [1.287],
         [1.370]],

        [[1.791],
         [0.722],
         [1.382],
         [1.793],
         [1.609],
         [1.210],
         [1.278],
         [1.814],
         [1.512],
         [1.435]],

        [[1.036],
         [1.642],
         [1.505],
         [1.508],
         [1.383],
         [1.427],
         [1.540],
         [1.397],
         [1.854],
         [1.570]],

        [[1.142],
         [1.425],
         [1.270],
         [1.665],
         [1.832],
         [2.161],
         [1.453],
         [1.602],
         [1.662],
         [1.584]],

        [[1.659],
         [1.519],
         [1.117],
         [1.764],
         [0.960],
         [1.330],
         [1.242],
         [1.736],
         [1.415],
         [1.557]],

        [[1.478],
         [0.820],
         [2.020],
         [1.581],
         [1.616],
         [1.350],
         [1.668],
         [1.768],
         [1.944],
         [1.469]]], device='cuda:0')
b after update for 1 param tensor([[[69.113],
         [63.209],
         [70.710],
         [70.923],
         [48.972],
         [62.885],
         [38.641],
         [69.657],
         [63.811],
         [67.394]],

        [[58.222],
         [60.266],
         [68.590],
         [58.308],
         [68.510],
         [65.472],
         [57.181],
         [53.296],
         [49.552],
         [63.674]],

        [[74.580],
         [70.721],
         [57.881],
         [64.675],
         [55.291],
         [57.144],
         [68.719],
         [69.951],
         [54.073],
         [65.087]],

        [[64.504],
         [63.438],
         [61.808],
         [72.770],
         [59.873],
         [65.008],
         [62.515],
         [71.470],
         [72.536],
         [61.367]],

        [[56.622],
         [69.772],
         [70.613],
         [70.414],
         [60.188],
         [68.818],
         [67.356],
         [51.014],
         [66.851],
         [59.689]],

        [[62.955],
         [53.273],
         [64.386],
         [68.501],
         [53.533],
         [53.603],
         [69.494],
         [54.567],
         [71.042],
         [72.910]],

        [[57.764],
         [61.987],
         [61.296],
         [74.814],
         [66.662],
         [38.550],
         [68.822],
         [68.586],
         [59.722],
         [61.628]],

        [[70.457],
         [44.724],
         [61.900],
         [70.487],
         [66.777],
         [57.909],
         [59.505],
         [70.901],
         [64.728],
         [63.074]],

        [[53.578],
         [67.466],
         [64.589],
         [64.647],
         [61.905],
         [62.893],
         [65.339],
         [62.235],
         [71.684],
         [65.960]],

        [[56.259],
         [62.842],
         [59.322],
         [67.923],
         [71.265],
         [77.394],
         [63.467],
         [66.639],
         [67.874],
         [66.261]],

        [[67.814],
         [64.891],
         [55.643],
         [69.913],
         [51.587],
         [60.721],
         [58.682],
         [69.365],
         [62.621],
         [65.681]],

        [[63.994],
         [47.663],
         [74.830],
         [66.192],
         [66.929],
         [61.160],
         [67.985],
         [70.005],
         [73.398],
         [63.807]]], device='cuda:0')
clipping threshold 0.37664961022789234
a after update for 1 param tensor([[-0.035],
        [ 0.016],
        [ 0.026],
        [ 0.019],
        [ 0.066],
        [-0.025],
        [ 0.016],
        [-0.020],
        [ 0.009],
        [ 0.005],
        [ 0.033],
        [-0.020]], device='cuda:0')
s after update for 1 param tensor([[1.440],
        [2.214],
        [1.192],
        [1.177],
        [1.580],
        [1.027],
        [1.497],
        [1.626],
        [1.515],
        [1.456],
        [0.804],
        [1.996]], device='cuda:0')
b after update for 1 param tensor([[63.172],
        [78.329],
        [57.471],
        [57.121],
        [66.165],
        [53.342],
        [64.402],
        [67.131],
        [64.808],
        [63.521],
        [47.210],
        [74.381]], device='cuda:0')
clipping threshold 0.37664961022789234
||w||^2 0.3663138347245485
exp ma of ||w||^2 0.22684162849037032
||w|| 0.6052386593109766
exp ma of ||w|| 0.47028873171952734
||w||^2 0.17873192597905804
exp ma of ||w||^2 0.22025885597200243
||w|| 0.4227669878065907
exp ma of ||w|| 0.4640538256473675
||w||^2 0.24499586085789757
exp ma of ||w||^2 0.22325862925517978
||w|| 0.49497056564799646
exp ma of ||w|| 0.46743191322572936
||w||^2 0.3332669563714774
exp ma of ||w||^2 0.20243885652918184
||w|| 0.5772927821924309
exp ma of ||w|| 0.4414820081380309
||w||^2 0.283212444000099
exp ma of ||w||^2 0.2167785181592539
||w|| 0.5321770795516272
exp ma of ||w|| 0.4522113879245773
cuda
Objective function 10.90 = squared loss an data 9.70 + 0.5*rho*h**2 0.375331 + alpha*h 0.105266 + L2reg 0.65 + L1reg 0.08 ; SHD = 21 ; DAG True
Proportion of microbatches that were clipped  0.7749059964377597
iteration 3 in inner loop, alpha 38.420704796994286 rho 100000.0 h 0.002739822442034523
iteration 4 in outer loop, alpha = 312.4029490004466, rho = 100000.0, h = 0.002739822442034523
cuda
1692
cuda
Objective function 11.65 = squared loss an data 9.70 + 0.5*rho*h**2 0.375331 + alpha*h 0.855929 + L2reg 0.65 + L1reg 0.08 ; SHD = 21 ; DAG True
||w||^2 1109.8501163679493
exp ma of ||w||^2 586652716180.5199
||w|| 33.31441304252484
exp ma of ||w|| 80896.88450628321
||w||^2 24.941026941604335
exp ma of ||w||^2 244705097353.0887
||w|| 4.994099212230804
exp ma of ||w|| 33751.95255701736
||w||^2 2.24821513081499
exp ma of ||w||^2 2173624284.2715516
||w|| 1.4994049255671364
exp ma of ||w|| 301.44048815850067
||w||^2 0.4187155223079647
exp ma of ||w||^2 78849455.39449638
||w|| 0.6470823149398882
exp ma of ||w|| 11.691523986956678
||w||^2 0.1055509001869717
exp ma of ||w||^2 0.18090848422264533
||w|| 0.32488598028688725
exp ma of ||w|| 0.4080271281489482
||w||^2 0.18199386946495236
exp ma of ||w||^2 0.21655585210116168
||w|| 0.426607394995624
exp ma of ||w|| 0.4463707697669478
||w||^2 0.07214402537836022
exp ma of ||w||^2 0.20398452620739438
||w|| 0.26859639866975177
exp ma of ||w|| 0.42951359560134755
v before min max tensor([[ 0.688, -1.943, -2.399,  ...,  1.618, -1.133, -4.564],
        [-1.654,  3.118, -2.915,  ..., -1.249,  3.595, -1.906],
        [34.014,  3.750, -2.549,  ..., -2.967,  4.549, -1.376],
        ...,
        [-1.706, -1.166, -3.533,  ...,  5.609,  0.336, 33.083],
        [-2.931,  1.221, 11.054,  ..., -1.673, -1.319, 16.037],
        [ 1.423, -1.078,  1.629,  ...,  3.380, -0.900, -3.428]],
       device='cuda:0')
v tensor([[6.878e-01, 1.000e-12, 1.000e-12,  ..., 1.618e+00, 1.000e-12,
         1.000e-12],
        [1.000e-12, 3.118e+00, 1.000e-12,  ..., 1.000e-12, 3.595e+00,
         1.000e-12],
        [1.000e+01, 3.750e+00, 1.000e-12,  ..., 1.000e-12, 4.549e+00,
         1.000e-12],
        ...,
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 5.609e+00, 3.358e-01,
         1.000e+01],
        [1.000e-12, 1.221e+00, 1.000e+01,  ..., 1.000e-12, 1.000e-12,
         1.000e+01],
        [1.423e+00, 1.000e-12, 1.629e+00,  ..., 3.380e+00, 1.000e-12,
         1.000e-12]], device='cuda:0')
v before min max tensor([ 5.561e+00,  1.106e+01,  6.892e+00, -3.424e+00,  1.657e+00, -4.363e+00,
        -2.307e+00,  7.302e-01, -3.766e+00,  4.047e+00, -5.548e-01, -1.673e+00,
         3.603e+00,  3.862e+00,  1.614e+01, -9.582e-01,  7.466e-01,  6.504e+00,
         2.780e+00, -1.681e+00, -1.543e+00, -1.420e+00, -8.911e-02,  2.838e+00,
        -1.110e+00, -2.202e+00,  9.685e+00, -1.110e+00, -9.302e-01,  1.237e+01,
         3.996e+00,  4.280e+00,  1.112e+01, -1.959e+00,  1.340e+01, -5.396e-01,
        -1.538e+00, -1.367e+00,  6.971e+00, -9.832e-01, -1.420e+00,  2.247e-01,
        -1.120e+00,  3.360e+00, -3.528e+00,  1.057e+00,  2.208e+00, -1.537e+00,
         1.330e+00, -1.734e-01,  6.807e+00, -1.022e+00,  2.954e+00,  2.252e+00,
        -1.623e+00, -1.144e+00,  1.408e+00, -1.621e+00, -1.690e+00,  1.778e+00,
        -3.048e+00, -7.814e-01,  5.603e-01,  3.820e+00,  8.795e+00, -6.136e-01,
         6.717e-01,  8.236e+00,  3.833e+00, -2.999e+00,  1.589e+00, -2.184e+00,
         1.002e-01,  2.091e+00, -1.118e+00, -2.580e+00, -1.500e+00,  1.384e+00,
        -5.855e-01,  2.570e+01, -2.140e+00,  5.020e+00, -2.121e+00,  3.366e+01,
        -2.231e+00, -8.748e-01,  6.248e+00, -2.518e+00, -1.051e+00,  3.153e+00,
        -5.798e-01,  6.179e+00,  5.549e+00, -3.187e-02, -1.755e+00, -2.544e+00,
        -5.307e-01, -1.147e+00, -2.750e+00, -1.537e+00, -7.979e-01,  2.322e-01,
        -1.102e+00, -1.320e+00, -1.328e+00, -1.689e+00,  4.588e+00, -4.006e+00,
        -3.533e-01, -3.358e-01, -2.445e+00, -1.716e+00, -2.353e+00,  6.323e+00,
         2.969e-01, -1.595e+00, -4.043e+00, -1.969e+00,  4.429e+00, -1.068e+00],
       device='cuda:0')
v tensor([5.561e+00, 1.000e+01, 6.892e+00, 1.000e-12, 1.657e+00, 1.000e-12,
        1.000e-12, 7.302e-01, 1.000e-12, 4.047e+00, 1.000e-12, 1.000e-12,
        3.603e+00, 3.862e+00, 1.000e+01, 1.000e-12, 7.466e-01, 6.504e+00,
        2.780e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 2.838e+00,
        1.000e-12, 1.000e-12, 9.685e+00, 1.000e-12, 1.000e-12, 1.000e+01,
        3.996e+00, 4.280e+00, 1.000e+01, 1.000e-12, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 6.971e+00, 1.000e-12, 1.000e-12, 2.247e-01,
        1.000e-12, 3.360e+00, 1.000e-12, 1.057e+00, 2.208e+00, 1.000e-12,
        1.330e+00, 1.000e-12, 6.807e+00, 1.000e-12, 2.954e+00, 2.252e+00,
        1.000e-12, 1.000e-12, 1.408e+00, 1.000e-12, 1.000e-12, 1.778e+00,
        1.000e-12, 1.000e-12, 5.603e-01, 3.820e+00, 8.795e+00, 1.000e-12,
        6.717e-01, 8.236e+00, 3.833e+00, 1.000e-12, 1.589e+00, 1.000e-12,
        1.002e-01, 2.091e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.384e+00,
        1.000e-12, 1.000e+01, 1.000e-12, 5.020e+00, 1.000e-12, 1.000e+01,
        1.000e-12, 1.000e-12, 6.248e+00, 1.000e-12, 1.000e-12, 3.153e+00,
        1.000e-12, 6.179e+00, 5.549e+00, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 2.322e-01,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 4.588e+00, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 6.323e+00,
        2.969e-01, 1.000e-12, 1.000e-12, 1.000e-12, 4.429e+00, 1.000e-12],
       device='cuda:0')
v before min max tensor([[[-0.476],
         [-2.451],
         [ 6.729],
         [ 6.413],
         [-2.482],
         [ 2.203],
         [ 7.486],
         [-2.389],
         [ 0.868],
         [11.041]],

        [[ 0.297],
         [-2.075],
         [-0.466],
         [-0.239],
         [-2.059],
         [ 0.634],
         [-1.749],
         [ 1.978],
         [-1.983],
         [ 1.635]],

        [[29.684],
         [ 4.868],
         [13.962],
         [ 8.846],
         [-1.319],
         [ 7.015],
         [-1.013],
         [-3.391],
         [-3.226],
         [-0.598]],

        [[-2.311],
         [-0.753],
         [ 0.775],
         [10.064],
         [-1.900],
         [13.933],
         [-1.746],
         [-3.874],
         [ 2.600],
         [ 1.302]],

        [[ 2.929],
         [-2.074],
         [-0.524],
         [-1.763],
         [-2.728],
         [ 9.032],
         [12.176],
         [18.735],
         [-0.185],
         [-2.926]],

        [[ 1.289],
         [-2.547],
         [14.772],
         [ 0.804],
         [ 0.513],
         [-2.827],
         [-0.303],
         [ 1.645],
         [ 4.314],
         [-2.544]],

        [[-2.232],
         [ 2.706],
         [-1.845],
         [13.781],
         [-1.217],
         [ 0.477],
         [ 1.534],
         [-2.096],
         [-1.998],
         [-1.620]],

        [[ 8.957],
         [-0.625],
         [-2.100],
         [-2.942],
         [-1.383],
         [-3.092],
         [-0.200],
         [ 0.276],
         [ 3.529],
         [-0.350]],

        [[-0.949],
         [-0.067],
         [-1.523],
         [-1.951],
         [-3.616],
         [11.044],
         [32.825],
         [-1.199],
         [-0.298],
         [-1.752]],

        [[ 3.861],
         [-1.400],
         [-1.632],
         [-1.900],
         [-1.520],
         [-2.223],
         [-1.999],
         [20.438],
         [-1.640],
         [-2.136]],

        [[12.984],
         [ 3.066],
         [ 4.362],
         [ 2.249],
         [-2.269],
         [-3.300],
         [ 5.727],
         [-3.008],
         [14.414],
         [ 3.844]],

        [[-1.508],
         [ 2.538],
         [ 2.504],
         [10.760],
         [ 3.285],
         [-1.219],
         [ 1.914],
         [-2.519],
         [-1.032],
         [-2.949]]], device='cuda:0')
v tensor([[[1.000e-12],
         [1.000e-12],
         [6.729e+00],
         [6.413e+00],
         [1.000e-12],
         [2.203e+00],
         [7.486e+00],
         [1.000e-12],
         [8.683e-01],
         [1.000e+01]],

        [[2.970e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [6.340e-01],
         [1.000e-12],
         [1.978e+00],
         [1.000e-12],
         [1.635e+00]],

        [[1.000e+01],
         [4.868e+00],
         [1.000e+01],
         [8.846e+00],
         [1.000e-12],
         [7.015e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [7.754e-01],
         [1.000e+01],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [2.600e+00],
         [1.302e+00]],

        [[2.929e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [9.032e+00],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12]],

        [[1.289e+00],
         [1.000e-12],
         [1.000e+01],
         [8.035e-01],
         [5.126e-01],
         [1.000e-12],
         [1.000e-12],
         [1.645e+00],
         [4.314e+00],
         [1.000e-12]],

        [[1.000e-12],
         [2.706e+00],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [4.766e-01],
         [1.534e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[8.957e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.762e-01],
         [3.529e+00],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[3.861e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e+01],
         [3.066e+00],
         [4.362e+00],
         [2.249e+00],
         [1.000e-12],
         [1.000e-12],
         [5.727e+00],
         [1.000e-12],
         [1.000e+01],
         [3.844e+00]],

        [[1.000e-12],
         [2.538e+00],
         [2.504e+00],
         [1.000e+01],
         [3.285e+00],
         [1.000e-12],
         [1.914e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]]], device='cuda:0')
v before min max tensor([[-1.178],
        [-3.723],
        [ 0.983],
        [ 1.824],
        [ 8.010],
        [35.921],
        [ 5.497],
        [-3.053],
        [-3.346],
        [ 0.224],
        [35.501],
        [ 2.285]], device='cuda:0')
v tensor([[1.000e-12],
        [1.000e-12],
        [9.829e-01],
        [1.824e+00],
        [8.010e+00],
        [1.000e+01],
        [5.497e+00],
        [1.000e-12],
        [1.000e-12],
        [2.244e-01],
        [1.000e+01],
        [2.285e+00]], device='cuda:0')
a after update for 1 param tensor([[-0.009, -0.038, -0.004,  ...,  0.002,  0.004, -0.009],
        [-0.004,  0.012, -0.006,  ...,  0.009, -0.029,  0.020],
        [-0.004,  0.008,  0.009,  ...,  0.006,  0.014,  0.008],
        ...,
        [-0.010, -0.003, -0.001,  ...,  0.016,  0.002, -0.005],
        [ 0.001,  0.008,  0.022,  ..., -0.005, -0.030,  0.001],
        [-0.004,  0.051,  0.001,  ..., -0.004,  0.043,  0.001]],
       device='cuda:0')
s after update for 1 param tensor([[1.351, 0.716, 0.884,  ..., 1.090, 0.983, 1.781],
        [0.666, 0.997, 1.261,  ..., 1.269, 1.039, 1.068],
        [1.775, 1.049, 1.312,  ..., 1.095, 0.867, 1.533],
        ...,
        [0.635, 0.865, 1.307,  ..., 1.343, 0.599, 2.113],
        [1.084, 0.872, 1.807,  ..., 0.812, 0.790, 1.866],
        [0.927, 1.049, 0.610,  ..., 0.915, 0.413, 1.271]], device='cuda:0')
b after update for 1 param tensor([[52.947, 38.551, 42.828,  ..., 47.556, 45.168, 60.786],
        [37.158, 45.472, 51.155,  ..., 51.313, 46.429, 47.064],
        [60.690, 46.649, 52.179,  ..., 47.669, 42.412, 56.388],
        ...,
        [36.304, 42.353, 52.065,  ..., 52.788, 35.243, 66.206],
        [47.422, 42.525, 61.228,  ..., 41.047, 40.489, 62.225],
        [43.857, 46.651, 35.571,  ..., 43.569, 29.272, 51.354]],
       device='cuda:0')
clipping threshold 0.3552894891992913
a after update for 1 param tensor([ 2.880e-02,  1.629e-02,  5.559e-02,  1.918e-02, -3.537e-03, -2.448e-02,
         3.992e-02,  7.687e-02,  8.823e-03,  6.572e-03, -1.954e-02, -4.967e-02,
        -3.702e-02,  1.641e-02, -1.507e-02, -6.304e-03,  3.883e-02, -2.195e-03,
         5.597e-02, -6.342e-02, -1.696e-02, -1.574e-02,  1.063e-02, -3.396e-02,
         2.071e-04, -6.532e-02,  1.405e-02,  2.195e-03, -9.213e-03, -4.018e-02,
         2.379e-02, -2.269e-02, -1.513e-02, -4.295e-03, -3.180e-02,  5.248e-05,
         1.738e-02, -7.565e-03,  3.111e-02,  1.482e-02,  5.217e-02,  1.941e-02,
        -3.124e-02, -1.821e-02,  6.340e-02, -6.791e-02,  1.806e-03, -1.894e-03,
        -2.499e-02,  2.607e-02,  1.866e-02,  8.739e-03, -3.025e-02,  1.525e-02,
        -1.525e-02, -9.079e-04, -2.757e-02, -9.124e-03, -9.719e-03, -1.159e-02,
        -1.173e-02, -1.678e-02,  2.699e-02, -6.101e-03,  5.276e-02, -3.543e-03,
        -4.463e-02, -9.834e-03, -1.869e-02,  2.987e-02, -3.583e-02, -6.184e-03,
         7.598e-03, -3.358e-02, -1.792e-02,  2.389e-02,  2.913e-02, -4.546e-02,
        -2.302e-02, -1.819e-02, -1.474e-02,  3.654e-03, -3.686e-02, -9.619e-02,
        -3.459e-02,  1.546e-02, -3.556e-02,  8.811e-03,  9.283e-03, -5.176e-02,
         5.429e-02,  2.153e-02,  2.978e-02, -7.121e-03, -1.943e-03,  4.553e-02,
        -2.402e-03, -1.128e-02,  3.396e-02, -4.865e-02, -1.741e-02, -1.008e-02,
        -9.115e-04,  3.037e-02,  1.449e-03,  3.429e-02,  2.383e-02,  3.959e-02,
         3.922e-02,  4.862e-02,  1.459e-02, -6.754e-03, -6.085e-03, -4.396e-02,
        -2.158e-02, -7.800e-03, -8.788e-04,  1.762e-02,  4.923e-02, -5.274e-03],
       device='cuda:0')
s after update for 1 param tensor([1.197, 1.547, 1.536, 1.441, 1.294, 1.670, 1.315, 0.730, 1.454, 1.393,
        0.992, 0.629, 0.989, 1.077, 1.235, 0.717, 1.498, 1.055, 0.745, 0.655,
        0.664, 1.112, 0.625, 0.998, 1.360, 0.875, 1.198, 0.766, 0.494, 1.267,
        1.536, 1.204, 1.287, 0.728, 1.421, 1.012, 1.165, 0.529, 0.977, 0.931,
        1.126, 0.451, 1.410, 1.306, 1.302, 1.359, 1.134, 0.696, 0.838, 0.497,
        1.644, 0.455, 0.680, 0.806, 0.635, 0.621, 1.003, 0.613, 0.625, 1.308,
        1.134, 0.737, 1.006, 0.933, 1.315, 1.087, 0.709, 1.228, 1.119, 1.488,
        0.538, 1.022, 0.357, 0.819, 0.458, 1.060, 0.938, 1.023, 1.019, 1.384,
        1.058, 0.920, 0.804, 1.420, 1.148, 0.531, 0.855, 1.071, 0.641, 0.842,
        0.688, 1.198, 0.866, 0.859, 0.647, 1.110, 0.732, 0.426, 1.157, 1.005,
        1.018, 0.646, 0.925, 0.780, 0.605, 1.279, 0.752, 1.566, 0.354, 0.289,
        1.024, 1.175, 1.013, 1.260, 1.097, 0.718, 1.495, 0.735, 0.958, 0.421],
       device='cuda:0')
b after update for 1 param tensor([49.842, 56.655, 56.447, 54.669, 51.812, 58.860, 52.223, 38.925, 54.927,
        53.762, 45.369, 36.111, 45.292, 47.272, 50.618, 38.569, 55.746, 46.789,
        39.319, 36.854, 37.105, 48.034, 36.007, 45.502, 53.114, 42.618, 49.850,
        39.876, 32.026, 51.264, 56.454, 49.971, 51.677, 38.856, 54.294, 45.824,
        49.153, 33.138, 45.015, 43.943, 48.341, 30.582, 54.076, 52.055, 51.977,
        53.102, 48.503, 37.996, 41.697, 32.120, 58.406, 30.717, 37.573, 40.897,
        36.294, 35.890, 45.608, 35.650, 35.995, 52.094, 48.512, 39.113, 45.690,
        43.999, 52.227, 47.484, 38.360, 50.482, 48.174, 55.552, 33.406, 46.057,
        27.214, 41.212, 30.836, 46.889, 44.119, 46.069, 45.978, 53.589, 46.840,
        43.697, 40.838, 54.279, 48.805, 33.182, 42.123, 47.136, 36.480, 41.806,
        37.775, 49.847, 42.381, 42.205, 36.636, 47.979, 38.963, 29.712, 48.992,
        45.673, 45.956, 36.606, 43.812, 40.217, 35.417, 51.505, 39.511, 56.989,
        27.092, 24.490, 46.097, 49.372, 45.839, 51.127, 47.711, 38.587, 55.691,
        39.061, 44.572, 29.570], device='cuda:0')
clipping threshold 0.3552894891992913
a after update for 1 param tensor([[[ 3.604e-02],
         [-3.953e-02],
         [-1.336e-02],
         [-1.329e-02],
         [ 1.271e-04],
         [ 4.872e-02],
         [-1.783e-02],
         [-1.207e-02],
         [ 3.668e-02],
         [-3.725e-02]],

        [[ 2.743e-03],
         [-3.120e-02],
         [ 5.733e-02],
         [ 1.390e-02],
         [ 1.098e-02],
         [-1.400e-03],
         [ 6.237e-02],
         [ 4.885e-02],
         [-3.266e-02],
         [ 2.419e-02]],

        [[ 1.405e-02],
         [ 1.527e-02],
         [ 6.843e-03],
         [ 4.550e-02],
         [-1.667e-02],
         [ 9.064e-03],
         [ 2.190e-02],
         [-3.338e-02],
         [ 5.670e-03],
         [-1.478e-02]],

        [[ 6.258e-02],
         [ 1.969e-02],
         [ 5.007e-03],
         [-1.971e-02],
         [-4.095e-02],
         [ 5.226e-02],
         [ 2.169e-03],
         [ 3.332e-02],
         [ 2.082e-03],
         [-2.596e-02]],

        [[-7.463e-02],
         [-1.368e-02],
         [-3.788e-02],
         [-1.022e-02],
         [ 2.665e-02],
         [ 1.542e-02],
         [-1.121e-02],
         [ 1.832e-02],
         [ 2.034e-02],
         [ 4.130e-02]],

        [[ 2.430e-03],
         [ 3.744e-03],
         [ 5.767e-03],
         [-2.390e-02],
         [-1.794e-02],
         [ 5.323e-02],
         [ 1.748e-02],
         [ 7.731e-03],
         [-3.013e-02],
         [ 1.207e-02]],

        [[ 3.189e-02],
         [ 3.779e-02],
         [ 1.287e-02],
         [ 6.151e-03],
         [-1.517e-02],
         [-1.901e-02],
         [ 6.088e-03],
         [-2.756e-02],
         [ 5.836e-02],
         [ 1.238e-02]],

        [[-1.076e-02],
         [ 1.777e-02],
         [-1.342e-02],
         [ 1.042e-02],
         [-4.486e-02],
         [-6.632e-04],
         [-1.300e-02],
         [ 7.015e-03],
         [-3.612e-02],
         [ 3.891e-02]],

        [[ 5.933e-02],
         [ 4.529e-02],
         [ 2.374e-02],
         [-8.105e-03],
         [-3.675e-02],
         [ 2.051e-02],
         [ 8.082e-03],
         [-1.763e-02],
         [-4.532e-02],
         [ 4.538e-03]],

        [[ 7.946e-03],
         [ 2.583e-02],
         [-2.679e-03],
         [ 8.949e-03],
         [-1.189e-02],
         [-3.592e-02],
         [-1.648e-03],
         [-4.986e-02],
         [-4.117e-03],
         [ 3.249e-02]],

        [[ 4.195e-02],
         [ 3.243e-02],
         [ 6.004e-05],
         [ 2.170e-03],
         [ 2.212e-02],
         [-2.457e-02],
         [ 2.576e-02],
         [-4.113e-02],
         [ 5.912e-02],
         [ 3.339e-02]],

        [[-4.228e-03],
         [ 6.798e-03],
         [ 2.162e-03],
         [ 2.785e-02],
         [ 1.148e-02],
         [ 8.481e-03],
         [-6.157e-03],
         [-3.894e-02],
         [-5.228e-02],
         [-4.416e-03]]], device='cuda:0')
s after update for 1 param tensor([[[0.363],
         [1.153],
         [1.195],
         [0.944],
         [1.111],
         [0.672],
         [1.383],
         [0.881],
         [1.126],
         [1.293]],

        [[0.793],
         [0.826],
         [1.841],
         [0.549],
         [0.810],
         [0.463],
         [0.981],
         [1.155],
         [1.224],
         [0.942]],

        [[1.480],
         [1.031],
         [1.195],
         [1.470],
         [0.541],
         [1.151],
         [0.486],
         [1.283],
         [1.303],
         [1.047]],

        [[0.877],
         [0.686],
         [1.598],
         [1.093],
         [0.826],
         [1.482],
         [0.652],
         [1.485],
         [0.997],
         [0.710]],

        [[0.983],
         [1.633],
         [1.431],
         [1.160],
         [1.009],
         [1.175],
         [1.412],
         [1.142],
         [0.839],
         [1.121]],

        [[0.933],
         [0.943],
         [1.207],
         [0.795],
         [0.513],
         [1.068],
         [0.611],
         [1.276],
         [1.120],
         [0.966]],

        [[0.828],
         [1.204],
         [1.253],
         [1.624],
         [1.318],
         [1.021],
         [1.379],
         [0.851],
         [0.748],
         [1.298]],

        [[1.180],
         [0.450],
         [1.039],
         [1.369],
         [0.673],
         [1.140],
         [0.945],
         [1.135],
         [0.967],
         [1.162]],

        [[0.835],
         [0.626],
         [0.577],
         [0.909],
         [1.333],
         [1.781],
         [1.244],
         [0.610],
         [0.904],
         [1.266]],

        [[1.373],
         [1.219],
         [0.817],
         [0.776],
         [1.218],
         [1.031],
         [0.768],
         [1.433],
         [0.704],
         [0.886]],

        [[1.321],
         [0.832],
         [1.566],
         [1.136],
         [1.306],
         [1.219],
         [1.714],
         [1.246],
         [1.273],
         [1.351]],

        [[0.999],
         [0.776],
         [1.001],
         [1.424],
         [1.274],
         [0.472],
         [0.605],
         [1.451],
         [0.578],
         [1.089]]], device='cuda:0')
b after update for 1 param tensor([[[27.424],
         [48.905],
         [49.792],
         [44.260],
         [48.006],
         [37.325],
         [53.559],
         [42.746],
         [48.338],
         [51.790]],

        [[40.549],
         [41.392],
         [61.799],
         [33.743],
         [40.992],
         [31.001],
         [45.107],
         [48.947],
         [50.392],
         [44.214]],

        [[55.415],
         [46.243],
         [49.796],
         [55.217],
         [33.513],
         [48.871],
         [31.759],
         [51.600],
         [51.990],
         [46.601]],

        [[42.647],
         [37.730],
         [57.573],
         [47.621],
         [41.395],
         [55.444],
         [36.769],
         [55.510],
         [45.479],
         [38.379]],

        [[45.163],
         [58.207],
         [54.491],
         [49.061],
         [45.744],
         [49.363],
         [54.118],
         [48.667],
         [41.725],
         [48.228]],

        [[44.006],
         [44.229],
         [50.035],
         [40.606],
         [32.638],
         [47.069],
         [35.603],
         [51.459],
         [48.212],
         [44.764]],

        [[41.441],
         [49.978],
         [50.985],
         [58.046],
         [52.289],
         [46.031],
         [53.487],
         [42.009],
         [39.394],
         [51.896]],

        [[49.473],
         [30.564],
         [46.427],
         [53.300],
         [37.374],
         [48.623],
         [44.277],
         [48.516],
         [44.782],
         [49.103]],

        [[41.618],
         [36.026],
         [34.600],
         [43.436],
         [52.590],
         [60.791],
         [50.808],
         [35.579],
         [43.310],
         [51.250]],

        [[53.364],
         [50.288],
         [41.174],
         [40.130],
         [50.258],
         [46.257],
         [39.910],
         [54.530],
         [38.225],
         [42.882]],

        [[52.347],
         [41.538],
         [57.003],
         [48.545],
         [52.060],
         [50.294],
         [59.631],
         [50.848],
         [51.391],
         [52.937]],

        [[45.519],
         [40.135],
         [45.582],
         [54.351],
         [51.409],
         [31.278],
         [35.420],
         [54.864],
         [34.632],
         [47.532]]], device='cuda:0')
clipping threshold 0.3552894891992913
a after update for 1 param tensor([[ 0.012],
        [-0.038],
        [-0.042],
        [-0.010],
        [ 0.060],
        [ 0.010],
        [-0.022],
        [ 0.000],
        [ 0.026],
        [-0.025],
        [-0.013],
        [-0.020]], device='cuda:0')
s after update for 1 param tensor([[1.123],
        [1.374],
        [0.753],
        [1.128],
        [1.492],
        [1.352],
        [1.638],
        [1.246],
        [1.609],
        [1.049],
        [1.541],
        [0.920]], device='cuda:0')
b after update for 1 param tensor([[48.270],
        [53.387],
        [39.522],
        [48.368],
        [55.642],
        [52.962],
        [58.287],
        [50.839],
        [57.776],
        [46.646],
        [56.535],
        [43.676]], device='cuda:0')
clipping threshold 0.3552894891992913
||w||^2 0.16917814591162514
exp ma of ||w||^2 0.1589338680330805
||w|| 0.411312710612771
exp ma of ||w|| 0.38723877258133266
v before min max tensor([[-4.045e+00, -9.621e-01,  5.831e+00,  ..., -1.214e+00,  7.236e-01,
         -2.801e+00],
        [ 8.576e+01, -1.083e+00,  1.544e+01,  ..., -3.606e+00, -2.380e+00,
          1.844e+01],
        [ 5.365e-01,  3.957e+00,  8.688e-01,  ..., -3.850e-01, -2.906e+00,
         -1.830e+00],
        ...,
        [-2.028e+00, -2.388e+00,  8.891e+00,  ..., -1.038e+00, -5.897e-01,
          4.512e+00],
        [-5.213e-01, -1.948e+00, -3.441e+00,  ..., -3.827e+00, -3.418e+00,
          6.431e+00],
        [-6.450e-01, -9.478e-01, -2.186e+00,  ..., -2.749e-02, -1.452e+00,
         -4.047e+00]], device='cuda:0')
v tensor([[1.000e-12, 1.000e-12, 5.831e+00,  ..., 1.000e-12, 7.236e-01,
         1.000e-12],
        [1.000e+01, 1.000e-12, 1.000e+01,  ..., 1.000e-12, 1.000e-12,
         1.000e+01],
        [5.365e-01, 3.957e+00, 8.688e-01,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        ...,
        [1.000e-12, 1.000e-12, 8.891e+00,  ..., 1.000e-12, 1.000e-12,
         4.512e+00],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         6.431e+00],
        [1.000e-12, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12]], device='cuda:0')
v before min max tensor([-3.088, -1.952,  4.481, -3.167, -0.093,  6.749, -4.796, -0.228, -1.020,
        -1.394,  5.435, -3.586, -0.095, -0.927, -1.925,  6.057, -3.102, -4.799,
        -1.794,  0.835,  1.683, -0.424,  4.022, -1.467, -2.598, 10.992, -0.546,
         1.081, 12.051, -0.495, -3.553, -0.930, -0.841, -1.780, -2.617,  0.216,
        -3.705, -2.104, -1.865, -2.320,  1.149, -3.543, -0.722, -1.565, -2.992,
         4.674, -0.993, -1.386, -3.667, -1.670, -3.629,  0.462, -3.545,  2.657,
        -2.698,  6.173, -1.118,  1.074, -0.688, -2.215, -2.545, -2.379, -2.248,
        -2.231, -1.107, -1.660,  0.023, -2.776, -1.449,  8.298, -3.325, -1.980,
        -2.101, -3.601,  3.755, -2.897, -1.348,  3.599, -1.067, -0.344, -0.715,
        16.111, -2.150, -1.763, -2.235,  2.440, 10.865,  1.433,  0.315, -1.827,
        -0.943, -2.533, -3.444, -3.601,  2.750, -1.680, -2.910,  0.873, -2.609,
        -0.868, -1.614, -0.021,  2.943, -3.029, 12.079, 13.074, -2.338,  1.992,
        -1.186, -2.588, -2.362,  2.014, -2.440, -3.958, -0.322, -1.639,  0.176,
        -2.256, -1.308, -3.044], device='cuda:0')
v tensor([1.000e-12, 1.000e-12, 4.481e+00, 1.000e-12, 1.000e-12, 6.749e+00,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 5.435e+00, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 6.057e+00, 1.000e-12, 1.000e-12,
        1.000e-12, 8.351e-01, 1.683e+00, 1.000e-12, 4.022e+00, 1.000e-12,
        1.000e-12, 1.000e+01, 1.000e-12, 1.081e+00, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 2.165e-01,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.149e+00, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 4.674e+00, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 4.617e-01, 1.000e-12, 2.657e+00,
        1.000e-12, 6.173e+00, 1.000e-12, 1.074e+00, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        2.270e-02, 1.000e-12, 1.000e-12, 8.298e+00, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 3.755e+00, 1.000e-12, 1.000e-12, 3.599e+00,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.000e-12, 1.000e-12,
        1.000e-12, 2.440e+00, 1.000e+01, 1.433e+00, 3.148e-01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 2.750e+00, 1.000e-12,
        1.000e-12, 8.731e-01, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        2.943e+00, 1.000e-12, 1.000e+01, 1.000e+01, 1.000e-12, 1.992e+00,
        1.000e-12, 1.000e-12, 1.000e-12, 2.014e+00, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.756e-01, 1.000e-12, 1.000e-12, 1.000e-12],
       device='cuda:0')
v before min max tensor([[[ 3.737],
         [-2.176],
         [ 1.131],
         [-2.084],
         [-1.866],
         [-3.685],
         [-2.933],
         [ 0.085],
         [-0.475],
         [-1.537]],

        [[ 1.976],
         [-2.609],
         [ 0.659],
         [-2.800],
         [ 7.473],
         [-1.419],
         [-0.287],
         [-1.561],
         [-3.075],
         [-3.549]],

        [[-3.075],
         [-0.475],
         [ 0.176],
         [-2.408],
         [ 0.797],
         [-0.065],
         [-2.921],
         [ 0.075],
         [-5.438],
         [ 2.431]],

        [[-2.661],
         [-2.410],
         [ 3.584],
         [-4.149],
         [ 8.460],
         [-4.360],
         [-0.910],
         [-2.252],
         [-0.327],
         [-1.602]],

        [[ 2.593],
         [ 1.357],
         [-5.405],
         [-2.655],
         [-1.482],
         [-2.373],
         [15.819],
         [-0.508],
         [ 9.554],
         [-2.973]],

        [[-0.607],
         [-2.012],
         [16.410],
         [-1.757],
         [-0.952],
         [-1.254],
         [-2.760],
         [-1.294],
         [10.947],
         [-2.581]],

        [[-1.712],
         [ 9.534],
         [-1.773],
         [ 0.490],
         [-1.556],
         [-3.482],
         [ 4.573],
         [-3.375],
         [ 6.127],
         [ 8.227]],

        [[-3.322],
         [ 3.420],
         [ 5.522],
         [-1.034],
         [ 2.009],
         [-2.854],
         [ 0.242],
         [-4.303],
         [-0.037],
         [-2.405]],

        [[-3.718],
         [-3.007],
         [ 5.358],
         [ 0.789],
         [ 4.225],
         [-4.444],
         [-1.891],
         [ 2.513],
         [ 0.741],
         [-2.228]],

        [[ 4.575],
         [-2.194],
         [ 6.182],
         [-1.373],
         [ 2.960],
         [-3.048],
         [-1.501],
         [-2.746],
         [ 0.257],
         [-3.688]],

        [[-2.778],
         [-0.327],
         [-2.033],
         [ 1.798],
         [-2.422],
         [32.083],
         [24.719],
         [-2.396],
         [ 1.891],
         [-1.044]],

        [[ 8.865],
         [-3.096],
         [-2.816],
         [ 5.337],
         [-1.627],
         [10.949],
         [ 4.946],
         [-1.740],
         [-1.660],
         [-3.520]]], device='cuda:0')
v tensor([[[3.737e+00],
         [1.000e-12],
         [1.131e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [8.459e-02],
         [1.000e-12],
         [1.000e-12]],

        [[1.976e+00],
         [1.000e-12],
         [6.595e-01],
         [1.000e-12],
         [7.473e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.760e-01],
         [1.000e-12],
         [7.967e-01],
         [1.000e-12],
         [1.000e-12],
         [7.472e-02],
         [1.000e-12],
         [2.431e+00]],

        [[1.000e-12],
         [1.000e-12],
         [3.584e+00],
         [1.000e-12],
         [8.460e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[2.593e+00],
         [1.357e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [9.554e+00],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12]],

        [[1.000e-12],
         [9.534e+00],
         [1.000e-12],
         [4.899e-01],
         [1.000e-12],
         [1.000e-12],
         [4.573e+00],
         [1.000e-12],
         [6.127e+00],
         [8.227e+00]],

        [[1.000e-12],
         [3.420e+00],
         [5.522e+00],
         [1.000e-12],
         [2.009e+00],
         [1.000e-12],
         [2.422e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [5.358e+00],
         [7.894e-01],
         [4.225e+00],
         [1.000e-12],
         [1.000e-12],
         [2.513e+00],
         [7.410e-01],
         [1.000e-12]],

        [[4.575e+00],
         [1.000e-12],
         [6.182e+00],
         [1.000e-12],
         [2.960e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.573e-01],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.798e+00],
         [1.000e-12],
         [1.000e+01],
         [1.000e+01],
         [1.000e-12],
         [1.891e+00],
         [1.000e-12]],

        [[8.865e+00],
         [1.000e-12],
         [1.000e-12],
         [5.337e+00],
         [1.000e-12],
         [1.000e+01],
         [4.946e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]]], device='cuda:0')
v before min max tensor([[-1.659],
        [-0.282],
        [-2.807],
        [-2.380],
        [13.939],
        [-3.922],
        [ 0.401],
        [ 0.293],
        [25.277],
        [-2.962],
        [-3.510],
        [12.683]], device='cuda:0')
v tensor([[1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e+01],
        [1.000e-12],
        [4.010e-01],
        [2.934e-01],
        [1.000e+01],
        [1.000e-12],
        [1.000e-12],
        [1.000e+01]], device='cuda:0')
a after update for 1 param tensor([[-0.010, -0.026,  0.002,  ..., -0.003, -0.006, -0.030],
        [ 0.023,  0.010,  0.002,  ..., -0.001, -0.021, -0.000],
        [-0.006, -0.012,  0.003,  ...,  0.003,  0.020, -0.001],
        ...,
        [ 0.002,  0.011,  0.007,  ..., -0.008, -0.002, -0.020],
        [ 0.001, -0.013, -0.004,  ..., -0.017, -0.012, -0.000],
        [-0.001,  0.017, -0.006,  ...,  0.000,  0.040, -0.012]],
       device='cuda:0')
s after update for 1 param tensor([[1.996, 1.162, 1.018,  ..., 0.879, 0.840, 1.093],
        [2.579, 0.752, 1.940,  ..., 1.259, 1.302, 1.304],
        [1.673, 0.820, 1.502,  ..., 0.821, 1.015, 0.768],
        ...,
        [0.826, 1.232, 1.410,  ..., 0.719, 0.975, 2.170],
        [0.607, 0.781, 1.200,  ..., 1.777, 1.240, 2.010],
        [0.625, 0.824, 0.824,  ..., 0.962, 1.081, 2.009]], device='cuda:0')
b after update for 1 param tensor([[66.775, 50.938, 47.678,  ..., 44.300, 43.324, 49.409],
        [75.890, 40.994, 65.821,  ..., 53.017, 53.926, 53.971],
        [61.129, 42.795, 57.914,  ..., 42.825, 47.604, 41.406],
        ...,
        [42.959, 52.460, 56.115,  ..., 40.059, 46.670, 69.620],
        [36.807, 41.772, 51.765,  ..., 62.994, 52.624, 66.994],
        [37.347, 42.887, 42.907,  ..., 46.351, 49.142, 66.989]],
       device='cuda:0')
clipping threshold 0.34323616962853826
a after update for 1 param tensor([-0.001,  0.030,  0.035,  0.024, -0.013, -0.020,  0.014,  0.061, -0.012,
         0.017, -0.016, -0.054, -0.030,  0.028, -0.019,  0.000,  0.023, -0.022,
         0.050, -0.063, -0.013, -0.016,  0.020, -0.014, -0.004, -0.054,  0.006,
         0.012, -0.017, -0.044,  0.009, -0.050,  0.008, -0.031, -0.054, -0.007,
        -0.017,  0.002,  0.013, -0.004,  0.057,  0.018, -0.006, -0.031,  0.022,
        -0.059,  0.006, -0.004, -0.039,  0.024,  0.048, -0.011,  0.008, -0.026,
        -0.008,  0.002, -0.020, -0.016, -0.024, -0.020,  0.008,  0.019,  0.023,
        -0.033,  0.029, -0.003, -0.032,  0.024, -0.034,  0.028,  0.006, -0.010,
        -0.004, -0.014, -0.019,  0.033,  0.001, -0.053, -0.030, -0.042,  0.008,
         0.024, -0.036, -0.056, -0.018,  0.023, -0.047, -0.009, -0.009, -0.059,
         0.039,  0.003,  0.023,  0.027,  0.007,  0.022,  0.010, -0.016,  0.043,
        -0.034, -0.016, -0.001, -0.005,  0.029,  0.013, -0.003,  0.020,  0.050,
         0.023,  0.036,  0.036, -0.017, -0.016, -0.059, -0.009,  0.013,  0.049,
         0.018,  0.037, -0.036], device='cuda:0')
s after update for 1 param tensor([1.076, 0.708, 1.313, 1.127, 1.184, 1.231, 1.685, 0.711, 1.354, 1.309,
        1.159, 1.293, 0.570, 0.827, 0.920, 1.181, 1.619, 1.756, 0.758, 0.442,
        0.781, 0.621, 1.288, 1.252, 0.906, 1.484, 1.129, 0.766, 1.152, 0.801,
        1.255, 1.180, 1.356, 0.622, 0.996, 1.308, 1.370, 0.808, 0.649, 1.247,
        1.264, 1.240, 0.729, 0.635, 1.181, 1.441, 1.122, 0.491, 1.297, 0.629,
        1.264, 1.094, 1.243, 1.403, 0.973, 1.123, 0.730, 0.903, 0.386, 0.771,
        0.889, 1.001, 0.834, 0.786, 0.815, 0.597, 0.933, 1.224, 0.699, 1.325,
        1.243, 0.697, 0.791, 1.256, 1.279, 1.053, 1.256, 1.593, 0.372, 0.545,
        0.412, 1.534, 0.879, 1.180, 1.335, 1.247, 1.528, 0.972, 1.079, 0.654,
        1.481, 0.887, 1.574, 1.776, 1.144, 0.738, 1.059, 0.914, 1.318, 1.153,
        0.837, 0.772, 1.072, 1.104, 1.499, 1.591, 0.821, 1.389, 0.528, 1.192,
        0.824, 0.703, 0.866, 1.552, 1.191, 0.635, 0.800, 1.427, 0.823, 1.073],
       device='cuda:0')
b after update for 1 param tensor([49.014, 39.756, 54.158, 50.174, 51.432, 52.426, 61.353, 39.857, 54.992,
        54.063, 50.871, 53.734, 35.666, 42.976, 45.332, 51.347, 60.128, 62.620,
        41.142, 31.406, 41.770, 37.252, 53.636, 52.887, 44.977, 57.562, 50.207,
        41.358, 50.716, 42.301, 52.940, 51.339, 55.033, 37.261, 47.169, 54.058,
        55.311, 42.468, 38.082, 52.778, 53.126, 52.625, 40.345, 37.650, 51.353,
        56.732, 50.064, 33.098, 53.825, 37.467, 53.122, 49.426, 52.698, 55.983,
        46.610, 50.076, 40.379, 44.899, 29.370, 41.506, 44.553, 47.275, 43.169,
        41.899, 42.672, 36.503, 45.637, 52.293, 39.517, 54.397, 52.691, 39.453,
        42.031, 52.961, 53.447, 48.495, 52.960, 59.648, 28.825, 34.903, 30.338,
        58.536, 44.312, 51.327, 54.601, 52.776, 58.426, 46.596, 49.079, 38.212,
        57.513, 44.517, 59.284, 62.972, 50.537, 40.593, 48.641, 45.175, 54.255,
        50.755, 43.237, 41.517, 48.924, 49.650, 57.859, 59.604, 42.820, 55.697,
        34.354, 51.589, 42.898, 39.626, 43.983, 58.870, 51.571, 37.655, 42.276,
        56.450, 42.865, 48.953], device='cuda:0')
clipping threshold 0.34323616962853826
a after update for 1 param tensor([[[ 0.013],
         [-0.009],
         [ 0.028],
         [ 0.023],
         [-0.005],
         [ 0.023],
         [-0.015],
         [-0.038],
         [ 0.044],
         [-0.038]],

        [[ 0.013],
         [-0.020],
         [ 0.050],
         [-0.001],
         [ 0.020],
         [ 0.025],
         [ 0.055],
         [ 0.046],
         [-0.015],
         [-0.005]],

        [[ 0.024],
         [ 0.039],
         [ 0.013],
         [ 0.055],
         [-0.012],
         [-0.015],
         [ 0.018],
         [-0.003],
         [ 0.005],
         [-0.053]],

        [[ 0.027],
         [ 0.009],
         [ 0.011],
         [ 0.018],
         [-0.048],
         [ 0.050],
         [-0.007],
         [ 0.059],
         [ 0.006],
         [ 0.006]],

        [[-0.063],
         [-0.023],
         [-0.031],
         [-0.008],
         [ 0.021],
         [-0.002],
         [-0.030],
         [ 0.011],
         [-0.029],
         [ 0.026]],

        [[ 0.007],
         [ 0.008],
         [ 0.004],
         [-0.020],
         [-0.053],
         [ 0.038],
         [ 0.027],
         [ 0.002],
         [-0.016],
         [ 0.010]],

        [[-0.002],
         [-0.001],
         [ 0.016],
         [ 0.028],
         [-0.028],
         [-0.028],
         [ 0.004],
         [-0.041],
         [ 0.033],
         [-0.016]],

        [[ 0.002],
         [-0.010],
         [-0.053],
         [-0.010],
         [ 0.001],
         [ 0.028],
         [ 0.005],
         [ 0.004],
         [-0.024],
         [ 0.064]],

        [[-0.001],
         [ 0.015],
         [ 0.005],
         [-0.032],
         [-0.039],
         [-0.018],
         [ 0.009],
         [-0.023],
         [-0.037],
         [ 0.027]],

        [[-0.022],
         [ 0.009],
         [ 0.015],
         [ 0.007],
         [ 0.007],
         [-0.004],
         [ 0.011],
         [-0.007],
         [ 0.010],
         [ 0.053]],

        [[ 0.059],
         [-0.026],
         [-0.000],
         [ 0.010],
         [ 0.049],
         [-0.021],
         [ 0.013],
         [-0.027],
         [ 0.016],
         [-0.002]],

        [[ 0.013],
         [-0.008],
         [ 0.006],
         [ 0.043],
         [-0.007],
         [ 0.009],
         [-0.015],
         [-0.039],
         [-0.068],
         [-0.010]]], device='cuda:0')
s after update for 1 param tensor([[[1.161],
         [1.260],
         [1.618],
         [0.831],
         [0.902],
         [1.415],
         [1.374],
         [1.177],
         [1.046],
         [1.098]],

        [[1.231],
         [0.920],
         [0.718],
         [1.012],
         [1.335],
         [1.540],
         [1.170],
         [1.127],
         [1.118],
         [1.247]],

        [[1.592],
         [0.544],
         [0.980],
         [1.330],
         [1.110],
         [1.306],
         [1.230],
         [1.415],
         [1.901],
         [1.306]],

        [[1.249],
         [0.874],
         [1.198],
         [1.536],
         [1.304],
         [1.521],
         [0.317],
         [1.004],
         [0.788],
         [0.955]],

        [[1.069],
         [0.778],
         [1.898],
         [1.066],
         [0.812],
         [1.114],
         [1.673],
         [1.791],
         [1.721],
         [1.172]],

        [[0.780],
         [0.841],
         [1.508],
         [1.142],
         [0.978],
         [1.206],
         [1.593],
         [0.547],
         [1.292],
         [0.909]],

        [[0.854],
         [1.179],
         [0.683],
         [1.430],
         [0.963],
         [1.446],
         [1.456],
         [1.204],
         [1.195],
         [1.931]],

        [[1.377],
         [1.384],
         [1.525],
         [0.882],
         [1.286],
         [1.039],
         [1.044],
         [1.498],
         [0.478],
         [1.094]],

        [[1.300],
         [1.056],
         [1.407],
         [1.096],
         [1.299],
         [1.553],
         [0.716],
         [0.874],
         [0.676],
         [1.477]],

        [[1.078],
         [0.764],
         [1.160],
         [0.831],
         [1.339],
         [1.192],
         [0.818],
         [0.995],
         [0.744],
         [1.376]],

        [[0.970],
         [1.385],
         [0.708],
         [0.731],
         [1.225],
         [1.984],
         [1.685],
         [0.873],
         [0.957],
         [0.603]],

        [[1.636],
         [1.079],
         [1.240],
         [1.357],
         [1.639],
         [1.463],
         [1.209],
         [0.799],
         [1.105],
         [1.315]]], device='cuda:0')
b after update for 1 param tensor([[[50.917],
         [53.056],
         [60.115],
         [43.075],
         [44.893],
         [56.218],
         [55.386],
         [51.271],
         [48.341],
         [49.517]],

        [[52.426],
         [45.332],
         [40.051],
         [47.550],
         [54.597],
         [58.641],
         [51.113],
         [50.179],
         [49.967],
         [52.773]],

        [[59.635],
         [34.850],
         [46.791],
         [54.494],
         [49.780],
         [54.015],
         [52.411],
         [56.218],
         [65.150],
         [54.017]],

        [[52.805],
         [44.187],
         [51.732],
         [58.567],
         [53.961],
         [58.290],
         [26.607],
         [47.358],
         [41.963],
         [46.183]],

        [[48.871],
         [41.692],
         [65.101],
         [48.788],
         [42.576],
         [49.868],
         [61.123],
         [63.243],
         [62.000],
         [51.171]],

        [[41.745],
         [43.328],
         [58.031],
         [50.492],
         [46.741],
         [51.902],
         [59.645],
         [34.965],
         [53.710],
         [45.064]],

        [[43.678],
         [51.308],
         [39.047],
         [56.518],
         [46.370],
         [56.827],
         [57.033],
         [51.847],
         [51.661],
         [65.673]],

        [[55.465],
         [55.597],
         [58.369],
         [44.372],
         [53.601],
         [48.173],
         [48.282],
         [57.850],
         [32.685],
         [49.439]],

        [[53.875],
         [48.555],
         [56.062],
         [49.476],
         [53.869],
         [58.890],
         [39.998],
         [44.189],
         [38.859],
         [57.441]],

        [[49.077],
         [41.306],
         [50.907],
         [43.075],
         [54.695],
         [51.603],
         [42.739],
         [47.132],
         [40.757],
         [55.440]],

        [[46.547],
         [55.620],
         [39.767],
         [40.418],
         [52.315],
         [66.560],
         [61.338],
         [44.155],
         [46.223],
         [36.700]],

        [[60.449],
         [49.087],
         [52.631],
         [55.042],
         [60.502],
         [57.160],
         [51.968],
         [42.232],
         [49.679],
         [54.196]]], device='cuda:0')
clipping threshold 0.34323616962853826
a after update for 1 param tensor([[ 0.040],
        [-0.065],
        [-0.017],
        [-0.009],
        [-0.025],
        [ 0.014],
        [ 0.004],
        [ 0.005],
        [-0.003],
        [ 0.007],
        [-0.017],
        [-0.023]], device='cuda:0')
s after update for 1 param tensor([[1.107],
        [1.899],
        [1.001],
        [0.994],
        [1.461],
        [1.444],
        [1.157],
        [1.517],
        [1.920],
        [1.184],
        [1.280],
        [1.781]], device='cuda:0')
b after update for 1 param tensor([[49.730],
        [65.125],
        [47.280],
        [47.118],
        [57.122],
        [56.795],
        [50.833],
        [58.216],
        [65.487],
        [51.420],
        [53.463],
        [63.066]], device='cuda:0')
clipping threshold 0.34323616962853826
||w||^2 0.11880211247104937
exp ma of ||w||^2 0.1760456985674128
||w|| 0.3446768232287303
exp ma of ||w|| 0.4101381502417838
||w||^2 0.1227901099188283
exp ma of ||w||^2 0.20766247894442963
||w|| 0.3504141976559002
exp ma of ||w|| 0.44512424112274085
||w||^2 0.4181761496003909
exp ma of ||w||^2 0.2372172303263206
||w|| 0.6466654077653999
exp ma of ||w|| 0.4782396641641582
||w||^2 0.5919891730014478
exp ma of ||w||^2 0.6748819133197526
||w|| 0.7694083265740291
exp ma of ||w|| 0.8182767713026963
||w||^2 0.7331562154625046
exp ma of ||w||^2 0.6950728397150024
||w|| 0.856245417776063
exp ma of ||w|| 0.8314066466794533
||w||^2 0.19355114986549687
exp ma of ||w||^2 0.23931007143030733
||w|| 0.4399444849813404
exp ma of ||w|| 0.45538043108848253
||w||^2 0.37277921602913544
exp ma of ||w||^2 0.305601600285301
||w|| 0.6105564806216829
exp ma of ||w|| 0.5124967345357372
v before min max tensor([[ 2.129, -2.785,  5.354,  ..., -0.380,  4.107,  0.146],
        [19.924, -2.467, -1.389,  ..., -1.051,  1.564, -1.226],
        [-1.844,  3.516, -0.750,  ..., -1.714, -0.030, -0.762],
        ...,
        [-2.181,  4.319,  1.938,  ...,  0.022,  2.102, -1.955],
        [-2.156, -2.365,  0.617,  ..., -1.376, -2.110, -1.659],
        [-0.562,  0.810, -1.276,  ..., -1.687, -0.478,  3.893]],
       device='cuda:0')
v tensor([[2.129e+00, 1.000e-12, 5.354e+00,  ..., 1.000e-12, 4.107e+00,
         1.465e-01],
        [1.000e+01, 1.000e-12, 1.000e-12,  ..., 1.000e-12, 1.564e+00,
         1.000e-12],
        [1.000e-12, 3.516e+00, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        ...,
        [1.000e-12, 4.319e+00, 1.938e+00,  ..., 2.153e-02, 2.102e+00,
         1.000e-12],
        [1.000e-12, 1.000e-12, 6.172e-01,  ..., 1.000e-12, 1.000e-12,
         1.000e-12],
        [1.000e-12, 8.096e-01, 1.000e-12,  ..., 1.000e-12, 1.000e-12,
         3.893e+00]], device='cuda:0')
v before min max tensor([ 3.485e-01,  2.955e+00, -2.678e+00, -7.894e-01, -2.602e+00,  7.269e+00,
        -1.125e+00, -1.207e-02, -1.540e+00,  3.358e+00,  7.599e+00, -1.561e+00,
        -1.474e+00, -1.939e+00, -1.128e+00, -1.071e+00, -2.656e+00, -9.281e-01,
        -1.300e+00,  4.675e+00,  2.946e+00, -2.146e+00, -9.903e-01, -1.759e+00,
        -2.722e-01,  1.264e+00, -2.322e+00, -5.652e-01, -1.223e+00,  8.262e+00,
         1.421e+00, -1.935e+00, -1.758e+00, -7.513e-01, -1.382e+00, -7.230e-01,
        -1.949e+00,  2.617e+01,  1.286e+01,  2.066e+00,  5.797e-01,  8.657e-01,
        -1.920e+00,  2.255e+00, -1.476e+00, -2.258e+00, -3.205e+00,  6.108e-02,
         4.209e+00, -1.890e+00,  3.229e+00, -1.009e+00, -1.650e+00, -1.045e+00,
        -2.077e-01, -1.145e+00, -3.553e+00,  1.953e+01,  1.130e+00, -1.100e+00,
        -8.797e-01,  2.246e+00,  3.142e+00, -2.557e+00,  7.913e-03, -2.518e+00,
        -6.498e-01, -2.116e+00,  1.690e+00, -2.938e+00, -3.920e-01,  1.273e+00,
        -1.431e+00, -1.582e+00, -2.259e+00,  1.745e+00,  2.394e+01, -6.269e-01,
        -1.897e+00, -2.257e+00, -7.503e-01, -1.968e+00,  2.805e+00,  8.160e-03,
         4.216e-01,  6.980e-01, -9.838e-01, -1.309e+00, -1.953e+00,  2.624e-01,
        -1.978e+00, -1.792e+00,  4.985e-01, -1.145e+00,  4.094e+00, -3.087e-01,
         6.457e+00, -1.478e+00,  9.980e+00,  1.354e+00, -2.209e+00,  1.573e+01,
        -1.950e+00, -6.665e-01, -2.499e+00, -1.896e-01,  4.006e-01, -1.048e+00,
        -1.022e+00, -1.883e+00, -1.303e+00,  1.549e+00,  7.239e+00, -2.725e-01,
        -1.074e+00,  8.220e+00,  3.080e+00, -3.373e+00, -1.423e+00, -2.028e+00],
       device='cuda:0')
v tensor([3.485e-01, 2.955e+00, 1.000e-12, 1.000e-12, 1.000e-12, 7.269e+00,
        1.000e-12, 1.000e-12, 1.000e-12, 3.358e+00, 7.599e+00, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 4.675e+00, 2.946e+00, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.264e+00, 1.000e-12, 1.000e-12, 1.000e-12, 8.262e+00,
        1.421e+00, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e+01, 1.000e+01, 2.066e+00, 5.797e-01, 8.657e-01,
        1.000e-12, 2.255e+00, 1.000e-12, 1.000e-12, 1.000e-12, 6.108e-02,
        4.209e+00, 1.000e-12, 3.229e+00, 1.000e-12, 1.000e-12, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e+01, 1.130e+00, 1.000e-12,
        1.000e-12, 2.246e+00, 3.142e+00, 1.000e-12, 7.913e-03, 1.000e-12,
        1.000e-12, 1.000e-12, 1.690e+00, 1.000e-12, 1.000e-12, 1.273e+00,
        1.000e-12, 1.000e-12, 1.000e-12, 1.745e+00, 1.000e+01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 2.805e+00, 8.160e-03,
        4.216e-01, 6.980e-01, 1.000e-12, 1.000e-12, 1.000e-12, 2.624e-01,
        1.000e-12, 1.000e-12, 4.985e-01, 1.000e-12, 4.094e+00, 1.000e-12,
        6.457e+00, 1.000e-12, 9.980e+00, 1.354e+00, 1.000e-12, 1.000e+01,
        1.000e-12, 1.000e-12, 1.000e-12, 1.000e-12, 4.006e-01, 1.000e-12,
        1.000e-12, 1.000e-12, 1.000e-12, 1.549e+00, 7.239e+00, 1.000e-12,
        1.000e-12, 8.220e+00, 3.080e+00, 1.000e-12, 1.000e-12, 1.000e-12],
       device='cuda:0')
v before min max tensor([[[-2.256e+00],
         [ 1.382e+00],
         [-1.760e+00],
         [ 6.699e+00],
         [-1.749e+00],
         [-1.756e+00],
         [-3.347e-01],
         [-2.684e+00],
         [-1.877e+00],
         [-1.319e+00]],

        [[ 3.573e+00],
         [-1.100e+00],
         [ 1.052e+00],
         [ 1.873e+01],
         [ 7.219e+00],
         [-2.308e+00],
         [ 4.530e+00],
         [-8.097e-01],
         [ 4.351e+00],
         [-1.139e+00]],

        [[-1.398e+00],
         [ 1.564e+00],
         [ 1.214e+00],
         [-2.977e+00],
         [-2.100e+00],
         [-3.358e+00],
         [ 3.715e-01],
         [-2.170e+00],
         [-2.257e+00],
         [-3.046e+00]],

        [[-7.181e-01],
         [-1.865e+00],
         [-1.657e+00],
         [-2.394e+00],
         [-2.385e+00],
         [-3.002e+00],
         [-2.147e+00],
         [ 5.651e+00],
         [-1.479e+00],
         [ 4.030e+00]],

        [[ 4.707e-01],
         [-3.802e+00],
         [-2.790e+00],
         [-2.743e+00],
         [-1.695e+00],
         [-2.477e+00],
         [ 8.641e-02],
         [ 2.933e+00],
         [ 2.920e-01],
         [ 6.853e-01]],

        [[-1.659e+00],
         [ 1.853e+00],
         [-1.900e-01],
         [ 1.069e+00],
         [-2.820e+00],
         [ 2.619e+00],
         [ 2.392e+00],
         [ 5.139e+00],
         [ 1.041e+01],
         [-3.808e+00]],

        [[-1.230e+00],
         [-1.080e+00],
         [-1.982e+00],
         [-2.415e+00],
         [ 8.927e+00],
         [-9.990e-01],
         [-3.698e+00],
         [-6.513e-01],
         [ 1.635e+01],
         [-2.065e+00]],

        [[-1.075e+00],
         [ 7.995e+00],
         [-1.524e+00],
         [ 5.849e-01],
         [-1.101e+00],
         [ 6.405e-03],
         [-1.657e+00],
         [-1.284e+00],
         [-2.806e+00],
         [-1.846e+00]],

        [[ 2.838e+00],
         [ 2.084e+00],
         [ 1.379e+00],
         [-2.121e+00],
         [-1.189e+00],
         [ 1.241e+00],
         [-2.141e+00],
         [ 4.038e+00],
         [-1.180e+00],
         [-2.419e+00]],

        [[-2.160e-01],
         [-4.778e+00],
         [-1.580e+00],
         [ 4.242e+00],
         [-3.094e+00],
         [-2.931e-01],
         [-1.128e+00],
         [ 2.979e+00],
         [-8.233e-01],
         [ 1.638e-01]],

        [[ 1.017e+01],
         [ 8.174e+00],
         [-2.772e+00],
         [-3.103e+00],
         [-2.504e+00],
         [ 1.930e+00],
         [-6.745e-01],
         [ 1.159e+00],
         [-3.605e+00],
         [-2.551e+00]],

        [[-2.559e+00],
         [-1.323e+00],
         [-2.438e+00],
         [-2.064e+00],
         [-2.275e+00],
         [-1.309e+00],
         [-2.033e+00],
         [-1.485e+00],
         [-2.173e+00],
         [-3.183e+00]]], device='cuda:0')
v tensor([[[1.000e-12],
         [1.382e+00],
         [1.000e-12],
         [6.699e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[3.573e+00],
         [1.000e-12],
         [1.052e+00],
         [1.000e+01],
         [7.219e+00],
         [1.000e-12],
         [4.530e+00],
         [1.000e-12],
         [4.351e+00],
         [1.000e-12]],

        [[1.000e-12],
         [1.564e+00],
         [1.214e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [3.715e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [5.651e+00],
         [1.000e-12],
         [4.030e+00]],

        [[4.707e-01],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [8.641e-02],
         [2.933e+00],
         [2.920e-01],
         [6.853e-01]],

        [[1.000e-12],
         [1.853e+00],
         [1.000e-12],
         [1.069e+00],
         [1.000e-12],
         [2.619e+00],
         [2.392e+00],
         [5.139e+00],
         [1.000e+01],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [8.927e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e+01],
         [1.000e-12]],

        [[1.000e-12],
         [7.995e+00],
         [1.000e-12],
         [5.849e-01],
         [1.000e-12],
         [6.405e-03],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]],

        [[2.838e+00],
         [2.084e+00],
         [1.379e+00],
         [1.000e-12],
         [1.000e-12],
         [1.241e+00],
         [1.000e-12],
         [4.038e+00],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [4.242e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [2.979e+00],
         [1.000e-12],
         [1.638e-01]],

        [[1.000e+01],
         [8.174e+00],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.930e+00],
         [1.000e-12],
         [1.159e+00],
         [1.000e-12],
         [1.000e-12]],

        [[1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12],
         [1.000e-12]]], device='cuda:0')
v before min max tensor([[-3.986],
        [-1.528],
        [-2.137],
        [ 2.242],
        [-2.536],
        [-0.388],
        [-1.763],
        [16.629],
        [-2.005],
        [ 7.683],
        [-1.172],
        [-2.168]], device='cuda:0')
v tensor([[1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [2.242e+00],
        [1.000e-12],
        [1.000e-12],
        [1.000e-12],
        [1.000e+01],
        [1.000e-12],
        [7.683e+00],
        [1.000e-12],
        [1.000e-12]], device='cuda:0')
a after update for 1 param tensor([[ 0.003, -0.354,  0.051,  ..., -0.006,  0.028, -0.049],
        [ 0.004, -0.220,  0.249,  ..., -0.003,  0.043, -0.040],
        [-0.003,  0.195, -0.025,  ..., -0.019, -0.201,  0.029],
        ...,
        [ 0.010,  0.067,  0.016,  ..., -0.013, -0.088, -0.008],
        [ 0.008, -0.056, -0.049,  ..., -0.016,  0.174,  0.015],
        [ 0.001,  0.190, -0.009,  ..., -0.019, -0.072, -0.005]],
       device='cuda:0')
s after update for 1 param tensor([[0.883, 1.225, 1.143,  ..., 0.725, 1.341, 0.674],
        [1.622, 1.175, 0.674,  ..., 0.688, 1.337, 1.311],
        [1.019, 0.755, 0.734,  ..., 0.747, 1.275, 0.880],
        ...,
        [0.950, 1.016, 1.597,  ..., 1.334, 1.014, 0.989],
        [0.964, 1.081, 0.728,  ..., 0.634, 0.938, 0.880],
        [0.293, 1.322, 1.456,  ..., 0.882, 0.635, 1.247]], device='cuda:0')
b after update for 1 param tensor([[37.971, 44.722, 43.197,  ..., 34.403, 46.793, 33.181],
        [51.466, 43.796, 33.166,  ..., 33.524, 46.713, 46.262],
        [40.783, 35.102, 34.609,  ..., 34.917, 45.619, 37.907],
        ...,
        [39.392, 40.737, 51.061,  ..., 46.669, 40.691, 40.173],
        [39.667, 42.004, 34.469,  ..., 32.185, 39.137, 37.899],
        [21.870, 46.466, 48.749,  ..., 37.955, 32.206, 45.124]],
       device='cuda:0')
clipping threshold 0.35891476494078345
a after update for 1 param tensor([ 0.104, -0.396,  0.068,  0.230,  0.262, -0.066,  0.067, -0.278, -0.089,
        -0.011,  0.240,  0.090,  0.061, -0.222, -0.086,  0.034, -0.260,  0.066,
        -0.120,  0.337, -0.015,  0.001,  0.056,  0.032, -0.148,  0.214,  0.092,
         0.086, -0.014, -0.049, -0.068,  0.004, -0.093,  0.060,  0.161,  0.030,
        -0.008, -0.464, -0.347, -0.013, -0.130, -0.081,  0.079, -0.251, -0.032,
        -0.076, -0.091, -0.016,  0.082,  0.302,  0.098,  0.002,  0.061, -0.076,
        -0.108, -0.305,  0.334, -0.224, -0.197,  0.002,  0.295,  0.069,  0.062,
        -0.210, -0.134,  0.164,  0.051,  0.106,  0.229,  0.181,  0.054, -0.287,
        -0.082, -0.133,  0.222, -0.287, -0.155, -0.086, -0.265, -0.007,  0.003,
        -0.019, -0.119, -0.002, -0.027, -0.131,  0.207, -0.048,  0.164,  0.068,
         0.127, -0.093,  0.001, -0.065, -0.146, -0.026, -0.038, -0.206, -0.167,
        -0.074, -0.154, -0.212, -0.267, -0.127,  0.271, -0.258,  0.271,  0.022,
        -0.089,  0.056,  0.080, -0.096,  0.139,  0.271, -0.001, -0.151, -0.102,
         0.311,  0.126,  0.151], device='cuda:0')
s after update for 1 param tensor([1.023, 1.711, 1.164, 1.173, 1.151, 1.155, 0.496, 1.402, 1.092, 1.035,
        1.238, 0.689, 0.686, 0.932, 0.767, 0.630, 1.319, 0.861, 0.682, 1.628,
        0.895, 1.283, 0.779, 0.764, 0.733, 1.159, 1.008, 0.972, 0.901, 1.350,
        0.763, 0.840, 0.765, 0.422, 0.654, 0.713, 1.179, 1.378, 1.704, 1.634,
        0.667, 0.781, 0.925, 1.303, 0.644, 0.990, 1.457, 0.748, 0.799, 1.126,
        1.061, 0.645, 0.731, 0.514, 0.547, 1.536, 1.741, 1.499, 1.324, 0.488,
        1.439, 0.691, 1.122, 1.303, 1.032, 1.104, 0.789, 1.367, 1.466, 1.286,
        0.291, 1.458, 0.769, 1.261, 1.000, 1.652, 1.272, 0.513, 0.970, 0.996,
        0.442, 0.904, 1.037, 0.702, 0.724, 1.117, 0.953, 0.599, 0.873, 1.078,
        0.859, 1.278, 0.742, 0.520, 1.099, 0.679, 1.342, 1.419, 1.324, 0.696,
        1.074, 1.522, 0.896, 0.865, 1.135, 1.025, 1.460, 0.460, 0.494, 0.826,
        0.590, 0.659, 1.380, 0.444, 0.466, 1.452, 1.515, 1.474, 0.889, 0.985],
       device='cuda:0')
b after update for 1 param tensor([40.863, 52.849, 43.596, 43.763, 43.355, 43.426, 28.454, 47.845, 42.227,
        41.115, 44.949, 33.538, 33.463, 39.004, 35.385, 32.067, 46.408, 37.489,
        33.372, 51.559, 38.220, 45.761, 35.663, 35.318, 34.594, 43.497, 40.576,
        39.843, 38.350, 46.948, 35.295, 37.035, 35.340, 26.255, 32.668, 34.107,
        43.872, 47.434, 52.748, 51.645, 33.011, 35.700, 38.851, 46.125, 32.426,
        40.208, 48.778, 34.943, 36.115, 42.885, 41.610, 32.442, 34.553, 28.977,
        29.879, 50.074, 53.316, 49.471, 46.500, 28.230, 48.478, 33.584, 42.805,
        46.128, 41.045, 42.450, 35.893, 47.246, 48.928, 45.821, 21.778, 48.795,
        35.425, 45.382, 40.404, 51.931, 45.572, 28.951, 39.797, 40.324, 26.849,
        38.415, 41.146, 33.860, 34.371, 42.702, 39.439, 31.284, 37.745, 41.960,
        37.445, 45.671, 34.796, 29.150, 42.365, 33.290, 46.812, 48.139, 46.491,
        33.713, 41.866, 49.845, 38.240, 37.590, 43.049, 40.905, 48.828, 27.407,
        28.389, 36.726, 31.041, 32.808, 47.458, 26.926, 27.596, 48.686, 49.726,
        49.051, 38.101, 40.093], device='cuda:0')
clipping threshold 0.35891476494078345
a after update for 1 param tensor([[[-0.106],
         [ 0.496],
         [ 0.107],
         [ 0.252],
         [ 0.146],
         [ 0.051],
         [ 0.129],
         [ 0.101],
         [-0.169],
         [ 0.151]],

        [[ 0.080],
         [-0.245],
         [-0.163],
         [-0.337],
         [-0.230],
         [-0.151],
         [-0.101],
         [ 0.010],
         [-0.078],
         [-0.086]],

        [[ 0.281],
         [ 0.273],
         [-0.189],
         [ 0.262],
         [ 0.286],
         [-0.243],
         [-0.024],
         [-0.175],
         [ 0.165],
         [ 0.296]],

        [[ 0.141],
         [ 0.020],
         [ 0.068],
         [-0.127],
         [-0.314],
         [ 0.392],
         [ 0.093],
         [-0.128],
         [-0.058],
         [ 0.114]],

        [[ 0.070],
         [ 0.323],
         [-0.412],
         [-0.295],
         [-0.075],
         [-0.147],
         [-0.001],
         [ 0.113],
         [ 0.013],
         [-0.003]],

        [[-0.076],
         [-0.145],
         [-0.154],
         [ 0.073],
         [-0.084],
         [-0.019],
         [ 0.075],
         [ 0.088],
         [-0.352],
         [ 0.032]],

        [[-0.017],
         [ 0.012],
         [ 0.084],
         [ 0.035],
         [-0.116],
         [-0.089],
         [ 0.397],
         [-0.053],
         [ 0.021],
         [ 0.015]],

        [[ 0.190],
         [ 0.057],
         [-0.033],
         [ 0.152],
         [-0.054],
         [ 0.045],
         [ 0.056],
         [ 0.115],
         [ 0.387],
         [ 0.044]],

        [[-0.145],
         [-0.017],
         [-0.239],
         [-0.183],
         [-0.065],
         [-0.010],
         [-0.067],
         [-0.057],
         [ 0.137],
         [-0.332]],

        [[ 0.289],
         [-0.307],
         [ 0.414],
         [-0.108],
         [-0.213],
         [ 0.047],
         [ 0.040],
         [-0.098],
         [-0.033],
         [ 0.080]],

        [[-0.271],
         [-0.198],
         [-0.531],
         [-0.534],
         [ 0.289],
         [-0.250],
         [ 0.016],
         [-0.215],
         [ 0.282],
         [-0.278]],

        [[ 0.122],
         [-0.075],
         [-0.210],
         [ 0.136],
         [-0.197],
         [-0.101],
         [ 0.102],
         [ 0.030],
         [ 0.033],
         [-0.515]]], device='cuda:0')
s after update for 1 param tensor([[[1.180],
         [1.604],
         [0.942],
         [1.201],
         [0.760],
         [0.767],
         [0.698],
         [1.182],
         [1.056],
         [0.642]],

        [[1.138],
         [0.486],
         [0.798],
         [1.934],
         [1.515],
         [1.515],
         [1.003],
         [0.352],
         [0.980],
         [0.909]],

        [[0.992],
         [0.799],
         [1.559],
         [1.321],
         [0.929],
         [1.525],
         [0.900],
         [1.592],
         [0.986],
         [1.337]],

        [[1.152],
         [0.958],
         [0.901],
         [1.230],
         [1.284],
         [1.395],
         [1.217],
         [1.166],
         [0.979],
         [1.023]],

        [[0.812],
         [1.747],
         [1.465],
         [1.368],
         [1.038],
         [1.088],
         [1.019],
         [0.975],
         [0.904],
         [0.601]],

        [[1.111],
         [0.823],
         [0.969],
         [0.842],
         [1.260],
         [0.916],
         [0.982],
         [1.047],
         [1.582],
         [1.701]],

        [[0.662],
         [1.006],
         [1.029],
         [1.117],
         [1.681],
         [0.634],
         [1.980],
         [0.514],
         [1.336],
         [1.299]],

        [[0.529],
         [1.320],
         [1.125],
         [0.812],
         [0.755],
         [0.769],
         [0.931],
         [0.595],
         [1.659],
         [0.816]],

        [[1.395],
         [1.293],
         [1.365],
         [1.171],
         [1.032],
         [1.216],
         [1.020],
         [1.254],
         [0.610],
         [1.264]],

        [[1.242],
         [2.079],
         [1.692],
         [1.357],
         [1.835],
         [1.170],
         [1.235],
         [1.603],
         [0.952],
         [1.138]],

        [[1.760],
         [1.464],
         [1.584],
         [1.636],
         [1.117],
         [1.173],
         [0.921],
         [0.836],
         [1.568],
         [1.180]],

        [[1.728],
         [1.140],
         [1.064],
         [0.952],
         [1.148],
         [0.582],
         [1.495],
         [1.053],
         [1.150],
         [1.391]]], device='cuda:0')
b after update for 1 param tensor([[[43.889],
         [51.177],
         [39.212],
         [44.273],
         [35.216],
         [35.385],
         [33.758],
         [43.930],
         [41.523],
         [32.387]],

        [[43.097],
         [28.181],
         [36.100],
         [56.189],
         [49.734],
         [49.737],
         [40.463],
         [23.972],
         [40.009],
         [38.515]],

        [[40.247],
         [36.122],
         [50.444],
         [46.436],
         [38.955],
         [49.900],
         [38.340],
         [50.988],
         [40.122],
         [46.723]],

        [[43.358],
         [39.556],
         [38.360],
         [44.821],
         [45.785],
         [47.722],
         [44.569],
         [43.628],
         [39.984],
         [40.859]],

        [[36.400],
         [53.405],
         [48.903],
         [47.250],
         [41.174],
         [42.146],
         [40.783],
         [39.902],
         [38.415],
         [31.321]],

        [[42.592],
         [36.666],
         [39.781],
         [37.071],
         [45.362],
         [38.667],
         [40.036],
         [41.338],
         [50.813],
         [52.701]],

        [[32.869],
         [40.528],
         [40.992],
         [42.710],
         [52.382],
         [32.174],
         [56.862],
         [28.974],
         [46.702],
         [46.045]],

        [[29.376],
         [46.424],
         [42.854],
         [36.402],
         [35.108],
         [35.427],
         [38.978],
         [31.155],
         [52.042],
         [36.504]],

        [[47.729],
         [45.948],
         [47.204],
         [43.730],
         [41.044],
         [44.560],
         [40.798],
         [45.248],
         [31.562],
         [45.424]],

        [[45.027],
         [58.263],
         [52.560],
         [47.076],
         [54.730],
         [43.698],
         [44.902],
         [51.160],
         [39.424],
         [43.097]],

        [[53.608],
         [48.882],
         [50.849],
         [51.678],
         [42.702],
         [43.754],
         [38.777],
         [36.948],
         [50.602],
         [43.897]],

        [[53.119],
         [43.142],
         [41.670],
         [39.418],
         [43.293],
         [30.820],
         [49.397],
         [41.470],
         [43.324],
         [47.657]]], device='cuda:0')
clipping threshold 0.35891476494078345
a after update for 1 param tensor([[ 0.627],
        [ 0.078],
        [-0.027],
        [ 0.021],
        [-0.115],
        [-0.268],
        [-0.113],
        [ 0.296],
        [-0.162],
        [-0.001],
        [-0.136],
        [-0.238]], device='cuda:0')
s after update for 1 param tensor([[1.736],
        [1.408],
        [1.050],
        [1.250],
        [1.134],
        [1.516],
        [1.575],
        [1.517],
        [1.002],
        [1.460],
        [0.669],
        [1.221]], device='cuda:0')
b after update for 1 param tensor([[53.231],
        [47.941],
        [41.409],
        [45.183],
        [43.034],
        [49.755],
        [50.709],
        [49.760],
        [40.451],
        [48.818],
        [33.052],
        [44.641]], device='cuda:0')
clipping threshold 0.35891476494078345
||w||^2 0.39136781863852377
exp ma of ||w||^2 0.32023399726192303
||w|| 0.6255939726679948
exp ma of ||w|| 0.5290026014295781
cuda
Objective function 11.63 = squared loss an data 10.65 + 0.5*rho*h**2 0.002178 + alpha*h 0.065203 + L2reg 0.82 + L1reg 0.09 ; SHD = 34 ; DAG True
Proportion of microbatches that were clipped  0.7731667528747066
iteration 1 in inner loop, alpha 312.4029490004466 rho 100000.0 h 0.00020871527075883023
iteration 5 in outer loop, alpha = 333.2744760763296, rho = 100000.0, h = 0.00020871527075883023
cuda
1692
cuda
Objective function 11.64 = squared loss an data 10.65 + 0.5*rho*h**2 0.002178 + alpha*h 0.069559 + L2reg 0.82 + L1reg 0.09 ; SHD = 34 ; DAG True
||w||^2 1.7557842336290936
exp ma of ||w||^2 4633247042.806191
||w|| 1.3250600867994982
exp ma of ||w|| 372.4393842228922
||w||^2 0.35604324501700074
exp ma of ||w||^2 140259788.29171538
||w|| 0.596693593913158
exp ma of ||w|| 12.027699736250705
||w||^2 0.25572285398128985
exp ma of ||w||^2 13761416.469557852
||w|| 0.5056904725039714
exp ma of ||w|| 1.6299320631162877
||w||^2 0.09859408726817964
exp ma of ||w||^2 610342.4441797497
||w|| 0.3139969542339219
exp ma of ||w|| 0.4460193240204009
||w||^2 0.10121948382418873
exp ma of ||w||^2 4.7333322099403015
||w|| 0.31815009637620534
exp ma of ||w|| 0.4204760799975725
||w||^2 0.13548215261430654
exp ma of ||w||^2 0.21469148015194825
||w|| 0.3680790032239092
exp ma of ||w|| 0.4492946150677051
||w||^2 0.15830920576522972
exp ma of ||w||^2 0.21516293535109404
||w|| 0.39788089394343845
exp ma of ||w|| 0.44509878742489567
||w||^2 0.3199323207319307
exp ma of ||w||^2 0.20325280669299717
||w|| 0.5656256011991773
exp ma of ||w|| 0.44037136004643895
||w||^2 0.2165767140658029
exp ma of ||w||^2 0.2103046054747067
||w|| 0.4653780335015856
exp ma of ||w|| 0.44681766712363846
||w||^2 0.164505557403915
exp ma of ||w||^2 0.186300542744165
||w|| 0.40559284683524066
exp ma of ||w|| 0.42193607530823124
||w||^2 0.20747747603400177
exp ma of ||w||^2 0.20899913031985085
||w|| 0.4554969550216574
exp ma of ||w|| 0.4471688556555447
||w||^2 0.28873682995596556
exp ma of ||w||^2 0.3288896444995269
||w|| 0.5373423768473556
exp ma of ||w|| 0.5697586973382983
||w||^2 0.4179490815514481
exp ma of ||w||^2 0.391508596431214
||w|| 0.6464898155048138
exp ma of ||w|| 0.6197349236276075
||w||^2 6.682855085349327
exp ma of ||w||^2 3.1718765623091207
||w|| 2.585121870502303
exp ma of ||w|| 1.7692757818999985
||w||^2 12.272915985303051
exp ma of ||w||^2 5.993778687344648
||w|| 3.503272182589165
exp ma of ||w|| 2.370596059099492
||w||^2 54.778398215004316
exp ma of ||w||^2 111.82654270875236
||w|| 7.40124301823716
exp ma of ||w|| 9.931445452284406
||w||^2 2.528386042718456
exp ma of ||w||^2 6.247523387128012
||w|| 1.5900899479961679
exp ma of ||w|| 2.2238534887837385
||w||^2 0.30144931021473104
exp ma of ||w||^2 0.5239721028853506
||w|| 0.5490439966111378
exp ma of ||w|| 0.6900008487684349
||w||^2 0.20955058407069413
exp ma of ||w||^2 0.2368368922224551
||w|| 0.4577669538866847
exp ma of ||w|| 0.48068164955907755
||w||^2 0.11748594777192127
exp ma of ||w||^2 0.19434565094317888
||w|| 0.3427622321258882
exp ma of ||w|| 0.43356612099722397
||w||^2 0.24580361814759866
exp ma of ||w||^2 0.21197291449742828
||w|| 0.4957858591646182
exp ma of ||w|| 0.44224340656096345
cuda
Objective function 13.00 = squared loss an data 11.90 + 0.5*rho*h**2 0.002988 + alpha*h 0.081465 + L2reg 0.91 + L1reg 0.10 ; SHD = 38 ; DAG True
Proportion of microbatches that were clipped  0.7712160804020101
iteration 1 in inner loop, alpha 333.2744760763296 rho 100000.0 h 0.000244439110792527
iteration 6 in outer loop, alpha = 577.7135868688566, rho = 1000000.0, h = 0.000244439110792527
Threshold 0.3
[[0.002 0.003 0.012 0.11  0.003 0.002 0.086 0.001 0.    0.13  0.001 0.002]
 [0.636 0.002 0.916 1.43  0.375 0.279 0.782 0.003 0.014 0.874 0.376 0.696]
 [0.269 0.002 0.003 0.375 0.007 0.008 0.327 0.001 0.001 0.59  0.01  0.094]
 [0.053 0.001 0.003 0.002 0.001 0.003 0.325 0.001 0.    0.009 0.004 0.006]
 [0.448 0.005 0.331 1.166 0.002 0.361 0.591 0.002 0.002 1.198 0.038 0.407]
 [0.383 0.002 0.256 0.247 0.003 0.001 0.422 0.001 0.001 0.148 0.001 0.006]
 [0.031 0.001 0.004 0.003 0.002 0.002 0.002 0.001 0.    0.012 0.002 0.008]
 [0.71  0.328 0.502 0.9   0.533 0.81  1.047 0.001 0.137 1.199 0.434 0.525]
 [1.185 0.26  0.824 2.504 0.587 0.714 1.512 0.006 0.001 1.36  1.657 1.082]
 [0.018 0.    0.002 0.291 0.    0.005 0.147 0.    0.    0.003 0.002 0.003]
 [0.698 0.012 0.114 0.527 0.068 0.53  0.454 0.002 0.    0.653 0.002 0.358]
 [0.567 0.001 0.024 0.376 0.002 0.249 0.297 0.001 0.    0.374 0.005 0.003]]
[[0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.636 0.    0.916 1.43  0.375 0.    0.782 0.    0.    0.874 0.376 0.696]
 [0.    0.    0.    0.375 0.    0.    0.327 0.    0.    0.59  0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.325 0.    0.    0.    0.    0.   ]
 [0.448 0.    0.331 1.166 0.    0.361 0.591 0.    0.    1.198 0.    0.407]
 [0.383 0.    0.    0.    0.    0.    0.422 0.    0.    0.    0.    0.   ]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.71  0.328 0.502 0.9   0.533 0.81  1.047 0.    0.    1.199 0.434 0.525]
 [1.185 0.    0.824 2.504 0.587 0.714 1.512 0.    0.    1.36  1.657 1.082]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.698 0.    0.    0.527 0.    0.53  0.454 0.    0.    0.653 0.    0.358]
 [0.567 0.    0.    0.376 0.    0.    0.    0.    0.    0.374 0.    0.   ]]
{'fdr': 0.673469387755102, 'tpr': 0.6666666666666666, 'fpr': 0.7857142857142857, 'f1': 0.4383561643835617, 'shd': 38, 'npred': 49, 'ntrue': 24}
[3.029e-03 1.210e-02 1.097e-01 3.007e-03 1.581e-03 8.573e-02 9.318e-04
 4.625e-04 1.297e-01 1.289e-03 2.319e-03 6.361e-01 9.156e-01 1.430e+00
 3.747e-01 2.785e-01 7.824e-01 3.049e-03 1.433e-02 8.742e-01 3.765e-01
 6.963e-01 2.686e-01 1.557e-03 3.745e-01 7.347e-03 7.659e-03 3.274e-01
 1.228e-03 8.646e-04 5.905e-01 9.628e-03 9.448e-02 5.311e-02 6.153e-04
 2.715e-03 5.960e-04 3.285e-03 3.248e-01 5.328e-04 2.126e-04 9.398e-03
 4.443e-03 6.493e-03 4.478e-01 4.675e-03 3.306e-01 1.166e+00 3.610e-01
 5.911e-01 1.653e-03 1.696e-03 1.198e+00 3.832e-02 4.073e-01 3.827e-01
 2.288e-03 2.555e-01 2.466e-01 2.761e-03 4.218e-01 6.902e-04 5.122e-04
 1.478e-01 9.220e-04 6.075e-03 3.091e-02 5.785e-04 4.266e-03 2.624e-03
 1.777e-03 1.585e-03 6.418e-04 2.452e-04 1.248e-02 2.051e-03 8.034e-03
 7.101e-01 3.276e-01 5.019e-01 8.999e-01 5.325e-01 8.097e-01 1.047e+00
 1.375e-01 1.199e+00 4.337e-01 5.247e-01 1.185e+00 2.597e-01 8.239e-01
 2.504e+00 5.867e-01 7.138e-01 1.512e+00 6.206e-03 1.360e+00 1.657e+00
 1.082e+00 1.819e-02 4.360e-04 2.134e-03 2.915e-01 4.952e-04 4.791e-03
 1.473e-01 4.739e-04 4.616e-04 1.553e-03 2.600e-03 6.979e-01 1.203e-02
 1.143e-01 5.272e-01 6.819e-02 5.299e-01 4.541e-01 1.979e-03 4.864e-04
 6.526e-01 3.580e-01 5.668e-01 1.270e-03 2.448e-02 3.763e-01 2.424e-03
 2.494e-01 2.968e-01 1.173e-03 3.353e-04 3.742e-01 4.855e-03]
[[0. 0. 1. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 1. 0. 0. 0. 0. 0. 0. 1. 0. 1.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 1. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 1. 0. 1. 0. 0. 1. 0. 0. 1. 1. 0.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]]
[0. 1. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 1. 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0.
 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 0. 0.
 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 1. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 1. 0.
 1. 1. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0.
 1. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
aucroc, aucpr (0.7600308641975309, 0.4703465226882741)
Iterations 11000
Achieves (25.73096248983075, 1e-05)-DP
